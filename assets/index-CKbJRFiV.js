var lw=Object.defineProperty;var bv=n=>{throw TypeError(n)};var cw=(n,t,e)=>t in n?lw(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var Av=(n,t,e)=>cw(n,typeof t!="symbol"?t+"":t,e),Zd=(n,t,e)=>t.has(n)||bv("Cannot "+e);var xe=(n,t,e)=>(Zd(n,t,"read from private field"),e?e.call(n):t.get(n)),Hn=(n,t,e)=>t.has(n)?bv("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e),Xi=(n,t,e,i)=>(Zd(n,t,"write to private field"),i?i.call(n,e):t.set(n,e),e),er=(n,t,e)=>(Zd(n,t,"access private method"),e);var wv=(n,t,e,i)=>({set _(r){Xi(n,t,r,e)},get _(){return xe(n,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function e(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(r){if(r.ep)return;r.ep=!0;const a=e(r);fetch(r.href,a)}})();function uw(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Jd={exports:{}},Tl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sv;function hw(){if(Sv)return Tl;Sv=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,r,a){var l=null;if(a!==void 0&&(l=""+a),r.key!==void 0&&(l=""+r.key),"key"in r){a={};for(var c in r)c!=="key"&&(a[c]=r[c])}else a=r;return r=a.ref,{$$typeof:n,type:i,key:l,ref:r!==void 0?r:null,props:a}}return Tl.Fragment=t,Tl.jsx=e,Tl.jsxs=e,Tl}var Tv;function fw(){return Tv||(Tv=1,Jd.exports=hw()),Jd.exports}var ct=fw(),t0={exports:{}},Kt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cv;function dw(){if(Cv)return Kt;Cv=1;var n=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),m=Symbol.iterator;function v(G){return G===null||typeof G!="object"?null:(G=m&&G[m]||G["@@iterator"],typeof G=="function"?G:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,_={};function b(G,ht,P){this.props=G,this.context=ht,this.refs=_,this.updater=P||x}b.prototype.isReactComponent={},b.prototype.setState=function(G,ht){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,ht,"setState")},b.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function A(){}A.prototype=b.prototype;function T(G,ht,P){this.props=G,this.context=ht,this.refs=_,this.updater=P||x}var S=T.prototype=new A;S.constructor=T,E(S,b.prototype),S.isPureReactComponent=!0;var C=Array.isArray,N={H:null,A:null,T:null,S:null,V:null},B=Object.prototype.hasOwnProperty;function O(G,ht,P,j,z,X){return P=X.ref,{$$typeof:n,type:G,key:ht,ref:P!==void 0?P:null,props:X}}function H(G,ht){return O(G.type,ht,void 0,void 0,void 0,G.props)}function M(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function W(G){var ht={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(P){return ht[P]})}var Y=/\/+/g;function J(G,ht){return typeof G=="object"&&G!==null&&G.key!=null?W(""+G.key):ht.toString(36)}function ut(){}function At(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(ut,ut):(G.status="pending",G.then(function(ht){G.status==="pending"&&(G.status="fulfilled",G.value=ht)},function(ht){G.status==="pending"&&(G.status="rejected",G.reason=ht)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function Et(G,ht,P,j,z){var X=typeof G;(X==="undefined"||X==="boolean")&&(G=null);var et=!1;if(G===null)et=!0;else switch(X){case"bigint":case"string":case"number":et=!0;break;case"object":switch(G.$$typeof){case n:case t:et=!0;break;case p:return et=G._init,Et(et(G._payload),ht,P,j,z)}}if(et)return z=z(G),et=j===""?"."+J(G,0):j,C(z)?(P="",et!=null&&(P=et.replace(Y,"$&/")+"/"),Et(z,ht,P,"",function(pt){return pt})):z!=null&&(M(z)&&(z=H(z,P+(z.key==null||G&&G.key===z.key?"":(""+z.key).replace(Y,"$&/")+"/")+et)),ht.push(z)),1;et=0;var wt=j===""?".":j+":";if(C(G))for(var Ct=0;Ct<G.length;Ct++)j=G[Ct],X=wt+J(j,Ct),et+=Et(j,ht,P,X,z);else if(Ct=v(G),typeof Ct=="function")for(G=Ct.call(G),Ct=0;!(j=G.next()).done;)j=j.value,X=wt+J(j,Ct++),et+=Et(j,ht,P,X,z);else if(X==="object"){if(typeof G.then=="function")return Et(At(G),ht,P,j,z);throw ht=String(G),Error("Objects are not valid as a React child (found: "+(ht==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":ht)+"). If you meant to render a collection of children, use an array instead.")}return et}function q(G,ht,P){if(G==null)return G;var j=[],z=0;return Et(G,j,"","",function(X){return ht.call(P,X,z++)}),j}function nt(G){if(G._status===-1){var ht=G._result;ht=ht(),ht.then(function(P){(G._status===0||G._status===-1)&&(G._status=1,G._result=P)},function(P){(G._status===0||G._status===-1)&&(G._status=2,G._result=P)}),G._status===-1&&(G._status=0,G._result=ht)}if(G._status===1)return G._result.default;throw G._result}var St=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ht=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(ht))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)};function kt(){}return Kt.Children={map:q,forEach:function(G,ht,P){q(G,function(){ht.apply(this,arguments)},P)},count:function(G){var ht=0;return q(G,function(){ht++}),ht},toArray:function(G){return q(G,function(ht){return ht})||[]},only:function(G){if(!M(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},Kt.Component=b,Kt.Fragment=e,Kt.Profiler=r,Kt.PureComponent=T,Kt.StrictMode=i,Kt.Suspense=h,Kt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,Kt.__COMPILER_RUNTIME={__proto__:null,c:function(G){return N.H.useMemoCache(G)}},Kt.cache=function(G){return function(){return G.apply(null,arguments)}},Kt.cloneElement=function(G,ht,P){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var j=E({},G.props),z=G.key,X=void 0;if(ht!=null)for(et in ht.ref!==void 0&&(X=void 0),ht.key!==void 0&&(z=""+ht.key),ht)!B.call(ht,et)||et==="key"||et==="__self"||et==="__source"||et==="ref"&&ht.ref===void 0||(j[et]=ht[et]);var et=arguments.length-2;if(et===1)j.children=P;else if(1<et){for(var wt=Array(et),Ct=0;Ct<et;Ct++)wt[Ct]=arguments[Ct+2];j.children=wt}return O(G.type,z,void 0,void 0,X,j)},Kt.createContext=function(G){return G={$$typeof:l,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:a,_context:G},G},Kt.createElement=function(G,ht,P){var j,z={},X=null;if(ht!=null)for(j in ht.key!==void 0&&(X=""+ht.key),ht)B.call(ht,j)&&j!=="key"&&j!=="__self"&&j!=="__source"&&(z[j]=ht[j]);var et=arguments.length-2;if(et===1)z.children=P;else if(1<et){for(var wt=Array(et),Ct=0;Ct<et;Ct++)wt[Ct]=arguments[Ct+2];z.children=wt}if(G&&G.defaultProps)for(j in et=G.defaultProps,et)z[j]===void 0&&(z[j]=et[j]);return O(G,X,void 0,void 0,null,z)},Kt.createRef=function(){return{current:null}},Kt.forwardRef=function(G){return{$$typeof:c,render:G}},Kt.isValidElement=M,Kt.lazy=function(G){return{$$typeof:p,_payload:{_status:-1,_result:G},_init:nt}},Kt.memo=function(G,ht){return{$$typeof:f,type:G,compare:ht===void 0?null:ht}},Kt.startTransition=function(G){var ht=N.T,P={};N.T=P;try{var j=G(),z=N.S;z!==null&&z(P,j),typeof j=="object"&&j!==null&&typeof j.then=="function"&&j.then(kt,St)}catch(X){St(X)}finally{N.T=ht}},Kt.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},Kt.use=function(G){return N.H.use(G)},Kt.useActionState=function(G,ht,P){return N.H.useActionState(G,ht,P)},Kt.useCallback=function(G,ht){return N.H.useCallback(G,ht)},Kt.useContext=function(G){return N.H.useContext(G)},Kt.useDebugValue=function(){},Kt.useDeferredValue=function(G,ht){return N.H.useDeferredValue(G,ht)},Kt.useEffect=function(G,ht,P){var j=N.H;if(typeof P=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return j.useEffect(G,ht)},Kt.useId=function(){return N.H.useId()},Kt.useImperativeHandle=function(G,ht,P){return N.H.useImperativeHandle(G,ht,P)},Kt.useInsertionEffect=function(G,ht){return N.H.useInsertionEffect(G,ht)},Kt.useLayoutEffect=function(G,ht){return N.H.useLayoutEffect(G,ht)},Kt.useMemo=function(G,ht){return N.H.useMemo(G,ht)},Kt.useOptimistic=function(G,ht){return N.H.useOptimistic(G,ht)},Kt.useReducer=function(G,ht,P){return N.H.useReducer(G,ht,P)},Kt.useRef=function(G){return N.H.useRef(G)},Kt.useState=function(G){return N.H.useState(G)},Kt.useSyncExternalStore=function(G,ht,P){return N.H.useSyncExternalStore(G,ht,P)},Kt.useTransition=function(){return N.H.useTransition()},Kt.version="19.1.1",Kt}var Rv;function ep(){return Rv||(Rv=1,t0.exports=dw()),t0.exports}var re=ep();const qs=uw(re);var e0={exports:{}},Cl={},i0={exports:{}},n0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dv;function pw(){return Dv||(Dv=1,(function(n){function t(q,nt){var St=q.length;q.push(nt);t:for(;0<St;){var kt=St-1>>>1,G=q[kt];if(0<r(G,nt))q[kt]=nt,q[St]=G,St=kt;else break t}}function e(q){return q.length===0?null:q[0]}function i(q){if(q.length===0)return null;var nt=q[0],St=q.pop();if(St!==nt){q[0]=St;t:for(var kt=0,G=q.length,ht=G>>>1;kt<ht;){var P=2*(kt+1)-1,j=q[P],z=P+1,X=q[z];if(0>r(j,St))z<G&&0>r(X,j)?(q[kt]=X,q[z]=St,kt=z):(q[kt]=j,q[P]=St,kt=P);else if(z<G&&0>r(X,St))q[kt]=X,q[z]=St,kt=z;else break t}}return nt}function r(q,nt){var St=q.sortIndex-nt.sortIndex;return St!==0?St:q.id-nt.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var h=[],f=[],p=1,m=null,v=3,x=!1,E=!1,_=!1,b=!1,A=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function C(q){for(var nt=e(f);nt!==null;){if(nt.callback===null)i(f);else if(nt.startTime<=q)i(f),nt.sortIndex=nt.expirationTime,t(h,nt);else break;nt=e(f)}}function N(q){if(_=!1,C(q),!E)if(e(h)!==null)E=!0,B||(B=!0,J());else{var nt=e(f);nt!==null&&Et(N,nt.startTime-q)}}var B=!1,O=-1,H=5,M=-1;function W(){return b?!0:!(n.unstable_now()-M<H)}function Y(){if(b=!1,B){var q=n.unstable_now();M=q;var nt=!0;try{t:{E=!1,_&&(_=!1,T(O),O=-1),x=!0;var St=v;try{e:{for(C(q),m=e(h);m!==null&&!(m.expirationTime>q&&W());){var kt=m.callback;if(typeof kt=="function"){m.callback=null,v=m.priorityLevel;var G=kt(m.expirationTime<=q);if(q=n.unstable_now(),typeof G=="function"){m.callback=G,C(q),nt=!0;break e}m===e(h)&&i(h),C(q)}else i(h);m=e(h)}if(m!==null)nt=!0;else{var ht=e(f);ht!==null&&Et(N,ht.startTime-q),nt=!1}}break t}finally{m=null,v=St,x=!1}nt=void 0}}finally{nt?J():B=!1}}}var J;if(typeof S=="function")J=function(){S(Y)};else if(typeof MessageChannel<"u"){var ut=new MessageChannel,At=ut.port2;ut.port1.onmessage=Y,J=function(){At.postMessage(null)}}else J=function(){A(Y,0)};function Et(q,nt){O=A(function(){q(n.unstable_now())},nt)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(q){q.callback=null},n.unstable_forceFrameRate=function(q){0>q||125<q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<q?Math.floor(1e3/q):5},n.unstable_getCurrentPriorityLevel=function(){return v},n.unstable_next=function(q){switch(v){case 1:case 2:case 3:var nt=3;break;default:nt=v}var St=v;v=nt;try{return q()}finally{v=St}},n.unstable_requestPaint=function(){b=!0},n.unstable_runWithPriority=function(q,nt){switch(q){case 1:case 2:case 3:case 4:case 5:break;default:q=3}var St=v;v=q;try{return nt()}finally{v=St}},n.unstable_scheduleCallback=function(q,nt,St){var kt=n.unstable_now();switch(typeof St=="object"&&St!==null?(St=St.delay,St=typeof St=="number"&&0<St?kt+St:kt):St=kt,q){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=St+G,q={id:p++,callback:nt,priorityLevel:q,startTime:St,expirationTime:G,sortIndex:-1},St>kt?(q.sortIndex=St,t(f,q),e(h)===null&&q===e(f)&&(_?(T(O),O=-1):_=!0,Et(N,St-kt))):(q.sortIndex=G,t(h,q),E||x||(E=!0,B||(B=!0,J()))),q},n.unstable_shouldYield=W,n.unstable_wrapCallback=function(q){var nt=v;return function(){var St=v;v=nt;try{return q.apply(this,arguments)}finally{v=St}}}})(n0)),n0}var Mv;function gw(){return Mv||(Mv=1,i0.exports=pw()),i0.exports}var r0={exports:{}},Di={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nv;function mw(){if(Nv)return Di;Nv=1;var n=ep();function t(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(h,f,p){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:m==null?null:""+m,children:h,containerInfo:f,implementation:p}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Di.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Di.createPortal=function(h,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return a(h,f,null,p)},Di.flushSync=function(h){var f=l.T,p=i.p;try{if(l.T=null,i.p=2,h)return h()}finally{l.T=f,i.p=p,i.d.f()}},Di.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(h,f))},Di.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},Di.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var p=f.as,m=c(p,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,x=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?i.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:m,integrity:v,fetchPriority:x}):p==="script"&&i.d.X(h,{crossOrigin:m,integrity:v,fetchPriority:x,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Di.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=c(f.as,f.crossOrigin);i.d.M(h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(h)},Di.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,m=c(p,f.crossOrigin);i.d.L(h,p,{crossOrigin:m,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Di.preloadModule=function(h,f){if(typeof h=="string")if(f){var p=c(f.as,f.crossOrigin);i.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(h)},Di.requestFormReset=function(h){i.d.r(h)},Di.unstable_batchedUpdates=function(h,f){return h(f)},Di.useFormState=function(h,f,p){return l.H.useFormState(h,f,p)},Di.useFormStatus=function(){return l.H.useHostTransitionStatus()},Di.version="19.1.1",Di}var Ov;function vw(){if(Ov)return r0.exports;Ov=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),r0.exports=mw(),r0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lv;function xw(){if(Lv)return Cl;Lv=1;var n=gw(),t=ep(),e=vw();function i(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var o=s,u=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(u=o.return),s=o.return;while(s)}return o.tag===3?u:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function c(s){if(a(s)!==s)throw Error(i(188))}function h(s){var o=s.alternate;if(!o){if(o=a(s),o===null)throw Error(i(188));return o!==s?null:s}for(var u=s,d=o;;){var g=u.return;if(g===null)break;var y=g.alternate;if(y===null){if(d=g.return,d!==null){u=d;continue}break}if(g.child===y.child){for(y=g.child;y;){if(y===u)return c(g),s;if(y===d)return c(g),o;y=y.sibling}throw Error(i(188))}if(u.return!==d.return)u=g,d=y;else{for(var w=!1,D=g.child;D;){if(D===u){w=!0,u=g,d=y;break}if(D===d){w=!0,d=g,u=y;break}D=D.sibling}if(!w){for(D=y.child;D;){if(D===u){w=!0,u=y,d=g;break}if(D===d){w=!0,d=y,u=g;break}D=D.sibling}if(!w)throw Error(i(189))}}if(u.alternate!==d)throw Error(i(190))}if(u.tag!==3)throw Error(i(188));return u.stateNode.current===u?s:o}function f(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=f(s),o!==null)return o;s=s.sibling}return null}var p=Object.assign,m=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),T=Symbol.for("react.consumer"),S=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),M=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),Y=Symbol.iterator;function J(s){return s===null||typeof s!="object"?null:(s=Y&&s[Y]||s["@@iterator"],typeof s=="function"?s:null)}var ut=Symbol.for("react.client.reference");function At(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ut?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case E:return"Fragment";case b:return"Profiler";case _:return"StrictMode";case N:return"Suspense";case B:return"SuspenseList";case M:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case x:return"Portal";case S:return(s.displayName||"Context")+".Provider";case T:return(s._context.displayName||"Context")+".Consumer";case C:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case O:return o=s.displayName||null,o!==null?o:At(s.type)||"Memo";case H:o=s._payload,s=s._init;try{return At(s(o))}catch{}}return null}var Et=Array.isArray,q=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,nt=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,St={pending:!1,data:null,method:null,action:null},kt=[],G=-1;function ht(s){return{current:s}}function P(s){0>G||(s.current=kt[G],kt[G]=null,G--)}function j(s,o){G++,kt[G]=s.current,s.current=o}var z=ht(null),X=ht(null),et=ht(null),wt=ht(null);function Ct(s,o){switch(j(et,o),j(X,s),j(z,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?K1(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=K1(o),s=Q1(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}P(z),j(z,s)}function pt(){P(z),P(X),P(et)}function yt(s){s.memoizedState!==null&&j(wt,s);var o=z.current,u=Q1(o,s.type);o!==u&&(j(X,s),j(z,u))}function Ut(s){X.current===s&&(P(z),P(X)),wt.current===s&&(P(wt),El._currentValue=St)}var Lt=Object.prototype.hasOwnProperty,Qt=n.unstable_scheduleCallback,jt=n.unstable_cancelCallback,ge=n.unstable_shouldYield,ae=n.unstable_requestPaint,Rt=n.unstable_now,ce=n.unstable_getCurrentPriorityLevel,Ji=n.unstable_ImmediatePriority,Ln=n.unstable_UserBlockingPriority,Pn=n.unstable_NormalPriority,_c=n.unstable_LowPriority,ga=n.unstable_IdlePriority,gn=n.log,ma=n.unstable_setDisableYieldValue,fr=null,pi=null;function Ci(s){if(typeof gn=="function"&&ma(s),pi&&typeof pi.setStrictMode=="function")try{pi.setStrictMode(fr,s)}catch{}}var Pi=Math.clz32?Math.clz32:Ac,Ec=Math.log,bc=Math.LN2;function Ac(s){return s>>>=0,s===0?32:31-(Ec(s)/bc|0)|0}var Ts=256,Cs=4194304;function $n(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function va(s,o,u){var d=s.pendingLanes;if(d===0)return 0;var g=0,y=s.suspendedLanes,w=s.pingedLanes;s=s.warmLanes;var D=d&134217727;return D!==0?(d=D&~y,d!==0?g=$n(d):(w&=D,w!==0?g=$n(w):u||(u=D&~s,u!==0&&(g=$n(u))))):(D=d&~y,D!==0?g=$n(D):w!==0?g=$n(w):u||(u=d&~s,u!==0&&(g=$n(u)))),g===0?0:o!==0&&o!==g&&(o&y)===0&&(y=g&-g,u=o&-o,y>=u||y===32&&(u&4194048)!==0)?o:g}function Rs(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function wc(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ro(){var s=Ts;return Ts<<=1,(Ts&4194048)===0&&(Ts=256),s}function Do(){var s=Cs;return Cs<<=1,(Cs&62914560)===0&&(Cs=4194304),s}function Mo(s){for(var o=[],u=0;31>u;u++)o.push(s);return o}function Ds(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function xa(s,o,u,d,g,y){var w=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var D=s.entanglements,V=s.expirationTimes,it=s.hiddenUpdates;for(u=w&~u;0<u;){var mt=31-Pi(u),xt=1<<mt;D[mt]=0,V[mt]=-1;var at=it[mt];if(at!==null)for(it[mt]=null,mt=0;mt<at.length;mt++){var lt=at[mt];lt!==null&&(lt.lane&=-536870913)}u&=~xt}d!==0&&Sc(s,d,0),y!==0&&g===0&&s.tag!==0&&(s.suspendedLanes|=y&~(w&~o))}function Sc(s,o,u){s.pendingLanes|=o,s.suspendedLanes&=~o;var d=31-Pi(o);s.entangledLanes|=o,s.entanglements[d]=s.entanglements[d]|1073741824|u&4194090}function Tc(s,o){var u=s.entangledLanes|=o;for(s=s.entanglements;u;){var d=31-Pi(u),g=1<<d;g&o|s[d]&o&&(s[d]|=o),u&=~g}}function No(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Oo(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Cc(){var s=nt.p;return s!==0?s:(s=window.event,s===void 0?32:mv(s.type))}function Xh(s,o){var u=nt.p;try{return nt.p=s,o()}finally{nt.p=u}}var qn=Math.random().toString(36).slice(2),si="__reactFiber$"+qn,ai="__reactProps$"+qn,zr="__reactContainer$"+qn,Lo="__reactEvents$"+qn,Yh="__reactListeners$"+qn,R="__reactHandles$"+qn,I="__reactResources$"+qn,L="__reactMarker$"+qn;function k(s){delete s[si],delete s[ai],delete s[Lo],delete s[Yh],delete s[R]}function F(s){var o=s[si];if(o)return o;for(var u=s.parentNode;u;){if(o=u[zr]||u[si]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(s=ev(s);s!==null;){if(u=s[si])return u;s=ev(s)}return o}s=u,u=s.parentNode}return null}function U(s){if(s=s[si]||s[zr]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function rt(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(i(33))}function dt(s){var o=s[I];return o||(o=s[I]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Z(s){s[L]=!0}var st=new Set,ot={};function bt(s,o){Dt(s,o),Dt(s+"Capture",o)}function Dt(s,o){for(ot[s]=o,s=0;s<o.length;s++)st.add(o[s])}var Pt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Tt={},Ot={};function $t(s){return Lt.call(Ot,s)?!0:Lt.call(Tt,s)?!1:Pt.test(s)?Ot[s]=!0:(Tt[s]=!0,!1)}function Ae(s,o,u){if($t(o))if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var d=o.toLowerCase().slice(0,5);if(d!=="data-"&&d!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+u)}}function we(s,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+u)}}function Oe(s,o,u,d){if(d===null)s.removeAttribute(u);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(o,u,""+d)}}var dr,Vr;function mn(s){if(dr===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);dr=o&&o[1]||"",Vr=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+dr+s+Vr}var kn=!1;function Ms(s,o){if(!s||kn)return"";kn=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var d={DetermineComponentFrameRoot:function(){try{if(o){var xt=function(){throw Error()};if(Object.defineProperty(xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xt,[])}catch(lt){var at=lt}Reflect.construct(s,[],xt)}else{try{xt.call()}catch(lt){at=lt}s.call(xt.prototype)}}else{try{throw Error()}catch(lt){at=lt}(xt=s())&&typeof xt.catch=="function"&&xt.catch(function(){})}}catch(lt){if(lt&&at&&typeof lt.stack=="string")return[lt.stack,at.stack]}return[null,null]}};d.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(d.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(d.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=d.DetermineComponentFrameRoot(),w=y[0],D=y[1];if(w&&D){var V=w.split(`
`),it=D.split(`
`);for(g=d=0;d<V.length&&!V[d].includes("DetermineComponentFrameRoot");)d++;for(;g<it.length&&!it[g].includes("DetermineComponentFrameRoot");)g++;if(d===V.length||g===it.length)for(d=V.length-1,g=it.length-1;1<=d&&0<=g&&V[d]!==it[g];)g--;for(;1<=d&&0<=g;d--,g--)if(V[d]!==it[g]){if(d!==1||g!==1)do if(d--,g--,0>g||V[d]!==it[g]){var mt=`
`+V[d].replace(" at new "," at ");return s.displayName&&mt.includes("<anonymous>")&&(mt=mt.replace("<anonymous>",s.displayName)),mt}while(1<=d&&0<=g);break}}}finally{kn=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?mn(u):""}function Fn(s){switch(s.tag){case 26:case 27:case 5:return mn(s.type);case 16:return mn("Lazy");case 13:return mn("Suspense");case 19:return mn("SuspenseList");case 0:case 15:return Ms(s.type,!1);case 11:return Ms(s.type.render,!1);case 1:return Ms(s.type,!0);case 31:return mn("Activity");default:return""}}function Gp(s){try{var o="";do o+=Fn(s),s=s.return;while(s);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function vn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Wp(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function nb(s){var o=Wp(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),d=""+s[o];if(!s.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,y=u.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return g.call(this)},set:function(w){d=""+w,y.call(this,w)}}),Object.defineProperty(s,o,{enumerable:u.enumerable}),{getValue:function(){return d},setValue:function(w){d=""+w},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Rc(s){s._valueTracker||(s._valueTracker=nb(s))}function Xp(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var u=o.getValue(),d="";return s&&(d=Wp(s)?s.checked?"true":"false":s.value),s=d,s!==u?(o.setValue(s),!0):!1}function Dc(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var rb=/[\n"\\]/g;function xn(s){return s.replace(rb,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function $h(s,o,u,d,g,y,w,D){s.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?s.type=w:s.removeAttribute("type"),o!=null?w==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+vn(o)):s.value!==""+vn(o)&&(s.value=""+vn(o)):w!=="submit"&&w!=="reset"||s.removeAttribute("value"),o!=null?qh(s,w,vn(o)):u!=null?qh(s,w,vn(u)):d!=null&&s.removeAttribute("value"),g==null&&y!=null&&(s.defaultChecked=!!y),g!=null&&(s.checked=g&&typeof g!="function"&&typeof g!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?s.name=""+vn(D):s.removeAttribute("name")}function Yp(s,o,u,d,g,y,w,D){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(s.type=y),o!=null||u!=null){if(!(y!=="submit"&&y!=="reset"||o!=null))return;u=u!=null?""+vn(u):"",o=o!=null?""+vn(o):u,D||o===s.value||(s.value=o),s.defaultValue=o}d=d??g,d=typeof d!="function"&&typeof d!="symbol"&&!!d,s.checked=D?s.checked:!!d,s.defaultChecked=!!d,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.name=w)}function qh(s,o,u){o==="number"&&Dc(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function ya(s,o,u,d){if(s=s.options,o){o={};for(var g=0;g<u.length;g++)o["$"+u[g]]=!0;for(u=0;u<s.length;u++)g=o.hasOwnProperty("$"+s[u].value),s[u].selected!==g&&(s[u].selected=g),g&&d&&(s[u].defaultSelected=!0)}else{for(u=""+vn(u),o=null,g=0;g<s.length;g++){if(s[g].value===u){s[g].selected=!0,d&&(s[g].defaultSelected=!0);return}o!==null||s[g].disabled||(o=s[g])}o!==null&&(o.selected=!0)}}function $p(s,o,u){if(o!=null&&(o=""+vn(o),o!==s.value&&(s.value=o),u==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=u!=null?""+vn(u):""}function qp(s,o,u,d){if(o==null){if(d!=null){if(u!=null)throw Error(i(92));if(Et(d)){if(1<d.length)throw Error(i(93));d=d[0]}u=d}u==null&&(u=""),o=u}u=vn(o),s.defaultValue=u,d=s.textContent,d===u&&d!==""&&d!==null&&(s.value=d)}function _a(s,o){if(o){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=o;return}}s.textContent=o}var sb=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Kp(s,o,u){var d=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?d?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":d?s.setProperty(o,u):typeof u!="number"||u===0||sb.has(o)?o==="float"?s.cssFloat=u:s[o]=(""+u).trim():s[o]=u+"px"}function Qp(s,o,u){if(o!=null&&typeof o!="object")throw Error(i(62));if(s=s.style,u!=null){for(var d in u)!u.hasOwnProperty(d)||o!=null&&o.hasOwnProperty(d)||(d.indexOf("--")===0?s.setProperty(d,""):d==="float"?s.cssFloat="":s[d]="");for(var g in o)d=o[g],o.hasOwnProperty(g)&&u[g]!==d&&Kp(s,g,d)}else for(var y in o)o.hasOwnProperty(y)&&Kp(s,y,o[y])}function Kh(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ab=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ob=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Mc(s){return ob.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var Qh=null;function Zh(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ea=null,ba=null;function Zp(s){var o=U(s);if(o&&(s=o.stateNode)){var u=s[ai]||null;t:switch(s=o.stateNode,o.type){case"input":if($h(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+xn(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var d=u[o];if(d!==s&&d.form===s.form){var g=d[ai]||null;if(!g)throw Error(i(90));$h(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<u.length;o++)d=u[o],d.form===s.form&&Xp(d)}break t;case"textarea":$p(s,u.value,u.defaultValue);break t;case"select":o=u.value,o!=null&&ya(s,!!u.multiple,o,!1)}}}var Jh=!1;function Jp(s,o,u){if(Jh)return s(o,u);Jh=!0;try{var d=s(o);return d}finally{if(Jh=!1,(Ea!==null||ba!==null)&&(gu(),Ea&&(o=Ea,s=ba,ba=Ea=null,Zp(o),s)))for(o=0;o<s.length;o++)Zp(s[o])}}function Po(s,o){var u=s.stateNode;if(u===null)return null;var d=u[ai]||null;if(d===null)return null;u=d[o];t:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(s=s.type,d=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!d;break t;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(i(231,o,typeof u));return u}var pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),tf=!1;if(pr)try{var ko={};Object.defineProperty(ko,"passive",{get:function(){tf=!0}}),window.addEventListener("test",ko,ko),window.removeEventListener("test",ko,ko)}catch{tf=!1}var Gr=null,ef=null,Nc=null;function tg(){if(Nc)return Nc;var s,o=ef,u=o.length,d,g="value"in Gr?Gr.value:Gr.textContent,y=g.length;for(s=0;s<u&&o[s]===g[s];s++);var w=u-s;for(d=1;d<=w&&o[u-d]===g[y-d];d++);return Nc=g.slice(s,1<d?1-d:void 0)}function Oc(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Lc(){return!0}function eg(){return!1}function zi(s){function o(u,d,g,y,w){this._reactName=u,this._targetInst=g,this.type=d,this.nativeEvent=y,this.target=w,this.currentTarget=null;for(var D in s)s.hasOwnProperty(D)&&(u=s[D],this[D]=u?u(y):y[D]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Lc:eg,this.isPropagationStopped=eg,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Lc)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Lc)},persist:function(){},isPersistent:Lc}),o}var Ns={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pc=zi(Ns),Fo=p({},Ns,{view:0,detail:0}),lb=zi(Fo),nf,rf,Io,kc=p({},Fo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:af,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Io&&(Io&&s.type==="mousemove"?(nf=s.screenX-Io.screenX,rf=s.screenY-Io.screenY):rf=nf=0,Io=s),nf)},movementY:function(s){return"movementY"in s?s.movementY:rf}}),ig=zi(kc),cb=p({},kc,{dataTransfer:0}),ub=zi(cb),hb=p({},Fo,{relatedTarget:0}),sf=zi(hb),fb=p({},Ns,{animationName:0,elapsedTime:0,pseudoElement:0}),db=zi(fb),pb=p({},Ns,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),gb=zi(pb),mb=p({},Ns,{data:0}),ng=zi(mb),vb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _b(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=yb[s])?!!o[s]:!1}function af(){return _b}var Eb=p({},Fo,{key:function(s){if(s.key){var o=vb[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=Oc(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?xb[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:af,charCode:function(s){return s.type==="keypress"?Oc(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Oc(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),bb=zi(Eb),Ab=p({},kc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rg=zi(Ab),wb=p({},Fo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:af}),Sb=zi(wb),Tb=p({},Ns,{propertyName:0,elapsedTime:0,pseudoElement:0}),Cb=zi(Tb),Rb=p({},kc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Db=zi(Rb),Mb=p({},Ns,{newState:0,oldState:0}),Nb=zi(Mb),Ob=[9,13,27,32],of=pr&&"CompositionEvent"in window,Bo=null;pr&&"documentMode"in document&&(Bo=document.documentMode);var Lb=pr&&"TextEvent"in window&&!Bo,sg=pr&&(!of||Bo&&8<Bo&&11>=Bo),ag=" ",og=!1;function lg(s,o){switch(s){case"keyup":return Ob.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cg(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Aa=!1;function Pb(s,o){switch(s){case"compositionend":return cg(o);case"keypress":return o.which!==32?null:(og=!0,ag);case"textInput":return s=o.data,s===ag&&og?null:s;default:return null}}function kb(s,o){if(Aa)return s==="compositionend"||!of&&lg(s,o)?(s=tg(),Nc=ef=Gr=null,Aa=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return sg&&o.locale!=="ko"?null:o.data;default:return null}}var Fb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ug(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!Fb[s.type]:o==="textarea"}function hg(s,o,u,d){Ea?ba?ba.push(d):ba=[d]:Ea=d,o=Eu(o,"onChange"),0<o.length&&(u=new Pc("onChange","change",null,u,d),s.push({event:u,listeners:o}))}var Uo=null,Ho=null;function Ib(s){W1(s,0)}function Fc(s){var o=rt(s);if(Xp(o))return s}function fg(s,o){if(s==="change")return o}var dg=!1;if(pr){var lf;if(pr){var cf="oninput"in document;if(!cf){var pg=document.createElement("div");pg.setAttribute("oninput","return;"),cf=typeof pg.oninput=="function"}lf=cf}else lf=!1;dg=lf&&(!document.documentMode||9<document.documentMode)}function gg(){Uo&&(Uo.detachEvent("onpropertychange",mg),Ho=Uo=null)}function mg(s){if(s.propertyName==="value"&&Fc(Ho)){var o=[];hg(o,Ho,s,Zh(s)),Jp(Ib,o)}}function Bb(s,o,u){s==="focusin"?(gg(),Uo=o,Ho=u,Uo.attachEvent("onpropertychange",mg)):s==="focusout"&&gg()}function Ub(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Fc(Ho)}function Hb(s,o){if(s==="click")return Fc(o)}function jb(s,o){if(s==="input"||s==="change")return Fc(o)}function zb(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var tn=typeof Object.is=="function"?Object.is:zb;function jo(s,o){if(tn(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var u=Object.keys(s),d=Object.keys(o);if(u.length!==d.length)return!1;for(d=0;d<u.length;d++){var g=u[d];if(!Lt.call(o,g)||!tn(s[g],o[g]))return!1}return!0}function vg(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function xg(s,o){var u=vg(s);s=0;for(var d;u;){if(u.nodeType===3){if(d=s+u.textContent.length,s<=o&&d>=o)return{node:u,offset:o-s};s=d}t:{for(;u;){if(u.nextSibling){u=u.nextSibling;break t}u=u.parentNode}u=void 0}u=vg(u)}}function yg(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?yg(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function _g(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Dc(s.document);o instanceof s.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)s=o.contentWindow;else break;o=Dc(s.document)}return o}function uf(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var Vb=pr&&"documentMode"in document&&11>=document.documentMode,wa=null,hf=null,zo=null,ff=!1;function Eg(s,o,u){var d=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;ff||wa==null||wa!==Dc(d)||(d=wa,"selectionStart"in d&&uf(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),zo&&jo(zo,d)||(zo=d,d=Eu(hf,"onSelect"),0<d.length&&(o=new Pc("onSelect","select",null,o,u),s.push({event:o,listeners:d}),o.target=wa)))}function Os(s,o){var u={};return u[s.toLowerCase()]=o.toLowerCase(),u["Webkit"+s]="webkit"+o,u["Moz"+s]="moz"+o,u}var Sa={animationend:Os("Animation","AnimationEnd"),animationiteration:Os("Animation","AnimationIteration"),animationstart:Os("Animation","AnimationStart"),transitionrun:Os("Transition","TransitionRun"),transitionstart:Os("Transition","TransitionStart"),transitioncancel:Os("Transition","TransitionCancel"),transitionend:Os("Transition","TransitionEnd")},df={},bg={};pr&&(bg=document.createElement("div").style,"AnimationEvent"in window||(delete Sa.animationend.animation,delete Sa.animationiteration.animation,delete Sa.animationstart.animation),"TransitionEvent"in window||delete Sa.transitionend.transition);function Ls(s){if(df[s])return df[s];if(!Sa[s])return s;var o=Sa[s],u;for(u in o)if(o.hasOwnProperty(u)&&u in bg)return df[s]=o[u];return s}var Ag=Ls("animationend"),wg=Ls("animationiteration"),Sg=Ls("animationstart"),Gb=Ls("transitionrun"),Wb=Ls("transitionstart"),Xb=Ls("transitioncancel"),Tg=Ls("transitionend"),Cg=new Map,pf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");pf.push("scrollEnd");function In(s,o){Cg.set(s,o),bt(o,[s])}var Rg=new WeakMap;function yn(s,o){if(typeof s=="object"&&s!==null){var u=Rg.get(s);return u!==void 0?u:(o={value:s,source:o,stack:Gp(o)},Rg.set(s,o),o)}return{value:s,source:o,stack:Gp(o)}}var _n=[],Ta=0,gf=0;function Ic(){for(var s=Ta,o=gf=Ta=0;o<s;){var u=_n[o];_n[o++]=null;var d=_n[o];_n[o++]=null;var g=_n[o];_n[o++]=null;var y=_n[o];if(_n[o++]=null,d!==null&&g!==null){var w=d.pending;w===null?g.next=g:(g.next=w.next,w.next=g),d.pending=g}y!==0&&Dg(u,g,y)}}function Bc(s,o,u,d){_n[Ta++]=s,_n[Ta++]=o,_n[Ta++]=u,_n[Ta++]=d,gf|=d,s.lanes|=d,s=s.alternate,s!==null&&(s.lanes|=d)}function mf(s,o,u,d){return Bc(s,o,u,d),Uc(s)}function Ca(s,o){return Bc(s,null,null,o),Uc(s)}function Dg(s,o,u){s.lanes|=u;var d=s.alternate;d!==null&&(d.lanes|=u);for(var g=!1,y=s.return;y!==null;)y.childLanes|=u,d=y.alternate,d!==null&&(d.childLanes|=u),y.tag===22&&(s=y.stateNode,s===null||s._visibility&1||(g=!0)),s=y,y=y.return;return s.tag===3?(y=s.stateNode,g&&o!==null&&(g=31-Pi(u),s=y.hiddenUpdates,d=s[g],d===null?s[g]=[o]:d.push(o),o.lane=u|536870912),y):null}function Uc(s){if(50<dl)throw dl=0,bd=null,Error(i(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var Ra={};function Yb(s,o,u,d){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function en(s,o,u,d){return new Yb(s,o,u,d)}function vf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function gr(s,o){var u=s.alternate;return u===null?(u=en(s.tag,o,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=o,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,o=s.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function Mg(s,o){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,o=u.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function Hc(s,o,u,d,g,y){var w=0;if(d=s,typeof s=="function")vf(s)&&(w=1);else if(typeof s=="string")w=qA(s,u,z.current)?26:s==="html"||s==="head"||s==="body"?27:5;else t:switch(s){case M:return s=en(31,u,o,g),s.elementType=M,s.lanes=y,s;case E:return Ps(u.children,g,y,o);case _:w=8,g|=24;break;case b:return s=en(12,u,o,g|2),s.elementType=b,s.lanes=y,s;case N:return s=en(13,u,o,g),s.elementType=N,s.lanes=y,s;case B:return s=en(19,u,o,g),s.elementType=B,s.lanes=y,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case A:case S:w=10;break t;case T:w=9;break t;case C:w=11;break t;case O:w=14;break t;case H:w=16,d=null;break t}w=29,u=Error(i(130,s===null?"null":typeof s,"")),d=null}return o=en(w,u,o,g),o.elementType=s,o.type=d,o.lanes=y,o}function Ps(s,o,u,d){return s=en(7,s,d,o),s.lanes=u,s}function xf(s,o,u){return s=en(6,s,null,o),s.lanes=u,s}function yf(s,o,u){return o=en(4,s.children!==null?s.children:[],s.key,o),o.lanes=u,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var Da=[],Ma=0,jc=null,zc=0,En=[],bn=0,ks=null,mr=1,vr="";function Fs(s,o){Da[Ma++]=zc,Da[Ma++]=jc,jc=s,zc=o}function Ng(s,o,u){En[bn++]=mr,En[bn++]=vr,En[bn++]=ks,ks=s;var d=mr;s=vr;var g=32-Pi(d)-1;d&=~(1<<g),u+=1;var y=32-Pi(o)+g;if(30<y){var w=g-g%5;y=(d&(1<<w)-1).toString(32),d>>=w,g-=w,mr=1<<32-Pi(o)+g|u<<g|d,vr=y+s}else mr=1<<y|u<<g|d,vr=s}function _f(s){s.return!==null&&(Fs(s,1),Ng(s,1,0))}function Ef(s){for(;s===jc;)jc=Da[--Ma],Da[Ma]=null,zc=Da[--Ma],Da[Ma]=null;for(;s===ks;)ks=En[--bn],En[bn]=null,vr=En[--bn],En[bn]=null,mr=En[--bn],En[bn]=null}var ki=null,Be=null,fe=!1,Is=null,Kn=!1,bf=Error(i(519));function Bs(s){var o=Error(i(418,""));throw Wo(yn(o,s)),bf}function Og(s){var o=s.stateNode,u=s.type,d=s.memoizedProps;switch(o[si]=s,o[ai]=d,u){case"dialog":ne("cancel",o),ne("close",o);break;case"iframe":case"object":case"embed":ne("load",o);break;case"video":case"audio":for(u=0;u<gl.length;u++)ne(gl[u],o);break;case"source":ne("error",o);break;case"img":case"image":case"link":ne("error",o),ne("load",o);break;case"details":ne("toggle",o);break;case"input":ne("invalid",o),Yp(o,d.value,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name,!0),Rc(o);break;case"select":ne("invalid",o);break;case"textarea":ne("invalid",o),qp(o,d.value,d.defaultValue,d.children),Rc(o)}u=d.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||d.suppressHydrationWarning===!0||q1(o.textContent,u)?(d.popover!=null&&(ne("beforetoggle",o),ne("toggle",o)),d.onScroll!=null&&ne("scroll",o),d.onScrollEnd!=null&&ne("scrollend",o),d.onClick!=null&&(o.onclick=bu),o=!0):o=!1,o||Bs(s)}function Lg(s){for(ki=s.return;ki;)switch(ki.tag){case 5:case 13:Kn=!1;return;case 27:case 3:Kn=!0;return;default:ki=ki.return}}function Vo(s){if(s!==ki)return!1;if(!fe)return Lg(s),fe=!0,!1;var o=s.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||Bd(s.type,s.memoizedProps)),u=!u),u&&Be&&Bs(s),Lg(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));t:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(o===0){Be=Un(s.nextSibling);break t}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;s=s.nextSibling}Be=null}}else o===27?(o=Be,as(s.type)?(s=zd,zd=null,Be=s):Be=o):Be=ki?Un(s.stateNode.nextSibling):null;return!0}function Go(){Be=ki=null,fe=!1}function Pg(){var s=Is;return s!==null&&(Wi===null?Wi=s:Wi.push.apply(Wi,s),Is=null),s}function Wo(s){Is===null?Is=[s]:Is.push(s)}var Af=ht(null),Us=null,xr=null;function Wr(s,o,u){j(Af,o._currentValue),o._currentValue=u}function yr(s){s._currentValue=Af.current,P(Af)}function wf(s,o,u){for(;s!==null;){var d=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,d!==null&&(d.childLanes|=o)):d!==null&&(d.childLanes&o)!==o&&(d.childLanes|=o),s===u)break;s=s.return}}function Sf(s,o,u,d){var g=s.child;for(g!==null&&(g.return=s);g!==null;){var y=g.dependencies;if(y!==null){var w=g.child;y=y.firstContext;t:for(;y!==null;){var D=y;y=g;for(var V=0;V<o.length;V++)if(D.context===o[V]){y.lanes|=u,D=y.alternate,D!==null&&(D.lanes|=u),wf(y.return,u,s),d||(w=null);break t}y=D.next}}else if(g.tag===18){if(w=g.return,w===null)throw Error(i(341));w.lanes|=u,y=w.alternate,y!==null&&(y.lanes|=u),wf(w,u,s),w=null}else w=g.child;if(w!==null)w.return=g;else for(w=g;w!==null;){if(w===s){w=null;break}if(g=w.sibling,g!==null){g.return=w.return,w=g;break}w=w.return}g=w}}function Xo(s,o,u,d){s=null;for(var g=o,y=!1;g!==null;){if(!y){if((g.flags&524288)!==0)y=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var w=g.alternate;if(w===null)throw Error(i(387));if(w=w.memoizedProps,w!==null){var D=g.type;tn(g.pendingProps.value,w.value)||(s!==null?s.push(D):s=[D])}}else if(g===wt.current){if(w=g.alternate,w===null)throw Error(i(387));w.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(s!==null?s.push(El):s=[El])}g=g.return}s!==null&&Sf(o,s,u,d),o.flags|=262144}function Vc(s){for(s=s.firstContext;s!==null;){if(!tn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Hs(s){Us=s,xr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Ri(s){return kg(Us,s)}function Gc(s,o){return Us===null&&Hs(s),kg(s,o)}function kg(s,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},xr===null){if(s===null)throw Error(i(308));xr=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else xr=xr.next=o;return u}var $b=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(u,d){s.push(d)}};this.abort=function(){o.aborted=!0,s.forEach(function(u){return u()})}},qb=n.unstable_scheduleCallback,Kb=n.unstable_NormalPriority,ii={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Tf(){return{controller:new $b,data:new Map,refCount:0}}function Yo(s){s.refCount--,s.refCount===0&&qb(Kb,function(){s.controller.abort()})}var $o=null,Cf=0,Na=0,Oa=null;function Qb(s,o){if($o===null){var u=$o=[];Cf=0,Na=Dd(),Oa={status:"pending",value:void 0,then:function(d){u.push(d)}}}return Cf++,o.then(Fg,Fg),o}function Fg(){if(--Cf===0&&$o!==null){Oa!==null&&(Oa.status="fulfilled");var s=$o;$o=null,Na=0,Oa=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function Zb(s,o){var u=[],d={status:"pending",value:null,reason:null,then:function(g){u.push(g)}};return s.then(function(){d.status="fulfilled",d.value=o;for(var g=0;g<u.length;g++)(0,u[g])(o)},function(g){for(d.status="rejected",d.reason=g,g=0;g<u.length;g++)(0,u[g])(void 0)}),d}var Ig=q.S;q.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&Qb(s,o),Ig!==null&&Ig(s,o)};var js=ht(null);function Rf(){var s=js.current;return s!==null?s:Le.pooledCache}function Wc(s,o){o===null?j(js,js.current):j(js,o.pool)}function Bg(){var s=Rf();return s===null?null:{parent:ii._currentValue,pool:s}}var qo=Error(i(460)),Ug=Error(i(474)),Xc=Error(i(542)),Df={then:function(){}};function Hg(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Yc(){}function jg(s,o,u){switch(u=s[u],u===void 0?s.push(o):u!==o&&(o.then(Yc,Yc),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Vg(s),s;default:if(typeof o.status=="string")o.then(Yc,Yc);else{if(s=Le,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=o,s.status="pending",s.then(function(d){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=d}},function(d){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=d}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Vg(s),s}throw Ko=o,qo}}var Ko=null;function zg(){if(Ko===null)throw Error(i(459));var s=Ko;return Ko=null,s}function Vg(s){if(s===qo||s===Xc)throw Error(i(483))}var Xr=!1;function Mf(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Nf(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Yr(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function $r(s,o,u){var d=s.updateQueue;if(d===null)return null;if(d=d.shared,(me&2)!==0){var g=d.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),d.pending=o,o=Uc(s),Dg(s,null,u),o}return Bc(s,d,o,u),Uc(s)}function Qo(s,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var d=o.lanes;d&=s.pendingLanes,u|=d,o.lanes=u,Tc(s,u)}}function Of(s,o){var u=s.updateQueue,d=s.alternate;if(d!==null&&(d=d.updateQueue,u===d)){var g=null,y=null;if(u=u.firstBaseUpdate,u!==null){do{var w={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};y===null?g=y=w:y=y.next=w,u=u.next}while(u!==null);y===null?g=y=o:y=y.next=o}else g=y=o;u={baseState:d.baseState,firstBaseUpdate:g,lastBaseUpdate:y,shared:d.shared,callbacks:d.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=o:s.next=o,u.lastBaseUpdate=o}var Lf=!1;function Zo(){if(Lf){var s=Oa;if(s!==null)throw s}}function Jo(s,o,u,d){Lf=!1;var g=s.updateQueue;Xr=!1;var y=g.firstBaseUpdate,w=g.lastBaseUpdate,D=g.shared.pending;if(D!==null){g.shared.pending=null;var V=D,it=V.next;V.next=null,w===null?y=it:w.next=it,w=V;var mt=s.alternate;mt!==null&&(mt=mt.updateQueue,D=mt.lastBaseUpdate,D!==w&&(D===null?mt.firstBaseUpdate=it:D.next=it,mt.lastBaseUpdate=V))}if(y!==null){var xt=g.baseState;w=0,mt=it=V=null,D=y;do{var at=D.lane&-536870913,lt=at!==D.lane;if(lt?(oe&at)===at:(d&at)===at){at!==0&&at===Na&&(Lf=!0),mt!==null&&(mt=mt.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});t:{var Xt=s,Vt=D;at=o;var Ce=u;switch(Vt.tag){case 1:if(Xt=Vt.payload,typeof Xt=="function"){xt=Xt.call(Ce,xt,at);break t}xt=Xt;break t;case 3:Xt.flags=Xt.flags&-65537|128;case 0:if(Xt=Vt.payload,at=typeof Xt=="function"?Xt.call(Ce,xt,at):Xt,at==null)break t;xt=p({},xt,at);break t;case 2:Xr=!0}}at=D.callback,at!==null&&(s.flags|=64,lt&&(s.flags|=8192),lt=g.callbacks,lt===null?g.callbacks=[at]:lt.push(at))}else lt={lane:at,tag:D.tag,payload:D.payload,callback:D.callback,next:null},mt===null?(it=mt=lt,V=xt):mt=mt.next=lt,w|=at;if(D=D.next,D===null){if(D=g.shared.pending,D===null)break;lt=D,D=lt.next,lt.next=null,g.lastBaseUpdate=lt,g.shared.pending=null}}while(!0);mt===null&&(V=xt),g.baseState=V,g.firstBaseUpdate=it,g.lastBaseUpdate=mt,y===null&&(g.shared.lanes=0),is|=w,s.lanes=w,s.memoizedState=xt}}function Gg(s,o){if(typeof s!="function")throw Error(i(191,s));s.call(o)}function Wg(s,o){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)Gg(u[s],o)}var La=ht(null),$c=ht(0);function Xg(s,o){s=Tr,j($c,s),j(La,o),Tr=s|o.baseLanes}function Pf(){j($c,Tr),j(La,La.current)}function kf(){Tr=$c.current,P(La),P($c)}var qr=0,Jt=null,Se=null,Xe=null,qc=!1,Pa=!1,zs=!1,Kc=0,tl=0,ka=null,Jb=0;function ze(){throw Error(i(321))}function Ff(s,o){if(o===null)return!1;for(var u=0;u<o.length&&u<s.length;u++)if(!tn(s[u],o[u]))return!1;return!0}function If(s,o,u,d,g,y){return qr=y,Jt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,q.H=s===null||s.memoizedState===null?Dm:Mm,zs=!1,y=u(d,g),zs=!1,Pa&&(y=$g(o,u,d,g)),Yg(s),y}function Yg(s){q.H=iu;var o=Se!==null&&Se.next!==null;if(qr=0,Xe=Se=Jt=null,qc=!1,tl=0,ka=null,o)throw Error(i(300));s===null||oi||(s=s.dependencies,s!==null&&Vc(s)&&(oi=!0))}function $g(s,o,u,d){Jt=s;var g=0;do{if(Pa&&(ka=null),tl=0,Pa=!1,25<=g)throw Error(i(301));if(g+=1,Xe=Se=null,s.updateQueue!=null){var y=s.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}q.H=aA,y=o(u,d)}while(Pa);return y}function tA(){var s=q.H,o=s.useState()[0];return o=typeof o.then=="function"?el(o):o,s=s.useState()[0],(Se!==null?Se.memoizedState:null)!==s&&(Jt.flags|=1024),o}function Bf(){var s=Kc!==0;return Kc=0,s}function Uf(s,o,u){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~u}function Hf(s){if(qc){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}qc=!1}qr=0,Xe=Se=Jt=null,Pa=!1,tl=Kc=0,ka=null}function Vi(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xe===null?Jt.memoizedState=Xe=s:Xe=Xe.next=s,Xe}function Ye(){if(Se===null){var s=Jt.alternate;s=s!==null?s.memoizedState:null}else s=Se.next;var o=Xe===null?Jt.memoizedState:Xe.next;if(o!==null)Xe=o,Se=s;else{if(s===null)throw Jt.alternate===null?Error(i(467)):Error(i(310));Se=s,s={memoizedState:Se.memoizedState,baseState:Se.baseState,baseQueue:Se.baseQueue,queue:Se.queue,next:null},Xe===null?Jt.memoizedState=Xe=s:Xe=Xe.next=s}return Xe}function jf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function el(s){var o=tl;return tl+=1,ka===null&&(ka=[]),s=jg(ka,s,o),o=Jt,(Xe===null?o.memoizedState:Xe.next)===null&&(o=o.alternate,q.H=o===null||o.memoizedState===null?Dm:Mm),s}function Qc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return el(s);if(s.$$typeof===S)return Ri(s)}throw Error(i(438,String(s)))}function zf(s){var o=null,u=Jt.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var d=Jt.alternate;d!==null&&(d=d.updateQueue,d!==null&&(d=d.memoCache,d!=null&&(o={data:d.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=jf(),Jt.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(s),d=0;d<s;d++)u[d]=W;return o.index++,u}function _r(s,o){return typeof o=="function"?o(s):o}function Zc(s){var o=Ye();return Vf(o,Se,s)}function Vf(s,o,u){var d=s.queue;if(d===null)throw Error(i(311));d.lastRenderedReducer=u;var g=s.baseQueue,y=d.pending;if(y!==null){if(g!==null){var w=g.next;g.next=y.next,y.next=w}o.baseQueue=g=y,d.pending=null}if(y=s.baseState,g===null)s.memoizedState=y;else{o=g.next;var D=w=null,V=null,it=o,mt=!1;do{var xt=it.lane&-536870913;if(xt!==it.lane?(oe&xt)===xt:(qr&xt)===xt){var at=it.revertLane;if(at===0)V!==null&&(V=V.next={lane:0,revertLane:0,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null}),xt===Na&&(mt=!0);else if((qr&at)===at){it=it.next,at===Na&&(mt=!0);continue}else xt={lane:0,revertLane:it.revertLane,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},V===null?(D=V=xt,w=y):V=V.next=xt,Jt.lanes|=at,is|=at;xt=it.action,zs&&u(y,xt),y=it.hasEagerState?it.eagerState:u(y,xt)}else at={lane:xt,revertLane:it.revertLane,action:it.action,hasEagerState:it.hasEagerState,eagerState:it.eagerState,next:null},V===null?(D=V=at,w=y):V=V.next=at,Jt.lanes|=xt,is|=xt;it=it.next}while(it!==null&&it!==o);if(V===null?w=y:V.next=D,!tn(y,s.memoizedState)&&(oi=!0,mt&&(u=Oa,u!==null)))throw u;s.memoizedState=y,s.baseState=w,s.baseQueue=V,d.lastRenderedState=y}return g===null&&(d.lanes=0),[s.memoizedState,d.dispatch]}function Gf(s){var o=Ye(),u=o.queue;if(u===null)throw Error(i(311));u.lastRenderedReducer=s;var d=u.dispatch,g=u.pending,y=o.memoizedState;if(g!==null){u.pending=null;var w=g=g.next;do y=s(y,w.action),w=w.next;while(w!==g);tn(y,o.memoizedState)||(oi=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),u.lastRenderedState=y}return[y,d]}function qg(s,o,u){var d=Jt,g=Ye(),y=fe;if(y){if(u===void 0)throw Error(i(407));u=u()}else u=o();var w=!tn((Se||g).memoizedState,u);w&&(g.memoizedState=u,oi=!0),g=g.queue;var D=Zg.bind(null,d,g,s);if(il(2048,8,D,[s]),g.getSnapshot!==o||w||Xe!==null&&Xe.memoizedState.tag&1){if(d.flags|=2048,Fa(9,Jc(),Qg.bind(null,d,g,u,o),null),Le===null)throw Error(i(349));y||(qr&124)!==0||Kg(d,o,u)}return u}function Kg(s,o,u){s.flags|=16384,s={getSnapshot:o,value:u},o=Jt.updateQueue,o===null?(o=jf(),Jt.updateQueue=o,o.stores=[s]):(u=o.stores,u===null?o.stores=[s]:u.push(s))}function Qg(s,o,u,d){o.value=u,o.getSnapshot=d,Jg(o)&&tm(s)}function Zg(s,o,u){return u(function(){Jg(o)&&tm(s)})}function Jg(s){var o=s.getSnapshot;s=s.value;try{var u=o();return!tn(s,u)}catch{return!0}}function tm(s){var o=Ca(s,2);o!==null&&on(o,s,2)}function Wf(s){var o=Vi();if(typeof s=="function"){var u=s;if(s=u(),zs){Ci(!0);try{u()}finally{Ci(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_r,lastRenderedState:s},o}function em(s,o,u,d){return s.baseState=u,Vf(s,Se,typeof d=="function"?d:_r)}function eA(s,o,u,d,g){if(eu(s))throw Error(i(485));if(s=o.action,s!==null){var y={payload:g,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){y.listeners.push(w)}};q.T!==null?u(!0):y.isTransition=!1,d(y),u=o.pending,u===null?(y.next=o.pending=y,im(o,y)):(y.next=u.next,o.pending=u.next=y)}}function im(s,o){var u=o.action,d=o.payload,g=s.state;if(o.isTransition){var y=q.T,w={};q.T=w;try{var D=u(g,d),V=q.S;V!==null&&V(w,D),nm(s,o,D)}catch(it){Xf(s,o,it)}finally{q.T=y}}else try{y=u(g,d),nm(s,o,y)}catch(it){Xf(s,o,it)}}function nm(s,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(d){rm(s,o,d)},function(d){return Xf(s,o,d)}):rm(s,o,u)}function rm(s,o,u){o.status="fulfilled",o.value=u,sm(o),s.state=u,o=s.pending,o!==null&&(u=o.next,u===o?s.pending=null:(u=u.next,o.next=u,im(s,u)))}function Xf(s,o,u){var d=s.pending;if(s.pending=null,d!==null){d=d.next;do o.status="rejected",o.reason=u,sm(o),o=o.next;while(o!==d)}s.action=null}function sm(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function am(s,o){return o}function om(s,o){if(fe){var u=Le.formState;if(u!==null){t:{var d=Jt;if(fe){if(Be){e:{for(var g=Be,y=Kn;g.nodeType!==8;){if(!y){g=null;break e}if(g=Un(g.nextSibling),g===null){g=null;break e}}y=g.data,g=y==="F!"||y==="F"?g:null}if(g){Be=Un(g.nextSibling),d=g.data==="F!";break t}}Bs(d)}d=!1}d&&(o=u[0])}}return u=Vi(),u.memoizedState=u.baseState=o,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:am,lastRenderedState:o},u.queue=d,u=Tm.bind(null,Jt,d),d.dispatch=u,d=Wf(!1),y=Qf.bind(null,Jt,!1,d.queue),d=Vi(),g={state:o,dispatch:null,action:s,pending:null},d.queue=g,u=eA.bind(null,Jt,g,y,u),g.dispatch=u,d.memoizedState=s,[o,u,!1]}function lm(s){var o=Ye();return cm(o,Se,s)}function cm(s,o,u){if(o=Vf(s,o,am)[0],s=Zc(_r)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var d=el(o)}catch(w){throw w===qo?Xc:w}else d=o;o=Ye();var g=o.queue,y=g.dispatch;return u!==o.memoizedState&&(Jt.flags|=2048,Fa(9,Jc(),iA.bind(null,g,u),null)),[d,y,s]}function iA(s,o){s.action=o}function um(s){var o=Ye(),u=Se;if(u!==null)return cm(o,u,s);Ye(),o=o.memoizedState,u=Ye();var d=u.queue.dispatch;return u.memoizedState=s,[o,d,!1]}function Fa(s,o,u,d){return s={tag:s,create:u,deps:d,inst:o,next:null},o=Jt.updateQueue,o===null&&(o=jf(),Jt.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=s.next=s:(d=u.next,u.next=s,s.next=d,o.lastEffect=s),s}function Jc(){return{destroy:void 0,resource:void 0}}function hm(){return Ye().memoizedState}function tu(s,o,u,d){var g=Vi();d=d===void 0?null:d,Jt.flags|=s,g.memoizedState=Fa(1|o,Jc(),u,d)}function il(s,o,u,d){var g=Ye();d=d===void 0?null:d;var y=g.memoizedState.inst;Se!==null&&d!==null&&Ff(d,Se.memoizedState.deps)?g.memoizedState=Fa(o,y,u,d):(Jt.flags|=s,g.memoizedState=Fa(1|o,y,u,d))}function fm(s,o){tu(8390656,8,s,o)}function dm(s,o){il(2048,8,s,o)}function pm(s,o){return il(4,2,s,o)}function gm(s,o){return il(4,4,s,o)}function mm(s,o){if(typeof o=="function"){s=s();var u=o(s);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function vm(s,o,u){u=u!=null?u.concat([s]):null,il(4,4,mm.bind(null,o,s),u)}function Yf(){}function xm(s,o){var u=Ye();o=o===void 0?null:o;var d=u.memoizedState;return o!==null&&Ff(o,d[1])?d[0]:(u.memoizedState=[s,o],s)}function ym(s,o){var u=Ye();o=o===void 0?null:o;var d=u.memoizedState;if(o!==null&&Ff(o,d[1]))return d[0];if(d=s(),zs){Ci(!0);try{s()}finally{Ci(!1)}}return u.memoizedState=[d,o],d}function $f(s,o,u){return u===void 0||(qr&1073741824)!==0?s.memoizedState=o:(s.memoizedState=u,s=b1(),Jt.lanes|=s,is|=s,u)}function _m(s,o,u,d){return tn(u,o)?u:La.current!==null?(s=$f(s,u,d),tn(s,o)||(oi=!0),s):(qr&42)===0?(oi=!0,s.memoizedState=u):(s=b1(),Jt.lanes|=s,is|=s,o)}function Em(s,o,u,d,g){var y=nt.p;nt.p=y!==0&&8>y?y:8;var w=q.T,D={};q.T=D,Qf(s,!1,o,u);try{var V=g(),it=q.S;if(it!==null&&it(D,V),V!==null&&typeof V=="object"&&typeof V.then=="function"){var mt=Zb(V,d);nl(s,o,mt,an(s))}else nl(s,o,d,an(s))}catch(xt){nl(s,o,{then:function(){},status:"rejected",reason:xt},an())}finally{nt.p=y,q.T=w}}function nA(){}function qf(s,o,u,d){if(s.tag!==5)throw Error(i(476));var g=bm(s).queue;Em(s,g,o,St,u===null?nA:function(){return Am(s),u(d)})}function bm(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:St,baseState:St,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_r,lastRenderedState:St},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:_r,lastRenderedState:u},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function Am(s){var o=bm(s).next.queue;nl(s,o,{},an())}function Kf(){return Ri(El)}function wm(){return Ye().memoizedState}function Sm(){return Ye().memoizedState}function rA(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var u=an();s=Yr(u);var d=$r(o,s,u);d!==null&&(on(d,o,u),Qo(d,o,u)),o={cache:Tf()},s.payload=o;return}o=o.return}}function sA(s,o,u){var d=an();u={lane:d,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},eu(s)?Cm(o,u):(u=mf(s,o,u,d),u!==null&&(on(u,s,d),Rm(u,o,d)))}function Tm(s,o,u){var d=an();nl(s,o,u,d)}function nl(s,o,u,d){var g={lane:d,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(eu(s))Cm(o,g);else{var y=s.alternate;if(s.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var w=o.lastRenderedState,D=y(w,u);if(g.hasEagerState=!0,g.eagerState=D,tn(D,w))return Bc(s,o,g,0),Le===null&&Ic(),!1}catch{}finally{}if(u=mf(s,o,g,d),u!==null)return on(u,s,d),Rm(u,o,d),!0}return!1}function Qf(s,o,u,d){if(d={lane:2,revertLane:Dd(),action:d,hasEagerState:!1,eagerState:null,next:null},eu(s)){if(o)throw Error(i(479))}else o=mf(s,u,d,2),o!==null&&on(o,s,2)}function eu(s){var o=s.alternate;return s===Jt||o!==null&&o===Jt}function Cm(s,o){Pa=qc=!0;var u=s.pending;u===null?o.next=o:(o.next=u.next,u.next=o),s.pending=o}function Rm(s,o,u){if((u&4194048)!==0){var d=o.lanes;d&=s.pendingLanes,u|=d,o.lanes=u,Tc(s,u)}}var iu={readContext:Ri,use:Qc,useCallback:ze,useContext:ze,useEffect:ze,useImperativeHandle:ze,useLayoutEffect:ze,useInsertionEffect:ze,useMemo:ze,useReducer:ze,useRef:ze,useState:ze,useDebugValue:ze,useDeferredValue:ze,useTransition:ze,useSyncExternalStore:ze,useId:ze,useHostTransitionStatus:ze,useFormState:ze,useActionState:ze,useOptimistic:ze,useMemoCache:ze,useCacheRefresh:ze},Dm={readContext:Ri,use:Qc,useCallback:function(s,o){return Vi().memoizedState=[s,o===void 0?null:o],s},useContext:Ri,useEffect:fm,useImperativeHandle:function(s,o,u){u=u!=null?u.concat([s]):null,tu(4194308,4,mm.bind(null,o,s),u)},useLayoutEffect:function(s,o){return tu(4194308,4,s,o)},useInsertionEffect:function(s,o){tu(4,2,s,o)},useMemo:function(s,o){var u=Vi();o=o===void 0?null:o;var d=s();if(zs){Ci(!0);try{s()}finally{Ci(!1)}}return u.memoizedState=[d,o],d},useReducer:function(s,o,u){var d=Vi();if(u!==void 0){var g=u(o);if(zs){Ci(!0);try{u(o)}finally{Ci(!1)}}}else g=o;return d.memoizedState=d.baseState=g,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:g},d.queue=s,s=s.dispatch=sA.bind(null,Jt,s),[d.memoizedState,s]},useRef:function(s){var o=Vi();return s={current:s},o.memoizedState=s},useState:function(s){s=Wf(s);var o=s.queue,u=Tm.bind(null,Jt,o);return o.dispatch=u,[s.memoizedState,u]},useDebugValue:Yf,useDeferredValue:function(s,o){var u=Vi();return $f(u,s,o)},useTransition:function(){var s=Wf(!1);return s=Em.bind(null,Jt,s.queue,!0,!1),Vi().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,u){var d=Jt,g=Vi();if(fe){if(u===void 0)throw Error(i(407));u=u()}else{if(u=o(),Le===null)throw Error(i(349));(oe&124)!==0||Kg(d,o,u)}g.memoizedState=u;var y={value:u,getSnapshot:o};return g.queue=y,fm(Zg.bind(null,d,y,s),[s]),d.flags|=2048,Fa(9,Jc(),Qg.bind(null,d,y,u,o),null),u},useId:function(){var s=Vi(),o=Le.identifierPrefix;if(fe){var u=vr,d=mr;u=(d&~(1<<32-Pi(d)-1)).toString(32)+u,o="«"+o+"R"+u,u=Kc++,0<u&&(o+="H"+u.toString(32)),o+="»"}else u=Jb++,o="«"+o+"r"+u.toString(32)+"»";return s.memoizedState=o},useHostTransitionStatus:Kf,useFormState:om,useActionState:om,useOptimistic:function(s){var o=Vi();o.memoizedState=o.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=Qf.bind(null,Jt,!0,u),u.dispatch=o,[s,o]},useMemoCache:zf,useCacheRefresh:function(){return Vi().memoizedState=rA.bind(null,Jt)}},Mm={readContext:Ri,use:Qc,useCallback:xm,useContext:Ri,useEffect:dm,useImperativeHandle:vm,useInsertionEffect:pm,useLayoutEffect:gm,useMemo:ym,useReducer:Zc,useRef:hm,useState:function(){return Zc(_r)},useDebugValue:Yf,useDeferredValue:function(s,o){var u=Ye();return _m(u,Se.memoizedState,s,o)},useTransition:function(){var s=Zc(_r)[0],o=Ye().memoizedState;return[typeof s=="boolean"?s:el(s),o]},useSyncExternalStore:qg,useId:wm,useHostTransitionStatus:Kf,useFormState:lm,useActionState:lm,useOptimistic:function(s,o){var u=Ye();return em(u,Se,s,o)},useMemoCache:zf,useCacheRefresh:Sm},aA={readContext:Ri,use:Qc,useCallback:xm,useContext:Ri,useEffect:dm,useImperativeHandle:vm,useInsertionEffect:pm,useLayoutEffect:gm,useMemo:ym,useReducer:Gf,useRef:hm,useState:function(){return Gf(_r)},useDebugValue:Yf,useDeferredValue:function(s,o){var u=Ye();return Se===null?$f(u,s,o):_m(u,Se.memoizedState,s,o)},useTransition:function(){var s=Gf(_r)[0],o=Ye().memoizedState;return[typeof s=="boolean"?s:el(s),o]},useSyncExternalStore:qg,useId:wm,useHostTransitionStatus:Kf,useFormState:um,useActionState:um,useOptimistic:function(s,o){var u=Ye();return Se!==null?em(u,Se,s,o):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:zf,useCacheRefresh:Sm},Ia=null,rl=0;function nu(s){var o=rl;return rl+=1,Ia===null&&(Ia=[]),jg(Ia,s,o)}function sl(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function ru(s,o){throw o.$$typeof===m?Error(i(525)):(s=Object.prototype.toString.call(o),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function Nm(s){var o=s._init;return o(s._payload)}function Om(s){function o(Q,K){if(s){var tt=Q.deletions;tt===null?(Q.deletions=[K],Q.flags|=16):tt.push(K)}}function u(Q,K){if(!s)return null;for(;K!==null;)o(Q,K),K=K.sibling;return null}function d(Q){for(var K=new Map;Q!==null;)Q.key!==null?K.set(Q.key,Q):K.set(Q.index,Q),Q=Q.sibling;return K}function g(Q,K){return Q=gr(Q,K),Q.index=0,Q.sibling=null,Q}function y(Q,K,tt){return Q.index=tt,s?(tt=Q.alternate,tt!==null?(tt=tt.index,tt<K?(Q.flags|=67108866,K):tt):(Q.flags|=67108866,K)):(Q.flags|=1048576,K)}function w(Q){return s&&Q.alternate===null&&(Q.flags|=67108866),Q}function D(Q,K,tt,vt){return K===null||K.tag!==6?(K=xf(tt,Q.mode,vt),K.return=Q,K):(K=g(K,tt),K.return=Q,K)}function V(Q,K,tt,vt){var It=tt.type;return It===E?mt(Q,K,tt.props.children,vt,tt.key):K!==null&&(K.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===H&&Nm(It)===K.type)?(K=g(K,tt.props),sl(K,tt),K.return=Q,K):(K=Hc(tt.type,tt.key,tt.props,null,Q.mode,vt),sl(K,tt),K.return=Q,K)}function it(Q,K,tt,vt){return K===null||K.tag!==4||K.stateNode.containerInfo!==tt.containerInfo||K.stateNode.implementation!==tt.implementation?(K=yf(tt,Q.mode,vt),K.return=Q,K):(K=g(K,tt.children||[]),K.return=Q,K)}function mt(Q,K,tt,vt,It){return K===null||K.tag!==7?(K=Ps(tt,Q.mode,vt,It),K.return=Q,K):(K=g(K,tt),K.return=Q,K)}function xt(Q,K,tt){if(typeof K=="string"&&K!==""||typeof K=="number"||typeof K=="bigint")return K=xf(""+K,Q.mode,tt),K.return=Q,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case v:return tt=Hc(K.type,K.key,K.props,null,Q.mode,tt),sl(tt,K),tt.return=Q,tt;case x:return K=yf(K,Q.mode,tt),K.return=Q,K;case H:var vt=K._init;return K=vt(K._payload),xt(Q,K,tt)}if(Et(K)||J(K))return K=Ps(K,Q.mode,tt,null),K.return=Q,K;if(typeof K.then=="function")return xt(Q,nu(K),tt);if(K.$$typeof===S)return xt(Q,Gc(Q,K),tt);ru(Q,K)}return null}function at(Q,K,tt,vt){var It=K!==null?K.key:null;if(typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint")return It!==null?null:D(Q,K,""+tt,vt);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case v:return tt.key===It?V(Q,K,tt,vt):null;case x:return tt.key===It?it(Q,K,tt,vt):null;case H:return It=tt._init,tt=It(tt._payload),at(Q,K,tt,vt)}if(Et(tt)||J(tt))return It!==null?null:mt(Q,K,tt,vt,null);if(typeof tt.then=="function")return at(Q,K,nu(tt),vt);if(tt.$$typeof===S)return at(Q,K,Gc(Q,tt),vt);ru(Q,tt)}return null}function lt(Q,K,tt,vt,It){if(typeof vt=="string"&&vt!==""||typeof vt=="number"||typeof vt=="bigint")return Q=Q.get(tt)||null,D(K,Q,""+vt,It);if(typeof vt=="object"&&vt!==null){switch(vt.$$typeof){case v:return Q=Q.get(vt.key===null?tt:vt.key)||null,V(K,Q,vt,It);case x:return Q=Q.get(vt.key===null?tt:vt.key)||null,it(K,Q,vt,It);case H:var te=vt._init;return vt=te(vt._payload),lt(Q,K,tt,vt,It)}if(Et(vt)||J(vt))return Q=Q.get(tt)||null,mt(K,Q,vt,It,null);if(typeof vt.then=="function")return lt(Q,K,tt,nu(vt),It);if(vt.$$typeof===S)return lt(Q,K,tt,Gc(K,vt),It);ru(K,vt)}return null}function Xt(Q,K,tt,vt){for(var It=null,te=null,Ht=K,Gt=K=0,ci=null;Ht!==null&&Gt<tt.length;Gt++){Ht.index>Gt?(ci=Ht,Ht=null):ci=Ht.sibling;var ue=at(Q,Ht,tt[Gt],vt);if(ue===null){Ht===null&&(Ht=ci);break}s&&Ht&&ue.alternate===null&&o(Q,Ht),K=y(ue,K,Gt),te===null?It=ue:te.sibling=ue,te=ue,Ht=ci}if(Gt===tt.length)return u(Q,Ht),fe&&Fs(Q,Gt),It;if(Ht===null){for(;Gt<tt.length;Gt++)Ht=xt(Q,tt[Gt],vt),Ht!==null&&(K=y(Ht,K,Gt),te===null?It=Ht:te.sibling=Ht,te=Ht);return fe&&Fs(Q,Gt),It}for(Ht=d(Ht);Gt<tt.length;Gt++)ci=lt(Ht,Q,Gt,tt[Gt],vt),ci!==null&&(s&&ci.alternate!==null&&Ht.delete(ci.key===null?Gt:ci.key),K=y(ci,K,Gt),te===null?It=ci:te.sibling=ci,te=ci);return s&&Ht.forEach(function(hs){return o(Q,hs)}),fe&&Fs(Q,Gt),It}function Vt(Q,K,tt,vt){if(tt==null)throw Error(i(151));for(var It=null,te=null,Ht=K,Gt=K=0,ci=null,ue=tt.next();Ht!==null&&!ue.done;Gt++,ue=tt.next()){Ht.index>Gt?(ci=Ht,Ht=null):ci=Ht.sibling;var hs=at(Q,Ht,ue.value,vt);if(hs===null){Ht===null&&(Ht=ci);break}s&&Ht&&hs.alternate===null&&o(Q,Ht),K=y(hs,K,Gt),te===null?It=hs:te.sibling=hs,te=hs,Ht=ci}if(ue.done)return u(Q,Ht),fe&&Fs(Q,Gt),It;if(Ht===null){for(;!ue.done;Gt++,ue=tt.next())ue=xt(Q,ue.value,vt),ue!==null&&(K=y(ue,K,Gt),te===null?It=ue:te.sibling=ue,te=ue);return fe&&Fs(Q,Gt),It}for(Ht=d(Ht);!ue.done;Gt++,ue=tt.next())ue=lt(Ht,Q,Gt,ue.value,vt),ue!==null&&(s&&ue.alternate!==null&&Ht.delete(ue.key===null?Gt:ue.key),K=y(ue,K,Gt),te===null?It=ue:te.sibling=ue,te=ue);return s&&Ht.forEach(function(ow){return o(Q,ow)}),fe&&Fs(Q,Gt),It}function Ce(Q,K,tt,vt){if(typeof tt=="object"&&tt!==null&&tt.type===E&&tt.key===null&&(tt=tt.props.children),typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case v:t:{for(var It=tt.key;K!==null;){if(K.key===It){if(It=tt.type,It===E){if(K.tag===7){u(Q,K.sibling),vt=g(K,tt.props.children),vt.return=Q,Q=vt;break t}}else if(K.elementType===It||typeof It=="object"&&It!==null&&It.$$typeof===H&&Nm(It)===K.type){u(Q,K.sibling),vt=g(K,tt.props),sl(vt,tt),vt.return=Q,Q=vt;break t}u(Q,K);break}else o(Q,K);K=K.sibling}tt.type===E?(vt=Ps(tt.props.children,Q.mode,vt,tt.key),vt.return=Q,Q=vt):(vt=Hc(tt.type,tt.key,tt.props,null,Q.mode,vt),sl(vt,tt),vt.return=Q,Q=vt)}return w(Q);case x:t:{for(It=tt.key;K!==null;){if(K.key===It)if(K.tag===4&&K.stateNode.containerInfo===tt.containerInfo&&K.stateNode.implementation===tt.implementation){u(Q,K.sibling),vt=g(K,tt.children||[]),vt.return=Q,Q=vt;break t}else{u(Q,K);break}else o(Q,K);K=K.sibling}vt=yf(tt,Q.mode,vt),vt.return=Q,Q=vt}return w(Q);case H:return It=tt._init,tt=It(tt._payload),Ce(Q,K,tt,vt)}if(Et(tt))return Xt(Q,K,tt,vt);if(J(tt)){if(It=J(tt),typeof It!="function")throw Error(i(150));return tt=It.call(tt),Vt(Q,K,tt,vt)}if(typeof tt.then=="function")return Ce(Q,K,nu(tt),vt);if(tt.$$typeof===S)return Ce(Q,K,Gc(Q,tt),vt);ru(Q,tt)}return typeof tt=="string"&&tt!==""||typeof tt=="number"||typeof tt=="bigint"?(tt=""+tt,K!==null&&K.tag===6?(u(Q,K.sibling),vt=g(K,tt),vt.return=Q,Q=vt):(u(Q,K),vt=xf(tt,Q.mode,vt),vt.return=Q,Q=vt),w(Q)):u(Q,K)}return function(Q,K,tt,vt){try{rl=0;var It=Ce(Q,K,tt,vt);return Ia=null,It}catch(Ht){if(Ht===qo||Ht===Xc)throw Ht;var te=en(29,Ht,null,Q.mode);return te.lanes=vt,te.return=Q,te}finally{}}}var Ba=Om(!0),Lm=Om(!1),An=ht(null),Qn=null;function Kr(s){var o=s.alternate;j(ni,ni.current&1),j(An,s),Qn===null&&(o===null||La.current!==null||o.memoizedState!==null)&&(Qn=s)}function Pm(s){if(s.tag===22){if(j(ni,ni.current),j(An,s),Qn===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&(Qn=s)}}else Qr()}function Qr(){j(ni,ni.current),j(An,An.current)}function Er(s){P(An),Qn===s&&(Qn=null),P(ni)}var ni=ht(0);function su(s){for(var o=s;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||jd(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function Zf(s,o,u,d){o=s.memoizedState,u=u(d,o),u=u==null?o:p({},o,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var Jf={enqueueSetState:function(s,o,u){s=s._reactInternals;var d=an(),g=Yr(d);g.payload=o,u!=null&&(g.callback=u),o=$r(s,g,d),o!==null&&(on(o,s,d),Qo(o,s,d))},enqueueReplaceState:function(s,o,u){s=s._reactInternals;var d=an(),g=Yr(d);g.tag=1,g.payload=o,u!=null&&(g.callback=u),o=$r(s,g,d),o!==null&&(on(o,s,d),Qo(o,s,d))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var u=an(),d=Yr(u);d.tag=2,o!=null&&(d.callback=o),o=$r(s,d,u),o!==null&&(on(o,s,u),Qo(o,s,u))}};function km(s,o,u,d,g,y,w){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(d,y,w):o.prototype&&o.prototype.isPureReactComponent?!jo(u,d)||!jo(g,y):!0}function Fm(s,o,u,d){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,d),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,d),o.state!==s&&Jf.enqueueReplaceState(o,o.state,null)}function Vs(s,o){var u=o;if("ref"in o){u={};for(var d in o)d!=="ref"&&(u[d]=o[d])}if(s=s.defaultProps){u===o&&(u=p({},u));for(var g in s)u[g]===void 0&&(u[g]=s[g])}return u}var au=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function Im(s){au(s)}function Bm(s){console.error(s)}function Um(s){au(s)}function ou(s,o){try{var u=s.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(d){setTimeout(function(){throw d})}}function Hm(s,o,u){try{var d=s.onCaughtError;d(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function td(s,o,u){return u=Yr(u),u.tag=3,u.payload={element:null},u.callback=function(){ou(s,o)},u}function jm(s){return s=Yr(s),s.tag=3,s}function zm(s,o,u,d){var g=u.type.getDerivedStateFromError;if(typeof g=="function"){var y=d.value;s.payload=function(){return g(y)},s.callback=function(){Hm(o,u,d)}}var w=u.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(s.callback=function(){Hm(o,u,d),typeof g!="function"&&(ns===null?ns=new Set([this]):ns.add(this));var D=d.stack;this.componentDidCatch(d.value,{componentStack:D!==null?D:""})})}function oA(s,o,u,d,g){if(u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){if(o=u.alternate,o!==null&&Xo(o,u,g,!0),u=An.current,u!==null){switch(u.tag){case 13:return Qn===null?wd():u.alternate===null&&Ue===0&&(Ue=3),u.flags&=-257,u.flags|=65536,u.lanes=g,d===Df?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([d]):o.add(d),Td(s,d,g)),!1;case 22:return u.flags|=65536,d===Df?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([d])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([d]):u.add(d)),Td(s,d,g)),!1}throw Error(i(435,u.tag))}return Td(s,d,g),wd(),!1}if(fe)return o=An.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,d!==bf&&(s=Error(i(422),{cause:d}),Wo(yn(s,u)))):(d!==bf&&(o=Error(i(423),{cause:d}),Wo(yn(o,u))),s=s.current.alternate,s.flags|=65536,g&=-g,s.lanes|=g,d=yn(d,u),g=td(s.stateNode,d,g),Of(s,g),Ue!==4&&(Ue=2)),!1;var y=Error(i(520),{cause:d});if(y=yn(y,u),fl===null?fl=[y]:fl.push(y),Ue!==4&&(Ue=2),o===null)return!0;d=yn(d,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,s=g&-g,u.lanes|=s,s=td(u.stateNode,d,s),Of(u,s),!1;case 1:if(o=u.type,y=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(ns===null||!ns.has(y))))return u.flags|=65536,g&=-g,u.lanes|=g,g=jm(g),zm(g,s,u,d),Of(u,g),!1}u=u.return}while(u!==null);return!1}var Vm=Error(i(461)),oi=!1;function gi(s,o,u,d){o.child=s===null?Lm(o,null,u,d):Ba(o,s.child,u,d)}function Gm(s,o,u,d,g){u=u.render;var y=o.ref;if("ref"in d){var w={};for(var D in d)D!=="ref"&&(w[D]=d[D])}else w=d;return Hs(o),d=If(s,o,u,w,y,g),D=Bf(),s!==null&&!oi?(Uf(s,o,g),br(s,o,g)):(fe&&D&&_f(o),o.flags|=1,gi(s,o,d,g),o.child)}function Wm(s,o,u,d,g){if(s===null){var y=u.type;return typeof y=="function"&&!vf(y)&&y.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=y,Xm(s,o,y,d,g)):(s=Hc(u.type,null,d,o,o.mode,g),s.ref=o.ref,s.return=o,o.child=s)}if(y=s.child,!ld(s,g)){var w=y.memoizedProps;if(u=u.compare,u=u!==null?u:jo,u(w,d)&&s.ref===o.ref)return br(s,o,g)}return o.flags|=1,s=gr(y,d),s.ref=o.ref,s.return=o,o.child=s}function Xm(s,o,u,d,g){if(s!==null){var y=s.memoizedProps;if(jo(y,d)&&s.ref===o.ref)if(oi=!1,o.pendingProps=d=y,ld(s,g))(s.flags&131072)!==0&&(oi=!0);else return o.lanes=s.lanes,br(s,o,g)}return ed(s,o,u,d,g)}function Ym(s,o,u){var d=o.pendingProps,g=d.children,y=s!==null?s.memoizedState:null;if(d.mode==="hidden"){if((o.flags&128)!==0){if(d=y!==null?y.baseLanes|u:u,s!==null){for(g=o.child=s.child,y=0;g!==null;)y=y|g.lanes|g.childLanes,g=g.sibling;o.childLanes=y&~d}else o.childLanes=0,o.child=null;return $m(s,o,d,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&Wc(o,y!==null?y.cachePool:null),y!==null?Xg(o,y):Pf(),Pm(o);else return o.lanes=o.childLanes=536870912,$m(s,o,y!==null?y.baseLanes|u:u,u)}else y!==null?(Wc(o,y.cachePool),Xg(o,y),Qr(),o.memoizedState=null):(s!==null&&Wc(o,null),Pf(),Qr());return gi(s,o,g,u),o.child}function $m(s,o,u,d){var g=Rf();return g=g===null?null:{parent:ii._currentValue,pool:g},o.memoizedState={baseLanes:u,cachePool:g},s!==null&&Wc(o,null),Pf(),Pm(o),s!==null&&Xo(s,o,d,!0),null}function lu(s,o){var u=o.ref;if(u===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(i(284));(s===null||s.ref!==u)&&(o.flags|=4194816)}}function ed(s,o,u,d,g){return Hs(o),u=If(s,o,u,d,void 0,g),d=Bf(),s!==null&&!oi?(Uf(s,o,g),br(s,o,g)):(fe&&d&&_f(o),o.flags|=1,gi(s,o,u,g),o.child)}function qm(s,o,u,d,g,y){return Hs(o),o.updateQueue=null,u=$g(o,d,u,g),Yg(s),d=Bf(),s!==null&&!oi?(Uf(s,o,y),br(s,o,y)):(fe&&d&&_f(o),o.flags|=1,gi(s,o,u,y),o.child)}function Km(s,o,u,d,g){if(Hs(o),o.stateNode===null){var y=Ra,w=u.contextType;typeof w=="object"&&w!==null&&(y=Ri(w)),y=new u(d,y),o.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=Jf,o.stateNode=y,y._reactInternals=o,y=o.stateNode,y.props=d,y.state=o.memoizedState,y.refs={},Mf(o),w=u.contextType,y.context=typeof w=="object"&&w!==null?Ri(w):Ra,y.state=o.memoizedState,w=u.getDerivedStateFromProps,typeof w=="function"&&(Zf(o,u,w,d),y.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(w=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),w!==y.state&&Jf.enqueueReplaceState(y,y.state,null),Jo(o,d,y,g),Zo(),y.state=o.memoizedState),typeof y.componentDidMount=="function"&&(o.flags|=4194308),d=!0}else if(s===null){y=o.stateNode;var D=o.memoizedProps,V=Vs(u,D);y.props=V;var it=y.context,mt=u.contextType;w=Ra,typeof mt=="object"&&mt!==null&&(w=Ri(mt));var xt=u.getDerivedStateFromProps;mt=typeof xt=="function"||typeof y.getSnapshotBeforeUpdate=="function",D=o.pendingProps!==D,mt||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(D||it!==w)&&Fm(o,y,d,w),Xr=!1;var at=o.memoizedState;y.state=at,Jo(o,d,y,g),Zo(),it=o.memoizedState,D||at!==it||Xr?(typeof xt=="function"&&(Zf(o,u,xt,d),it=o.memoizedState),(V=Xr||km(o,u,V,d,at,it,w))?(mt||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(o.flags|=4194308)):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=d,o.memoizedState=it),y.props=d,y.state=it,y.context=w,d=V):(typeof y.componentDidMount=="function"&&(o.flags|=4194308),d=!1)}else{y=o.stateNode,Nf(s,o),w=o.memoizedProps,mt=Vs(u,w),y.props=mt,xt=o.pendingProps,at=y.context,it=u.contextType,V=Ra,typeof it=="object"&&it!==null&&(V=Ri(it)),D=u.getDerivedStateFromProps,(it=typeof D=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(w!==xt||at!==V)&&Fm(o,y,d,V),Xr=!1,at=o.memoizedState,y.state=at,Jo(o,d,y,g),Zo();var lt=o.memoizedState;w!==xt||at!==lt||Xr||s!==null&&s.dependencies!==null&&Vc(s.dependencies)?(typeof D=="function"&&(Zf(o,u,D,d),lt=o.memoizedState),(mt=Xr||km(o,u,mt,d,at,lt,V)||s!==null&&s.dependencies!==null&&Vc(s.dependencies))?(it||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(d,lt,V),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(d,lt,V)),typeof y.componentDidUpdate=="function"&&(o.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof y.componentDidUpdate!="function"||w===s.memoizedProps&&at===s.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&at===s.memoizedState||(o.flags|=1024),o.memoizedProps=d,o.memoizedState=lt),y.props=d,y.state=lt,y.context=V,d=mt):(typeof y.componentDidUpdate!="function"||w===s.memoizedProps&&at===s.memoizedState||(o.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||w===s.memoizedProps&&at===s.memoizedState||(o.flags|=1024),d=!1)}return y=d,lu(s,o),d=(o.flags&128)!==0,y||d?(y=o.stateNode,u=d&&typeof u.getDerivedStateFromError!="function"?null:y.render(),o.flags|=1,s!==null&&d?(o.child=Ba(o,s.child,null,g),o.child=Ba(o,null,u,g)):gi(s,o,u,g),o.memoizedState=y.state,s=o.child):s=br(s,o,g),s}function Qm(s,o,u,d){return Go(),o.flags|=256,gi(s,o,u,d),o.child}var id={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function nd(s){return{baseLanes:s,cachePool:Bg()}}function rd(s,o,u){return s=s!==null?s.childLanes&~u:0,o&&(s|=wn),s}function Zm(s,o,u){var d=o.pendingProps,g=!1,y=(o.flags&128)!==0,w;if((w=y)||(w=s!==null&&s.memoizedState===null?!1:(ni.current&2)!==0),w&&(g=!0,o.flags&=-129),w=(o.flags&32)!==0,o.flags&=-33,s===null){if(fe){if(g?Kr(o):Qr(),fe){var D=Be,V;if(V=D){t:{for(V=D,D=Kn;V.nodeType!==8;){if(!D){D=null;break t}if(V=Un(V.nextSibling),V===null){D=null;break t}}D=V}D!==null?(o.memoizedState={dehydrated:D,treeContext:ks!==null?{id:mr,overflow:vr}:null,retryLane:536870912,hydrationErrors:null},V=en(18,null,null,0),V.stateNode=D,V.return=o,o.child=V,ki=o,Be=null,V=!0):V=!1}V||Bs(o)}if(D=o.memoizedState,D!==null&&(D=D.dehydrated,D!==null))return jd(D)?o.lanes=32:o.lanes=536870912,null;Er(o)}return D=d.children,d=d.fallback,g?(Qr(),g=o.mode,D=cu({mode:"hidden",children:D},g),d=Ps(d,g,u,null),D.return=o,d.return=o,D.sibling=d,o.child=D,g=o.child,g.memoizedState=nd(u),g.childLanes=rd(s,w,u),o.memoizedState=id,d):(Kr(o),sd(o,D))}if(V=s.memoizedState,V!==null&&(D=V.dehydrated,D!==null)){if(y)o.flags&256?(Kr(o),o.flags&=-257,o=ad(s,o,u)):o.memoizedState!==null?(Qr(),o.child=s.child,o.flags|=128,o=null):(Qr(),g=d.fallback,D=o.mode,d=cu({mode:"visible",children:d.children},D),g=Ps(g,D,u,null),g.flags|=2,d.return=o,g.return=o,d.sibling=g,o.child=d,Ba(o,s.child,null,u),d=o.child,d.memoizedState=nd(u),d.childLanes=rd(s,w,u),o.memoizedState=id,o=g);else if(Kr(o),jd(D)){if(w=D.nextSibling&&D.nextSibling.dataset,w)var it=w.dgst;w=it,d=Error(i(419)),d.stack="",d.digest=w,Wo({value:d,source:null,stack:null}),o=ad(s,o,u)}else if(oi||Xo(s,o,u,!1),w=(u&s.childLanes)!==0,oi||w){if(w=Le,w!==null&&(d=u&-u,d=(d&42)!==0?1:No(d),d=(d&(w.suspendedLanes|u))!==0?0:d,d!==0&&d!==V.retryLane))throw V.retryLane=d,Ca(s,d),on(w,s,d),Vm;D.data==="$?"||wd(),o=ad(s,o,u)}else D.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=V.treeContext,Be=Un(D.nextSibling),ki=o,fe=!0,Is=null,Kn=!1,s!==null&&(En[bn++]=mr,En[bn++]=vr,En[bn++]=ks,mr=s.id,vr=s.overflow,ks=o),o=sd(o,d.children),o.flags|=4096);return o}return g?(Qr(),g=d.fallback,D=o.mode,V=s.child,it=V.sibling,d=gr(V,{mode:"hidden",children:d.children}),d.subtreeFlags=V.subtreeFlags&65011712,it!==null?g=gr(it,g):(g=Ps(g,D,u,null),g.flags|=2),g.return=o,d.return=o,d.sibling=g,o.child=d,d=g,g=o.child,D=s.child.memoizedState,D===null?D=nd(u):(V=D.cachePool,V!==null?(it=ii._currentValue,V=V.parent!==it?{parent:it,pool:it}:V):V=Bg(),D={baseLanes:D.baseLanes|u,cachePool:V}),g.memoizedState=D,g.childLanes=rd(s,w,u),o.memoizedState=id,d):(Kr(o),u=s.child,s=u.sibling,u=gr(u,{mode:"visible",children:d.children}),u.return=o,u.sibling=null,s!==null&&(w=o.deletions,w===null?(o.deletions=[s],o.flags|=16):w.push(s)),o.child=u,o.memoizedState=null,u)}function sd(s,o){return o=cu({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function cu(s,o){return s=en(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function ad(s,o,u){return Ba(o,s.child,null,u),s=sd(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function Jm(s,o,u){s.lanes|=o;var d=s.alternate;d!==null&&(d.lanes|=o),wf(s.return,o,u)}function od(s,o,u,d,g){var y=s.memoizedState;y===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:d,tail:u,tailMode:g}:(y.isBackwards=o,y.rendering=null,y.renderingStartTime=0,y.last=d,y.tail=u,y.tailMode=g)}function t1(s,o,u){var d=o.pendingProps,g=d.revealOrder,y=d.tail;if(gi(s,o,d.children,u),d=ni.current,(d&2)!==0)d=d&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)t:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Jm(s,u,o);else if(s.tag===19)Jm(s,u,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break t;for(;s.sibling===null;){if(s.return===null||s.return===o)break t;s=s.return}s.sibling.return=s.return,s=s.sibling}d&=1}switch(j(ni,d),g){case"forwards":for(u=o.child,g=null;u!==null;)s=u.alternate,s!==null&&su(s)===null&&(g=u),u=u.sibling;u=g,u===null?(g=o.child,o.child=null):(g=u.sibling,u.sibling=null),od(o,!1,g,u,y);break;case"backwards":for(u=null,g=o.child,o.child=null;g!==null;){if(s=g.alternate,s!==null&&su(s)===null){o.child=g;break}s=g.sibling,g.sibling=u,u=g,g=s}od(o,!0,u,null,y);break;case"together":od(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function br(s,o,u){if(s!==null&&(o.dependencies=s.dependencies),is|=o.lanes,(u&o.childLanes)===0)if(s!==null){if(Xo(s,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(i(153));if(o.child!==null){for(s=o.child,u=gr(s,s.pendingProps),o.child=u,u.return=o;s.sibling!==null;)s=s.sibling,u=u.sibling=gr(s,s.pendingProps),u.return=o;u.sibling=null}return o.child}function ld(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&Vc(s)))}function lA(s,o,u){switch(o.tag){case 3:Ct(o,o.stateNode.containerInfo),Wr(o,ii,s.memoizedState.cache),Go();break;case 27:case 5:yt(o);break;case 4:Ct(o,o.stateNode.containerInfo);break;case 10:Wr(o,o.type,o.memoizedProps.value);break;case 13:var d=o.memoizedState;if(d!==null)return d.dehydrated!==null?(Kr(o),o.flags|=128,null):(u&o.child.childLanes)!==0?Zm(s,o,u):(Kr(o),s=br(s,o,u),s!==null?s.sibling:null);Kr(o);break;case 19:var g=(s.flags&128)!==0;if(d=(u&o.childLanes)!==0,d||(Xo(s,o,u,!1),d=(u&o.childLanes)!==0),g){if(d)return t1(s,o,u);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),j(ni,ni.current),d)break;return null;case 22:case 23:return o.lanes=0,Ym(s,o,u);case 24:Wr(o,ii,s.memoizedState.cache)}return br(s,o,u)}function e1(s,o,u){if(s!==null)if(s.memoizedProps!==o.pendingProps)oi=!0;else{if(!ld(s,u)&&(o.flags&128)===0)return oi=!1,lA(s,o,u);oi=(s.flags&131072)!==0}else oi=!1,fe&&(o.flags&1048576)!==0&&Ng(o,zc,o.index);switch(o.lanes=0,o.tag){case 16:t:{s=o.pendingProps;var d=o.elementType,g=d._init;if(d=g(d._payload),o.type=d,typeof d=="function")vf(d)?(s=Vs(d,s),o.tag=1,o=Km(null,o,d,s,u)):(o.tag=0,o=ed(null,o,d,s,u));else{if(d!=null){if(g=d.$$typeof,g===C){o.tag=11,o=Gm(null,o,d,s,u);break t}else if(g===O){o.tag=14,o=Wm(null,o,d,s,u);break t}}throw o=At(d)||d,Error(i(306,o,""))}}return o;case 0:return ed(s,o,o.type,o.pendingProps,u);case 1:return d=o.type,g=Vs(d,o.pendingProps),Km(s,o,d,g,u);case 3:t:{if(Ct(o,o.stateNode.containerInfo),s===null)throw Error(i(387));d=o.pendingProps;var y=o.memoizedState;g=y.element,Nf(s,o),Jo(o,d,null,u);var w=o.memoizedState;if(d=w.cache,Wr(o,ii,d),d!==y.cache&&Sf(o,[ii],u,!0),Zo(),d=w.element,y.isDehydrated)if(y={element:d,isDehydrated:!1,cache:w.cache},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){o=Qm(s,o,d,u);break t}else if(d!==g){g=yn(Error(i(424)),o),Wo(g),o=Qm(s,o,d,u);break t}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Be=Un(s.firstChild),ki=o,fe=!0,Is=null,Kn=!0,u=Lm(o,null,d,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Go(),d===g){o=br(s,o,u);break t}gi(s,o,d,u)}o=o.child}return o;case 26:return lu(s,o),s===null?(u=sv(o.type,null,o.pendingProps,null))?o.memoizedState=u:fe||(u=o.type,s=o.pendingProps,d=Au(et.current).createElement(u),d[si]=o,d[ai]=s,vi(d,u,s),Z(d),o.stateNode=d):o.memoizedState=sv(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return yt(o),s===null&&fe&&(d=o.stateNode=iv(o.type,o.pendingProps,et.current),ki=o,Kn=!0,g=Be,as(o.type)?(zd=g,Be=Un(d.firstChild)):Be=g),gi(s,o,o.pendingProps.children,u),lu(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&fe&&((g=d=Be)&&(d=FA(d,o.type,o.pendingProps,Kn),d!==null?(o.stateNode=d,ki=o,Be=Un(d.firstChild),Kn=!1,g=!0):g=!1),g||Bs(o)),yt(o),g=o.type,y=o.pendingProps,w=s!==null?s.memoizedProps:null,d=y.children,Bd(g,y)?d=null:w!==null&&Bd(g,w)&&(o.flags|=32),o.memoizedState!==null&&(g=If(s,o,tA,null,null,u),El._currentValue=g),lu(s,o),gi(s,o,d,u),o.child;case 6:return s===null&&fe&&((s=u=Be)&&(u=IA(u,o.pendingProps,Kn),u!==null?(o.stateNode=u,ki=o,Be=null,s=!0):s=!1),s||Bs(o)),null;case 13:return Zm(s,o,u);case 4:return Ct(o,o.stateNode.containerInfo),d=o.pendingProps,s===null?o.child=Ba(o,null,d,u):gi(s,o,d,u),o.child;case 11:return Gm(s,o,o.type,o.pendingProps,u);case 7:return gi(s,o,o.pendingProps,u),o.child;case 8:return gi(s,o,o.pendingProps.children,u),o.child;case 12:return gi(s,o,o.pendingProps.children,u),o.child;case 10:return d=o.pendingProps,Wr(o,o.type,d.value),gi(s,o,d.children,u),o.child;case 9:return g=o.type._context,d=o.pendingProps.children,Hs(o),g=Ri(g),d=d(g),o.flags|=1,gi(s,o,d,u),o.child;case 14:return Wm(s,o,o.type,o.pendingProps,u);case 15:return Xm(s,o,o.type,o.pendingProps,u);case 19:return t1(s,o,u);case 31:return d=o.pendingProps,u=o.mode,d={mode:d.mode,children:d.children},s===null?(u=cu(d,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=gr(s.child,d),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return Ym(s,o,u);case 24:return Hs(o),d=Ri(ii),s===null?(g=Rf(),g===null&&(g=Le,y=Tf(),g.pooledCache=y,y.refCount++,y!==null&&(g.pooledCacheLanes|=u),g=y),o.memoizedState={parent:d,cache:g},Mf(o),Wr(o,ii,g)):((s.lanes&u)!==0&&(Nf(s,o),Jo(o,null,null,u),Zo()),g=s.memoizedState,y=o.memoizedState,g.parent!==d?(g={parent:d,cache:d},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),Wr(o,ii,d)):(d=y.cache,Wr(o,ii,d),d!==g.cache&&Sf(o,[ii],u,!0))),gi(s,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(i(156,o.tag))}function Ar(s){s.flags|=4}function i1(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!uv(o)){if(o=An.current,o!==null&&((oe&4194048)===oe?Qn!==null:(oe&62914560)!==oe&&(oe&536870912)===0||o!==Qn))throw Ko=Df,Ug;s.flags|=8192}}function uu(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?Do():536870912,s.lanes|=o,za|=o)}function al(s,o){if(!fe)switch(s.tailMode){case"hidden":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var d=null;u!==null;)u.alternate!==null&&(d=u),u=u.sibling;d===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:d.sibling=null}}function Fe(s){var o=s.alternate!==null&&s.alternate.child===s.child,u=0,d=0;if(o)for(var g=s.child;g!==null;)u|=g.lanes|g.childLanes,d|=g.subtreeFlags&65011712,d|=g.flags&65011712,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)u|=g.lanes|g.childLanes,d|=g.subtreeFlags,d|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=d,s.childLanes=u,o}function cA(s,o,u){var d=o.pendingProps;switch(Ef(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Fe(o),null;case 1:return Fe(o),null;case 3:return u=o.stateNode,d=null,s!==null&&(d=s.memoizedState.cache),o.memoizedState.cache!==d&&(o.flags|=2048),yr(ii),pt(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Vo(o)?Ar(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Pg())),Fe(o),null;case 26:return u=o.memoizedState,s===null?(Ar(o),u!==null?(Fe(o),i1(o,u)):(Fe(o),o.flags&=-16777217)):u?u!==s.memoizedState?(Ar(o),Fe(o),i1(o,u)):(Fe(o),o.flags&=-16777217):(s.memoizedProps!==d&&Ar(o),Fe(o),o.flags&=-16777217),null;case 27:Ut(o),u=et.current;var g=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==d&&Ar(o);else{if(!d){if(o.stateNode===null)throw Error(i(166));return Fe(o),null}s=z.current,Vo(o)?Og(o):(s=iv(g,d,u),o.stateNode=s,Ar(o))}return Fe(o),null;case 5:if(Ut(o),u=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==d&&Ar(o);else{if(!d){if(o.stateNode===null)throw Error(i(166));return Fe(o),null}if(s=z.current,Vo(o))Og(o);else{switch(g=Au(et.current),s){case 1:s=g.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=g.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=g.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=g.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=g.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof d.is=="string"?g.createElement("select",{is:d.is}):g.createElement("select"),d.multiple?s.multiple=!0:d.size&&(s.size=d.size);break;default:s=typeof d.is=="string"?g.createElement(u,{is:d.is}):g.createElement(u)}}s[si]=o,s[ai]=d;t:for(g=o.child;g!==null;){if(g.tag===5||g.tag===6)s.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===o)break t;for(;g.sibling===null;){if(g.return===null||g.return===o)break t;g=g.return}g.sibling.return=g.return,g=g.sibling}o.stateNode=s;t:switch(vi(s,u,d),u){case"button":case"input":case"select":case"textarea":s=!!d.autoFocus;break t;case"img":s=!0;break t;default:s=!1}s&&Ar(o)}}return Fe(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==d&&Ar(o);else{if(typeof d!="string"&&o.stateNode===null)throw Error(i(166));if(s=et.current,Vo(o)){if(s=o.stateNode,u=o.memoizedProps,d=null,g=ki,g!==null)switch(g.tag){case 27:case 5:d=g.memoizedProps}s[si]=o,s=!!(s.nodeValue===u||d!==null&&d.suppressHydrationWarning===!0||q1(s.nodeValue,u)),s||Bs(o)}else s=Au(s).createTextNode(d),s[si]=o,o.stateNode=s}return Fe(o),null;case 13:if(d=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(g=Vo(o),d!==null&&d.dehydrated!==null){if(s===null){if(!g)throw Error(i(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[si]=o}else Go(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;Fe(o),g=!1}else g=Pg(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(Er(o),o):(Er(o),null)}if(Er(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=d!==null,s=s!==null&&s.memoizedState!==null,u){d=o.child,g=null,d.alternate!==null&&d.alternate.memoizedState!==null&&d.alternate.memoizedState.cachePool!==null&&(g=d.alternate.memoizedState.cachePool.pool);var y=null;d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(y=d.memoizedState.cachePool.pool),y!==g&&(d.flags|=2048)}return u!==s&&u&&(o.child.flags|=8192),uu(o,o.updateQueue),Fe(o),null;case 4:return pt(),s===null&&Ld(o.stateNode.containerInfo),Fe(o),null;case 10:return yr(o.type),Fe(o),null;case 19:if(P(ni),g=o.memoizedState,g===null)return Fe(o),null;if(d=(o.flags&128)!==0,y=g.rendering,y===null)if(d)al(g,!1);else{if(Ue!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(y=su(s),y!==null){for(o.flags|=128,al(g,!1),s=y.updateQueue,o.updateQueue=s,uu(o,s),o.subtreeFlags=0,s=u,u=o.child;u!==null;)Mg(u,s),u=u.sibling;return j(ni,ni.current&1|2),o.child}s=s.sibling}g.tail!==null&&Rt()>du&&(o.flags|=128,d=!0,al(g,!1),o.lanes=4194304)}else{if(!d)if(s=su(y),s!==null){if(o.flags|=128,d=!0,s=s.updateQueue,o.updateQueue=s,uu(o,s),al(g,!0),g.tail===null&&g.tailMode==="hidden"&&!y.alternate&&!fe)return Fe(o),null}else 2*Rt()-g.renderingStartTime>du&&u!==536870912&&(o.flags|=128,d=!0,al(g,!1),o.lanes=4194304);g.isBackwards?(y.sibling=o.child,o.child=y):(s=g.last,s!==null?s.sibling=y:o.child=y,g.last=y)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=Rt(),o.sibling=null,s=ni.current,j(ni,d?s&1|2:s&1),o):(Fe(o),null);case 22:case 23:return Er(o),kf(),d=o.memoizedState!==null,s!==null?s.memoizedState!==null!==d&&(o.flags|=8192):d&&(o.flags|=8192),d?(u&536870912)!==0&&(o.flags&128)===0&&(Fe(o),o.subtreeFlags&6&&(o.flags|=8192)):Fe(o),u=o.updateQueue,u!==null&&uu(o,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),d=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(d=o.memoizedState.cachePool.pool),d!==u&&(o.flags|=2048),s!==null&&P(js),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),yr(ii),Fe(o),null;case 25:return null;case 30:return null}throw Error(i(156,o.tag))}function uA(s,o){switch(Ef(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return yr(ii),pt(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return Ut(o),null;case 13:if(Er(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(i(340));Go()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return P(ni),null;case 4:return pt(),null;case 10:return yr(o.type),null;case 22:case 23:return Er(o),kf(),s!==null&&P(js),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return yr(ii),null;case 25:return null;default:return null}}function n1(s,o){switch(Ef(o),o.tag){case 3:yr(ii),pt();break;case 26:case 27:case 5:Ut(o);break;case 4:pt();break;case 13:Er(o);break;case 19:P(ni);break;case 10:yr(o.type);break;case 22:case 23:Er(o),kf(),s!==null&&P(js);break;case 24:yr(ii)}}function ol(s,o){try{var u=o.updateQueue,d=u!==null?u.lastEffect:null;if(d!==null){var g=d.next;u=g;do{if((u.tag&s)===s){d=void 0;var y=u.create,w=u.inst;d=y(),w.destroy=d}u=u.next}while(u!==g)}}catch(D){Me(o,o.return,D)}}function Zr(s,o,u){try{var d=o.updateQueue,g=d!==null?d.lastEffect:null;if(g!==null){var y=g.next;d=y;do{if((d.tag&s)===s){var w=d.inst,D=w.destroy;if(D!==void 0){w.destroy=void 0,g=o;var V=u,it=D;try{it()}catch(mt){Me(g,V,mt)}}}d=d.next}while(d!==y)}}catch(mt){Me(o,o.return,mt)}}function r1(s){var o=s.updateQueue;if(o!==null){var u=s.stateNode;try{Wg(o,u)}catch(d){Me(s,s.return,d)}}}function s1(s,o,u){u.props=Vs(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(d){Me(s,o,d)}}function ll(s,o){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var d=s.stateNode;break;case 30:d=s.stateNode;break;default:d=s.stateNode}typeof u=="function"?s.refCleanup=u(d):u.current=d}}catch(g){Me(s,o,g)}}function Zn(s,o){var u=s.ref,d=s.refCleanup;if(u!==null)if(typeof d=="function")try{d()}catch(g){Me(s,o,g)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(g){Me(s,o,g)}else u.current=null}function a1(s){var o=s.type,u=s.memoizedProps,d=s.stateNode;try{t:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&d.focus();break t;case"img":u.src?d.src=u.src:u.srcSet&&(d.srcset=u.srcSet)}}catch(g){Me(s,s.return,g)}}function cd(s,o,u){try{var d=s.stateNode;NA(d,s.type,u,o),d[ai]=o}catch(g){Me(s,s.return,g)}}function o1(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&as(s.type)||s.tag===4}function ud(s){t:for(;;){for(;s.sibling===null;){if(s.return===null||o1(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&as(s.type)||s.flags&2||s.child===null||s.tag===4)continue t;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function hd(s,o,u){var d=s.tag;if(d===5||d===6)s=s.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(s),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=bu));else if(d!==4&&(d===27&&as(s.type)&&(u=s.stateNode,o=null),s=s.child,s!==null))for(hd(s,o,u),s=s.sibling;s!==null;)hd(s,o,u),s=s.sibling}function hu(s,o,u){var d=s.tag;if(d===5||d===6)s=s.stateNode,o?u.insertBefore(s,o):u.appendChild(s);else if(d!==4&&(d===27&&as(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(hu(s,o,u),s=s.sibling;s!==null;)hu(s,o,u),s=s.sibling}function l1(s){var o=s.stateNode,u=s.memoizedProps;try{for(var d=s.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);vi(o,d,u),o[si]=s,o[ai]=u}catch(y){Me(s,s.return,y)}}var wr=!1,Ve=!1,fd=!1,c1=typeof WeakSet=="function"?WeakSet:Set,li=null;function hA(s,o){if(s=s.containerInfo,Fd=Du,s=_g(s),uf(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else t:{u=(u=s.ownerDocument)&&u.defaultView||window;var d=u.getSelection&&u.getSelection();if(d&&d.rangeCount!==0){u=d.anchorNode;var g=d.anchorOffset,y=d.focusNode;d=d.focusOffset;try{u.nodeType,y.nodeType}catch{u=null;break t}var w=0,D=-1,V=-1,it=0,mt=0,xt=s,at=null;e:for(;;){for(var lt;xt!==u||g!==0&&xt.nodeType!==3||(D=w+g),xt!==y||d!==0&&xt.nodeType!==3||(V=w+d),xt.nodeType===3&&(w+=xt.nodeValue.length),(lt=xt.firstChild)!==null;)at=xt,xt=lt;for(;;){if(xt===s)break e;if(at===u&&++it===g&&(D=w),at===y&&++mt===d&&(V=w),(lt=xt.nextSibling)!==null)break;xt=at,at=xt.parentNode}xt=lt}u=D===-1||V===-1?null:{start:D,end:V}}else u=null}u=u||{start:0,end:0}}else u=null;for(Id={focusedElem:s,selectionRange:u},Du=!1,li=o;li!==null;)if(o=li,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,li=s;else for(;li!==null;){switch(o=li,y=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&y!==null){s=void 0,u=o,g=y.memoizedProps,y=y.memoizedState,d=u.stateNode;try{var Xt=Vs(u.type,g,u.elementType===u.type);s=d.getSnapshotBeforeUpdate(Xt,y),d.__reactInternalSnapshotBeforeUpdate=s}catch(Vt){Me(u,u.return,Vt)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,u=s.nodeType,u===9)Hd(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Hd(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=o.sibling,s!==null){s.return=o.return,li=s;break}li=o.return}}function u1(s,o,u){var d=u.flags;switch(u.tag){case 0:case 11:case 15:Jr(s,u),d&4&&ol(5,u);break;case 1:if(Jr(s,u),d&4)if(s=u.stateNode,o===null)try{s.componentDidMount()}catch(w){Me(u,u.return,w)}else{var g=Vs(u.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(g,o,s.__reactInternalSnapshotBeforeUpdate)}catch(w){Me(u,u.return,w)}}d&64&&r1(u),d&512&&ll(u,u.return);break;case 3:if(Jr(s,u),d&64&&(s=u.updateQueue,s!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{Wg(s,o)}catch(w){Me(u,u.return,w)}}break;case 27:o===null&&d&4&&l1(u);case 26:case 5:Jr(s,u),o===null&&d&4&&a1(u),d&512&&ll(u,u.return);break;case 12:Jr(s,u);break;case 13:Jr(s,u),d&4&&d1(s,u),d&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=_A.bind(null,u),BA(s,u))));break;case 22:if(d=u.memoizedState!==null||wr,!d){o=o!==null&&o.memoizedState!==null||Ve,g=wr;var y=Ve;wr=d,(Ve=o)&&!y?ts(s,u,(u.subtreeFlags&8772)!==0):Jr(s,u),wr=g,Ve=y}break;case 30:break;default:Jr(s,u)}}function h1(s){var o=s.alternate;o!==null&&(s.alternate=null,h1(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&k(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var ke=null,Gi=!1;function Sr(s,o,u){for(u=u.child;u!==null;)f1(s,o,u),u=u.sibling}function f1(s,o,u){if(pi&&typeof pi.onCommitFiberUnmount=="function")try{pi.onCommitFiberUnmount(fr,u)}catch{}switch(u.tag){case 26:Ve||Zn(u,o),Sr(s,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:Ve||Zn(u,o);var d=ke,g=Gi;as(u.type)&&(ke=u.stateNode,Gi=!1),Sr(s,o,u),vl(u.stateNode),ke=d,Gi=g;break;case 5:Ve||Zn(u,o);case 6:if(d=ke,g=Gi,ke=null,Sr(s,o,u),ke=d,Gi=g,ke!==null)if(Gi)try{(ke.nodeType===9?ke.body:ke.nodeName==="HTML"?ke.ownerDocument.body:ke).removeChild(u.stateNode)}catch(y){Me(u,o,y)}else try{ke.removeChild(u.stateNode)}catch(y){Me(u,o,y)}break;case 18:ke!==null&&(Gi?(s=ke,tv(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),Sl(s)):tv(ke,u.stateNode));break;case 4:d=ke,g=Gi,ke=u.stateNode.containerInfo,Gi=!0,Sr(s,o,u),ke=d,Gi=g;break;case 0:case 11:case 14:case 15:Ve||Zr(2,u,o),Ve||Zr(4,u,o),Sr(s,o,u);break;case 1:Ve||(Zn(u,o),d=u.stateNode,typeof d.componentWillUnmount=="function"&&s1(u,o,d)),Sr(s,o,u);break;case 21:Sr(s,o,u);break;case 22:Ve=(d=Ve)||u.memoizedState!==null,Sr(s,o,u),Ve=d;break;default:Sr(s,o,u)}}function d1(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Sl(s)}catch(u){Me(o,o.return,u)}}function fA(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new c1),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new c1),o;default:throw Error(i(435,s.tag))}}function dd(s,o){var u=fA(s);o.forEach(function(d){var g=EA.bind(null,s,d);u.has(d)||(u.add(d),d.then(g,g))})}function nn(s,o){var u=o.deletions;if(u!==null)for(var d=0;d<u.length;d++){var g=u[d],y=s,w=o,D=w;t:for(;D!==null;){switch(D.tag){case 27:if(as(D.type)){ke=D.stateNode,Gi=!1;break t}break;case 5:ke=D.stateNode,Gi=!1;break t;case 3:case 4:ke=D.stateNode.containerInfo,Gi=!0;break t}D=D.return}if(ke===null)throw Error(i(160));f1(y,w,g),ke=null,Gi=!1,y=g.alternate,y!==null&&(y.return=null),g.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)p1(o,s),o=o.sibling}var Bn=null;function p1(s,o){var u=s.alternate,d=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:nn(o,s),rn(s),d&4&&(Zr(3,s,s.return),ol(3,s),Zr(5,s,s.return));break;case 1:nn(o,s),rn(s),d&512&&(Ve||u===null||Zn(u,u.return)),d&64&&wr&&(s=s.updateQueue,s!==null&&(d=s.callbacks,d!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?d:u.concat(d))));break;case 26:var g=Bn;if(nn(o,s),rn(s),d&512&&(Ve||u===null||Zn(u,u.return)),d&4){var y=u!==null?u.memoizedState:null;if(d=s.memoizedState,u===null)if(d===null)if(s.stateNode===null){t:{d=s.type,u=s.memoizedProps,g=g.ownerDocument||g;e:switch(d){case"title":y=g.getElementsByTagName("title")[0],(!y||y[L]||y[si]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=g.createElement(d),g.head.insertBefore(y,g.querySelector("head > title"))),vi(y,d,u),y[si]=s,Z(y),d=y;break t;case"link":var w=lv("link","href",g).get(d+(u.href||""));if(w){for(var D=0;D<w.length;D++)if(y=w[D],y.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&y.getAttribute("rel")===(u.rel==null?null:u.rel)&&y.getAttribute("title")===(u.title==null?null:u.title)&&y.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){w.splice(D,1);break e}}y=g.createElement(d),vi(y,d,u),g.head.appendChild(y);break;case"meta":if(w=lv("meta","content",g).get(d+(u.content||""))){for(D=0;D<w.length;D++)if(y=w[D],y.getAttribute("content")===(u.content==null?null:""+u.content)&&y.getAttribute("name")===(u.name==null?null:u.name)&&y.getAttribute("property")===(u.property==null?null:u.property)&&y.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&y.getAttribute("charset")===(u.charSet==null?null:u.charSet)){w.splice(D,1);break e}}y=g.createElement(d),vi(y,d,u),g.head.appendChild(y);break;default:throw Error(i(468,d))}y[si]=s,Z(y),d=y}s.stateNode=d}else cv(g,s.type,s.stateNode);else s.stateNode=ov(g,d,s.memoizedProps);else y!==d?(y===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):y.count--,d===null?cv(g,s.type,s.stateNode):ov(g,d,s.memoizedProps)):d===null&&s.stateNode!==null&&cd(s,s.memoizedProps,u.memoizedProps)}break;case 27:nn(o,s),rn(s),d&512&&(Ve||u===null||Zn(u,u.return)),u!==null&&d&4&&cd(s,s.memoizedProps,u.memoizedProps);break;case 5:if(nn(o,s),rn(s),d&512&&(Ve||u===null||Zn(u,u.return)),s.flags&32){g=s.stateNode;try{_a(g,"")}catch(lt){Me(s,s.return,lt)}}d&4&&s.stateNode!=null&&(g=s.memoizedProps,cd(s,g,u!==null?u.memoizedProps:g)),d&1024&&(fd=!0);break;case 6:if(nn(o,s),rn(s),d&4){if(s.stateNode===null)throw Error(i(162));d=s.memoizedProps,u=s.stateNode;try{u.nodeValue=d}catch(lt){Me(s,s.return,lt)}}break;case 3:if(Tu=null,g=Bn,Bn=wu(o.containerInfo),nn(o,s),Bn=g,rn(s),d&4&&u!==null&&u.memoizedState.isDehydrated)try{Sl(o.containerInfo)}catch(lt){Me(s,s.return,lt)}fd&&(fd=!1,g1(s));break;case 4:d=Bn,Bn=wu(s.stateNode.containerInfo),nn(o,s),rn(s),Bn=d;break;case 12:nn(o,s),rn(s);break;case 13:nn(o,s),rn(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(yd=Rt()),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,dd(s,d)));break;case 22:g=s.memoizedState!==null;var V=u!==null&&u.memoizedState!==null,it=wr,mt=Ve;if(wr=it||g,Ve=mt||V,nn(o,s),Ve=mt,wr=it,rn(s),d&8192)t:for(o=s.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(u===null||V||wr||Ve||Gs(s)),u=null,o=s;;){if(o.tag===5||o.tag===26){if(u===null){V=u=o;try{if(y=V.stateNode,g)w=y.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{D=V.stateNode;var xt=V.memoizedProps.style,at=xt!=null&&xt.hasOwnProperty("display")?xt.display:null;D.style.display=at==null||typeof at=="boolean"?"":(""+at).trim()}}catch(lt){Me(V,V.return,lt)}}}else if(o.tag===6){if(u===null){V=o;try{V.stateNode.nodeValue=g?"":V.memoizedProps}catch(lt){Me(V,V.return,lt)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break t;for(;o.sibling===null;){if(o.return===null||o.return===s)break t;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}d&4&&(d=s.updateQueue,d!==null&&(u=d.retryQueue,u!==null&&(d.retryQueue=null,dd(s,u))));break;case 19:nn(o,s),rn(s),d&4&&(d=s.updateQueue,d!==null&&(s.updateQueue=null,dd(s,d)));break;case 30:break;case 21:break;default:nn(o,s),rn(s)}}function rn(s){var o=s.flags;if(o&2){try{for(var u,d=s.return;d!==null;){if(o1(d)){u=d;break}d=d.return}if(u==null)throw Error(i(160));switch(u.tag){case 27:var g=u.stateNode,y=ud(s);hu(s,y,g);break;case 5:var w=u.stateNode;u.flags&32&&(_a(w,""),u.flags&=-33);var D=ud(s);hu(s,D,w);break;case 3:case 4:var V=u.stateNode.containerInfo,it=ud(s);hd(s,it,V);break;default:throw Error(i(161))}}catch(mt){Me(s,s.return,mt)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function g1(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;g1(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Jr(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)u1(s,o.alternate,o),o=o.sibling}function Gs(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Zr(4,o,o.return),Gs(o);break;case 1:Zn(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&s1(o,o.return,u),Gs(o);break;case 27:vl(o.stateNode);case 26:case 5:Zn(o,o.return),Gs(o);break;case 22:o.memoizedState===null&&Gs(o);break;case 30:Gs(o);break;default:Gs(o)}s=s.sibling}}function ts(s,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var d=o.alternate,g=s,y=o,w=y.flags;switch(y.tag){case 0:case 11:case 15:ts(g,y,u),ol(4,y);break;case 1:if(ts(g,y,u),d=y,g=d.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(it){Me(d,d.return,it)}if(d=y,g=d.updateQueue,g!==null){var D=d.stateNode;try{var V=g.shared.hiddenCallbacks;if(V!==null)for(g.shared.hiddenCallbacks=null,g=0;g<V.length;g++)Gg(V[g],D)}catch(it){Me(d,d.return,it)}}u&&w&64&&r1(y),ll(y,y.return);break;case 27:l1(y);case 26:case 5:ts(g,y,u),u&&d===null&&w&4&&a1(y),ll(y,y.return);break;case 12:ts(g,y,u);break;case 13:ts(g,y,u),u&&w&4&&d1(g,y);break;case 22:y.memoizedState===null&&ts(g,y,u),ll(y,y.return);break;case 30:break;default:ts(g,y,u)}o=o.sibling}}function pd(s,o){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&Yo(u))}function gd(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Yo(s))}function Jn(s,o,u,d){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)m1(s,o,u,d),o=o.sibling}function m1(s,o,u,d){var g=o.flags;switch(o.tag){case 0:case 11:case 15:Jn(s,o,u,d),g&2048&&ol(9,o);break;case 1:Jn(s,o,u,d);break;case 3:Jn(s,o,u,d),g&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Yo(s)));break;case 12:if(g&2048){Jn(s,o,u,d),s=o.stateNode;try{var y=o.memoizedProps,w=y.id,D=y.onPostCommit;typeof D=="function"&&D(w,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(V){Me(o,o.return,V)}}else Jn(s,o,u,d);break;case 13:Jn(s,o,u,d);break;case 23:break;case 22:y=o.stateNode,w=o.alternate,o.memoizedState!==null?y._visibility&2?Jn(s,o,u,d):cl(s,o):y._visibility&2?Jn(s,o,u,d):(y._visibility|=2,Ua(s,o,u,d,(o.subtreeFlags&10256)!==0)),g&2048&&pd(w,o);break;case 24:Jn(s,o,u,d),g&2048&&gd(o.alternate,o);break;default:Jn(s,o,u,d)}}function Ua(s,o,u,d,g){for(g=g&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var y=s,w=o,D=u,V=d,it=w.flags;switch(w.tag){case 0:case 11:case 15:Ua(y,w,D,V,g),ol(8,w);break;case 23:break;case 22:var mt=w.stateNode;w.memoizedState!==null?mt._visibility&2?Ua(y,w,D,V,g):cl(y,w):(mt._visibility|=2,Ua(y,w,D,V,g)),g&&it&2048&&pd(w.alternate,w);break;case 24:Ua(y,w,D,V,g),g&&it&2048&&gd(w.alternate,w);break;default:Ua(y,w,D,V,g)}o=o.sibling}}function cl(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=s,d=o,g=d.flags;switch(d.tag){case 22:cl(u,d),g&2048&&pd(d.alternate,d);break;case 24:cl(u,d),g&2048&&gd(d.alternate,d);break;default:cl(u,d)}o=o.sibling}}var ul=8192;function Ha(s){if(s.subtreeFlags&ul)for(s=s.child;s!==null;)v1(s),s=s.sibling}function v1(s){switch(s.tag){case 26:Ha(s),s.flags&ul&&s.memoizedState!==null&&QA(Bn,s.memoizedState,s.memoizedProps);break;case 5:Ha(s);break;case 3:case 4:var o=Bn;Bn=wu(s.stateNode.containerInfo),Ha(s),Bn=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=ul,ul=16777216,Ha(s),ul=o):Ha(s));break;default:Ha(s)}}function x1(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function hl(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var d=o[u];li=d,_1(d,s)}x1(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)y1(s),s=s.sibling}function y1(s){switch(s.tag){case 0:case 11:case 15:hl(s),s.flags&2048&&Zr(9,s,s.return);break;case 3:hl(s);break;case 12:hl(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,fu(s)):hl(s);break;default:hl(s)}}function fu(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var d=o[u];li=d,_1(d,s)}x1(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Zr(8,o,o.return),fu(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,fu(o));break;default:fu(o)}s=s.sibling}}function _1(s,o){for(;li!==null;){var u=li;switch(u.tag){case 0:case 11:case 15:Zr(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var d=u.memoizedState.cachePool.pool;d!=null&&d.refCount++}break;case 24:Yo(u.memoizedState.cache)}if(d=u.child,d!==null)d.return=u,li=d;else t:for(u=s;li!==null;){d=li;var g=d.sibling,y=d.return;if(h1(d),d===u){li=null;break t}if(g!==null){g.return=y,li=g;break t}li=y}}}var dA={getCacheForType:function(s){var o=Ri(ii),u=o.data.get(s);return u===void 0&&(u=s(),o.data.set(s,u)),u}},pA=typeof WeakMap=="function"?WeakMap:Map,me=0,Le=null,ie=null,oe=0,ve=0,sn=null,es=!1,ja=!1,md=!1,Tr=0,Ue=0,is=0,Ws=0,vd=0,wn=0,za=0,fl=null,Wi=null,xd=!1,yd=0,du=1/0,pu=null,ns=null,mi=0,rs=null,Va=null,Ga=0,_d=0,Ed=null,E1=null,dl=0,bd=null;function an(){if((me&2)!==0&&oe!==0)return oe&-oe;if(q.T!==null){var s=Na;return s!==0?s:Dd()}return Cc()}function b1(){wn===0&&(wn=(oe&536870912)===0||fe?Ro():536870912);var s=An.current;return s!==null&&(s.flags|=32),wn}function on(s,o,u){(s===Le&&(ve===2||ve===9)||s.cancelPendingCommit!==null)&&(Wa(s,0),ss(s,oe,wn,!1)),Ds(s,u),((me&2)===0||s!==Le)&&(s===Le&&((me&2)===0&&(Ws|=u),Ue===4&&ss(s,oe,wn,!1)),tr(s))}function A1(s,o,u){if((me&6)!==0)throw Error(i(327));var d=!u&&(o&124)===0&&(o&s.expiredLanes)===0||Rs(s,o),g=d?vA(s,o):Sd(s,o,!0),y=d;do{if(g===0){ja&&!d&&ss(s,o,0,!1);break}else{if(u=s.current.alternate,y&&!gA(u)){g=Sd(s,o,!1),y=!1;continue}if(g===2){if(y=o,s.errorRecoveryDisabledLanes&y)var w=0;else w=s.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){o=w;t:{var D=s;g=fl;var V=D.current.memoizedState.isDehydrated;if(V&&(Wa(D,w).flags|=256),w=Sd(D,w,!1),w!==2){if(md&&!V){D.errorRecoveryDisabledLanes|=y,Ws|=y,g=4;break t}y=Wi,Wi=g,y!==null&&(Wi===null?Wi=y:Wi.push.apply(Wi,y))}g=w}if(y=!1,g!==2)continue}}if(g===1){Wa(s,0),ss(s,o,0,!0);break}t:{switch(d=s,y=g,y){case 0:case 1:throw Error(i(345));case 4:if((o&4194048)!==o)break;case 6:ss(d,o,wn,!es);break t;case 2:Wi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((o&62914560)===o&&(g=yd+300-Rt(),10<g)){if(ss(d,o,wn,!es),va(d,0,!0)!==0)break t;d.timeoutHandle=Z1(w1.bind(null,d,u,Wi,pu,xd,o,wn,Ws,za,es,y,2,-0,0),g);break t}w1(d,u,Wi,pu,xd,o,wn,Ws,za,es,y,0,-0,0)}}break}while(!0);tr(s)}function w1(s,o,u,d,g,y,w,D,V,it,mt,xt,at,lt){if(s.timeoutHandle=-1,xt=o.subtreeFlags,(xt&8192||(xt&16785408)===16785408)&&(_l={stylesheets:null,count:0,unsuspend:KA},v1(o),xt=ZA(),xt!==null)){s.cancelPendingCommit=xt(N1.bind(null,s,o,y,u,d,g,w,D,V,mt,1,at,lt)),ss(s,y,w,!it);return}N1(s,o,y,u,d,g,w,D,V)}function gA(s){for(var o=s;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var d=0;d<u.length;d++){var g=u[d],y=g.getSnapshot;g=g.value;try{if(!tn(y(),g))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ss(s,o,u,d){o&=~vd,o&=~Ws,s.suspendedLanes|=o,s.pingedLanes&=~o,d&&(s.warmLanes|=o),d=s.expirationTimes;for(var g=o;0<g;){var y=31-Pi(g),w=1<<y;d[y]=-1,g&=~w}u!==0&&Sc(s,u,o)}function gu(){return(me&6)===0?(pl(0),!1):!0}function Ad(){if(ie!==null){if(ve===0)var s=ie.return;else s=ie,xr=Us=null,Hf(s),Ia=null,rl=0,s=ie;for(;s!==null;)n1(s.alternate,s),s=s.return;ie=null}}function Wa(s,o){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,LA(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),Ad(),Le=s,ie=u=gr(s.current,null),oe=o,ve=0,sn=null,es=!1,ja=Rs(s,o),md=!1,za=wn=vd=Ws=is=Ue=0,Wi=fl=null,xd=!1,(o&8)!==0&&(o|=o&32);var d=s.entangledLanes;if(d!==0)for(s=s.entanglements,d&=o;0<d;){var g=31-Pi(d),y=1<<g;o|=s[g],d&=~y}return Tr=o,Ic(),u}function S1(s,o){Jt=null,q.H=iu,o===qo||o===Xc?(o=zg(),ve=3):o===Ug?(o=zg(),ve=4):ve=o===Vm?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,sn=o,ie===null&&(Ue=1,ou(s,yn(o,s.current)))}function T1(){var s=q.H;return q.H=iu,s===null?iu:s}function C1(){var s=q.A;return q.A=dA,s}function wd(){Ue=4,es||(oe&4194048)!==oe&&An.current!==null||(ja=!0),(is&134217727)===0&&(Ws&134217727)===0||Le===null||ss(Le,oe,wn,!1)}function Sd(s,o,u){var d=me;me|=2;var g=T1(),y=C1();(Le!==s||oe!==o)&&(pu=null,Wa(s,o)),o=!1;var w=Ue;t:do try{if(ve!==0&&ie!==null){var D=ie,V=sn;switch(ve){case 8:Ad(),w=6;break t;case 3:case 2:case 9:case 6:An.current===null&&(o=!0);var it=ve;if(ve=0,sn=null,Xa(s,D,V,it),u&&ja){w=0;break t}break;default:it=ve,ve=0,sn=null,Xa(s,D,V,it)}}mA(),w=Ue;break}catch(mt){S1(s,mt)}while(!0);return o&&s.shellSuspendCounter++,xr=Us=null,me=d,q.H=g,q.A=y,ie===null&&(Le=null,oe=0,Ic()),w}function mA(){for(;ie!==null;)R1(ie)}function vA(s,o){var u=me;me|=2;var d=T1(),g=C1();Le!==s||oe!==o?(pu=null,du=Rt()+500,Wa(s,o)):ja=Rs(s,o);t:do try{if(ve!==0&&ie!==null){o=ie;var y=sn;e:switch(ve){case 1:ve=0,sn=null,Xa(s,o,y,1);break;case 2:case 9:if(Hg(y)){ve=0,sn=null,D1(o);break}o=function(){ve!==2&&ve!==9||Le!==s||(ve=7),tr(s)},y.then(o,o);break t;case 3:ve=7;break t;case 4:ve=5;break t;case 7:Hg(y)?(ve=0,sn=null,D1(o)):(ve=0,sn=null,Xa(s,o,y,7));break;case 5:var w=null;switch(ie.tag){case 26:w=ie.memoizedState;case 5:case 27:var D=ie;if(!w||uv(w)){ve=0,sn=null;var V=D.sibling;if(V!==null)ie=V;else{var it=D.return;it!==null?(ie=it,mu(it)):ie=null}break e}}ve=0,sn=null,Xa(s,o,y,5);break;case 6:ve=0,sn=null,Xa(s,o,y,6);break;case 8:Ad(),Ue=6;break t;default:throw Error(i(462))}}xA();break}catch(mt){S1(s,mt)}while(!0);return xr=Us=null,q.H=d,q.A=g,me=u,ie!==null?0:(Le=null,oe=0,Ic(),Ue)}function xA(){for(;ie!==null&&!ge();)R1(ie)}function R1(s){var o=e1(s.alternate,s,Tr);s.memoizedProps=s.pendingProps,o===null?mu(s):ie=o}function D1(s){var o=s,u=o.alternate;switch(o.tag){case 15:case 0:o=qm(u,o,o.pendingProps,o.type,void 0,oe);break;case 11:o=qm(u,o,o.pendingProps,o.type.render,o.ref,oe);break;case 5:Hf(o);default:n1(u,o),o=ie=Mg(o,Tr),o=e1(u,o,Tr)}s.memoizedProps=s.pendingProps,o===null?mu(s):ie=o}function Xa(s,o,u,d){xr=Us=null,Hf(o),Ia=null,rl=0;var g=o.return;try{if(oA(s,g,o,u,oe)){Ue=1,ou(s,yn(u,s.current)),ie=null;return}}catch(y){if(g!==null)throw ie=g,y;Ue=1,ou(s,yn(u,s.current)),ie=null;return}o.flags&32768?(fe||d===1?s=!0:ja||(oe&536870912)!==0?s=!1:(es=s=!0,(d===2||d===9||d===3||d===6)&&(d=An.current,d!==null&&d.tag===13&&(d.flags|=16384))),M1(o,s)):mu(o)}function mu(s){var o=s;do{if((o.flags&32768)!==0){M1(o,es);return}s=o.return;var u=cA(o.alternate,o,Tr);if(u!==null){ie=u;return}if(o=o.sibling,o!==null){ie=o;return}ie=o=s}while(o!==null);Ue===0&&(Ue=5)}function M1(s,o){do{var u=uA(s.alternate,s);if(u!==null){u.flags&=32767,ie=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(s=s.sibling,s!==null)){ie=s;return}ie=s=u}while(s!==null);Ue=6,ie=null}function N1(s,o,u,d,g,y,w,D,V){s.cancelPendingCommit=null;do vu();while(mi!==0);if((me&6)!==0)throw Error(i(327));if(o!==null){if(o===s.current)throw Error(i(177));if(y=o.lanes|o.childLanes,y|=gf,xa(s,u,y,w,D,V),s===Le&&(ie=Le=null,oe=0),Va=o,rs=s,Ga=u,_d=y,Ed=g,E1=d,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,bA(Pn,function(){return F1(),null})):(s.callbackNode=null,s.callbackPriority=0),d=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||d){d=q.T,q.T=null,g=nt.p,nt.p=2,w=me,me|=4;try{hA(s,o,u)}finally{me=w,nt.p=g,q.T=d}}mi=1,O1(),L1(),P1()}}function O1(){if(mi===1){mi=0;var s=rs,o=Va,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=q.T,q.T=null;var d=nt.p;nt.p=2;var g=me;me|=4;try{p1(o,s);var y=Id,w=_g(s.containerInfo),D=y.focusedElem,V=y.selectionRange;if(w!==D&&D&&D.ownerDocument&&yg(D.ownerDocument.documentElement,D)){if(V!==null&&uf(D)){var it=V.start,mt=V.end;if(mt===void 0&&(mt=it),"selectionStart"in D)D.selectionStart=it,D.selectionEnd=Math.min(mt,D.value.length);else{var xt=D.ownerDocument||document,at=xt&&xt.defaultView||window;if(at.getSelection){var lt=at.getSelection(),Xt=D.textContent.length,Vt=Math.min(V.start,Xt),Ce=V.end===void 0?Vt:Math.min(V.end,Xt);!lt.extend&&Vt>Ce&&(w=Ce,Ce=Vt,Vt=w);var Q=xg(D,Vt),K=xg(D,Ce);if(Q&&K&&(lt.rangeCount!==1||lt.anchorNode!==Q.node||lt.anchorOffset!==Q.offset||lt.focusNode!==K.node||lt.focusOffset!==K.offset)){var tt=xt.createRange();tt.setStart(Q.node,Q.offset),lt.removeAllRanges(),Vt>Ce?(lt.addRange(tt),lt.extend(K.node,K.offset)):(tt.setEnd(K.node,K.offset),lt.addRange(tt))}}}}for(xt=[],lt=D;lt=lt.parentNode;)lt.nodeType===1&&xt.push({element:lt,left:lt.scrollLeft,top:lt.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<xt.length;D++){var vt=xt[D];vt.element.scrollLeft=vt.left,vt.element.scrollTop=vt.top}}Du=!!Fd,Id=Fd=null}finally{me=g,nt.p=d,q.T=u}}s.current=o,mi=2}}function L1(){if(mi===2){mi=0;var s=rs,o=Va,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=q.T,q.T=null;var d=nt.p;nt.p=2;var g=me;me|=4;try{u1(s,o.alternate,o)}finally{me=g,nt.p=d,q.T=u}}mi=3}}function P1(){if(mi===4||mi===3){mi=0,ae();var s=rs,o=Va,u=Ga,d=E1;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?mi=5:(mi=0,Va=rs=null,k1(s,s.pendingLanes));var g=s.pendingLanes;if(g===0&&(ns=null),Oo(u),o=o.stateNode,pi&&typeof pi.onCommitFiberRoot=="function")try{pi.onCommitFiberRoot(fr,o,void 0,(o.current.flags&128)===128)}catch{}if(d!==null){o=q.T,g=nt.p,nt.p=2,q.T=null;try{for(var y=s.onRecoverableError,w=0;w<d.length;w++){var D=d[w];y(D.value,{componentStack:D.stack})}}finally{q.T=o,nt.p=g}}(Ga&3)!==0&&vu(),tr(s),g=s.pendingLanes,(u&4194090)!==0&&(g&42)!==0?s===bd?dl++:(dl=0,bd=s):dl=0,pl(0)}}function k1(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Yo(o)))}function vu(s){return O1(),L1(),P1(),F1()}function F1(){if(mi!==5)return!1;var s=rs,o=_d;_d=0;var u=Oo(Ga),d=q.T,g=nt.p;try{nt.p=32>u?32:u,q.T=null,u=Ed,Ed=null;var y=rs,w=Ga;if(mi=0,Va=rs=null,Ga=0,(me&6)!==0)throw Error(i(331));var D=me;if(me|=4,y1(y.current),m1(y,y.current,w,u),me=D,pl(0,!1),pi&&typeof pi.onPostCommitFiberRoot=="function")try{pi.onPostCommitFiberRoot(fr,y)}catch{}return!0}finally{nt.p=g,q.T=d,k1(s,o)}}function I1(s,o,u){o=yn(u,o),o=td(s.stateNode,o,2),s=$r(s,o,2),s!==null&&(Ds(s,2),tr(s))}function Me(s,o,u){if(s.tag===3)I1(s,s,u);else for(;o!==null;){if(o.tag===3){I1(o,s,u);break}else if(o.tag===1){var d=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(ns===null||!ns.has(d))){s=yn(u,s),u=jm(2),d=$r(o,u,2),d!==null&&(zm(u,d,o,s),Ds(d,2),tr(d));break}}o=o.return}}function Td(s,o,u){var d=s.pingCache;if(d===null){d=s.pingCache=new pA;var g=new Set;d.set(o,g)}else g=d.get(o),g===void 0&&(g=new Set,d.set(o,g));g.has(u)||(md=!0,g.add(u),s=yA.bind(null,s,o,u),o.then(s,s))}function yA(s,o,u){var d=s.pingCache;d!==null&&d.delete(o),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,Le===s&&(oe&u)===u&&(Ue===4||Ue===3&&(oe&62914560)===oe&&300>Rt()-yd?(me&2)===0&&Wa(s,0):vd|=u,za===oe&&(za=0)),tr(s)}function B1(s,o){o===0&&(o=Do()),s=Ca(s,o),s!==null&&(Ds(s,o),tr(s))}function _A(s){var o=s.memoizedState,u=0;o!==null&&(u=o.retryLane),B1(s,u)}function EA(s,o){var u=0;switch(s.tag){case 13:var d=s.stateNode,g=s.memoizedState;g!==null&&(u=g.retryLane);break;case 19:d=s.stateNode;break;case 22:d=s.stateNode._retryCache;break;default:throw Error(i(314))}d!==null&&d.delete(o),B1(s,u)}function bA(s,o){return Qt(s,o)}var xu=null,Ya=null,Cd=!1,yu=!1,Rd=!1,Xs=0;function tr(s){s!==Ya&&s.next===null&&(Ya===null?xu=Ya=s:Ya=Ya.next=s),yu=!0,Cd||(Cd=!0,wA())}function pl(s,o){if(!Rd&&yu){Rd=!0;do for(var u=!1,d=xu;d!==null;){if(s!==0){var g=d.pendingLanes;if(g===0)var y=0;else{var w=d.suspendedLanes,D=d.pingedLanes;y=(1<<31-Pi(42|s)+1)-1,y&=g&~(w&~D),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(u=!0,z1(d,y))}else y=oe,y=va(d,d===Le?y:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),(y&3)===0||Rs(d,y)||(u=!0,z1(d,y));d=d.next}while(u);Rd=!1}}function AA(){U1()}function U1(){yu=Cd=!1;var s=0;Xs!==0&&(OA()&&(s=Xs),Xs=0);for(var o=Rt(),u=null,d=xu;d!==null;){var g=d.next,y=H1(d,o);y===0?(d.next=null,u===null?xu=g:u.next=g,g===null&&(Ya=u)):(u=d,(s!==0||(y&3)!==0)&&(yu=!0)),d=g}pl(s)}function H1(s,o){for(var u=s.suspendedLanes,d=s.pingedLanes,g=s.expirationTimes,y=s.pendingLanes&-62914561;0<y;){var w=31-Pi(y),D=1<<w,V=g[w];V===-1?((D&u)===0||(D&d)!==0)&&(g[w]=wc(D,o)):V<=o&&(s.expiredLanes|=D),y&=~D}if(o=Le,u=oe,u=va(s,s===o?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d=s.callbackNode,u===0||s===o&&(ve===2||ve===9)||s.cancelPendingCommit!==null)return d!==null&&d!==null&&jt(d),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||Rs(s,u)){if(o=u&-u,o===s.callbackPriority)return o;switch(d!==null&&jt(d),Oo(u)){case 2:case 8:u=Ln;break;case 32:u=Pn;break;case 268435456:u=ga;break;default:u=Pn}return d=j1.bind(null,s),u=Qt(u,d),s.callbackPriority=o,s.callbackNode=u,o}return d!==null&&d!==null&&jt(d),s.callbackPriority=2,s.callbackNode=null,2}function j1(s,o){if(mi!==0&&mi!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(vu()&&s.callbackNode!==u)return null;var d=oe;return d=va(s,s===Le?d:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),d===0?null:(A1(s,d,o),H1(s,Rt()),s.callbackNode!=null&&s.callbackNode===u?j1.bind(null,s):null)}function z1(s,o){if(vu())return null;A1(s,o,!0)}function wA(){PA(function(){(me&6)!==0?Qt(Ji,AA):U1()})}function Dd(){return Xs===0&&(Xs=Ro()),Xs}function V1(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Mc(""+s)}function G1(s,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,s.id&&u.setAttribute("form",s.id),o.parentNode.insertBefore(u,o),s=new FormData(s),u.parentNode.removeChild(u),s}function SA(s,o,u,d,g){if(o==="submit"&&u&&u.stateNode===g){var y=V1((g[ai]||null).action),w=d.submitter;w&&(o=(o=w[ai]||null)?V1(o.formAction):w.getAttribute("formAction"),o!==null&&(y=o,w=null));var D=new Pc("action","action",null,d,g);s.push({event:D,listeners:[{instance:null,listener:function(){if(d.defaultPrevented){if(Xs!==0){var V=w?G1(g,w):new FormData(g);qf(u,{pending:!0,data:V,method:g.method,action:y},null,V)}}else typeof y=="function"&&(D.preventDefault(),V=w?G1(g,w):new FormData(g),qf(u,{pending:!0,data:V,method:g.method,action:y},y,V))},currentTarget:g}]})}}for(var Md=0;Md<pf.length;Md++){var Nd=pf[Md],TA=Nd.toLowerCase(),CA=Nd[0].toUpperCase()+Nd.slice(1);In(TA,"on"+CA)}In(Ag,"onAnimationEnd"),In(wg,"onAnimationIteration"),In(Sg,"onAnimationStart"),In("dblclick","onDoubleClick"),In("focusin","onFocus"),In("focusout","onBlur"),In(Gb,"onTransitionRun"),In(Wb,"onTransitionStart"),In(Xb,"onTransitionCancel"),In(Tg,"onTransitionEnd"),Dt("onMouseEnter",["mouseout","mouseover"]),Dt("onMouseLeave",["mouseout","mouseover"]),Dt("onPointerEnter",["pointerout","pointerover"]),Dt("onPointerLeave",["pointerout","pointerover"]),bt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bt("onBeforeInput",["compositionend","keypress","textInput","paste"]),bt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),RA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gl));function W1(s,o){o=(o&4)!==0;for(var u=0;u<s.length;u++){var d=s[u],g=d.event;d=d.listeners;t:{var y=void 0;if(o)for(var w=d.length-1;0<=w;w--){var D=d[w],V=D.instance,it=D.currentTarget;if(D=D.listener,V!==y&&g.isPropagationStopped())break t;y=D,g.currentTarget=it;try{y(g)}catch(mt){au(mt)}g.currentTarget=null,y=V}else for(w=0;w<d.length;w++){if(D=d[w],V=D.instance,it=D.currentTarget,D=D.listener,V!==y&&g.isPropagationStopped())break t;y=D,g.currentTarget=it;try{y(g)}catch(mt){au(mt)}g.currentTarget=null,y=V}}}}function ne(s,o){var u=o[Lo];u===void 0&&(u=o[Lo]=new Set);var d=s+"__bubble";u.has(d)||(X1(o,s,2,!1),u.add(d))}function Od(s,o,u){var d=0;o&&(d|=4),X1(u,s,d,o)}var _u="_reactListening"+Math.random().toString(36).slice(2);function Ld(s){if(!s[_u]){s[_u]=!0,st.forEach(function(u){u!=="selectionchange"&&(RA.has(u)||Od(u,!1,s),Od(u,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[_u]||(o[_u]=!0,Od("selectionchange",!1,o))}}function X1(s,o,u,d){switch(mv(o)){case 2:var g=ew;break;case 8:g=iw;break;default:g=Yd}u=g.bind(null,o,u,s),g=void 0,!tf||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),d?g!==void 0?s.addEventListener(o,u,{capture:!0,passive:g}):s.addEventListener(o,u,!0):g!==void 0?s.addEventListener(o,u,{passive:g}):s.addEventListener(o,u,!1)}function Pd(s,o,u,d,g){var y=d;if((o&1)===0&&(o&2)===0&&d!==null)t:for(;;){if(d===null)return;var w=d.tag;if(w===3||w===4){var D=d.stateNode.containerInfo;if(D===g)break;if(w===4)for(w=d.return;w!==null;){var V=w.tag;if((V===3||V===4)&&w.stateNode.containerInfo===g)return;w=w.return}for(;D!==null;){if(w=F(D),w===null)return;if(V=w.tag,V===5||V===6||V===26||V===27){d=y=w;continue t}D=D.parentNode}}d=d.return}Jp(function(){var it=y,mt=Zh(u),xt=[];t:{var at=Cg.get(s);if(at!==void 0){var lt=Pc,Xt=s;switch(s){case"keypress":if(Oc(u)===0)break t;case"keydown":case"keyup":lt=bb;break;case"focusin":Xt="focus",lt=sf;break;case"focusout":Xt="blur",lt=sf;break;case"beforeblur":case"afterblur":lt=sf;break;case"click":if(u.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":lt=ig;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":lt=ub;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":lt=Sb;break;case Ag:case wg:case Sg:lt=db;break;case Tg:lt=Cb;break;case"scroll":case"scrollend":lt=lb;break;case"wheel":lt=Db;break;case"copy":case"cut":case"paste":lt=gb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":lt=rg;break;case"toggle":case"beforetoggle":lt=Nb}var Vt=(o&4)!==0,Ce=!Vt&&(s==="scroll"||s==="scrollend"),Q=Vt?at!==null?at+"Capture":null:at;Vt=[];for(var K=it,tt;K!==null;){var vt=K;if(tt=vt.stateNode,vt=vt.tag,vt!==5&&vt!==26&&vt!==27||tt===null||Q===null||(vt=Po(K,Q),vt!=null&&Vt.push(ml(K,vt,tt))),Ce)break;K=K.return}0<Vt.length&&(at=new lt(at,Xt,null,u,mt),xt.push({event:at,listeners:Vt}))}}if((o&7)===0){t:{if(at=s==="mouseover"||s==="pointerover",lt=s==="mouseout"||s==="pointerout",at&&u!==Qh&&(Xt=u.relatedTarget||u.fromElement)&&(F(Xt)||Xt[zr]))break t;if((lt||at)&&(at=mt.window===mt?mt:(at=mt.ownerDocument)?at.defaultView||at.parentWindow:window,lt?(Xt=u.relatedTarget||u.toElement,lt=it,Xt=Xt?F(Xt):null,Xt!==null&&(Ce=a(Xt),Vt=Xt.tag,Xt!==Ce||Vt!==5&&Vt!==27&&Vt!==6)&&(Xt=null)):(lt=null,Xt=it),lt!==Xt)){if(Vt=ig,vt="onMouseLeave",Q="onMouseEnter",K="mouse",(s==="pointerout"||s==="pointerover")&&(Vt=rg,vt="onPointerLeave",Q="onPointerEnter",K="pointer"),Ce=lt==null?at:rt(lt),tt=Xt==null?at:rt(Xt),at=new Vt(vt,K+"leave",lt,u,mt),at.target=Ce,at.relatedTarget=tt,vt=null,F(mt)===it&&(Vt=new Vt(Q,K+"enter",Xt,u,mt),Vt.target=tt,Vt.relatedTarget=Ce,vt=Vt),Ce=vt,lt&&Xt)e:{for(Vt=lt,Q=Xt,K=0,tt=Vt;tt;tt=$a(tt))K++;for(tt=0,vt=Q;vt;vt=$a(vt))tt++;for(;0<K-tt;)Vt=$a(Vt),K--;for(;0<tt-K;)Q=$a(Q),tt--;for(;K--;){if(Vt===Q||Q!==null&&Vt===Q.alternate)break e;Vt=$a(Vt),Q=$a(Q)}Vt=null}else Vt=null;lt!==null&&Y1(xt,at,lt,Vt,!1),Xt!==null&&Ce!==null&&Y1(xt,Ce,Xt,Vt,!0)}}t:{if(at=it?rt(it):window,lt=at.nodeName&&at.nodeName.toLowerCase(),lt==="select"||lt==="input"&&at.type==="file")var It=fg;else if(ug(at))if(dg)It=jb;else{It=Ub;var te=Bb}else lt=at.nodeName,!lt||lt.toLowerCase()!=="input"||at.type!=="checkbox"&&at.type!=="radio"?it&&Kh(it.elementType)&&(It=fg):It=Hb;if(It&&(It=It(s,it))){hg(xt,It,u,mt);break t}te&&te(s,at,it),s==="focusout"&&it&&at.type==="number"&&it.memoizedProps.value!=null&&qh(at,"number",at.value)}switch(te=it?rt(it):window,s){case"focusin":(ug(te)||te.contentEditable==="true")&&(wa=te,hf=it,zo=null);break;case"focusout":zo=hf=wa=null;break;case"mousedown":ff=!0;break;case"contextmenu":case"mouseup":case"dragend":ff=!1,Eg(xt,u,mt);break;case"selectionchange":if(Vb)break;case"keydown":case"keyup":Eg(xt,u,mt)}var Ht;if(of)t:{switch(s){case"compositionstart":var Gt="onCompositionStart";break t;case"compositionend":Gt="onCompositionEnd";break t;case"compositionupdate":Gt="onCompositionUpdate";break t}Gt=void 0}else Aa?lg(s,u)&&(Gt="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(Gt="onCompositionStart");Gt&&(sg&&u.locale!=="ko"&&(Aa||Gt!=="onCompositionStart"?Gt==="onCompositionEnd"&&Aa&&(Ht=tg()):(Gr=mt,ef="value"in Gr?Gr.value:Gr.textContent,Aa=!0)),te=Eu(it,Gt),0<te.length&&(Gt=new ng(Gt,s,null,u,mt),xt.push({event:Gt,listeners:te}),Ht?Gt.data=Ht:(Ht=cg(u),Ht!==null&&(Gt.data=Ht)))),(Ht=Lb?Pb(s,u):kb(s,u))&&(Gt=Eu(it,"onBeforeInput"),0<Gt.length&&(te=new ng("onBeforeInput","beforeinput",null,u,mt),xt.push({event:te,listeners:Gt}),te.data=Ht)),SA(xt,s,it,u,mt)}W1(xt,o)})}function ml(s,o,u){return{instance:s,listener:o,currentTarget:u}}function Eu(s,o){for(var u=o+"Capture",d=[];s!==null;){var g=s,y=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||y===null||(g=Po(s,u),g!=null&&d.unshift(ml(s,g,y)),g=Po(s,o),g!=null&&d.push(ml(s,g,y))),s.tag===3)return d;s=s.return}return[]}function $a(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Y1(s,o,u,d,g){for(var y=o._reactName,w=[];u!==null&&u!==d;){var D=u,V=D.alternate,it=D.stateNode;if(D=D.tag,V!==null&&V===d)break;D!==5&&D!==26&&D!==27||it===null||(V=it,g?(it=Po(u,y),it!=null&&w.unshift(ml(u,it,V))):g||(it=Po(u,y),it!=null&&w.push(ml(u,it,V)))),u=u.return}w.length!==0&&s.push({event:o,listeners:w})}var DA=/\r\n?/g,MA=/\u0000|\uFFFD/g;function $1(s){return(typeof s=="string"?s:""+s).replace(DA,`
`).replace(MA,"")}function q1(s,o){return o=$1(o),$1(s)===o}function bu(){}function Te(s,o,u,d,g,y){switch(u){case"children":typeof d=="string"?o==="body"||o==="textarea"&&d===""||_a(s,d):(typeof d=="number"||typeof d=="bigint")&&o!=="body"&&_a(s,""+d);break;case"className":we(s,"class",d);break;case"tabIndex":we(s,"tabindex",d);break;case"dir":case"role":case"viewBox":case"width":case"height":we(s,u,d);break;case"style":Qp(s,d,y);break;case"data":if(o!=="object"){we(s,"data",d);break}case"src":case"href":if(d===""&&(o!=="a"||u!=="href")){s.removeAttribute(u);break}if(d==null||typeof d=="function"||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(u);break}d=Mc(""+d),s.setAttribute(u,d);break;case"action":case"formAction":if(typeof d=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(u==="formAction"?(o!=="input"&&Te(s,o,"name",g.name,g,null),Te(s,o,"formEncType",g.formEncType,g,null),Te(s,o,"formMethod",g.formMethod,g,null),Te(s,o,"formTarget",g.formTarget,g,null)):(Te(s,o,"encType",g.encType,g,null),Te(s,o,"method",g.method,g,null),Te(s,o,"target",g.target,g,null)));if(d==null||typeof d=="symbol"||typeof d=="boolean"){s.removeAttribute(u);break}d=Mc(""+d),s.setAttribute(u,d);break;case"onClick":d!=null&&(s.onclick=bu);break;case"onScroll":d!=null&&ne("scroll",s);break;case"onScrollEnd":d!=null&&ne("scrollend",s);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(u=d.__html,u!=null){if(g.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"multiple":s.multiple=d&&typeof d!="function"&&typeof d!="symbol";break;case"muted":s.muted=d&&typeof d!="function"&&typeof d!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(d==null||typeof d=="function"||typeof d=="boolean"||typeof d=="symbol"){s.removeAttribute("xlink:href");break}u=Mc(""+d),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(u,""+d):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":d&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":d===!0?s.setAttribute(u,""):d!==!1&&d!=null&&typeof d!="function"&&typeof d!="symbol"?s.setAttribute(u,d):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":d!=null&&typeof d!="function"&&typeof d!="symbol"&&!isNaN(d)&&1<=d?s.setAttribute(u,d):s.removeAttribute(u);break;case"rowSpan":case"start":d==null||typeof d=="function"||typeof d=="symbol"||isNaN(d)?s.removeAttribute(u):s.setAttribute(u,d);break;case"popover":ne("beforetoggle",s),ne("toggle",s),Ae(s,"popover",d);break;case"xlinkActuate":Oe(s,"http://www.w3.org/1999/xlink","xlink:actuate",d);break;case"xlinkArcrole":Oe(s,"http://www.w3.org/1999/xlink","xlink:arcrole",d);break;case"xlinkRole":Oe(s,"http://www.w3.org/1999/xlink","xlink:role",d);break;case"xlinkShow":Oe(s,"http://www.w3.org/1999/xlink","xlink:show",d);break;case"xlinkTitle":Oe(s,"http://www.w3.org/1999/xlink","xlink:title",d);break;case"xlinkType":Oe(s,"http://www.w3.org/1999/xlink","xlink:type",d);break;case"xmlBase":Oe(s,"http://www.w3.org/XML/1998/namespace","xml:base",d);break;case"xmlLang":Oe(s,"http://www.w3.org/XML/1998/namespace","xml:lang",d);break;case"xmlSpace":Oe(s,"http://www.w3.org/XML/1998/namespace","xml:space",d);break;case"is":Ae(s,"is",d);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=ab.get(u)||u,Ae(s,u,d))}}function kd(s,o,u,d,g,y){switch(u){case"style":Qp(s,d,y);break;case"dangerouslySetInnerHTML":if(d!=null){if(typeof d!="object"||!("__html"in d))throw Error(i(61));if(u=d.__html,u!=null){if(g.children!=null)throw Error(i(60));s.innerHTML=u}}break;case"children":typeof d=="string"?_a(s,d):(typeof d=="number"||typeof d=="bigint")&&_a(s,""+d);break;case"onScroll":d!=null&&ne("scroll",s);break;case"onScrollEnd":d!=null&&ne("scrollend",s);break;case"onClick":d!=null&&(s.onclick=bu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ot.hasOwnProperty(u))t:{if(u[0]==="o"&&u[1]==="n"&&(g=u.endsWith("Capture"),o=u.slice(2,g?u.length-7:void 0),y=s[ai]||null,y=y!=null?y[u]:null,typeof y=="function"&&s.removeEventListener(o,y,g),typeof d=="function")){typeof y!="function"&&y!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(o,d,g);break t}u in s?s[u]=d:d===!0?s.setAttribute(u,""):Ae(s,u,d)}}}function vi(s,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ne("error",s),ne("load",s);var d=!1,g=!1,y;for(y in u)if(u.hasOwnProperty(y)){var w=u[y];if(w!=null)switch(y){case"src":d=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Te(s,o,y,w,u,null)}}g&&Te(s,o,"srcSet",u.srcSet,u,null),d&&Te(s,o,"src",u.src,u,null);return;case"input":ne("invalid",s);var D=y=w=g=null,V=null,it=null;for(d in u)if(u.hasOwnProperty(d)){var mt=u[d];if(mt!=null)switch(d){case"name":g=mt;break;case"type":w=mt;break;case"checked":V=mt;break;case"defaultChecked":it=mt;break;case"value":y=mt;break;case"defaultValue":D=mt;break;case"children":case"dangerouslySetInnerHTML":if(mt!=null)throw Error(i(137,o));break;default:Te(s,o,d,mt,u,null)}}Yp(s,y,D,V,it,w,g,!1),Rc(s);return;case"select":ne("invalid",s),d=w=y=null;for(g in u)if(u.hasOwnProperty(g)&&(D=u[g],D!=null))switch(g){case"value":y=D;break;case"defaultValue":w=D;break;case"multiple":d=D;default:Te(s,o,g,D,u,null)}o=y,u=w,s.multiple=!!d,o!=null?ya(s,!!d,o,!1):u!=null&&ya(s,!!d,u,!0);return;case"textarea":ne("invalid",s),y=g=d=null;for(w in u)if(u.hasOwnProperty(w)&&(D=u[w],D!=null))switch(w){case"value":d=D;break;case"defaultValue":g=D;break;case"children":y=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(i(91));break;default:Te(s,o,w,D,u,null)}qp(s,d,g,y),Rc(s);return;case"option":for(V in u)if(u.hasOwnProperty(V)&&(d=u[V],d!=null))switch(V){case"selected":s.selected=d&&typeof d!="function"&&typeof d!="symbol";break;default:Te(s,o,V,d,u,null)}return;case"dialog":ne("beforetoggle",s),ne("toggle",s),ne("cancel",s),ne("close",s);break;case"iframe":case"object":ne("load",s);break;case"video":case"audio":for(d=0;d<gl.length;d++)ne(gl[d],s);break;case"image":ne("error",s),ne("load",s);break;case"details":ne("toggle",s);break;case"embed":case"source":case"link":ne("error",s),ne("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(it in u)if(u.hasOwnProperty(it)&&(d=u[it],d!=null))switch(it){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,o));default:Te(s,o,it,d,u,null)}return;default:if(Kh(o)){for(mt in u)u.hasOwnProperty(mt)&&(d=u[mt],d!==void 0&&kd(s,o,mt,d,u,void 0));return}}for(D in u)u.hasOwnProperty(D)&&(d=u[D],d!=null&&Te(s,o,D,d,u,null))}function NA(s,o,u,d){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,y=null,w=null,D=null,V=null,it=null,mt=null;for(lt in u){var xt=u[lt];if(u.hasOwnProperty(lt)&&xt!=null)switch(lt){case"checked":break;case"value":break;case"defaultValue":V=xt;default:d.hasOwnProperty(lt)||Te(s,o,lt,null,d,xt)}}for(var at in d){var lt=d[at];if(xt=u[at],d.hasOwnProperty(at)&&(lt!=null||xt!=null))switch(at){case"type":y=lt;break;case"name":g=lt;break;case"checked":it=lt;break;case"defaultChecked":mt=lt;break;case"value":w=lt;break;case"defaultValue":D=lt;break;case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(i(137,o));break;default:lt!==xt&&Te(s,o,at,lt,d,xt)}}$h(s,w,D,V,it,mt,y,g);return;case"select":lt=w=D=at=null;for(y in u)if(V=u[y],u.hasOwnProperty(y)&&V!=null)switch(y){case"value":break;case"multiple":lt=V;default:d.hasOwnProperty(y)||Te(s,o,y,null,d,V)}for(g in d)if(y=d[g],V=u[g],d.hasOwnProperty(g)&&(y!=null||V!=null))switch(g){case"value":at=y;break;case"defaultValue":D=y;break;case"multiple":w=y;default:y!==V&&Te(s,o,g,y,d,V)}o=D,u=w,d=lt,at!=null?ya(s,!!u,at,!1):!!d!=!!u&&(o!=null?ya(s,!!u,o,!0):ya(s,!!u,u?[]:"",!1));return;case"textarea":lt=at=null;for(D in u)if(g=u[D],u.hasOwnProperty(D)&&g!=null&&!d.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:Te(s,o,D,null,d,g)}for(w in d)if(g=d[w],y=u[w],d.hasOwnProperty(w)&&(g!=null||y!=null))switch(w){case"value":at=g;break;case"defaultValue":lt=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==y&&Te(s,o,w,g,d,y)}$p(s,at,lt);return;case"option":for(var Xt in u)if(at=u[Xt],u.hasOwnProperty(Xt)&&at!=null&&!d.hasOwnProperty(Xt))switch(Xt){case"selected":s.selected=!1;break;default:Te(s,o,Xt,null,d,at)}for(V in d)if(at=d[V],lt=u[V],d.hasOwnProperty(V)&&at!==lt&&(at!=null||lt!=null))switch(V){case"selected":s.selected=at&&typeof at!="function"&&typeof at!="symbol";break;default:Te(s,o,V,at,d,lt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Vt in u)at=u[Vt],u.hasOwnProperty(Vt)&&at!=null&&!d.hasOwnProperty(Vt)&&Te(s,o,Vt,null,d,at);for(it in d)if(at=d[it],lt=u[it],d.hasOwnProperty(it)&&at!==lt&&(at!=null||lt!=null))switch(it){case"children":case"dangerouslySetInnerHTML":if(at!=null)throw Error(i(137,o));break;default:Te(s,o,it,at,d,lt)}return;default:if(Kh(o)){for(var Ce in u)at=u[Ce],u.hasOwnProperty(Ce)&&at!==void 0&&!d.hasOwnProperty(Ce)&&kd(s,o,Ce,void 0,d,at);for(mt in d)at=d[mt],lt=u[mt],!d.hasOwnProperty(mt)||at===lt||at===void 0&&lt===void 0||kd(s,o,mt,at,d,lt);return}}for(var Q in u)at=u[Q],u.hasOwnProperty(Q)&&at!=null&&!d.hasOwnProperty(Q)&&Te(s,o,Q,null,d,at);for(xt in d)at=d[xt],lt=u[xt],!d.hasOwnProperty(xt)||at===lt||at==null&&lt==null||Te(s,o,xt,at,d,lt)}var Fd=null,Id=null;function Au(s){return s.nodeType===9?s:s.ownerDocument}function K1(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Q1(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Bd(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ud=null;function OA(){var s=window.event;return s&&s.type==="popstate"?s===Ud?!1:(Ud=s,!0):(Ud=null,!1)}var Z1=typeof setTimeout=="function"?setTimeout:void 0,LA=typeof clearTimeout=="function"?clearTimeout:void 0,J1=typeof Promise=="function"?Promise:void 0,PA=typeof queueMicrotask=="function"?queueMicrotask:typeof J1<"u"?function(s){return J1.resolve(null).then(s).catch(kA)}:Z1;function kA(s){setTimeout(function(){throw s})}function as(s){return s==="head"}function tv(s,o){var u=o,d=0,g=0;do{var y=u.nextSibling;if(s.removeChild(u),y&&y.nodeType===8)if(u=y.data,u==="/$"){if(0<d&&8>d){u=d;var w=s.ownerDocument;if(u&1&&vl(w.documentElement),u&2&&vl(w.body),u&4)for(u=w.head,vl(u),w=u.firstChild;w;){var D=w.nextSibling,V=w.nodeName;w[L]||V==="SCRIPT"||V==="STYLE"||V==="LINK"&&w.rel.toLowerCase()==="stylesheet"||u.removeChild(w),w=D}}if(g===0){s.removeChild(y),Sl(o);return}g--}else u==="$"||u==="$?"||u==="$!"?g++:d=u.charCodeAt(0)-48;else d=0;u=y}while(u);Sl(o)}function Hd(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Hd(u),k(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function FA(s,o,u,d){for(;s.nodeType===1;){var g=u;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!d&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(d){if(!s[L])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(y=s.getAttribute("rel"),y==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(y!==g.rel||s.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||s.getAttribute("title")!==(g.title==null?null:g.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(y=s.getAttribute("src"),(y!==(g.src==null?null:g.src)||s.getAttribute("type")!==(g.type==null?null:g.type)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&y&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var y=g.name==null?null:""+g.name;if(g.type==="hidden"&&s.getAttribute("name")===y)return s}else return s;if(s=Un(s.nextSibling),s===null)break}return null}function IA(s,o,u){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=Un(s.nextSibling),s===null))return null;return s}function jd(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function BA(s,o){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")o();else{var d=function(){o(),u.removeEventListener("DOMContentLoaded",d)};u.addEventListener("DOMContentLoaded",d),s._reactRetry=d}}function Un(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var zd=null;function ev(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return s;o--}else u==="/$"&&o++}s=s.previousSibling}return null}function iv(s,o,u){switch(o=Au(u),s){case"html":if(s=o.documentElement,!s)throw Error(i(452));return s;case"head":if(s=o.head,!s)throw Error(i(453));return s;case"body":if(s=o.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function vl(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);k(s)}var Sn=new Map,nv=new Set;function wu(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Cr=nt.d;nt.d={f:UA,r:HA,D:jA,C:zA,L:VA,m:GA,X:XA,S:WA,M:YA};function UA(){var s=Cr.f(),o=gu();return s||o}function HA(s){var o=U(s);o!==null&&o.tag===5&&o.type==="form"?Am(o):Cr.r(s)}var qa=typeof document>"u"?null:document;function rv(s,o,u){var d=qa;if(d&&typeof o=="string"&&o){var g=xn(o);g='link[rel="'+s+'"][href="'+g+'"]',typeof u=="string"&&(g+='[crossorigin="'+u+'"]'),nv.has(g)||(nv.add(g),s={rel:s,crossOrigin:u,href:o},d.querySelector(g)===null&&(o=d.createElement("link"),vi(o,"link",s),Z(o),d.head.appendChild(o)))}}function jA(s){Cr.D(s),rv("dns-prefetch",s,null)}function zA(s,o){Cr.C(s,o),rv("preconnect",s,o)}function VA(s,o,u){Cr.L(s,o,u);var d=qa;if(d&&s&&o){var g='link[rel="preload"][as="'+xn(o)+'"]';o==="image"&&u&&u.imageSrcSet?(g+='[imagesrcset="'+xn(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(g+='[imagesizes="'+xn(u.imageSizes)+'"]')):g+='[href="'+xn(s)+'"]';var y=g;switch(o){case"style":y=Ka(s);break;case"script":y=Qa(s)}Sn.has(y)||(s=p({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:s,as:o},u),Sn.set(y,s),d.querySelector(g)!==null||o==="style"&&d.querySelector(xl(y))||o==="script"&&d.querySelector(yl(y))||(o=d.createElement("link"),vi(o,"link",s),Z(o),d.head.appendChild(o)))}}function GA(s,o){Cr.m(s,o);var u=qa;if(u&&s){var d=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+xn(d)+'"][href="'+xn(s)+'"]',y=g;switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Qa(s)}if(!Sn.has(y)&&(s=p({rel:"modulepreload",href:s},o),Sn.set(y,s),u.querySelector(g)===null)){switch(d){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(yl(y)))return}d=u.createElement("link"),vi(d,"link",s),Z(d),u.head.appendChild(d)}}}function WA(s,o,u){Cr.S(s,o,u);var d=qa;if(d&&s){var g=dt(d).hoistableStyles,y=Ka(s);o=o||"default";var w=g.get(y);if(!w){var D={loading:0,preload:null};if(w=d.querySelector(xl(y)))D.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":o},u),(u=Sn.get(y))&&Vd(s,u);var V=w=d.createElement("link");Z(V),vi(V,"link",s),V._p=new Promise(function(it,mt){V.onload=it,V.onerror=mt}),V.addEventListener("load",function(){D.loading|=1}),V.addEventListener("error",function(){D.loading|=2}),D.loading|=4,Su(w,o,d)}w={type:"stylesheet",instance:w,count:1,state:D},g.set(y,w)}}}function XA(s,o){Cr.X(s,o);var u=qa;if(u&&s){var d=dt(u).hoistableScripts,g=Qa(s),y=d.get(g);y||(y=u.querySelector(yl(g)),y||(s=p({src:s,async:!0},o),(o=Sn.get(g))&&Gd(s,o),y=u.createElement("script"),Z(y),vi(y,"link",s),u.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function YA(s,o){Cr.M(s,o);var u=qa;if(u&&s){var d=dt(u).hoistableScripts,g=Qa(s),y=d.get(g);y||(y=u.querySelector(yl(g)),y||(s=p({src:s,async:!0,type:"module"},o),(o=Sn.get(g))&&Gd(s,o),y=u.createElement("script"),Z(y),vi(y,"link",s),u.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},d.set(g,y))}}function sv(s,o,u,d){var g=(g=et.current)?wu(g):null;if(!g)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Ka(u.href),u=dt(g).hoistableStyles,d=u.get(o),d||(d={type:"style",instance:null,count:0,state:null},u.set(o,d)),d):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=Ka(u.href);var y=dt(g).hoistableStyles,w=y.get(s);if(w||(g=g.ownerDocument||g,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(s,w),(y=g.querySelector(xl(s)))&&!y._p&&(w.instance=y,w.state.loading=5),Sn.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},Sn.set(s,u),y||$A(g,s,u,w.state))),o&&d===null)throw Error(i(528,""));return w}if(o&&d!==null)throw Error(i(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Qa(u),u=dt(g).hoistableScripts,d=u.get(o),d||(d={type:"script",instance:null,count:0,state:null},u.set(o,d)),d):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Ka(s){return'href="'+xn(s)+'"'}function xl(s){return'link[rel="stylesheet"]['+s+"]"}function av(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function $A(s,o,u,d){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?d.loading=1:(o=s.createElement("link"),d.preload=o,o.addEventListener("load",function(){return d.loading|=1}),o.addEventListener("error",function(){return d.loading|=2}),vi(o,"link",u),Z(o),s.head.appendChild(o))}function Qa(s){return'[src="'+xn(s)+'"]'}function yl(s){return"script[async]"+s}function ov(s,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var d=s.querySelector('style[data-href~="'+xn(u.href)+'"]');if(d)return o.instance=d,Z(d),d;var g=p({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return d=(s.ownerDocument||s).createElement("style"),Z(d),vi(d,"style",g),Su(d,u.precedence,s),o.instance=d;case"stylesheet":g=Ka(u.href);var y=s.querySelector(xl(g));if(y)return o.state.loading|=4,o.instance=y,Z(y),y;d=av(u),(g=Sn.get(g))&&Vd(d,g),y=(s.ownerDocument||s).createElement("link"),Z(y);var w=y;return w._p=new Promise(function(D,V){w.onload=D,w.onerror=V}),vi(y,"link",d),o.state.loading|=4,Su(y,u.precedence,s),o.instance=y;case"script":return y=Qa(u.src),(g=s.querySelector(yl(y)))?(o.instance=g,Z(g),g):(d=u,(g=Sn.get(y))&&(d=p({},u),Gd(d,g)),s=s.ownerDocument||s,g=s.createElement("script"),Z(g),vi(g,"link",d),s.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(i(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(d=o.instance,o.state.loading|=4,Su(d,u.precedence,s));return o.instance}function Su(s,o,u){for(var d=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=d.length?d[d.length-1]:null,y=g,w=0;w<d.length;w++){var D=d[w];if(D.dataset.precedence===o)y=D;else if(y!==g)break}y?y.parentNode.insertBefore(s,y.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(s,o.firstChild))}function Vd(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function Gd(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Tu=null;function lv(s,o,u){if(Tu===null){var d=new Map,g=Tu=new Map;g.set(u,d)}else g=Tu,d=g.get(u),d||(d=new Map,g.set(u,d));if(d.has(s))return d;for(d.set(s,null),u=u.getElementsByTagName(s),g=0;g<u.length;g++){var y=u[g];if(!(y[L]||y[si]||s==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var w=y.getAttribute(o)||"";w=s+w;var D=d.get(w);D?D.push(y):d.set(w,[y])}}return d}function cv(s,o,u){s=s.ownerDocument||s,s.head.insertBefore(u,o==="title"?s.querySelector("head > title"):null)}function qA(s,o,u){if(u===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function uv(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var _l=null;function KA(){}function QA(s,o,u){if(_l===null)throw Error(i(475));var d=_l;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Ka(u.href),y=s.querySelector(xl(g));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(d.count++,d=Cu.bind(d),s.then(d,d)),o.state.loading|=4,o.instance=y,Z(y);return}y=s.ownerDocument||s,u=av(u),(g=Sn.get(g))&&Vd(u,g),y=y.createElement("link"),Z(y);var w=y;w._p=new Promise(function(D,V){w.onload=D,w.onerror=V}),vi(y,"link",u),o.instance=y}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(d.count++,o=Cu.bind(d),s.addEventListener("load",o),s.addEventListener("error",o))}}function ZA(){if(_l===null)throw Error(i(475));var s=_l;return s.stylesheets&&s.count===0&&Wd(s,s.stylesheets),0<s.count?function(o){var u=setTimeout(function(){if(s.stylesheets&&Wd(s,s.stylesheets),s.unsuspend){var d=s.unsuspend;s.unsuspend=null,d()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u)}}:null}function Cu(){if(this.count--,this.count===0){if(this.stylesheets)Wd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Ru=null;function Wd(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Ru=new Map,o.forEach(JA,s),Ru=null,Cu.call(s))}function JA(s,o){if(!(o.state.loading&4)){var u=Ru.get(s);if(u)var d=u.get(null);else{u=new Map,Ru.set(s,u);for(var g=s.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<g.length;y++){var w=g[y];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(u.set(w.dataset.precedence,w),d=w)}d&&u.set(null,d)}g=o.instance,w=g.getAttribute("data-precedence"),y=u.get(w)||d,y===d&&u.set(null,g),u.set(w,g),this.count++,d=Cu.bind(this),g.addEventListener("load",d),g.addEventListener("error",d),y?y.parentNode.insertBefore(g,y.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(g,s.firstChild)),o.state.loading|=4}}var El={$$typeof:S,Provider:null,Consumer:null,_currentValue:St,_currentValue2:St,_threadCount:0};function tw(s,o,u,d,g,y,w,D){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Mo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mo(0),this.hiddenUpdates=Mo(null),this.identifierPrefix=d,this.onUncaughtError=g,this.onCaughtError=y,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function hv(s,o,u,d,g,y,w,D,V,it,mt,xt){return s=new tw(s,o,u,w,D,V,it,xt),o=1,y===!0&&(o|=24),y=en(3,null,null,o),s.current=y,y.stateNode=s,o=Tf(),o.refCount++,s.pooledCache=o,o.refCount++,y.memoizedState={element:d,isDehydrated:u,cache:o},Mf(y),s}function fv(s){return s?(s=Ra,s):Ra}function dv(s,o,u,d,g,y){g=fv(g),d.context===null?d.context=g:d.pendingContext=g,d=Yr(o),d.payload={element:u},y=y===void 0?null:y,y!==null&&(d.callback=y),u=$r(s,d,o),u!==null&&(on(u,s,o),Qo(u,s,o))}function pv(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<o?u:o}}function Xd(s,o){pv(s,o),(s=s.alternate)&&pv(s,o)}function gv(s){if(s.tag===13){var o=Ca(s,67108864);o!==null&&on(o,s,67108864),Xd(s,67108864)}}var Du=!0;function ew(s,o,u,d){var g=q.T;q.T=null;var y=nt.p;try{nt.p=2,Yd(s,o,u,d)}finally{nt.p=y,q.T=g}}function iw(s,o,u,d){var g=q.T;q.T=null;var y=nt.p;try{nt.p=8,Yd(s,o,u,d)}finally{nt.p=y,q.T=g}}function Yd(s,o,u,d){if(Du){var g=$d(d);if(g===null)Pd(s,o,d,Mu,u),vv(s,d);else if(rw(g,s,o,u,d))d.stopPropagation();else if(vv(s,d),o&4&&-1<nw.indexOf(s)){for(;g!==null;){var y=U(g);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var w=$n(y.pendingLanes);if(w!==0){var D=y;for(D.pendingLanes|=2,D.entangledLanes|=2;w;){var V=1<<31-Pi(w);D.entanglements[1]|=V,w&=~V}tr(y),(me&6)===0&&(du=Rt()+500,pl(0))}}break;case 13:D=Ca(y,2),D!==null&&on(D,y,2),gu(),Xd(y,2)}if(y=$d(d),y===null&&Pd(s,o,d,Mu,u),y===g)break;g=y}g!==null&&d.stopPropagation()}else Pd(s,o,d,null,u)}}function $d(s){return s=Zh(s),qd(s)}var Mu=null;function qd(s){if(Mu=null,s=F(s),s!==null){var o=a(s);if(o===null)s=null;else{var u=o.tag;if(u===13){if(s=l(o),s!==null)return s;s=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Mu=s,null}function mv(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ce()){case Ji:return 2;case Ln:return 8;case Pn:case _c:return 32;case ga:return 268435456;default:return 32}default:return 32}}var Kd=!1,os=null,ls=null,cs=null,bl=new Map,Al=new Map,us=[],nw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function vv(s,o){switch(s){case"focusin":case"focusout":os=null;break;case"dragenter":case"dragleave":ls=null;break;case"mouseover":case"mouseout":cs=null;break;case"pointerover":case"pointerout":bl.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Al.delete(o.pointerId)}}function wl(s,o,u,d,g,y){return s===null||s.nativeEvent!==y?(s={blockedOn:o,domEventName:u,eventSystemFlags:d,nativeEvent:y,targetContainers:[g]},o!==null&&(o=U(o),o!==null&&gv(o)),s):(s.eventSystemFlags|=d,o=s.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),s)}function rw(s,o,u,d,g){switch(o){case"focusin":return os=wl(os,s,o,u,d,g),!0;case"dragenter":return ls=wl(ls,s,o,u,d,g),!0;case"mouseover":return cs=wl(cs,s,o,u,d,g),!0;case"pointerover":var y=g.pointerId;return bl.set(y,wl(bl.get(y)||null,s,o,u,d,g)),!0;case"gotpointercapture":return y=g.pointerId,Al.set(y,wl(Al.get(y)||null,s,o,u,d,g)),!0}return!1}function xv(s){var o=F(s.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){s.blockedOn=o,Xh(s.priority,function(){if(u.tag===13){var d=an();d=No(d);var g=Ca(u,d);g!==null&&on(g,u,d),Xd(u,d)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Nu(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var u=$d(s.nativeEvent);if(u===null){u=s.nativeEvent;var d=new u.constructor(u.type,u);Qh=d,u.target.dispatchEvent(d),Qh=null}else return o=U(u),o!==null&&gv(o),s.blockedOn=u,!1;o.shift()}return!0}function yv(s,o,u){Nu(s)&&u.delete(o)}function sw(){Kd=!1,os!==null&&Nu(os)&&(os=null),ls!==null&&Nu(ls)&&(ls=null),cs!==null&&Nu(cs)&&(cs=null),bl.forEach(yv),Al.forEach(yv)}function Ou(s,o){s.blockedOn===o&&(s.blockedOn=null,Kd||(Kd=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,sw)))}var Lu=null;function _v(s){Lu!==s&&(Lu=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Lu===s&&(Lu=null);for(var o=0;o<s.length;o+=3){var u=s[o],d=s[o+1],g=s[o+2];if(typeof d!="function"){if(qd(d||u)===null)continue;break}var y=U(u);y!==null&&(s.splice(o,3),o-=3,qf(y,{pending:!0,data:g,method:u.method,action:d},d,g))}}))}function Sl(s){function o(V){return Ou(V,s)}os!==null&&Ou(os,s),ls!==null&&Ou(ls,s),cs!==null&&Ou(cs,s),bl.forEach(o),Al.forEach(o);for(var u=0;u<us.length;u++){var d=us[u];d.blockedOn===s&&(d.blockedOn=null)}for(;0<us.length&&(u=us[0],u.blockedOn===null);)xv(u),u.blockedOn===null&&us.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(d=0;d<u.length;d+=3){var g=u[d],y=u[d+1],w=g[ai]||null;if(typeof y=="function")w||_v(u);else if(w){var D=null;if(y&&y.hasAttribute("formAction")){if(g=y,w=y[ai]||null)D=w.formAction;else if(qd(g)!==null)continue}else D=w.action;typeof D=="function"?u[d+1]=D:(u.splice(d,3),d-=3),_v(u)}}}function Qd(s){this._internalRoot=s}Pu.prototype.render=Qd.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(i(409));var u=o.current,d=an();dv(u,d,s,o,null,null)},Pu.prototype.unmount=Qd.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;dv(s.current,2,null,s,null,null),gu(),o[zr]=null}};function Pu(s){this._internalRoot=s}Pu.prototype.unstable_scheduleHydration=function(s){if(s){var o=Cc();s={blockedOn:null,target:s,priority:o};for(var u=0;u<us.length&&o!==0&&o<us[u].priority;u++);us.splice(u,0,s),u===0&&xv(s)}};var Ev=t.version;if(Ev!=="19.1.1")throw Error(i(527,Ev,"19.1.1"));nt.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=h(o),s=s!==null?f(s):null,s=s===null?null:s.stateNode,s};var aw={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:q,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ku=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ku.isDisabled&&ku.supportsFiber)try{fr=ku.inject(aw),pi=ku}catch{}}return Cl.createRoot=function(s,o){if(!r(s))throw Error(i(299));var u=!1,d="",g=Im,y=Bm,w=Um,D=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(d=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(y=o.onCaughtError),o.onRecoverableError!==void 0&&(w=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(D=o.unstable_transitionCallbacks)),o=hv(s,1,!1,null,null,u,d,g,y,w,D,null),s[zr]=o.current,Ld(s),new Qd(o)},Cl.hydrateRoot=function(s,o,u){if(!r(s))throw Error(i(299));var d=!1,g="",y=Im,w=Bm,D=Um,V=null,it=null;return u!=null&&(u.unstable_strictMode===!0&&(d=!0),u.identifierPrefix!==void 0&&(g=u.identifierPrefix),u.onUncaughtError!==void 0&&(y=u.onUncaughtError),u.onCaughtError!==void 0&&(w=u.onCaughtError),u.onRecoverableError!==void 0&&(D=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(V=u.unstable_transitionCallbacks),u.formState!==void 0&&(it=u.formState)),o=hv(s,1,!0,o,u??null,d,g,y,w,D,V,it),o.context=fv(null),u=o.current,d=an(),d=No(d),g=Yr(d),g.callback=null,$r(u,g,d),u=d,o.current.lanes=u,Ds(o,u),tr(o),s[zr]=o.current,Ld(s),new Pu(o)},Cl.version="19.1.1",Cl}var Pv;function yw(){if(Pv)return e0.exports;Pv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(t){console.error(t)}}return n(),e0.exports=xw(),e0.exports}var _w=yw();const Fi=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),D0=[.001,0,0,.001,0,0],s0=1.35,ln={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},gs={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},by="pdfjs_internal_editor_",Yt={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},se={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Ew={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},xi={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},nh={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Ke={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},no={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Dh={ERRORS:0,WARNINGS:1,INFOS:5},$l={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Fu={moveTo:0,lineTo:1,curveTo:2,closePath:3},bw={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Mh=Dh.WARNINGS;function Aw(n){Number.isInteger(n)&&(Mh=n)}function ww(){return Mh}function Nh(n){Mh>=Dh.INFOS&&console.log(`Info: ${n}`)}function qt(n){Mh>=Dh.WARNINGS&&console.log(`Warning: ${n}`)}function De(n){throw new Error(n)}function Ze(n,t){n||De(t)}function Sw(n){switch(n?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Ay(n,t=null,e=null){if(!n)return null;if(e&&typeof n=="string"&&(e.addDefaultProtocol&&n.startsWith("www.")&&n.match(/\./g)?.length>=2&&(n=`http://${n}`),e.tryConvertEncoding))try{n=Mw(n)}catch{}const i=t?URL.parse(n,t):URL.parse(n);return Sw(i)?i:null}function wy(n,t,e=!1){const i=URL.parse(n);return i?(i.hash=t,i.href):e&&Ay(n,"http://example.com")?n.split("#",1)[0]+`${t?`#${t}`:""}`:""}function ee(n,t,e,i=!1){return Object.defineProperty(n,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const la=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class kv extends la{constructor(t,e){super(t,"PasswordException"),this.code=e}}class a0 extends la{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}let M0=class extends la{constructor(t){super(t,"InvalidPDFException")}},lh=class extends la{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}};class Tw extends la{constructor(t){super(t,"FormatError")}}let _s=class extends la{constructor(t){super(t,"AbortException")}};function Sy(n){(typeof n!="object"||n?.length===void 0)&&De("Invalid argument for bytesToString");const t=n.length,e=8192;if(t<e)return String.fromCharCode.apply(null,n);const i=[];for(let r=0;r<t;r+=e){const a=Math.min(r+e,t),l=n.subarray(r,a);i.push(String.fromCharCode.apply(null,l))}return i.join("")}function lc(n){typeof n!="string"&&De("Invalid argument for stringToBytes");const t=n.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=n.charCodeAt(i)&255;return e}function Cw(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function Rw(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function Dw(){try{return new Function(""),!0}catch{return!1}}class wi{static get isLittleEndian(){return ee(this,"isLittleEndian",Rw())}static get isEvalSupported(){return ee(this,"isEvalSupported",Dw())}static get isOffscreenCanvasSupported(){return ee(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ee(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return ee(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return ee(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const o0=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));let Bt=class{static makeHexColor(t,e,i){return`#${o0[t]}${o0[e]}${o0[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const r=t[i],a=t[i+1];t[i]=r*e[0]+a*e[2]+e[4],t[i+1]=r*e[1]+a*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const r=e[0],a=e[1],l=e[2],c=e[3],h=e[4],f=e[5];for(let p=0;p<6;p+=2){const m=t[i+p],v=t[i+p+1];t[i+p]=m*r+v*l+h,t[i+p+1]=m*a+v*c+f}}static applyInverseTransform(t,e){const i=t[0],r=t[1],a=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-r*e[2]+e[2]*e[5]-e[4]*e[3])/a,t[1]=(-i*e[1]+r*e[0]+e[4]*e[1]-e[5]*e[0])/a}static axialAlignedBoundingBox(t,e,i){const r=e[0],a=e[1],l=e[2],c=e[3],h=e[4],f=e[5],p=t[0],m=t[1],v=t[2],x=t[3];let E=r*p+h,_=E,b=r*v+h,A=b,T=c*m+f,S=T,C=c*x+f,N=C;if(a!==0||l!==0){const B=a*p,O=a*v,H=l*m,M=l*x;E+=H,A+=H,b+=M,_+=M,T+=B,N+=B,C+=O,S+=O}i[0]=Math.min(i[0],E,b,_,A),i[1]=Math.min(i[1],T,C,S,N),i[2]=Math.max(i[2],E,b,_,A),i[3]=Math.max(i[3],T,C,S,N)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],r=t[1],a=t[2],l=t[3],c=i**2+r**2,h=i*a+r*l,f=a**2+l**2,p=(c+f)/2,m=Math.sqrt(p**2-(c*f-h**2));e[0]=Math.sqrt(p+m||1),e[1]=Math.sqrt(p-m||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>r)return null;const a=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),l=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return a>l?null:[i,a,r,l]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,r,a){a[0]=Math.min(a[0],t,i),a[1]=Math.min(a[1],e,r),a[2]=Math.max(a[2],t,i),a[3]=Math.max(a[3],e,r)}static#t(t,e,i,r,a,l,c,h,f,p){if(f<=0||f>=1)return;const m=1-f,v=f*f,x=v*f,E=m*(m*(m*t+3*f*e)+3*v*i)+x*r,_=m*(m*(m*a+3*f*l)+3*v*c)+x*h;p[0]=Math.min(p[0],E),p[1]=Math.min(p[1],_),p[2]=Math.max(p[2],E),p[3]=Math.max(p[3],_)}static#e(t,e,i,r,a,l,c,h,f,p,m,v){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,i,r,a,l,c,h,-m/p,v);return}const x=p**2-4*m*f;if(x<0)return;const E=Math.sqrt(x),_=2*f;this.#t(t,e,i,r,a,l,c,h,(-p+E)/_,v),this.#t(t,e,i,r,a,l,c,h,(-p-E)/_,v)}static bezierBoundingBox(t,e,i,r,a,l,c,h,f){f[0]=Math.min(f[0],t,c),f[1]=Math.min(f[1],e,h),f[2]=Math.max(f[2],t,c),f[3]=Math.max(f[3],e,h),this.#e(t,i,a,c,e,r,l,h,3*(-t+3*(i-a)+c),6*(t-2*i+a),3*(i-t),f),this.#e(t,i,a,c,e,r,l,h,3*(-e+3*(r-l)+h),6*(e-2*r+l),3*(r-e),f)}};function Mw(n){return decodeURIComponent(escape(n))}let l0=null,Fv=null;function Nw(n){return l0||(l0=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Fv=new Map([["ﬅ","ſt"]])),n.replaceAll(l0,(t,e,i)=>e?e.normalize("NFKC"):Fv.get(i))}function Ty(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),Sy(n)}const ip="pdfjs_internal_id_";function Ow(n,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,r,...a]=e;if(!n(i)&&!Number.isInteger(i)||!t(r))return!1;const l=a.length;let c=!0;switch(r.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;c=!1;break;default:return!1}for(const h of a)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function Ii(n,t,e){return Math.min(Math.max(n,t),e)}function Cy(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(Sy(n))}function Lw(n){return Uint8Array.fromBase64?Uint8Array.fromBase64(n):lc(atob(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...t){return new Promise(e=>{e(n(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(n){return n.reduce((t,e)=>t+e,0)});const Rr="http://www.w3.org/2000/svg";let Eo=class{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF};async function cc(n,t="text"){if(Pl(n,document.baseURI)){const e=await fetch(n);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const r=new XMLHttpRequest;r.open("GET",n,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(r.response);return}e(r.responseText);return}i(new Error(r.statusText))}},r.send(null)})}class uc{constructor({viewBox:t,userUnit:e,scale:i,rotation:r,offsetX:a=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=r,this.offsetX=a,this.offsetY=l,i*=e;const h=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,m,v,x;switch(r%=360,r<0&&(r+=360),r){case 180:p=-1,m=0,v=0,x=1;break;case 90:p=0,m=1,v=1,x=0;break;case 270:p=0,m=-1,v=-1,x=0;break;case 0:p=1,m=0,v=0,x=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(v=-v,x=-x);let E,_,b,A;p===0?(E=Math.abs(f-t[1])*i+a,_=Math.abs(h-t[0])*i+l,b=(t[3]-t[1])*i,A=(t[2]-t[0])*i):(E=Math.abs(h-t[0])*i+a,_=Math.abs(f-t[1])*i+l,b=(t[2]-t[0])*i,A=(t[3]-t[1])*i),this.transform=[p*i,m*i,v*i,x*i,E-p*i*h-v*i*f,_-m*i*h-x*i*f],this.width=b,this.height=A}get rawDims(){const t=this.viewBox;return ee(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:r=this.offsetY,dontFlip:a=!1}={}){return new uc({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:r,dontFlip:a})}convertToViewportPoint(t,e){const i=[t,e];return Bt.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];Bt.applyTransform(e,this.transform);const i=[t[2],t[3]];return Bt.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return Bt.applyInverseTransform(i,this.transform),i}}let np=class extends la{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}};function Oh(n){const t=n.length;let e=0;for(;e<t&&n[e].trim()==="";)e++;return n.substring(e,e+5).toLowerCase()==="data:"}function rp(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function Pw(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function kw(n,t="document.pdf"){if(typeof n!="string")return t;if(Oh(n))return qt('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(n);if(!i)return t;const r=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},a=/\.pdf$/i,l=i.pathname.split("/").at(-1);if(a.test(l))return r(l);if(i.searchParams.size>0){const c=Array.from(i.searchParams.values()).reverse();for(const f of c)if(a.test(f))return r(f);const h=Array.from(i.searchParams.keys()).reverse();for(const f of h)if(a.test(f))return r(f)}if(i.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(h)return r(h[0])}return t}class Iv{started=Object.create(null);times=[];time(t){t in this.started&&qt(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||qt(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:r,end:a}of this.times)t.push(`${i.padEnd(e)} ${a-r}ms
`);return t.join("")}}function Pl(n,t){const e=t?URL.parse(n,t):URL.parse(n);return e?.protocol==="http:"||e?.protocol==="https:"}function Nn(n){n.preventDefault()}function Qe(n){n.preventDefault(),n.stopPropagation()}function Fw(n){console.log("Deprecated API usage: "+n)}let N0=class{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let r=parseInt(e[2],10);r=r>=1&&r<=12?r-1:0;let a=parseInt(e[3],10);a=a>=1&&a<=31?a:1;let l=parseInt(e[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(e[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const f=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let m=parseInt(e[9],10)||0;return m=m>=0&&m<=59?m:0,f==="-"?(l+=p,c+=m):f==="+"&&(l-=p,c-=m),new Date(Date.UTC(i,r,a,l,c,h))}};function Iw(n,{scale:t=1,rotation:e=0}){const{width:i,height:r}=n.attributes.style,a=[0,0,parseInt(i),parseInt(r)];return new uc({viewBox:a,userUnit:1,scale:t,rotation:e})}function Lh(n){if(n.startsWith("#")){const t=parseInt(n.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(t=>parseInt(t)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(qt(`Not a valid color format: "${n}"`),[0,0,0])}function Bw(n){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of n.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;n.set(e,Lh(i))}t.remove()}function Ie(n){const{a:t,b:e,c:i,d:r,e:a,f:l}=n.getTransform();return[t,e,i,r,a,l]}function ir(n){const{a:t,b:e,c:i,d:r,e:a,f:l}=n.getTransform().invertSelf();return[t,e,i,r,a,l]}function ia(n,t,e=!1,i=!0){if(t instanceof uc){const{pageWidth:r,pageHeight:a}=t.rawDims,{style:l}=n,c=wi.isCSSRoundSupported,h=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${a}px`,p=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,m=c?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(l.width=p,l.height=m):(l.width=m,l.height=p)}i&&n.setAttribute("data-main-rotation",t.rotation)}let na=class O0{constructor(){const{pixelRatio:t}=O0;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,r,a=-1){let l=1/0,c=1/0,h=1/0;i=O0.capPixels(i,a),i>0&&(l=Math.sqrt(i/(t*e))),r!==-1&&(c=r/t,h=r/e);const f=Math.min(l,c,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}};const L0=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class Bl{#t=null;#e=null;#i;#n=null;#s=null;#r=null;#a=null;static#o=null;constructor(t){this.#i=t,Bl.#o||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",Nn,{signal:e}),t.addEventListener("pointerdown",Bl.#c,{signal:e}));const i=this.#n=document.createElement("div");i.className="buttons",t.append(i);const r=this.#i.toolbarPosition;if(r){const{style:a}=t,l=this.#i._uiManager.direction==="ltr"?1-r[0]:r[0];a.insetInlineEnd=`${100*l}%`,a.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#c(t){t.stopPropagation()}#l(t){this.#i._focusEventsAllowed=!1,Qe(t)}#f(t){this.#i._focusEventsAllowed=!0,Qe(t)}#u(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#l.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#f.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Nn,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",Bl.#o[t]),this.#u(i)&&i.addEventListener("click",r=>{e.delete()},{signal:e._signal}),this.#n.append(i)}get#d(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#u(e),this.#n.append(e,this.#d),this.#s=t}addComment(t){if(this.#r)return;const e=t.render();e&&(this.#u(e),this.#n.append(e,this.#d),this.#r=t,t.toolbar=this)}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#u(e),this.#n.append(e,this.#d)}async addEditSignatureButton(t){const e=this.#a=await t.renderEditButton(this.#i);this.#u(e),this.#n.append(e,this.#d)}async addButton(t,e){switch(t){case"colorPicker":this.addColorPicker(e);break;case"altText":await this.addAltText(e);break;case"editSignature":await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(e);break}}updateEditSignatureButton(t){this.#a&&(this.#a.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class Uw{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",Nn,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#i.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#s(t,e){let i=0,r=0;for(const a of t){const l=a.y+a.height;if(l<i)continue;const c=a.x+(e?a.width:0);if(l>i){r=c,i=l;continue}e?c>r&&(r=c):c<r&&(r=c)}return[e?1-r:r,i]}show(t,e,i){const[r,a]=this.#s(e,i),{style:l}=this.#e||=this.#n();t.append(this.#e),l.insetInlineEnd=`${100*r}%`,l.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,e,i,r){const a=document.createElement("button");a.classList.add("basic",t),a.tabIndex=0,a.setAttribute("data-l10n-id",e);const l=document.createElement("span");a.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",i);const c=this.#i._signal;c instanceof AbortSignal&&!c.aborted&&(a.addEventListener("contextmenu",Nn,{signal:c}),a.addEventListener("click",r,{signal:c})),this.#t.append(a)}}function Ry(n,t,e){for(const i of e)t.addEventListener(i,n[i].bind(n))}class Hw{#t=0;get id(){return`${by}${this.#t++}`}}class sp{#t=Ty();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const a=r.decode().then(()=>(i.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return ee(this,"_isSVGFittingCanvas",a)}async#n(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof e=="string"?(i.url=e,r=await cc(e,"blob")):e instanceof File?r=i.file=e:e instanceof Blob&&(r=e),r.type==="image/svg+xml"){const a=sp._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((f,p)=>{c.onload=()=>{i.bitmap=c,i.isSvg=!0,f()},l.onload=async()=>{const m=i.svgUrl=l.result;c.src=await a?`${m}#svgView(preserveAspectRatio(none))`:m},c.onerror=l.onerror=p});l.readAsDataURL(r),await h}else i.bitmap=await createImageBitmap(r);i.refCounter=1}catch(r){qt(r),i=null}return this.#i.set(t,i),i&&this.#i.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:r,type:a}=t;return this.#n(`${e}_${i}_${r}_${a}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const i=await e;return this.#n(t,i)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i?.bitmap)return i.refCounter+=1,i;const r=new OffscreenCanvas(e.width,e.height);return r.getContext("2d").drawImage(e,0,0),i={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,i),this.#i.set(i.id,i),i}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=r.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class jw{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:i,mustExec:r,type:a=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(r&&t(),this.#e)return;const h={cmd:t,undo:e,post:i,type:a};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(h);return}if(l&&this.#t[this.#n].type===a){c&&(h.undo=this.#t[this.#n].undo),this.#t[this.#n]=h;return}const f=this.#n+1;f===this.#i?this.#t.splice(0,1):(this.#n=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(h)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class hc{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=wi.platform;for(const[i,r,a={}]of t)for(const l of i){const c=l.startsWith("mac+");e&&c?(this.callbacks.set(l.slice(4),{callback:r,options:a}),this.allKeys.add(l.split("+").at(-1))):!e&&!c&&(this.callbacks.set(l,{callback:r,options:a}),this.allKeys.add(l.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:r,options:{bubbles:a=!1,args:l=[],checker:c=null}}=i;c&&!c(t,e)||(r.bind(t,...l,e)(),a||Qe(e))}}class ap{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return Bw(t),ee(this,"_colors",t)}convert(t){const e=Lh(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,r]of this._colors)if(r.every((a,l)=>a===e[l]))return ap._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?Bt.makeHexColor(...e):t}}let ql=class P0{#t=new AbortController;#e=null;#i=null;#n=new Map;#s=new Map;#r=null;#a=null;#o=null;#c=new jw;#l=null;#f=null;#u=null;#d=0;#g=new Set;#p=null;#h=null;#m=new Set;_editorUndoBar=null;#y=!1;#v=!1;#_=!1;#E=null;#x=null;#A=null;#T=null;#w=!1;#S=null;#M=new Hw;#C=!1;#D=!1;#P=!1;#O=null;#N=null;#F=null;#L=null;#j=null;#R=Yt.NONE;#b=new Set;#B=null;#z=null;#V=null;#q=null;#I=null;#W={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#U=[0,0];#G=null;#X=null;#K=null;#Z=null;#H=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=P0.prototype,e=l=>l.#X.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),i=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},r=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return ee(this,"_keyboardManager",new hc([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#X.contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#X.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}]]))}constructor(t,e,i,r,a,l,c,h,f,p,m,v,x,E,_,b){const A=this._signal=this.#t.signal;this.#X=t,this.#K=e,this.#Z=i,this.#r=r,this.#l=a,this.#z=l,this.#I=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:A}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:A}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:A}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:A}),c._on("setpreference",this.onSetPreference.bind(this),{signal:A}),c._on("switchannotationeditorparams",T=>this.updateParams(T.type,T.value),{signal:A}),window.addEventListener("pointerdown",()=>{this.#D=!0},{capture:!0,signal:A}),window.addEventListener("pointerup",()=>{this.#D=!1},{capture:!0,signal:A}),this.#lt(),this.#ft(),this.#et(),this.#a=h.annotationStorage,this.#E=h.filterFactory,this.#V=f,this.#T=p||null,this.#y=m,this.#v=v,this.#_=x,this.#j=E||null,this.viewParameters={realScale:Eo.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=_||null,this._supportsPinchToZoom=b!==!1}destroy(){this.#H?.resolve(),this.#H=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#s.values())t.destroy();this.#s.clear(),this.#n.clear(),this.#m.clear(),this.#L?.clear(),this.#e=null,this.#b.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#z?.destroy(),this.#S?.hide(),this.#S=null,this.#F?.destroy(),this.#F=null,this.#i=null,this.#x&&(clearTimeout(this.#x),this.#x=null),this.#G&&(clearTimeout(this.#G),this.#G=null),this._editorUndoBar?.destroy(),this.#I=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#j}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#_}get hcmFilter(){return ee(this,"hcmFilter",this.#V?this.#E.addHCMFilter(this.#V.foreground,this.#V.background):"none")}get direction(){return ee(this,"direction",getComputedStyle(this.#X).direction)}get _highlightColors(){return ee(this,"_highlightColors",this.#T?new Map(this.#T.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return ee(this,"highlightColors",null);const e=new Map,i=!!this.#V;for(const[r,a]of t){const l=r.endsWith("_HCM");if(i&&l){e.set(r.replace("_HCM",""),a);continue}!i&&!l&&e.set(r,a)}return ee(this,"highlightColors",e)}get highlightColorNames(){return ee(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#u=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e){this.#l?.open(this,t,e)}getSignature(t){this.#z?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#z}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){switch(t){case"enableNewAltTextWhenAddingImage":this.#_=e;break}}onPageChanging({pageNumber:t}){this.#d=t-1}focusMainContainer(){this.#X.focus()}findParent(t,e){for(const i of this.#s.values()){const{x:r,y:a,width:l,height:c}=i.div.getBoundingClientRect();if(t>=r&&t<=r+l&&e>=a&&e<=a+c)return i}return null}disableUserSelect(t=!1){this.#K.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#m.add(t)}removeShouldRescale(t){this.#m.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*Eo.PDF_TO_CSS_UNITS;for(const e of this.#m)e.onScaleChanging();this.#u?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#$({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#Q(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#s.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:r,anchorOffset:a,focusNode:l,focusOffset:c}=i,h=i.toString(),p=this.#$(i).closest(".textLayer"),m=this.getSelectionBoxes(p);if(!m)return;i.empty();const v=this.#Q(p),x=this.#R===Yt.NONE,E=()=>{const _=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:m,anchorNode:r,anchorOffset:a,focusNode:l,focusOffset:c,text:h});x&&this.showAllEditors("highlight",!0,!0),e&&_?.editComment()};if(x){this.switchToMode(Yt.HIGHLIGHT,E);return}E()}commentSelection(t=""){this.highlightSelection(t,!0)}#at(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#$(t).closest(".textLayer"),r=this.getSelectionBoxes(i);r&&(this.#S||=new Uw(this),this.#S.show(i,r,this.direction==="ltr"))}addToAnnotationStorage(t){!t.isEmpty()&&this.#a&&!this.#a.has(t.id)&&this.#a.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#Z;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#ot(){const t=document.getSelection();if(!t||t.isCollapsed){this.#B&&(this.#S?.hide(),this.#B=null,this.#k({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#B)return;const r=this.#$(t).closest(".textLayer");if(!r){this.#B&&(this.#S?.hide(),this.#B=null,this.#k({hasSelectedText:!1}));return}if(this.#S?.hide(),this.#B=e,this.#k({hasSelectedText:!0}),!(this.#R!==Yt.HIGHLIGHT&&this.#R!==Yt.NONE)&&(this.#R===Yt.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#w=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#R===Yt.HIGHLIGHT?this.#Q(r):null;if(a?.toggleDrawing(),this.#D){const l=new AbortController,c=this.combinedSignal(l),h=f=>{f.type==="pointerup"&&f.button!==0||(l.abort(),a?.toggleDrawing(!0),f.type==="pointerup"&&this.#J("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else a?.toggleDrawing(!0),this.#J("main_toolbar")}}#J(t=""){this.#R===Yt.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#at()}#lt(){document.addEventListener("selectionchange",this.#ot.bind(this),{signal:this._signal})}#ct(){if(this.#A)return;this.#A=new AbortController;const t=this.combinedSignal(this.#A);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#ut(){this.#A?.abort(),this.#A=null}blur(){if(this.isShiftKeyDown=!1,this.#w&&(this.#w=!1,this.#J("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#b)if(e.div.contains(t)){this.#N=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#N)return;const[t,e]=this.#N;this.#N=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#O)return;this.#O=new AbortController;const t=this.combinedSignal(this.#O);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ht(){this.#O?.abort(),this.#O=null}#it(){if(this.#f)return;this.#f=new AbortController;const t=this.combinedSignal(this.#f);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#nt(){this.#f?.abort(),this.#f=null}#ft(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.#it()}removeEditListeners(){this.#ht(),this.#nt()}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#b){const r=i.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const a of e.items)for(const l of this.#h)if(l.isHandlingMimeForPasting(a.type)){l.paste(a,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(a){qt(`paste: "${a.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const r=this.currentLayer;try{const a=[];for(const h of i){const f=await r.deserialize(h);if(!f)return;a.push(f)}const l=()=>{for(const h of a)this.#rt(h);this.#st(a)},c=()=>{for(const h of a)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(a){qt(`paste: "${a.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#R!==Yt.NONE&&!this.isEditorHandlingKeyboard&&P0._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#w&&(this.#w=!1,this.#J("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#k(t){Object.entries(t).some(([i,r])=>this.#W[i]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#W,t)}),this.#R===Yt.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#Y([[se.HIGHLIGHT_FREE,!0]]))}#Y(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ct(),this.#it(),this.#k({isEditing:this.#R!==Yt.NONE,isEmpty:this.#tt(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ut(),this.#nt(),this.#k({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(const e of this.#h)this.#Y(e.defaultPropertiesToUpdate)}}getId(){return this.#M.id}get currentLayer(){return this.#s.get(this.#d)}getLayer(t){return this.#s.get(t)}get currentPageIndex(){return this.#d}addLayer(t){this.#s.set(t.pageIndex,t),this.#C?t.enable():t.disable()}removeLayer(t){this.#s.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,r=!1,a=!1){if(this.#R!==t&&!(this.#H&&(await this.#H.promise,!this.#H))){if(this.#H=Promise.withResolvers(),this.#u?.commitOrRemove(),this.#R===Yt.POPUP&&this.#l?.hideSidebar(),this.#R=t,t===Yt.NONE){this.setEditingState(!1),this.#pt(),this._editorUndoBar?.hide(),this.#H.resolve();return}t===Yt.SIGNATURE&&await this.#z?.loadSignatures(),t===Yt.POPUP&&(this.#i||=await this.#I.getAnnotationsByType(new Set(this.#h.map(l=>l._editorType))),this.#l?.showSidebar(this.#i)),this.setEditingState(!0),await this.#dt(),this.unselectAll();for(const l of this.#s.values())l.updateMode(t);if(!e){i&&this.addNewEditorFromKeyboard(),this.#H.resolve();return}for(const l of this.#n.values())l.annotationElementId===e||l.id===e?(this.setSelected(l),a?l.editComment():r&&l.enterInEditMode()):l.unselect();this.#H.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#R&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#h){switch(t){case se.CREATE:this.currentLayer.addNewEditor(e);return;case se.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#q||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#b)i.updateParams(t,e);else for(const i of this.#h)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const a of this.#n.values())a.editorType===t&&a.show(e);(this.#q?.get(se.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#Y([[se.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#P!==t){this.#P=t;for(const e of this.#s.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#dt(){if(!this.#C){this.#C=!0;const t=[];for(const e of this.#s.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#pt(){if(this.unselectAll(),this.#C){this.#C=!1;for(const t of this.#s.values())t.disable();for(const t of this.#n.values())t.disable()}}getEditors(t){const e=[];for(const i of this.#n.values())i.pageIndex===t&&e.push(i);return e}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.focusMainContainer(),this.#x=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#L?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#a?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#rt(t){const e=this.#s.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#Y(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#b);return t}updateUI(t){this.#gt===t&&this.#Y(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#Y(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#b.has(t)){this.#b.delete(t),t.unselect(),this.#k({hasSelectedEditor:this.hasSelection});return}this.#b.add(t),t.select(),this.#Y(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.id}),this.#u?.commitOrRemove();for(const e of this.#b)e!==t&&e.unselect();this.#b.clear(),this.#b.add(t),t.select(),this.#Y(t.propertiesToUpdate),this.#k({hasSelectedEditor:!0})}isSelected(t){return this.#b.has(t)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(t){t.unselect(),this.#b.delete(t),this.#k({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#k({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#tt()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#tt()})}addCommands(t){this.#c.add(t),this.#k({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#tt()})}cleanUndoStack(t){this.#c.cleanType(t)}#tt(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#b],i=()=>{this._editorUndoBar?.show(r,e.length===1?e[0].editorType:e.length);for(const a of e)a.remove()},r=()=>{for(const a of e)this.#rt(a)};this.addCommands({cmd:i,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#st(t){for(const e of this.#b)e.unselect();this.#b.clear();for(const e of t)e.isEmpty()||(this.#b.add(e),e.select());this.#k({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#b)t.commit();this.#st(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#R!==Yt.NONE))&&!this.#u?.commitOrRemove()&&this.hasSelection){for(const t of this.#b)t.unselect();this.#b.clear(),this.#k({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#U[0]+=t,this.#U[1]+=e;const[r,a]=this.#U,l=[...this.#b],c=1e3;this.#G&&clearTimeout(this.#G),this.#G=setTimeout(()=>{this.#G=null,this.#U[0]=this.#U[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(r,a),h.translationDone())},undo:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(-r,-a),h.translationDone())},mustExec:!1})},c);for(const h of l)h.translateInPage(t,e),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const t of this.#b)this.#p.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const t=this.#p;this.#p=null;let e=!1;for(const[{x:r,y:a,pageIndex:l},c]of t)c.newX=r,c.newY=a,c.newPageIndex=l,e||=r!==c.savedX||a!==c.savedY||l!==c.savedPageIndex;if(!e)return!1;const i=(r,a,l,c)=>{if(this.#n.has(r.id)){const h=this.#s.get(c);h?r._setParentAndPosition(h,a,l):(r.pageIndex=c,r.x=a,r.y=l)}};return this.addCommands({cmd:()=>{for(const[r,{newX:a,newY:l,newPageIndex:c}]of t)i(r,a,l,c)},undo:()=>{for(const[r,{savedX:a,savedY:l,savedPageIndex:c}]of t)i(r,a,l,c)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#p)for(const i of this.#p.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#R}get imageManager(){return ee(this,"imageManager",new sp)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,p=e.rangeCount;f<p;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:i,y:r,width:a,height:l}=t.getBoundingClientRect();let c;switch(t.getAttribute("data-main-rotation")){case"90":c=(f,p,m,v)=>({x:(p-r)/l,y:1-(f+m-i)/a,width:v/l,height:m/a});break;case"180":c=(f,p,m,v)=>({x:1-(f+m-i)/a,y:1-(p+v-r)/l,width:m/a,height:v/l});break;case"270":c=(f,p,m,v)=>({x:1-(p+v-r)/l,y:(f-i)/a,width:v/l,height:m/a});break;default:c=(f,p,m,v)=>({x:(f-i)/a,y:(p-r)/l,width:m/a,height:v/l});break}const h=[];for(let f=0,p=e.rangeCount;f<p;f++){const m=e.getRangeAt(f);if(!m.collapsed)for(const{x:v,y:x,width:E,height:_}of m.getClientRects())E===0||_===0||h.push(c(v,x,E,_))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const i=this.#a.getRawValue(e);i&&(this.#R===Yt.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const r=this.#L?.get(t);r&&(r.setCanvas(e,i),this.#L.delete(t))}addMissingCanvas(t,e){(this.#L||=new Map).set(t,e)}};class cr{#t=null;#e=!1;#i=null;#n=null;#s=null;#r=null;#a=!1;#o=null;#c=null;#l=null;#f=null;#u=!1;static#d=null;static _l10n=null;constructor(t){this.#c=t,this.#u=t._uiManager.useNewAltTextFlow,cr.#d||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){cr._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#u?(t.classList.add("new"),t.setAttribute("data-l10n-id",cr.#d.missing),e.setAttribute("data-l10n-id",cr.#d["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#c._uiManager._signal;t.addEventListener("contextmenu",Nn,{signal:i}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:i});const r=a=>{a.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#u&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",r,{capture:!0,signal:i}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#a=!0,r(a))},{signal:i}),await this.#p(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#u?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#u?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#f=await cr._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#p())}toggleAltTextBadge(t=!1){if(!this.#u||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#f),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#f}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:r,cancel:a=!1}){i&&(this.#l=i,this.#f=r),!(this.#t===t&&this.#e===e)&&(a||(this.#t=t,this.#e=e),this.#p())}toggle(t=!1){this.#i&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#s=null,this.#o?.remove(),this.#o=null}async#p(){const t=this.#i;if(!t)return;if(this.#u){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",cr.#d[this.#g]),this.#n?.setAttribute("data-l10n-id",cr.#d[`${this.#g}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const r=100,a=this.#c._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:a}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:a})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Iu{#t=null;#e=!1;#i=null;#n=null;#s=null;#r=null;#a=!1;constructor(t){this.#i=t,this.toolbar=null}render(){if(!this.#i._uiManager.hasCommentManager())return null;const t=this.#t=document.createElement("button");t.className="comment",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button");const e=this.#i._uiManager._signal;if(!(e instanceof AbortSignal)||e.aborted)return t;t.addEventListener("contextmenu",Nn,{signal:e}),t.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:e});const i=r=>{r.preventDefault(),this.edit()};return t.addEventListener("click",i,{capture:!0,signal:e}),t.addEventListener("keydown",r=>{r.target===t&&r.key==="Enter"&&(this.#e=!0,i(r))},{signal:e}),t}edit(){const{bottom:t,left:e,right:i}=this.#i.getClientDimensions(),r={top:t};this.#i._uiManager.direction==="ltr"?r.right=i:r.left=e,this.#i._uiManager.editComment(this.#i,r)}finish(){this.#t&&(this.#t.focus({focusVisible:this.#e}),this.#e=!1)}isDeleted(){return this.#a||this.#s===""}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#n}serialize(){return this.data}get data(){return{text:this.#s,date:this.#r,deleted:this.#a}}set data(t){if(t===null){this.#s="",this.#a=!0;return}this.#s=t,this.#r=new Date,this.#a=!1}setInitialText(t){this.#n=t,this.data=t}toggle(t=!1){this.#t&&(this.#t.disabled=!t)}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#s="",this.#r=null,this.#i=null,this.#e=!1,this.#a=!1}}let Dy=class My{#t;#e=!1;#i=null;#n;#s;#r;#a;#o=null;#c;#l=null;#f;#u=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:r=null,onPinching:a=null,onPinchEnd:l=null,signal:c}){this.#t=t,this.#i=i,this.#n=e,this.#s=r,this.#r=a,this.#a=l,this.#f=new AbortController,this.#c=AbortSignal.any([c,this.#f.signal]),t.addEventListener("touchstart",this.#d.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/na.pixelRatio}#d(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#o)return;const r=this.#o=new AbortController,a=AbortSignal.any([this.#c,r.signal]),l=this.#t,c={capture:!0,signal:a,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};l.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(Qe(f),h(f))},c),l.addEventListener("pointerup",h,c),l.addEventListener("pointercancel",h,c);return}if(!this.#u){this.#u=new AbortController;const r=AbortSignal.any([this.#c,this.#u.signal]),a=this.#t,l={signal:r,capture:!1,passive:!1};a.addEventListener("touchmove",this.#g.bind(this),l);const c=this.#p.bind(this);a.addEventListener("touchend",c,l),a.addEventListener("touchcancel",c,l),l.capture=!0,a.addEventListener("pointerdown",Qe,l),a.addEventListener("pointermove",Qe,l),a.addEventListener("pointercancel",Qe,l),a.addEventListener("pointerup",Qe,l),this.#s?.()}if(Qe(t),t.touches.length!==2||this.#i?.()){this.#l=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#g(t){if(!this.#l||t.touches.length!==2)return;Qe(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:r,screenY:a}=e,{screenX:l,screenY:c}=i,h=this.#l,{touch0X:f,touch0Y:p,touch1X:m,touch1Y:v}=h,x=m-f,E=v-p,_=l-r,b=c-a,A=Math.hypot(_,b)||1,T=Math.hypot(x,E)||1;if(!this.#e&&Math.abs(T-A)<=My.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=r,h.touch0Y=a,h.touch1X=l,h.touch1Y=c,!this.#e){this.#e=!0;return}const S=[(r+l)/2,(a+c)/2];this.#r?.(S,T,A)}#p(t){t.touches.length>=2||(this.#u&&(this.#u.abort(),this.#u=null,this.#a?.()),this.#l&&(Qe(t),this.#l=null,this.#e=!1))}destroy(){this.#f?.abort(),this.#f=null,this.#o?.abort(),this.#o=null}};class zt{#t=null;#e=null;#i=null;#n=null;#s=!1;#r=null;#a="";#o=!1;#c=null;#l=null;#f=null;#u=null;#d="";#g=!1;#p=null;#h=!1;#m=!1;#y=!1;#v=null;#_=0;#E=0;#x=null;#A=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#T=!1;#w=zt._zIndex++;static _borderLineWidth=-1;static _colorManager=new ap;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=zt.prototype._resizeWithKeyboard,e=ql.TRANSLATE_SMALL,i=ql.TRANSLATE_BIG;return ee(this,"_resizerKeyboardManager",new hc([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],zt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null;const{rotation:e,rawDims:{pageWidth:i,pageHeight:r,pageX:a,pageY:l}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[a,l];const[c,h]=this.parentDimensions;this.x=t.x/c,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ee(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new zw({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(zt._l10n??=t,zt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),zt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);zt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){De("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#T}set _isDraggable(t){this.#T=t,this.div?.classList.toggle("draggable",t)}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#w}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):this.#U(),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,r){const[a,l]=this.parentDimensions;[i,r]=this.screenToPageTranslation(i,r),this.x=(t+i)/a,this.y=(e+r)/l,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,r]=this.parentDimensions;this.setAt(t*i,e*r,this.width*i,this.height*r),this._onTranslated()}#S([t,e],i,r){[i,r]=this.screenToPageTranslation(i,r),this.x+=i/t,this.y+=r/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#S(this.parentDimensions,t,e)}translateInPage(t,e){this.#p||=[this.x,this.y,this.width,this.height],this.#S(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#p||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[r,a]}=this;if(this.x+=t/r,this.y+=e/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:m,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,m,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,f]=this.getBaseTranslation();l+=h,c+=f;const{style:p}=i;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#p&&(this.#p[0]!==this.x||this.#p[1]!==this.y)}get _hasBeenResized(){return!!this.#p&&(this.#p[2]!==this.width||this.#p[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=zt,r=i/t,a=i/e;switch(this.rotation){case 90:return[-r,a];case 180:return[r,a];case 270:return[r,-a];default:return[-r,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,r]}=this;let{x:a,y:l,width:c,height:h}=this;if(c*=i,h*=r,a*=i,l*=r,this._mustFixPosition)switch(t){case 0:a=Ii(a,0,i-c),l=Ii(l,0,r-h);break;case 90:a=Ii(a,0,i-h),l=Ii(l,c,r);break;case 180:a=Ii(a,c,i),l=Ii(l,h,r);break;case 270:a=Ii(a,h,i),l=Ii(l,0,r-c);break}this.x=a/=i,this.y=l/=r;const[f,p]=this.getBaseTranslation();a+=f,l+=p,e.left=`${(100*a).toFixed(2)}%`,e.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#M(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return zt.#M(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return zt.#M(t,e,360-this.parentRotation)}#C(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(t,e){const[i,r]=this.parentDimensions,{style:a}=this.div;a.width=`${(100*t/i).toFixed(2)}%`,this.#o||(a.height=`${(100*e/r).toFixed(2)}%`)}fixDims(){const{style:t}=this.div,{height:e,width:i}=t,r=i.endsWith("%"),a=!this.#o&&e.endsWith("%");if(r&&a)return;const[l,c]=this.parentDimensions;r||(t.width=`${(100*parseFloat(i)/l).toFixed(2)}%`),!this.#o&&!a&&(t.height=`${(100*parseFloat(e)/c).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#D(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",i),r.setAttribute("data-resizer-name",i),r.addEventListener("pointerdown",this.#P.bind(this,i),{signal:e}),r.addEventListener("contextmenu",Nn,{signal:e}),r.tabIndex=-1}this.div.prepend(this.#c)}#P(t,e){e.preventDefault();const{isMac:i}=wi.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#i?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const a=new AbortController,l=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#F.bind(this,t),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Qe,{passive:!1,signal:l}),window.addEventListener("contextmenu",Nn,{signal:l}),this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#N()};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}#O(t,e,i,r){this.width=i,this.height=r,this.x=t,this.y=e;const[a,l]=this.parentDimensions;this.setDims(a*i,l*r),this.fixAndSetPosition(),this._onResized()}_onResized(){}#N(){if(!this.#f)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:r}=this.#f;this.#f=null;const a=this.x,l=this.y,c=this.width,h=this.height;a===t&&l===e&&c===i&&h===r||this.addCommands({cmd:this.#O.bind(this,a,l,c,h),undo:this.#O.bind(this,t,e,i,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#F(t,e){const[i,r]=this.parentDimensions,a=this.x,l=this.y,c=this.width,h=this.height,f=zt.MIN_SIZE/i,p=zt.MIN_SIZE/r,m=this.#C(this.rotation),v=(q,nt)=>[m[0]*q+m[2]*nt,m[1]*q+m[3]*nt],x=this.#C(360-this.rotation),E=(q,nt)=>[x[0]*q+x[2]*nt,x[1]*q+x[3]*nt];let _,b,A=!1,T=!1;switch(t){case"topLeft":A=!0,_=(q,nt)=>[0,0],b=(q,nt)=>[q,nt];break;case"topMiddle":_=(q,nt)=>[q/2,0],b=(q,nt)=>[q/2,nt];break;case"topRight":A=!0,_=(q,nt)=>[q,0],b=(q,nt)=>[0,nt];break;case"middleRight":T=!0,_=(q,nt)=>[q,nt/2],b=(q,nt)=>[0,nt/2];break;case"bottomRight":A=!0,_=(q,nt)=>[q,nt],b=(q,nt)=>[0,0];break;case"bottomMiddle":_=(q,nt)=>[q/2,nt],b=(q,nt)=>[q/2,0];break;case"bottomLeft":A=!0,_=(q,nt)=>[0,nt],b=(q,nt)=>[q,0];break;case"middleLeft":T=!0,_=(q,nt)=>[0,nt/2],b=(q,nt)=>[q,nt/2];break}const S=_(c,h),C=b(c,h);let N=v(...C);const B=zt._round(a+N[0]),O=zt._round(l+N[1]);let H=1,M=1,W,Y;if(e.fromKeyboard)({deltaX:W,deltaY:Y}=e);else{const{screenX:q,screenY:nt}=e,[St,kt]=this.#l;[W,Y]=this.screenToPageTranslation(q-St,nt-kt),this.#l[0]=q,this.#l[1]=nt}if([W,Y]=E(W/i,Y/r),A){const q=Math.hypot(c,h);H=M=Math.max(Math.min(Math.hypot(C[0]-S[0]-W,C[1]-S[1]-Y)/q,1/c,1/h),f/c,p/h)}else T?H=Ii(Math.abs(C[0]-S[0]-W),f,1)/c:M=Ii(Math.abs(C[1]-S[1]-Y),p,1)/h;const J=zt._round(c*H),ut=zt._round(h*M);N=v(...b(J,ut));const At=B-N[0],Et=O-N[1];this.#p||=[this.x,this.y,this.width,this.height],this.width=J,this.height=ut,this.x=At,this.y=Et,this.setDims(i*J,r*ut),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#m)return this._editToolbar;this._editToolbar=new Bl(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}removeEditToolbar(){this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,this.#i?.destroy())}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(cr.initialize(zt._l10n),this.#i=new cr(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}addCommentButton(){return this.#n?this.#n:this.#n=new Iu(this)}get commentColor(){return null}get comment(){const t=this.#n;return{text:t.data.text,date:t.data.date,deleted:t.isDeleted(),color:this.commentColor}}set comment(t){this.#n||(this.#n=new Iu(this)),this.#n.data=t}setCommentData(t){this.#n||(this.#n=new Iu(this)),this.#n.setInitialText(t)}get hasEditedComment(){return this.#n?.hasBeenEdited()}async editComment(){this.#n||(this.#n=new Iu(this)),this.#n.edit()}addComment(t){if(this.hasEditedComment){const[,,,r]=t.rect,[a]=this.pageDimensions,[l]=this.pageTranslation,c=l+a+1,h=r-100,f=c+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,f,r]}}}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#s?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[r,a]=this.getInitialTranslation();return this.translate(r,a),Ry(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#A||=new Dy({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#L.bind(this),onPinching:this.#j.bind(this),onPinchEnd:this.#R.bind(this),signal:this._uiManager._signal})),this._uiManager._editorUndoBar?.hide(),t}#L(){this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#j(t,e,i){let a=.7*(i/e)+1-.7;if(a===1)return;const l=this.#C(this.rotation),c=(B,O)=>[l[0]*B+l[2]*O,l[1]*B+l[3]*O],[h,f]=this.parentDimensions,p=this.x,m=this.y,v=this.width,x=this.height,E=zt.MIN_SIZE/h,_=zt.MIN_SIZE/f;a=Math.max(Math.min(a,1/v,1/x),E/v,_/x);const b=zt._round(v*a),A=zt._round(x*a);if(b===v&&A===x)return;this.#p||=[p,m,v,x];const T=c(v/2,x/2),S=zt._round(p+T[0]),C=zt._round(m+T[1]),N=c(b/2,A/2);this.x=S-N[0],this.y=C-N[1],this.width=b,this.height=A,this.setDims(h*b,f*A),this.fixAndSetPosition(),this._onResizing()}#R(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#N()}pointerdown(t){const{isMac:e}=wi.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#B(t);return}this.#b(t)}#b(t){const{isMac:e}=wi.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#B(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const r=new AbortController,a=this._uiManager.combinedSignal(r),l={capture:!0,passive:!1,signal:a},c=f=>{r.abort(),this.#r=null,this.#g=!1,this._uiManager.endDragSession()||this.#b(f),i&&this._onStopDragging()};e&&(this.#_=t.clientX,this.#E=t.clientY,this.#r=t.pointerId,this.#a=t.pointerType,window.addEventListener("pointermove",f=>{i||(i=!0,this._onStartDragging());const{clientX:p,clientY:m,pointerId:v}=f;if(v!==this.#r){Qe(f);return}const[x,E]=this.screenToPageTranslation(p-this.#_,m-this.#E);this.#_=p,this.#E=m,this._uiManager.dragSelectedEditors(x,E)},l),window.addEventListener("touchmove",Qe,l),window.addEventListener("pointerdown",f=>{f.pointerType===this.#a&&(this.#A||f.isPrimary)&&c(f),Qe(f)},l));const h=f=>{if(!this.#r||this.#r===f.pointerId){c(f);return}Qe(f)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const r=this.parentScale,[a,l]=this.pageDimensions,[c,h]=this.pageTranslation,f=t/r,p=e/r,m=this.x*a,v=this.y*l,x=this.width*a,E=this.height*l;switch(i){case 0:return[m+f+c,l-v-p-E+h,m+f+x+c,l-v-p+h];case 90:return[m+p+c,l-v+f+h,m+p+E+c,l-v+f+x+h];case 180:return[m-f-x+c,l-v+p+h,m-f+c,l-v+p+E+h];case 270:return[m-p-E+c,l-v-f-x+h,m-p+c,l-v-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,r,a,l]=t,c=a-i,h=l-r;switch(this.rotation){case 0:return[i,e-l,c,h];case 90:return[i,e-r,h,c];case 180:return[a,e-r,c,h];case 270:return[a,e-l,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#m=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#m=!1,!0):!1}isInEditMode(){return this.#m}shouldGetKeyboardEvents(){return this.#y}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:r}=this.getClientDimensions(),{innerHeight:a,innerWidth:l}=window;return e<l&&r>0&&t<a&&i>0}#z(){if(this.#u||!this.div)return;this.#u=new AbortController;const t=this._uiManager.combinedSignal(this.#u);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){De("An editor must be serializable")}static async deserialize(t,e,i){const r=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[a,l]=r.pageDimensions,[c,h,f,p]=r.getRectInCurrentCoords(t.rect,l);return r.x=c/a,r.y=h/l,r.width=f/a,r.height=p/l,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#u?.abort(),this.#u=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#U(),this.removeEditToolbar(),this.#x){for(const t of this.#x.values())clearTimeout(t);this.#x=null}this.parent=null,this.#A?.destroy(),this.#A=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#D(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#f={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const l=this.#V.bind(this),c=this.#q.bind(this),h=this._uiManager._signal;for(const f of this.#e){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",this.#I.bind(this,p),{signal:h}),f.setAttribute("data-l10n-id",zt._l10nResizer[p])}}const i=this.#e[0];let r=0;for(const l of e){if(l===i)break;r++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(a!==r){if(a<r)for(let c=0;c<r-a;c++)this.#c.append(this.#c.firstChild);else if(a>r)for(let c=0;c<a-r;c++)this.#c.firstChild.before(this.#c.lastChild);let l=0;for(const c of e){const f=this.#e[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",zt._l10nResizer[f])}}this.#W(0),this.#y=!0,this.#c.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#V(t){zt._resizerKeyboardManager.exec(this,t)}#q(t){this.#y&&t.relatedTarget?.parentNode!==this.#c&&this.#U()}#I(t){this.#d=this.#y?t:""}#W(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#y&&this.#F(this.#d,{deltaX:t,deltaY:e,fromKeyboard:!0})}#U(){this.#y=!1,this.#W(-1),this.#N()}_stopResizingWithKeyboard(){this.#U(),this.div.focus()}select(){if(!(this.isSelected&&this._editToolbar)){if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0))}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id})}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#h}set isEditing(t){this.#h=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(t,e){this.#o=!0;const i=t/e,{style:r}=this.div;r.aspectRatio=i,r.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#x||=new Map;const{action:i}=t;let r=this.#x.get(i);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#x.delete(i),this.#x.size===0&&(this.#x=null)},zt._telemetryTimeout),this.#x.set(i,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class zw extends zt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Bv=3285377520,Tn=4294901760,nr=65535;class Ny{constructor(t){this.h1=t?t&4294967295:Bv,this.h2=t?t&4294967295:Bv}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let _=0,b=t.length;_<b;_++){const A=t.charCodeAt(_);A<=255?e[i++]=A:(e[i++]=A>>>8,e[i++]=A&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=i>>2,a=i-r*4,l=new Uint32Array(e.buffer,0,r);let c=0,h=0,f=this.h1,p=this.h2;const m=3432918353,v=461845907,x=m&nr,E=v&nr;for(let _=0;_<r;_++)_&1?(c=l[_],c=c*m&Tn|c*x&nr,c=c<<15|c>>>17,c=c*v&Tn|c*E&nr,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[_],h=h*m&Tn|h*x&nr,h=h<<15|h>>>17,h=h*v&Tn|h*E&nr,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(c=0,a){case 3:c^=e[r*4+2]<<16;case 2:c^=e[r*4+1]<<8;case 1:c^=e[r*4],c=c*m&Tn|c*x&nr,c=c<<15|c>>>17,c=c*v&Tn|c*E&nr,r&1?f^=c:p^=c}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Tn|t*36045&nr,e=e*4283543511&Tn|((e<<16|t>>>16)*2950163797&Tn)>>>16,t^=e>>>1,t=t*444984403&Tn|t*60499&nr,e=e*3301882366&Tn|((e<<16|t>>>16)*3120437893&Tn)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const k0=Object.freeze({map:null,hash:"",transfer:void 0});class op{#t=!1;#e=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#i.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#i.get(t)}remove(t){if(this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const e of this.#i.values())if(e instanceof zt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#i.get(t);let r=!1;if(i!==void 0)for(const[a,l]of Object.entries(e))i[a]!==l&&(r=!0,i[a]=l);else r=!0,this.#i.set(t,e);r&&this.#n(),e instanceof zt&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type)}has(t){return this.#i.has(t)}get size(){return this.#i.size}#n(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Oy(this)}get serializable(){if(this.#i.size===0)return k0;const t=new Map,e=new Ny,i=[],r=Object.create(null);let a=!1;for(const[l,c]of this.#i){const h=c instanceof zt?c.serialize(!1,r):c;h&&(t.set(l,h),e.update(`${l}:${JSON.stringify(h)}`),a||=!!h.bitmap)}if(a)for(const l of t.values())l.bitmap&&i.push(l.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:k0}get editorStats(){let t=null;const e=new Map;for(const i of this.#i.values()){if(!(i instanceof zt))continue;const r=i.telemetryFinalData;if(!r)continue;const{type:a}=r;e.has(a)||e.set(a,Object.getPrototypeOf(i).constructor),t||=Object.create(null);const l=t[a]||=new Map;for(const[c,h]of Object.entries(r)){if(c==="type")continue;let f=l.get(c);f||(f=new Map,l.set(c,f));const p=f.get(h)??0;f.set(h,p+1)}}for(const[i,r]of e)t[i]=r.computeTelemetryFinalData(t[i]);return t}resetModifiedIds(){this.#e=null}get modifiedIds(){if(this.#e)return this.#e;const t=[];for(const e of this.#i.values())!(e instanceof zt)||!e.annotationElementId||!e.serialize()||t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class Oy extends op{#t;constructor(t){super();const{map:e,hash:i,transfer:r}=t.serializable,a=structuredClone(e,r?{transfer:r}:null);this.#t={map:a,hash:i,transfer:r}}get print(){De("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return ee(this,"modifiedIds",{ids:new Set,hash:""})}}class Vw{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Ze(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:a,style:l}=t,c=new FontFace(r,a,l);this.addNativeFontFace(c);try{await c.load(),this.#t.add(r),i?.(t)}catch{qt(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}De("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(r){throw qt(`Failed to load font '${i.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const r=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return ee(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return ee(this,"isSyncFontLoadingSupported",Fi||wi.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Ze(!r.done,"completeRequest() cannot be called twice."),r.done=!0;i.length>0&&i[0].done;){const a=i.shift();setTimeout(a.callback,0)}}const{loadingRequests:i}=this,r={done:!1,complete:e,callback:t};return i.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ee(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(C,N){return C.charCodeAt(N)<<24|C.charCodeAt(N+1)<<16|C.charCodeAt(N+2)<<8|C.charCodeAt(N+3)&255}function r(C,N,B,O){const H=C.substring(0,N),M=C.substring(N+B);return H+O+M}let a,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function p(C,N){if(++f>30){qt("Load test font never loaded."),N();return}if(h.font="30px "+C,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){N();return}setTimeout(p.bind(null,C,N))}const m=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=r(v,976,m.length,m);const E=16,_=1482184792;let b=i(v,E);for(a=0,l=m.length-3;a<l;a+=4)b=b-_+i(m,a)|0;a<m.length&&(b=b-_+i(m+"XXX",a)|0),v=r(v,E,4,Cw(b));const A=`url(data:font/opentype;base64,${btoa(v)});`,T=`@font-face {font-family:"${m}";src:${A}}`;this.insertRule(T);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const C of[t.loadedName,m]){const N=this._document.createElement("span");N.textContent="Hi",N.style.fontFamily=C,S.append(N)}this._document.body.append(S),p(m,()=>{S.remove(),e.complete()})}}class Gw{constructor(t,e=null){this.compiledGlyphs=Object.create(null);for(const i in t)this[i]=t[i];this._inspectFont=e}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${Cy(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let r;try{r=t.get(i)}catch(l){qt(`getPathGenerator - ignoring character: "${l}".`)}const a=new Path2D(r||"");return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=a}}function Ww(n){if(n instanceof URL)return n.href;if(typeof n=="string"){if(Fi)return n;const t=URL.parse(n,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function Xw(n){if(Fi&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return lc(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n?.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Bu(n){if(typeof n!="string")return null;if(n.endsWith("/"))return n;throw new Error(`Invalid factory url: "${n}" must include trailing slash.`)}const F0=n=>typeof n=="object"&&Number.isInteger(n?.num)&&n.num>=0&&Number.isInteger(n?.gen)&&n.gen>=0,Yw=n=>typeof n=="object"&&typeof n?.name=="string",$w=Ow.bind(null,F0,Yw);class qw{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,i)})}addEventListener(t,e,i=null){let r=null;if(i?.signal instanceof AbortSignal){const{signal:a}=i;if(a.aborted){qt("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(t,e);r=()=>a.removeEventListener("abort",l),a.addEventListener("abort",l)}this.#t.set(e,r)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Uu={DATA:1,ERROR:2},$e={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Uv(){}function Yi(n){if(n instanceof _s||n instanceof M0||n instanceof kv||n instanceof lh||n instanceof a0)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||De('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new _s(n.message);case"InvalidPDFException":return new M0(n.message);case"PasswordException":return new kv(n.message,n.code);case"ResponseException":return new lh(n.message,n.status,n.missing);case"UnknownErrorException":return new a0(n.message,n.details)}return new a0(n.message,n.toString())}class kl{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const i=t.callbackId,r=this.callbackCapabilities[i];if(!r)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===Uu.DATA)r.resolve(t.data);else if(t.callback===Uu.ERROR)r.reject(Yi(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,r=t.sourceName,a=this.comObj;Promise.try(e,t.data).then(function(l){a.postMessage({sourceName:i,targetName:r,callback:Uu.DATA,callbackId:t.callbackId,data:l})},function(l){a.postMessage({sourceName:i,targetName:r,callback:Uu.ERROR,callbackId:t.callbackId,reason:Yi(l)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const r=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[r]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:e},i)}catch(l){a.reject(l)}return a.promise}sendWithStream(t,e,i,r){const a=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[a]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:t,streamId:a,data:e,desiredSize:f.desiredSize},r),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[a].pullCall=p,h.postMessage({sourceName:l,targetName:c,stream:$e.PULL,streamId:a,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Ze(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[a].cancelCall=p,this.streamControllers[a].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:$e.CANCEL,streamId:a,reason:Yi(f)}),p.promise}},i)}#i(t){const e=t.streamId,i=this.sourceName,r=t.sourceName,a=this.comObj,l=this,c=this.actionHandler[t.action],h={enqueue(f,p=1,m){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=p,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:i,targetName:r,stream:$e.ENQUEUE,streamId:e,chunk:f},m)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:r,stream:$e.CLOSE,streamId:e}),delete l.streamSinks[e])},error(f){Ze(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:r,stream:$e.ERROR,streamId:e,reason:Yi(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(c,t.data,h).then(function(){a.postMessage({sourceName:i,targetName:r,stream:$e.START_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:i,targetName:r,stream:$e.START_COMPLETE,streamId:e,reason:Yi(f)})})}#n(t){const e=t.streamId,i=this.sourceName,r=t.sourceName,a=this.comObj,l=this.streamControllers[e],c=this.streamSinks[e];switch(t.stream){case $e.START_COMPLETE:t.success?l.startCall.resolve():l.startCall.reject(Yi(t.reason));break;case $e.PULL_COMPLETE:t.success?l.pullCall.resolve():l.pullCall.reject(Yi(t.reason));break;case $e.PULL:if(!c){a.postMessage({sourceName:i,targetName:r,stream:$e.PULL_COMPLETE,streamId:e,success:!0});break}c.desiredSize<=0&&t.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=t.desiredSize,Promise.try(c.onPull||Uv).then(function(){a.postMessage({sourceName:i,targetName:r,stream:$e.PULL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:i,targetName:r,stream:$e.PULL_COMPLETE,streamId:e,reason:Yi(f)})});break;case $e.ENQUEUE:if(Ze(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(t.chunk);break;case $e.CLOSE:if(Ze(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#s(l,e);break;case $e.ERROR:Ze(l,"error should have stream controller"),l.controller.error(Yi(t.reason)),this.#s(l,e);break;case $e.CANCEL_COMPLETE:t.success?l.cancelCall.resolve():l.cancelCall.reject(Yi(t.reason)),this.#s(l,e);break;case $e.CANCEL:if(!c)break;const h=Yi(t.reason);Promise.try(c.onCancel||Uv,h).then(function(){a.postMessage({sourceName:i,targetName:r,stream:$e.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){a.postMessage({sourceName:i,targetName:r,stream:$e.CANCEL_COMPLETE,streamId:e,reason:Yi(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class Ly{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){De("Abstract method `_createCanvas` called.")}}class Kw extends Ly{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class Py{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){De("Abstract method `_fetch` called.")}}class Hv extends Py{async _fetch(t){const e=await cc(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):lc(e)}}class ky{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,r,a){return"none"}destroy(t=!1){}}class Qw extends ky{#t;#e;#i;#n;#s;#r;#a=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#s=e}get#o(){return this.#e||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#i){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#s.createElementNS(Rr,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#i=this.#s.createElementNS(Rr,"defs"),t.append(i),i.append(this.#i),this.#s.body.append(t)}return this.#i}#f(t){if(t.length===1){const h=t[0],f=new Array(256);for(let m=0;m<256;m++)f[m]=h[m]/255;const p=f.join(",");return[p,p,p]}const[e,i,r]=t,a=new Array(256),l=new Array(256),c=new Array(256);for(let h=0;h<256;h++)a[h]=e[h]/255,l[h]=i[h]/255,c[h]=r[h]/255;return[a.join(","),l.join(","),c.join(",")]}#u(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(Oh(e)?qt('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=wy(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,r,a]=this.#f(t),l=t.length===1?i:`${i}${r}${a}`;if(e=this.#o.get(l),e)return this.#o.set(t,e),e;const c=`g_${this.#n}_transfer_map_${this.#a++}`,h=this.#u(c);this.#o.set(t,h),this.#o.set(l,h);const f=this.#p(c);return this.#m(i,r,a,f),h}addHCMFilter(t,e){const i=`${t}-${e}`,r="base";let a=this.#c.get(r);if(a?.key===i||(a?(a.filter?.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},this.#c.set(r,a)),!t||!e))return a.url;const l=this.#v(t);t=Bt.makeHexColor(...l);const c=this.#v(e);if(e=Bt.makeHexColor(...c),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return a.url;const h=new Array(256);for(let x=0;x<=255;x++){const E=x/255;h[x]=E<=.03928?E/12.92:((E+.055)/1.055)**2.4}const f=h.join(","),p=`g_${this.#n}_hcm_filter`,m=a.filter=this.#p(p);this.#m(f,f,f,m),this.#g(m);const v=(x,E)=>{const _=l[x]/255,b=c[x]/255,A=new Array(E+1);for(let T=0;T<=E;T++)A[T]=_+T/E*(b-_);return A.join(",")};return this.#m(v(0,5),v(1,5),v(2,5),m),a.url=this.#u(p),a.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#f([t]),r=`alpha_${i}`;if(e=this.#o.get(r),e)return this.#o.set(t,e),e;const a=`g_${this.#n}_alpha_map_${this.#a++}`,l=this.#u(a);this.#o.set(t,l),this.#o.set(r,l);const c=this.#p(a);return this.#y(i,c),l}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,r;if(t?([i]=this.#f([t]),r=`luminosity_${i}`):r="luminosity",e=this.#o.get(r),e)return this.#o.set(t,e),e;const a=`g_${this.#n}_luminosity_map_${this.#a++}`,l=this.#u(a);this.#o.set(t,l),this.#o.set(r,l);const c=this.#p(a);return this.#d(c),t&&this.#y(i,c),l}addHighlightHCMFilter(t,e,i,r,a){const l=`${e}-${i}-${r}-${a}`;let c=this.#c.get(t);if(c?.key===l||(c?(c.filter?.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},this.#c.set(t,c)),!e||!i))return c.url;const[h,f]=[e,i].map(this.#v.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),m=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[v,x]=[r,a].map(this.#v.bind(this));m<p&&([p,m,v,x]=[m,p,x,v]),this.#l.style.color="";const E=(A,T,S)=>{const C=new Array(256),N=(m-p)/S,B=A/255,O=(T-A)/(255*S);let H=0;for(let M=0;M<=S;M++){const W=Math.round(p+M*N),Y=B+M*O;for(let J=H;J<=W;J++)C[J]=Y;H=W+1}for(let M=H;M<256;M++)C[M]=C[H-1];return C.join(",")},_=`g_${this.#n}_hcm_${t}_filter`,b=c.filter=this.#p(_);return this.#g(b),this.#m(E(v[0],x[0],5),E(v[1],x[1],5),E(v[2],x[2],5),b),c.url=this.#u(_),c.url}destroy(t=!1){t&&this.#r?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#a=0)}#d(t){const e=this.#s.createElementNS(Rr,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#s.createElementNS(Rr,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#p(t){const e=this.#s.createElementNS(Rr,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#h(t,e,i){const r=this.#s.createElementNS(Rr,e);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)}#m(t,e,i,r){const a=this.#s.createElementNS(Rr,"feComponentTransfer");r.append(a),this.#h(a,"feFuncR",t),this.#h(a,"feFuncG",e),this.#h(a,"feFuncB",i)}#y(t,e){const i=this.#s.createElementNS(Rr,"feComponentTransfer");e.append(i),this.#h(i,"feFuncA",t)}#v(t){return this.#l.style.color=t,Lh(getComputedStyle(this.#l).getPropertyValue("color"))}}class Fy{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){De("Abstract method `_fetch` called.")}}class jv extends Fy{async _fetch(t){const e=await cc(t,"arraybuffer");return new Uint8Array(e)}}class Iy{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){De("Abstract method `_fetch` called.")}}class zv extends Iy{async _fetch(t){const e=await cc(t,"arraybuffer");return new Uint8Array(e)}}Fi&&qt("Please use the `legacy` build in Node.js environments.");async function lp(n){const e=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(e)}class Zw extends ky{}class Jw extends Ly{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class tS extends Py{async _fetch(t){return lp(t)}}class eS extends Fy{async _fetch(t){return lp(t)}}class iS extends Iy{async _fetch(t){return lp(t)}}const Za="__forcedDependency";class nS{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Za]:[]};#i=new Map;#n=[];#s=[];#r=[[1,0,0,1,0,0]];#a=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#f=new Map;#u=new Map;#d;#g;constructor(t){this.#d=t.width,this.#g=t.height}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Za]:{__proto__:this.#e[Za]}},this.#a={__proto__:this.#a},this.#n.push([t,null]),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#a=Object.getPrototypeOf(this.#a);const i=this.#n.pop();return i!==void 0&&(i[1]=t),this}recordOpenMarker(t){return this.#n.push([t,null]),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)[0]}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(e[1]=t),this}beginMarkedContent(t){return this.#s.push([t,null]),this}endMarkedContent(t){const e=this.#s.pop();return e!==void 0&&(e[1]=t),this}pushBaseTransform(t){return this.#r.push(Bt.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordFutureForcedDependency(t,e){return this.recordIncrementalData(Za,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(Za,t);return this}resetBBox(t){return this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0,this}get hasPendingBBox(){return this.#c!==-1}recordClipBox(t,e,i,r,a,l){const c=Bt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform()),h=[1/0,1/0,-1/0,-1/0];Bt.axialAlignedBoundingBox([i,a,r,l],c,h);const f=Bt.intersect(this.#a,h);return f?(this.#a[0]=f[0],this.#a[1]=f[1],this.#a[2]=f[2],this.#a[3]=f[3]):(this.#a[0]=this.#a[1]=1/0,this.#a[2]=this.#a[3]=-1/0),this}recordBBox(t,e,i,r,a,l){const c=this.#a;if(c[0]===1/0)return this;const h=Bt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform());if(c[0]===-1/0)return Bt.axialAlignedBoundingBox([i,a,r,l],h,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return Bt.axialAlignedBoundingBox([i,a,r,l],h,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],c[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],c[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],c[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],c[3])),this}recordCharacterBBox(t,e,i,r=1,a=0,l=0,c){const h=i.bbox;let f,p;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#u.get(i),f!==!1&&(p=[0,0,0,0],Bt.axialAlignedBoundingBox(h,i.fontMatrix,p),(r!==1||a!==0||l!==0)&&Bt.scaleMinMax([r,0,0,-r,a,l],p),f)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!c)return this.recordFullPageBBox(t);const m=c();return h&&p&&f===void 0&&(f=p[0]<=a-m.actualBoundingBoxLeft&&p[2]>=a+m.actualBoundingBoxRight&&p[1]<=l-m.actualBoundingBoxAscent&&p[3]>=l+m.actualBoundingBoxDescent,this.#u.set(i,f),f)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,a-m.actualBoundingBoxLeft,a+m.actualBoundingBoxRight,l-m.actualBoundingBoxAscent,l+m.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#a[0]),this.#o[1]=Math.max(0,this.#a[1]),this.#o[2]=Math.min(this.#d,this.#a[2]),this.#o[3]=Math.min(this.#g,this.#a[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#l,r=this.#t,a=this.#e;for(const l of e)l in this.#t?i.add(r[l]):l in a&&a[l].forEach(i.add,i);return this}copyDependenciesFromIncrementalOperation(t,e){const i=this.#f,r=this.#l;for(const a of this.#e[e])i.get(a).dependencies.forEach(r.add,r.add(a));return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#l.add(this.#i.get(e)),this}recordOperation(t,e=!1){this.recordDependencies(t,[Za]);const i=new Set(this.#l),r=this.#n.concat(this.#s),a=this.#c===t?{minX:this.#o[0],minY:this.#o[1],maxX:this.#o[2],maxY:this.#o[3]}:null;return this.#f.set(t,{bbox:a,pairs:r,dependencies:i}),e||(this.#c=-1),this.#l.clear(),this}bboxToClipBoxDropOperation(t){return this.#c!==-1&&(this.#c=-1,this.#a[0]=Math.max(this.#a[0],this.#o[0]),this.#a[1]=Math.max(this.#a[1],this.#o[1]),this.#a[2]=Math.min(this.#a[2],this.#o[2]),this.#a[3]=Math.min(this.#a[3],this.#o[3])),this.#l.clear(),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#f.get(t);return this.#f.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#u.clear(),Array.from(this.#f,([t,{bbox:e,pairs:i,dependencies:r}])=>(i.forEach(a=>a.forEach(r.add,r)),r.delete(t),{minX:(e?.minX??0)/this.#d,maxX:(e?.maxX??this.#d)/this.#d,minY:(e?.minY??0)/this.#g,maxY:(e?.maxY??this.#g)/this.#g,dependencies:Array.from(r).sort((a,l)=>a-l),idx:t}))}}class ch{#t;#e;#i=0;#n;#s=0;constructor(t,e){if(t instanceof ch)return t;this.#t=t,this.#n=t._takePendingDependencies(),this.#e=e}save(t){return this.#s++,this.#t.save(this.#e),this}restore(t){return this.#s>0&&(this.#t.restore(this.#e),this.#s--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#t.hasPendingBBox||this.#t.resetBBox(this.#e),this}get hasPendingBBox(){return this.#t.hasPendingBBox}recordClipBox(t,e,i,r,a,l){return this.#t.recordClipBox(this.#e,e,i,r,a,l),this}recordBBox(t,e,i,r,a,l){return this.#t.recordBBox(this.#e,e,i,r,a,l),this}recordCharacterBBox(t,e,i,r,a,l,c){return this.#t.recordCharacterBBox(this.#e,e,i,r,a,l,c),this}recordFullPageBBox(t){return this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}copyDependenciesFromIncrementalOperation(t,e){return this.#t.copyDependenciesFromIncrementalOperation(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){this.#t.recordOperation(this.#e,!0);const e=this.#t._extractOperation(this.#e);for(const i of e.dependencies)this.#n.add(i);return this.#n.delete(this.#e),this.#n.delete(null),this}bboxToClipBoxDropOperation(t){return this.#t.bboxToClipBoxDropOperation(this.#e),this}recordNestedDependencies(){this.#t._pushPendingDependencies(this.#n)}take(){throw new Error("Unreachable")}}const Cn={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation"],transform:["transform"],transformAndFill:["transform","fillColor"]},Ei={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function I0(n,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],e,i),n.clip(r)}class cp{isModifyingCurrentTransform(){return!1}getPattern(){De("Abstract method `getPattern` called.")}}class rS extends cp{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}_createGradient(t){let e;this._type==="axial"?e=t.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(e=t.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)e.addColorStop(i[0],i[1]);return e}getPattern(t,e,i,r){let a;if(r===Ei.STROKE||r===Ei.FILL){const l=e.current.getClippedPathBoundingBox(r,Ie(t))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=e.cachedCanvases.getCanvas("pattern",c,h),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),i=Bt.transform(i,[1,0,0,1,l[0],l[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),I0(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),a=t.createPattern(f.canvas,"no-repeat");const m=new DOMMatrix(i);a.setTransform(m)}else I0(t,this._bbox),a=this._createGradient(t);return a}}function c0(n,t,e,i,r,a,l,c){const h=t.coords,f=t.colors,p=n.data,m=n.width*4;let v;h[e+1]>h[i+1]&&(v=e,e=i,i=v,v=a,a=l,l=v),h[i+1]>h[r+1]&&(v=i,i=r,r=v,v=l,l=c,c=v),h[e+1]>h[i+1]&&(v=e,e=i,i=v,v=a,a=l,l=v);const x=(h[e]+t.offsetX)*t.scaleX,E=(h[e+1]+t.offsetY)*t.scaleY,_=(h[i]+t.offsetX)*t.scaleX,b=(h[i+1]+t.offsetY)*t.scaleY,A=(h[r]+t.offsetX)*t.scaleX,T=(h[r+1]+t.offsetY)*t.scaleY;if(E>=T)return;const S=f[a],C=f[a+1],N=f[a+2],B=f[l],O=f[l+1],H=f[l+2],M=f[c],W=f[c+1],Y=f[c+2],J=Math.round(E),ut=Math.round(T);let At,Et,q,nt,St,kt,G,ht;for(let P=J;P<=ut;P++){if(P<b){const wt=P<E?0:(E-P)/(E-b);At=x-(x-_)*wt,Et=S-(S-B)*wt,q=C-(C-O)*wt,nt=N-(N-H)*wt}else{let wt;P>T?wt=1:b===T?wt=0:wt=(b-P)/(b-T),At=_-(_-A)*wt,Et=B-(B-M)*wt,q=O-(O-W)*wt,nt=H-(H-Y)*wt}let j;P<E?j=0:P>T?j=1:j=(E-P)/(E-T),St=x-(x-A)*j,kt=S-(S-M)*j,G=C-(C-W)*j,ht=N-(N-Y)*j;const z=Math.round(Math.min(At,St)),X=Math.round(Math.max(At,St));let et=m*P+z*4;for(let wt=z;wt<=X;wt++)j=(At-wt)/(At-St),j<0?j=0:j>1&&(j=1),p[et++]=Et-(Et-kt)*j|0,p[et++]=q-(q-G)*j|0,p[et++]=nt-(nt-ht)*j|0,p[et++]=255}}function sS(n,t,e){const i=t.coords,r=t.colors;let a,l;switch(t.type){case"lattice":const c=t.verticesPerRow,h=Math.floor(i.length/c)-1,f=c-1;for(a=0;a<h;a++){let p=a*c;for(let m=0;m<f;m++,p++)c0(n,e,i[p],i[p+1],i[p+c],r[p],r[p+1],r[p+c]),c0(n,e,i[p+c+1],i[p+1],i[p+c],r[p+c+1],r[p+1],r[p+c])}break;case"triangles":for(a=0,l=i.length;a<l;a+=3)c0(n,e,i[a],i[a+1],i[a+2],r[a],r[a+1],r[a+2]);break;default:throw new Error("illegal figure")}}class aS extends cp{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,p=Math.ceil(this._bounds[3])-h,m=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),x=f/m,E=p/v,_={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/x,scaleY:1/E},b=m+4,A=v+4,T=i.getCanvas("mesh",b,A),S=T.context,C=S.createImageData(m,v);if(e){const B=C.data;for(let O=0,H=B.length;O<H;O+=4)B[O]=e[0],B[O+1]=e[1],B[O+2]=e[2],B[O+3]=255}for(const B of this._figures)sS(C,B,_);return S.putImageData(C,2,2),{canvas:T.canvas,offsetX:c-2*x,offsetY:h-2*E,scaleX:x,scaleY:E}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,r){I0(t,this._bbox);const a=new Float32Array(2);if(r===Ei.SHADING)Bt.singularValueDecompose2dScale(Ie(t),a);else if(this.matrix){Bt.singularValueDecompose2dScale(this.matrix,a);const[c,h]=a;Bt.singularValueDecompose2dScale(e.baseTransform,a),a[0]*=c,a[1]*=h}else Bt.singularValueDecompose2dScale(e.baseTransform,a);const l=this._createMeshCanvas(a,r===Ei.SHADING?null:this._background,e.cachedCanvases);return r!==Ei.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(l.offsetX,l.offsetY),t.scale(l.scaleX,l.scaleY),t.createPattern(l.canvas,"no-repeat")}}class oS extends cp{getPattern(){return"hotpink"}}function lS(n){switch(n[0]){case"RadialAxial":return new rS(n);case"Mesh":return new aS(n);case"Dummy":return new oS}throw new Error(`Unknown IR type: ${n[0]}`)}const Vv={COLORED:1,UNCOLORED:2};class up{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(t){const{bbox:e,operatorList:i,paintType:r,tilingType:a,color:l,canvasGraphicsFactory:c}=this;let{xstep:h,ystep:f}=this;h=Math.abs(h),f=Math.abs(f),Nh("TilingType: "+a);const p=e[0],m=e[1],v=e[2],x=e[3],E=v-p,_=x-m,b=new Float32Array(2);Bt.singularValueDecompose2dScale(this.matrix,b);const[A,T]=b;Bt.singularValueDecompose2dScale(this.baseTransform,b);const S=A*b[0],C=T*b[1];let N=E,B=_,O=!1,H=!1;const M=Math.ceil(h*S),W=Math.ceil(f*C),Y=Math.ceil(E*S),J=Math.ceil(_*C);M>=Y?N=h:O=!0,W>=J?B=f:H=!0;const ut=this.getSizeAndScale(N,this.ctx.canvas.width,S),At=this.getSizeAndScale(B,this.ctx.canvas.height,C),Et=t.cachedCanvases.getCanvas("pattern",ut.size,At.size),q=Et.context,nt=c.createCanvasGraphics(q);if(nt.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(nt,r,l),q.translate(-ut.scale*p,-At.scale*m),nt.transform(0,ut.scale,0,0,At.scale,0,0),q.save(),nt.dependencyTracker?.save(),this.clipBbox(nt,p,m,v,x),nt.baseTransform=Ie(nt.ctx),nt.executeOperatorList(i),nt.endDrawing(),nt.dependencyTracker?.restore().recordNestedDependencies?.(),q.restore(),O||H){const St=Et.canvas;O&&(N=h),H&&(B=f);const kt=this.getSizeAndScale(N,this.ctx.canvas.width,S),G=this.getSizeAndScale(B,this.ctx.canvas.height,C),ht=kt.size,P=G.size,j=t.cachedCanvases.getCanvas("pattern-workaround",ht,P),z=j.context,X=O?Math.floor(E/h):0,et=H?Math.floor(_/f):0;for(let wt=0;wt<=X;wt++)for(let Ct=0;Ct<=et;Ct++)z.drawImage(St,ht*wt,P*Ct,ht,P,0,0,ht,P);return{canvas:j.canvas,scaleX:kt.scale,scaleY:G.scale,offsetX:p,offsetY:m}}return{canvas:Et.canvas,scaleX:ut.scale,scaleY:At.scale,offsetX:p,offsetY:m}}getSizeAndScale(t,e,i){const r=Math.max(up.MAX_PATTERN_SIZE,e);let a=Math.ceil(t*i);return a>=r?a=r:i=a/t,{scale:i,size:a}}clipBbox(t,e,i,r,a){const l=r-e,c=a-i;t.ctx.rect(e,i,l,c),Bt.axialAlignedBoundingBox([e,i,r,a],Ie(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const r=t.ctx,a=t.current;switch(e){case Vv.COLORED:const{fillStyle:l,strokeStyle:c}=this.ctx;r.fillStyle=a.fillColor=l,r.strokeStyle=a.strokeColor=c;break;case Vv.UNCOLORED:r.fillStyle=r.strokeStyle=i,a.fillColor=a.strokeColor=i;break;default:throw new Tw(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,r){let a=i;r!==Ei.SHADING&&(a=Bt.transform(a,e.baseTransform),this.matrix&&(a=Bt.transform(a,this.matrix)));const l=this.createPatternCanvas(e);let c=new DOMMatrix(a);c=c.translate(l.offsetX,l.offsetY),c=c.scale(1/l.scaleX,1/l.scaleY);const h=t.createPattern(l.canvas,"repeat");return h.setTransform(c),h}}function cS({src:n,srcPos:t=0,dest:e,width:i,height:r,nonBlackColor:a=4294967295,inverseDecode:l=!1}){const c=wi.isLittleEndian?4278190080:255,[h,f]=l?[a,c]:[c,a],p=i>>3,m=i&7,v=n.length;e=new Uint32Array(e.buffer);let x=0;for(let E=0;E<r;E++){for(const b=t+p;t<b;t++){const A=t<v?n[t]:255;e[x++]=A&128?f:h,e[x++]=A&64?f:h,e[x++]=A&32?f:h,e[x++]=A&16?f:h,e[x++]=A&8?f:h,e[x++]=A&4?f:h,e[x++]=A&2?f:h,e[x++]=A&1?f:h}if(m===0)continue;const _=t<v?n[t++]:255;for(let b=0;b<m;b++)e[x++]=_&1<<7-b?f:h}return{srcPos:t,destPos:x}}const Gv=16,Wv=100,uS=15,Xv=10,qi=16,u0=new DOMMatrix,un=new Float32Array(2),oo=new Float32Array([1/0,1/0,-1/0,-1/0]);function hS(n,t){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){t.save(),this.__originalSave()},n.restore=function(){t.restore(),this.__originalRestore()},n.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},n.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},n.transform=function(e,i,r,a,l,c){t.transform(e,i,r,a,l,c),this.__originalTransform(e,i,r,a,l,c)},n.setTransform=function(e,i,r,a,l,c){t.setTransform(e,i,r,a,l,c),this.__originalSetTransform(e,i,r,a,l,c)},n.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},n.rotate=function(e){t.rotate(e),this.__originalRotate(e)},n.clip=function(e){t.clip(e),this.__originalClip(e)},n.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},n.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},n.bezierCurveTo=function(e,i,r,a,l,c){t.bezierCurveTo(e,i,r,a,l,c),this.__originalBezierCurveTo(e,i,r,a,l,c)},n.rect=function(e,i,r,a){t.rect(e,i,r,a),this.__originalRect(e,i,r,a)},n.closePath=function(){t.closePath(),this.__originalClosePath()},n.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class fS{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,e,i)):(r=this.canvasFactory.create(e,i),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Hu(n,t,e,i,r,a,l,c,h,f){const[p,m,v,x,E,_]=Ie(n);if(m===0&&v===0){const T=l*p+E,S=Math.round(T),C=c*x+_,N=Math.round(C),B=(l+h)*p+E,O=Math.abs(Math.round(B)-S)||1,H=(c+f)*x+_,M=Math.abs(Math.round(H)-N)||1;return n.setTransform(Math.sign(p),0,0,Math.sign(x),S,N),n.drawImage(t,e,i,r,a,0,0,O,M),n.setTransform(p,m,v,x,E,_),[O,M]}if(p===0&&x===0){const T=c*v+E,S=Math.round(T),C=l*m+_,N=Math.round(C),B=(c+f)*v+E,O=Math.abs(Math.round(B)-S)||1,H=(l+h)*m+_,M=Math.abs(Math.round(H)-N)||1;return n.setTransform(0,Math.sign(m),Math.sign(v),0,S,N),n.drawImage(t,e,i,r,a,0,0,M,O),n.setTransform(p,m,v,x,E,_),[M,O]}n.drawImage(t,e,i,r,a,l,c,h,f);const b=Math.hypot(p,m),A=Math.hypot(v,x);return[b*h,A*f]}class Yv{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=D0;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=xi.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=oo.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Ei.FILL,e=null){const i=this.minMax.slice();if(t===Ei.STROKE){e||De("Stroke bounding box must include transform."),Bt.singularValueDecompose2dScale(e,un);const r=un[0]*this.lineWidth/2,a=un[1]*this.lineWidth/2;i[0]-=r,i[1]-=a,i[2]+=r,i[3]+=a}return i}updateClipFromPath(){const t=Bt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(oo,0)}getClippedPathBoundingBox(t=Ei.FILL,e=null){return Bt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function $v(n,t){if(t instanceof ImageData){n.putImageData(t,0,0);return}const e=t.height,i=t.width,r=e%qi,a=(e-r)/qi,l=r===0?a:a+1,c=n.createImageData(i,qi);let h=0,f;const p=t.data,m=c.data;let v,x,E,_;if(t.kind===nh.GRAYSCALE_1BPP){const b=p.byteLength,A=new Uint32Array(m.buffer,0,m.byteLength>>2),T=A.length,S=i+7>>3,C=4294967295,N=wi.isLittleEndian?4278190080:255;for(v=0;v<l;v++){for(E=v<a?qi:r,f=0,x=0;x<E;x++){const B=b-h;let O=0;const H=B>S?i:B*8-7,M=H&-8;let W=0,Y=0;for(;O<M;O+=8)Y=p[h++],A[f++]=Y&128?C:N,A[f++]=Y&64?C:N,A[f++]=Y&32?C:N,A[f++]=Y&16?C:N,A[f++]=Y&8?C:N,A[f++]=Y&4?C:N,A[f++]=Y&2?C:N,A[f++]=Y&1?C:N;for(;O<H;O++)W===0&&(Y=p[h++],W=128),A[f++]=Y&W?C:N,W>>=1}for(;f<T;)A[f++]=0;n.putImageData(c,0,v*qi)}}else if(t.kind===nh.RGBA_32BPP){for(x=0,_=i*qi*4,v=0;v<a;v++)m.set(p.subarray(h,h+_)),h+=_,n.putImageData(c,0,x),x+=qi;v<l&&(_=i*r*4,m.set(p.subarray(h,h+_)),n.putImageData(c,0,x))}else if(t.kind===nh.RGB_24BPP)for(E=qi,_=i*E,v=0;v<l;v++){for(v>=a&&(E=r,_=i*E),f=0,x=_;x--;)m[f++]=p[h++],m[f++]=p[h++],m[f++]=p[h++],m[f++]=255;n.putImageData(c,0,v*qi)}else throw new Error(`bad image kind: ${t.kind}`)}function qv(n,t){if(t.bitmap){n.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,r=e%qi,a=(e-r)/qi,l=r===0?a:a+1,c=n.createImageData(i,qi);let h=0;const f=t.data,p=c.data;for(let m=0;m<l;m++){const v=m<a?qi:r;({srcPos:h}=cS({src:f,srcPos:h,dest:p,width:i,height:v,nonBlackColor:0})),n.putImageData(c,0,m*qi)}}function Rl(n,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)n[i]!==void 0&&(t[i]=n[i]);n.setLineDash!==void 0&&(t.setLineDash(n.getLineDash()),t.lineDashOffset=n.lineDashOffset)}function ju(n){n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0);const{filter:t}=n;t!=="none"&&t!==""&&(n.filter="none")}function Kv(n,t){if(t)return!0;Bt.singularValueDecompose2dScale(n,un);const e=Math.fround(na.pixelRatio*Eo.PDF_TO_CSS_UNITS);return un[0]<=e&&un[1]<=e}const dS=["butt","round","square"],pS=["miter","round","bevel"],gS={},Qv={};class uo{constructor(t,e,i,r,a,{optionalContentConfig:l,markedContentStack:c=null},h,f,p){this.ctx=t,this.current=new Yv(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=r,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new fS(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:r=null}){const a=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,a,l),this.ctx.fillStyle=c,i){const h=this.cachedCanvases.getCanvas("transparent",a,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Ie(this.compositeCtx))}this.ctx.save(),ju(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Ie(this.ctx)}executeOperatorList(t,e,i,r,a){const l=t.argsArray,c=t.fnArray;let h=e||0;const f=l.length;if(f===h)return h;const p=f-h>Xv&&typeof i=="function",m=p?Date.now()+uS:0;let v=0;const x=this.commonObjs,E=this.objs;let _,b;for(;;){if(r!==void 0&&h===r.nextBreakPoint)return r.breakIt(h,i),h;if(!a||a.has(h))if(_=c[h],b=l[h]??null,_!==$l.dependency)b===null?this[_](h):this[_](h,...b);else for(const A of b){this.dependencyTracker?.recordNamedData(A,h);const T=A.startsWith("g_")?x:E;if(!T.has(A))return T.get(A,i),h}if(h++,h===f)return h;if(p&&++v>Xv){if(Date.now()>m)return i(),h;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,r=t.height??t.displayHeight;let a=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),c=i,h=r,f="prescale1",p,m;for(;a>2&&c>1||l>2&&h>1;){let v=c,x=h;a>2&&c>1&&(v=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),a/=c/v),l>2&&h>1&&(x=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/x),p=this.cachedCanvases.getCanvas(f,v,x),m=p.context,m.clearRect(0,0,v,x),m.drawImage(t,0,0,c,h,0,0,v,x),t=p.canvas,c=v,h=x,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:c,paintHeight:h}}_createMaskCanvas(t,e){const i=this.ctx,{width:r,height:a}=e,l=this.current.fillColor,c=this.current.patternFill,h=Ie(i);let f,p,m,v;if((e.bitmap||e.data)&&e.count>1){const W=e.bitmap||e.data.buffer;p=JSON.stringify(c?h:[h.slice(0,4),l]),f=this._cachedBitmapsMap.get(W),f||(f=new Map,this._cachedBitmapsMap.set(W,f));const Y=f.get(p);if(Y&&!c){const J=Math.round(Math.min(h[0],h[2])+h[4]),ut=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,Cn.transformAndFill),{canvas:Y,offsetX:J,offsetY:ut}}m=Y}m||(v=this.cachedCanvases.getCanvas("maskCanvas",r,a),qv(v.context,e));let x=Bt.transform(h,[1/r,0,0,-1/a,0,0]);x=Bt.transform(x,[1,0,0,1,0,-a]);const E=oo.slice();Bt.axialAlignedBoundingBox([0,0,r,a],x,E);const[_,b,A,T]=E,S=Math.round(A-_)||1,C=Math.round(T-b)||1,N=this.cachedCanvases.getCanvas("fillCanvas",S,C),B=N.context,O=_,H=b;B.translate(-O,-H),B.transform(...x),m||(m=this._scaleImage(v.canvas,ir(B)),m=m.img,f&&c&&f.set(p,m)),B.imageSmoothingEnabled=Kv(Ie(B),e.interpolate),Hu(B,m,0,0,m.width,m.height,0,0,r,a),B.globalCompositeOperation="source-in";const M=Bt.transform(ir(B),[1,0,0,1,-O,-H]);return B.fillStyle=c?l.getPattern(i,this,M,Ei.FILL):l,B.fillRect(0,0,r,a),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,N.canvas)),this.dependencyTracker?.recordDependencies(t,Cn.transformAndFill),{canvas:N.canvas,offsetX:Math.round(O),offsetY:Math.round(H)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=dS[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=pS[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(e),r.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,r]of e)switch(i){case"LW":this.setLineWidth(t,r);break;case"LC":this.setLineCap(t,r);break;case"LJ":this.setLineJoin(t,r);break;case"ML":this.setMiterLimit(t,r);break;case"D":this.setDash(t,r[0],r[1]);break;case"RI":this.setRenderingIntent(t,r);break;case"FL":this.setFlatness(t,r);break;case"Font":this.setFont(t,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(r,e,i);this.suspendedCtx=this.ctx;const l=this.ctx=a.context;l.setTransform(this.suspendedCtx.getTransform()),Rl(this.suspendedCtx,l),hS(l,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Rl(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,r){const a=r[0],l=r[1],c=r[2]-a,h=r[3]-l;c===0||h===0||(this.genericComposeSMask(e.context,i,c,h,e.subtype,e.backdrop,e.transferMap,a,l,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,r,a,l,c,h,f,p,m){let v=t.canvas,x=h-p,E=f-m;if(l)if(x<0||E<0||x+i>v.width||E+r>v.height){const b=this.cachedCanvases.getCanvas("maskExtension",i,r),A=b.context;A.drawImage(v,-x,-E),A.globalCompositeOperation="destination-atop",A.fillStyle=l,A.fillRect(0,0,i,r),A.globalCompositeOperation="source-over",v=b.canvas,x=E=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(x,E,i,r),t.clip(b),t.globalCompositeOperation="destination-atop",t.fillStyle=l,t.fillRect(x,E,i,r),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),a==="Alpha"&&c?e.filter=this.filterFactory.addAlphaFilter(c):a==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(c));const _=new Path2D;_.rect(h,f,i,r),e.clip(_),e.globalCompositeOperation="destination-in",e.drawImage(v,x,E,i,r,h,f,i,r),e.restore()}save(t){this.inSMaskMode&&Rl(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Rl(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,r,a,l,c){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,r,a,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,r){let[a]=i;if(!r){a||=i[0]=new Path2D,this[e](t,a);return}if(this.dependencyTracker!==null){const l=e===$l.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,r[0]-l,r[2]+l,r[1]-l,r[3]+l).recordDependencies(t,["transform"])}if(!(a instanceof Path2D)){const l=i[0]=new Path2D;for(let c=0,h=a.length;c<h;)switch(a[c++]){case Fu.moveTo:l.moveTo(a[c++],a[c++]);break;case Fu.lineTo:l.lineTo(a[c++],a[c++]);break;case Fu.curveTo:l.bezierCurveTo(a[c++],a[c++],a[c++],a[c++],a[c++],a[c++]);break;case Fu.closePath:l.closePath();break;default:qt(`Unrecognized drawing path operator: ${a[c-1]}`);break}a=l}Bt.axialAlignedBoundingBox(r,Ie(this.ctx),this.current.minMax),this[e](t,a),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const r=this.ctx,a=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const l=a.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=a.getPattern(r,this,ir(r),Ei.STROKE),l){const c=new Path2D;c.addPath(e,r.getTransform().invertSelf().multiplySelf(l)),e=c}this.rescaleAndStroke(e,!1),r.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,Cn.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Ei.STROKE,Ie(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const r=this.ctx,a=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const f=a.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(t),r.save(),r.fillStyle=a.getPattern(r,this,ir(r),Ei.FILL),f){const p=new Path2D;p.addPath(e,r.getTransform().invertSelf().multiplySelf(f)),e=p}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(r.fill(e,"evenodd"),this.pendingEOFill=!1):r.fill(e)),this.dependencyTracker?.recordDependencies(t,Cn.fill),c&&(r.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,h)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,Cn.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=gS}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=Qv}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;e!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",t),r.recordCloseMarker(t)}if(e!==void 0){const r=new Path2D,a=i.getTransform().invertSelf();for(const{transform:l,x:c,y:h,fontSize:f,path:p}of e)p&&r.addPath(p,new DOMMatrix(l).preMultiplySelf(a).translate(c,h).scale(f,-f));i.clip(r)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordNamedDependency(t,e);const r=this.commonObjs.get(e),a=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(a.fontMatrix=r.fontMatrix||D0,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&qt("Invalid font matrix for font "+e),i<0?(i=-i,a.fontDirection=-1):a.fontDirection=1,this.current.font=r,this.current.fontSize=i,r.isType3Font)return;const l=r.loadedName||"sans-serif",c=r.systemFontInfo?.css||`"${l}", ${r.fallbackName}`;let h="normal";r.black?h="900":r.bold&&(h="bold");const f=r.italic?"italic":"normal";let p=i;i<Gv?p=Gv:i>Wv&&(p=Wv),this.current.fontSizeScale=i/p,this.ctx.font=`${f} ${h} ${p}px ${c}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,i){const r=new Path2D;return r.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),r}paintChar(t,e,i,r,a,l){const c=this.ctx,h=this.current,f=h.font,p=h.textRenderingMode,m=h.fontSize/h.fontSizeScale,v=p&xi.FILL_STROKE_MASK,x=!!(p&xi.ADD_TO_PATH_FLAG),E=h.patternFill&&!f.missingFile,_=h.patternStroke&&!f.missingFile;let b;if((f.disableFontFace||x||E||_)&&!f.missingFile&&(b=f.getPathGenerator(this.commonObjs,e)),b&&(f.disableFontFace||E||_)){c.save(),c.translate(i,r),c.scale(m,-m),this.dependencyTracker?.recordCharacterBBox(t,c,f);let A;if(v===xi.FILL||v===xi.FILL_STROKE)if(a){A=c.getTransform(),c.setTransform(...a);const T=this.#i(b,A,a);c.fill(T)}else c.fill(b);if(v===xi.STROKE||v===xi.FILL_STROKE)if(l){A||=c.getTransform(),c.setTransform(...l);const{a:T,b:S,c:C,d:N}=A,B=Bt.inverseTransform(l),O=Bt.transform([T,S,C,N,0,0],B);Bt.singularValueDecompose2dScale(O,un),c.lineWidth*=Math.max(un[0],un[1])/m,c.stroke(this.#i(b,A,l))}else c.lineWidth/=m,c.stroke(b);c.restore()}else(v===xi.FILL||v===xi.FILL_STROKE)&&(c.fillText(e,i,r),this.dependencyTracker?.recordCharacterBBox(t,c,f,m,i,r,()=>c.measureText(e))),(v===xi.STROKE||v===xi.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,c,f,m,i,r,()=>c.measureText(e)).recordDependencies(t,Cn.stroke),c.strokeText(e,i,r));x&&((this.pendingTextPaths||=[]).push({transform:Ie(c),x:i,y:r,fontSize:m,path:b}),this.dependencyTracker?.recordCharacterBBox(t,c,f,m,i,r))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<e.length;r+=4)if(e[r]>0&&e[r]<255){i=!0;break}return ee(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Cn.showText).copyDependenciesFromIncrementalOperation(t,"sameLineText").resetBBox(t),this.current.textRenderingMode&xi.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,r=i.font;if(r.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordOperation(t).recordIncrementalData("sameLineText",t);return}const a=i.fontSize;if(a===0){this.dependencyTracker?.recordOperation(t);return}const l=this.ctx,c=i.fontSizeScale,h=i.charSpacing,f=i.wordSpacing,p=i.fontDirection,m=i.textHScale*p,v=e.length,x=r.vertical,E=x?1:-1,_=r.defaultVMetrics,b=a*i.fontMatrix[0],A=i.textRenderingMode===xi.FILL&&!r.disableFontFace&&!i.patternFill;l.save(),i.textMatrix&&l.transform(...i.textMatrix),l.translate(i.x,i.y+i.textRise),p>0?l.scale(m,-1):l.scale(m,1);let T,S;if(i.patternFill){l.save();const H=i.fillColor.getPattern(l,this,ir(l),Ei.FILL);T=Ie(l),l.restore(),l.fillStyle=H}if(i.patternStroke){l.save();const H=i.strokeColor.getPattern(l,this,ir(l),Ei.STROKE);S=Ie(l),l.restore(),l.strokeStyle=H}let C=i.lineWidth;const N=i.textMatrixScale;if(N===0||C===0){const H=i.textRenderingMode&xi.FILL_STROKE_MASK;(H===xi.STROKE||H===xi.FILL_STROKE)&&(C=this.getSinglePixelWidth())}else C/=N;if(c!==1&&(l.scale(c,c),C/=c),l.lineWidth=C,r.isInvalidPDFjsFont){const H=[];let M=0;for(const Y of e)H.push(Y.unicode),M+=Y.width;const W=H.join("");if(l.fillText(W,0,0),this.dependencyTracker!==null){const Y=l.measureText(W);this.dependencyTracker.recordBBox(t,this.ctx,-Y.actualBoundingBoxLeft,Y.actualBoundingBoxRight,-Y.actualBoundingBoxAscent,Y.actualBoundingBoxDescent).recordOperation(t).recordIncrementalData("sameLineText",t)}i.x+=M*b*m,l.restore(),this.compose();return}let B=0,O;for(O=0;O<v;++O){const H=e[O];if(typeof H=="number"){B+=E*H*a/1e3;continue}let M=!1;const W=(H.isSpace?f:0)+h,Y=H.fontChar,J=H.accent;let ut,At,Et=H.width;if(x){const St=H.vmetric||_,kt=-(H.vmetric?St[1]:Et*.5)*b,G=St[2]*b;Et=St?-St[0]:Et,ut=kt/c,At=(B+G)/c}else ut=B/c,At=0;let q;if(r.remeasure&&Et>0){q=l.measureText(Y);const St=q.width*1e3/a*c;if(Et<St&&this.isFontSubpixelAAEnabled){const kt=Et/St;M=!0,l.save(),l.scale(kt,1),ut/=kt}else Et!==St&&(ut+=(Et-St)/2e3*a/c)}if(this.contentVisible&&(H.isInFont||r.missingFile)){if(A&&!J)l.fillText(Y,ut,At),this.dependencyTracker?.recordCharacterBBox(t,l,q?{bbox:null}:r,a/c,ut,At,()=>q??l.measureText(Y));else if(this.paintChar(t,Y,ut,At,T,S),J){const St=ut+a*J.offset.x/c,kt=At-a*J.offset.y/c;this.paintChar(t,J.fontChar,St,kt,T,S)}}const nt=x?Et*b-W*p:Et*b+W*p;B+=nt,M&&l.restore()}x?i.y-=B:i.x+=B*m,l.restore(),this.compose(),this.dependencyTracker?.recordOperation(t).recordIncrementalData("sameLineText",t)}showType3Text(t,e){const i=this.ctx,r=this.current,a=r.font,l=r.fontSize,c=r.fontDirection,h=a.vertical?1:-1,f=r.charSpacing,p=r.wordSpacing,m=r.textHScale*c,v=r.fontMatrix||D0,x=e.length,E=r.textRenderingMode===xi.INVISIBLE;let _,b,A,T;if(E||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),r.textMatrix&&i.transform(...r.textMatrix),i.translate(r.x,r.y+r.textRise),i.scale(m,c);const S=this.dependencyTracker;for(this.dependencyTracker=S?new ch(S,t):null,_=0;_<x;++_){if(b=e[_],typeof b=="number"){T=h*b*l/1e3,this.ctx.translate(T,0),r.x+=T*m;continue}const C=(b.isSpace?p:0)+f,N=a.charProcOperatorList[b.operatorListId];N?this.contentVisible&&(this.save(),i.scale(l,l),i.transform(...v),this.executeOperatorList(N),this.restore()):qt(`Type3 character "${b.operatorListId}" is not available.`);const B=[b.width,0];Bt.applyTransform(B,v),A=B[0]*l+C,i.translate(A,0),r.x+=A*m}i.restore(),S&&(this.dependencyTracker.recordNestedDependencies(),this.dependencyTracker=S)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,r,a,l,c){const h=new Path2D;h.rect(r,a,l-r,c-a),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,r,l,a,c).recordClipBox(t,this.ctx,r,l,a,c),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const r=this.baseTransform||Ie(this.ctx),a={createCanvasGraphics:l=>new uo(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new ch(this.dependencyTracker,t):null)};i=new up(e,this.ctx,a,r)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let r;return this.cachedPatterns.has(e)?r=this.cachedPatterns.get(e):(r=lS(this.getObject(t,e)),this.cachedPatterns.set(e,r)),i&&(r.matrix=i),r}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const r=this._getPattern(t,e);i.fillStyle=r.getPattern(i,this,ir(i),Ei.SHADING);const a=ir(i);if(a){const{width:l,height:c}=i.canvas,h=oo.slice();Bt.axialAlignedBoundingBox([0,0,l,c],a,h);const[f,p,m,v]=h;this.ctx.fillRect(f,p,m-f,v-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Cn.transform).recordDependencies(t,Cn.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){De("Should not call beginInlineImage")}beginImageData(){De("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=Ie(this.ctx),i)){Bt.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[r,a,l,c]=i,h=new Path2D;h.rect(r,a,l-r,c-a),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,r,l,a,c),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||Nh("TODO: Support non-isolated groups."),e.knockout&&qt("Knockout groups not supported.");const r=Ie(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let a=oo.slice();Bt.axialAlignedBoundingBox(e.bbox,Ie(i),a);const l=[0,0,i.canvas.width,i.canvas.height];a=Bt.intersect(a,l)||[0,0,0,0];const c=Math.floor(a[0]),h=Math.floor(a[1]),f=Math.max(Math.ceil(a[2])-c,1),p=Math.max(Math.ceil(a[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,p]);let m="groupAt"+this.groupLevel;e.smask&&(m+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(m,f,p),x=v.context;x.translate(-c,-h),x.transform(...r);let E=new Path2D;const[_,b,A,T]=e.bbox;if(E.rect(_,b,A-_,T-b),e.matrix){const S=new Path2D;S.addPath(E,new DOMMatrix(e.matrix)),E=S}x.clip(E),e.smask&&this.smaskStack.push({canvas:v.canvas,context:x,offsetX:c,offsetY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(c,h),i.save()),Rl(i,x),this.ctx=x,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=Ie(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...a);const l=oo.slice();Bt.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],a,l),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(t,e,i,r,a,l){if(this.#t(),ju(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const c=i[2]-i[0],h=i[3]-i[1];if(l&&this.annotationCanvasMap){r=r.slice(),r[4]-=i[0],r[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=c,i[3]=h,Bt.singularValueDecompose2dScale(Ie(this.ctx),un);const{viewportScale:f}=this,p=Math.ceil(c*this.outputScaleX*f),m=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,m);const{canvas:v,context:x}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=x,this.ctx.save(),this.ctx.setTransform(un[0],0,0,-un[1],0,h*un[1]),ju(this.ctx)}else{ju(this.ctx),this.endPath(t);const f=new Path2D;f.rect(i[0],i[1],c,h),this.ctx.clip(f)}}this.current=new Yv(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...r),this.transform(t,...a)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const r=this.ctx,a=this._createMaskCanvas(t,e),l=a.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(l,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,a.offsetX,a.offsetX+l.width,a.offsetY,a.offsetY+l.height).recordOperation(t),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,r=0,a=0,l,c){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const h=this.ctx;h.save();const f=Ie(h);h.transform(i,r,a,l,0,0);const p=this._createMaskCanvas(t,e);h.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let m=0,v=c.length;m<v;m+=2){const x=Bt.transform(f,[i,r,a,l,c[m],c[m+1]]);h.drawImage(p.canvas,x[4],x[5]),this.dependencyTracker?.recordBBox(t,this.ctx,x[4],x[4]+p.canvas.width,x[5],x[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,r=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Cn.transformAndFill);for(const l of e){const{data:c,width:h,height:f,transform:p}=l,m=this.cachedCanvases.getCanvas("maskCanvas",h,f),v=m.context;v.save();const x=this.getObject(t,c,l);qv(v,x),v.globalCompositeOperation="source-in",v.fillStyle=a?r.getPattern(v,this,ir(i),Ei.FILL):r,v.fillRect(0,0,h,f),v.restore(),i.save(),i.transform(...p),i.scale(1,-1),Hu(i,m.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,h,0,f),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){qt("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,r,a){if(!this.contentVisible)return;const l=this.getObject(t,e);if(!l){qt("Dependent image isn't ready yet");return}const c=l.width,h=l.height,f=[];for(let p=0,m=a.length;p<m;p+=2)f.push({transform:[i,0,0,r,a[p],a[p+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(t,l,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:r}=t,a=this.cachedCanvases.getCanvas("inlineImage",i,r),l=a.context;return l.filter=this.current.transferMaps,l.drawImage(e,0,0),l.filter="none",a.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,r=e.height,a=this.ctx;this.save(t);const{filter:l}=a;l!=="none"&&l!==""&&(a.filter="none"),a.scale(1/i,-1/r);let c;if(e.bitmap)c=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)c=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",i,r).context;$v(p,e),c=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(c,ir(a));a.imageSmoothingEnabled=Kv(Ie(a),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,a,0,i,-r,0).recordDependencies(t,Cn.imageXObject).recordOperation(t),Hu(a,h.img,0,0,h.paintWidth,h.paintHeight,0,-r,i,r),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const r=this.ctx;let a;if(e.bitmap)a=e.bitmap;else{const l=e.width,c=e.height,f=this.cachedCanvases.getCanvas("inlineImage",l,c).context;$v(f,e),a=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const l of i)r.save(),r.transform(...l.transform),r.scale(1,-1),Hu(r,a,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Cn.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const a=this.ctx;this.pendingClip?(r||(this.pendingClip===Qv?a.clip(e,"evenodd"):a.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Ie(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,r)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:r,d:a}=this.ctx.getTransform();let l,c;if(i===0&&r===0){const h=Math.abs(e),f=Math.abs(a);if(h===f)if(t===0)l=c=1/h;else{const p=h*t;l=c=p<1?1/p:1}else if(t===0)l=1/h,c=1/f;else{const p=h*t,m=f*t;l=p<1?1/p:1,c=m<1?1/m:1}}else{const h=Math.abs(e*a-i*r),f=Math.hypot(e,i),p=Math.hypot(r,a);if(t===0)l=p/h,c=f/h;else{const m=t*h;l=p>m?p/m:1,c=f>m?f/m:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:r}}=this,[a,l]=this.getScaleForStroking();if(a===l){i.lineWidth=(r||1)*a,i.stroke(t);return}const c=i.getLineDash();e&&i.save(),i.scale(a,l),u0.a=1/a,u0.d=1/l;const h=new Path2D;if(h.addPath(t,u0),c.length>0){const f=Math.max(a,l);i.setLineDash(c.map(p=>p/f)),i.lineDashOffset/=f}i.lineWidth=r||1,i.stroke(h),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const n in $l)uo.prototype[n]!==void 0&&(uo.prototype[$l[n]]=uo.prototype[n]);let ho=class{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}};class mS{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const ro=Symbol("INTERNAL");class vS{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:i,usage:r,rbGroups:a}){this.#t=!!(t&ln.DISPLAY),this.#e=!!(t&ln.PRINT),this.name=e,this.intent=i,this.usage=r,this.rbGroups=a}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==ro&&De("Internal method `_setVisible` called."),this.#i=i,this.#n=e}}class xS{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=ln.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const i of t.groups)this.#e.set(i.id,new vS(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(ro,!1);for(const i of t.on)this.#e.get(i)._setVisible(ro,!0);for(const i of t.off)this.#e.get(i)._setVisible(ro,!1);this.#i=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let r=1;r<e;r++){const a=t[r];let l;if(Array.isArray(a))l=this.#s(a);else if(this.#e.has(a))l=this.#e.get(a).visible;else return qt(`Optional content group not found: ${a}`),!0;switch(i){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Nh("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(qt(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return qt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return qt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return qt(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return qt(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return qt(`Unknown optional content policy ${t.policy}.`),!0}return qt(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const r=this.#e.get(t);if(!r){qt(`Optional content group not found: ${t}`);return}if(i&&e&&r.rbGroups.length)for(const a of r.rbGroups)for(const l of a)l!==t&&this.#e.get(l)?._setVisible(ro,!1,!0);r._setVisible(ro,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":i=r;continue}const a=this.#e.get(r);if(a)switch(i){case"ON":this.setVisibility(r,!0,e);break;case"OFF":this.setVisibility(r,!1,e);break;case"Toggle":this.setVisibility(r,!a.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Ny;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class yS{constructor(t,{disableRange:e=!1,disableStream:i=!1}){Ze(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:r,initialData:a,progressiveDone:l,contentDispositionFilename:c}=t;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,a?.length>0){const h=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),t.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.some(function(a){return a._begin!==t?!1:(a._enqueue(i),!0)});Ze(r,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){Ze(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new _S(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new ES(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class _S{constructor(t,e,i=!1,r=null){this._stream=t,this._done=i||!1,this._filename=rp(r)?r:null,this._queuedChunks=e||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class ES{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function bS(n){let t=!0,e=i("filename\\*","i").exec(n);if(e){e=e[1];let p=c(e);return p=unescape(p),p=h(p),p=f(p),a(p)}if(e=l(n),e){const p=f(e);return a(p)}if(e=i("filename","i").exec(n),e){e=e[1];let p=c(e);return p=f(p),a(p)}function i(p,m){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',m)}function r(p,m){if(p){if(!/^[\x00-\xFF]+$/.test(m))return m;try{const v=new TextDecoder(p,{fatal:!0}),x=lc(m);m=v.decode(x),t=!1}catch{}}return m}function a(p){return t&&/[\x80-\xff]/.test(p)&&(p=r("utf-8",p),t&&(p=r("iso-8859-1",p))),p}function l(p){const m=[];let v;const x=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=x.exec(p))!==null;){let[,_,b,A]=v;if(_=parseInt(_,10),_ in m){if(_===0)break;continue}m[_]=[b,A]}const E=[];for(let _=0;_<m.length&&_ in m;++_){let[b,A]=m[_];A=c(A),b&&(A=unescape(A),_===0&&(A=h(A))),E.push(A)}return E.join("")}function c(p){if(p.startsWith('"')){const m=p.slice(1).split('\\"');for(let v=0;v<m.length;++v){const x=m[v].indexOf('"');x!==-1&&(m[v]=m[v].slice(0,x),m.length=v+1),m[v]=m[v].replaceAll(/\\(.)/g,"$1")}p=m.join('"')}return p}function h(p){const m=p.indexOf("'");if(m===-1)return p;const v=p.slice(0,m),E=p.slice(m+1).replace(/^[^']*'/,"");return r(v,E)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(m,v,x,E){if(x==="q"||x==="Q")return E=E.replaceAll("_"," "),E=E.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,b){return String.fromCharCode(parseInt(b,16))}),r(v,E);try{E=atob(E)}catch{}return r(v,E)})}return""}function By(n,t){const e=new Headers;if(!n||!t||typeof t!="object")return e;for(const i in t){const r=t[i];r!==void 0&&e.append(i,r)}return e}function Ph(n){return URL.parse(n)?.origin??null}function Uy({responseHeaders:n,isHttp:t,rangeChunkSize:e,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(n.get("Content-Length"),10);return!Number.isInteger(a)||(r.suggestedLength=a,a<=2*e)||i||!t||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function Hy(n){const t=n.get("Content-Disposition");if(t){let e=bS(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(rp(e))return e}return null}function fc(n,t){return new lh(`Unexpected server response (${n}) while retrieving PDF "${t}".`,n,n===404||n===0&&t.startsWith("file:"))}function jy(n){return n===200||n===206}function zy(n,t,e){return{method:"GET",headers:n,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Vy(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(qt(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class AS{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=By(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ze(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new wS(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new SS(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class wS{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),r=e.url;fetch(r,zy(i,this._withCredentials,this._abortController)).then(a=>{if(t._responseOrigin=Ph(a.url),!jy(a.status))throw fc(a.status,r);this._reader=a.body.getReader(),this._headersCapability.resolve();const l=a.headers,{allowRangeRequests:c,suggestedLength:h}=Uy({responseHeaders:l,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=Hy(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new _s("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Vy(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class SS{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const r=t.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;const a=new Headers(t.headers);a.append("Range",`bytes=${e}-${i-1}`);const l=r.url;fetch(l,zy(a,this._withCredentials,this._abortController)).then(c=>{const h=Ph(c.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!jy(c.status))throw fc(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Vy(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const h0=200,f0=206;function TS(n){const t=n.response;return typeof t!="string"?t:lc(t).buffer}class CS{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=By(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,r=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[a,l]of this.headers)e.setRequestHeader(a,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),r.expectedStatus=f0):r.expectedStatus=h0,e.responseType="arraybuffer",Ze(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),r.onHeadersReceived=t.onHeadersReceived,r.onDone=t.onDone,r.onError=t.onError,r.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const r=i.xhr;if(r.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),r.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],r.status===0&&this.isHttp){i.onError(r.status);return}const a=r.status||h0;if(!(a===h0&&i.expectedStatus===f0)&&a!==i.expectedStatus){i.onError(r.status);return}const c=TS(r);if(a===f0){const h=r.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?i.onDone({begin:parseInt(f[1],10),chunk:c}):(qt('Missing or invalid "Content-Range" header.'),i.onError(0))}else c?i.onDone({begin:0,chunk:c}):i.onError(r.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class RS{constructor(t){this._source=t,this._manager=new CS(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return Ze(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new DS(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new MS(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class DS{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Ph(e.responseURL);const i=e.getAllResponseHeaders(),r=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:l}=Uy({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=Hy(r),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=fc(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class MS{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Ph(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=fc(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const NS=/^[a-z][a-z0-9\-+.]+:/i;function OS(n){if(NS.test(n))return new URL(n);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(n))}class LS{constructor(t){this.source=t,this.url=OS(t.url),Ze(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ze(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new PS(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new kS(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class PS{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(r=>{this._contentLength=r.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},r=>{r.code==="ENOENT"&&(r=fc(0,this._url.href)),this._storedError=r,this._headersCapability.reject(r)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new _s("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class kS{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const r=t.source;this._isStreamingSupported=!r.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Dl=Symbol("INITIAL_DATA");class Gy{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Dl}}get(t,e=null){if(e){const r=this.#e(t);return r.promise.then(()=>e(r.data)),null}const i=this.#t[t];if(!i||i.data===Dl)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==Dl}delete(t){const e=this.#t[t];return!e||e.data===Dl?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Dl&&(yield[t,e])}}}const FS=1e5,Zv=30;let B0=class Rn{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#s=null;#r=null;#a=0;#o=0;#c=null;#l=null;#f=0;#u=0;#d=Object.create(null);#g=[];#p=null;#h=[];#m=new WeakMap;#y=null;static#v=new Map;static#_=new Map;static#E=new WeakMap;static#x=null;static#A=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#p=t;else if(typeof t=="object")this.#p=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#u=i.scale*na.pixelRatio,this.#f=i.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:a,pageX:l,pageY:c}=i.rawDims;this.#y=[1,0,0,-1,-l,c+a],this.#o=r,this.#a=a,Rn.#D(),ia(e,i),this.#t.promise.finally(()=>{Rn.#A.delete(this),this.#r=null,this.#d=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=wi.platform;return ee(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#d,e.styles),this.#T(e.items),t()},this.#t.reject)};return this.#c=this.#p.getReader(),Rn.#A.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*na.pixelRatio,r=t.rotation;if(r!==this.#f&&(e?.(),this.#f=r,ia(this.#l,{rotation:r})),i!==this.#u){e?.(),this.#u=i;const a={div:null,properties:null,ctx:Rn.#M(this.#s)};for(const l of this.#h)a.properties=this.#m.get(l),a.div=l,this.#S(a)}}cancel(){const t=new _s("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#h}get textContentItemsStr(){return this.#g}#T(t){if(this.#i)return;this.#r.ctx??=Rn.#M(this.#s);const e=this.#h,i=this.#g;for(const r of t){if(e.length>FS){qt("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const a=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id&&this.#e.setAttribute("id",`${r.id}`),a.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(r.str),this.#w(r)}}#w(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#h.push(e);const r=Bt.transform(this.#y,t.transform);let a=Math.atan2(r[1],r[0]);const l=this.#d[t.fontName];l.vertical&&(a+=Math.PI/2);let c=this.#n&&l.fontSubstitution||l.fontFamily;c=Rn.fontFamilyMap.get(c)||c;const h=Math.hypot(r[2],r[3]),f=h*Rn.#P(c,l,this.#s);let p,m;a===0?(p=r[4],m=r[5]-f):(p=r[4]+f*Math.sin(a),m=r[5]-f*Math.cos(a));const v="calc(var(--total-scale-factor) *",x=e.style;this.#e===this.#l?(x.left=`${(100*p/this.#o).toFixed(2)}%`,x.top=`${(100*m/this.#a).toFixed(2)}%`):(x.left=`${v}${p.toFixed(2)}px)`,x.top=`${v}${m.toFixed(2)}px)`),x.fontSize=`${v}${(Rn.#x*h).toFixed(2)}px)`,x.fontFamily=c,i.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=l.fontSubstitutionLoadedName||t.fontName),a!==0&&(i.angle=a*(180/Math.PI));let E=!1;if(t.str.length>1)E=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),b=Math.abs(t.transform[3]);_!==b&&Math.max(_,b)/Math.min(_,b)>1.5&&(E=!0)}if(E&&(i.canvasWidth=l.vertical?t.height:t.width),this.#m.set(e,i),this.#r.div=e,this.#r.properties=i,this.#S(this.#r),i.hasText&&this.#e.append(e),i.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#S(t){const{div:e,properties:i,ctx:r}=t,{style:a}=e;let l="";if(Rn.#x>1&&(l=`scale(${1/Rn.#x})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:c}=a,{canvasWidth:h,fontSize:f}=i;Rn.#C(r,f*this.#u,c);const{width:p}=r.measureText(e.textContent);p>0&&(l=`scaleX(${h*this.#u/p}) ${l}`)}i.angle!==0&&(l=`rotate(${i.angle}deg) ${l}`),l.length>0&&(a.transform=l)}static cleanup(){if(!(this.#A.size>0)){this.#v.clear();for(const{canvas:t}of this.#_.values())t.remove();this.#_.clear()}}static#M(t=null){let e=this.#_.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#_.set(t,e),this.#E.set(e,{size:0,family:""})}return e}static#C(t,e,i){const r=this.#E.get(t);e===r.size&&i===r.family||(t.font=`${e}px ${i}`,r.size=e,r.family=i)}static#D(){if(this.#x!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#x=t.getBoundingClientRect().height,t.remove()}static#P(t,e,i){const r=this.#v.get(t);if(r)return r;const a=this.#M(i);a.canvas.width=a.canvas.height=Zv,this.#C(a,Zv,t);const l=a.measureText(""),c=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let f=.8;return c?f=c/(c+h):(wi.platform.isFirefox&&qt("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#v.set(t,f),f}};class Kl{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function r(a){if(!a)return;let l=null;const c=a.name;if(c==="#text")l=a.value;else if(Kl.shouldBuildText(c))a?.attributes?.textContent?l=a.attributes.textContent:a.value&&(l=a.value);else return;if(l!==null&&e.push({str:l}),!!a.children)for(const h of a.children)r(h)}return r(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}const IS=100;function Wy(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const t=new hp,{docId:e}=t,i=n.url?Ww(n.url):null,r=n.data?Xw(n.data):null,a=n.httpHeaders||null,l=n.withCredentials===!0,c=n.password??null,h=n.range instanceof Xy?n.range:null,f=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:2**16;let p=n.worker instanceof U0?n.worker:null;const m=n.verbosity,v=typeof n.docBaseUrl=="string"&&!Oh(n.docBaseUrl)?n.docBaseUrl:null,x=Bu(n.cMapUrl),E=n.cMapPacked!==!1,_=n.CMapReaderFactory||(Fi?tS:Hv),b=Bu(n.iccUrl),A=Bu(n.standardFontDataUrl),T=n.StandardFontDataFactory||(Fi?eS:jv),S=Bu(n.wasmUrl),C=n.WasmFactory||(Fi?iS:zv),N=n.stopAtErrors!==!0,B=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,O=n.isEvalSupported!==!1,H=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Fi,M=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Fi&&(wi.platform.isFirefox||!globalThis.chrome),W=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,Y=typeof n.disableFontFace=="boolean"?n.disableFontFace:Fi,J=n.fontExtraProperties===!0,ut=n.enableXfa===!0,At=n.ownerDocument||globalThis.document,Et=n.disableRange===!0,q=n.disableStream===!0,nt=n.disableAutoFetch===!0,St=n.pdfBug===!0,kt=n.CanvasFactory||(Fi?Jw:Kw),G=n.FilterFactory||(Fi?Zw:Qw),ht=n.enableHWA===!0,P=n.useWasm!==!1,j=h?h.length:n.length??NaN,z=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Fi&&!Y,X=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:!!(_===Hv&&T===jv&&C===zv&&x&&A&&S&&Pl(x,document.baseURI)&&Pl(A,document.baseURI)&&Pl(S,document.baseURI)),et=null;Aw(m);const wt={canvasFactory:new kt({ownerDocument:At,enableHWA:ht}),filterFactory:new G({docId:e,ownerDocument:At}),cMapReaderFactory:X?null:new _({baseUrl:x,isCompressed:E}),standardFontDataFactory:X?null:new T({baseUrl:A}),wasmFactory:X?null:new C({baseUrl:S})};p||(p=U0.create({verbosity:m,port:ho.workerPort}),t._worker=p);const Ct={docId:e,apiVersion:"5.4.149",data:r,password:c,disableAutoFetch:nt,rangeChunkSize:f,length:j,docBaseUrl:v,enableXfa:ut,evaluatorOptions:{maxImageSize:B,disableFontFace:Y,ignoreErrors:N,isEvalSupported:O,isOffscreenCanvasSupported:H,isImageDecoderSupported:M,canvasMaxAreaInBytes:W,fontExtraProperties:J,useSystemFonts:z,useWasm:P,useWorkerFetch:X,cMapUrl:x,iccUrl:b,standardFontDataUrl:A,wasmUrl:S}},pt={ownerDocument:At,pdfBug:St,styleElement:et,loadingParams:{disableAutoFetch:nt,enableXfa:ut}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const yt=p.messageHandler.sendWithPromise("GetDocRequest",Ct,r?[r.buffer]:null);let Ut;if(h)Ut=new yS(h,{disableRange:Et,disableStream:q});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Lt=Pl(i)?AS:Fi?LS:RS;Ut=new Lt({url:i,length:j,httpHeaders:a,withCredentials:l,rangeChunkSize:f,disableRange:Et,disableStream:q})}return yt.then(Lt=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Qt=new kl(e,Lt,p.port),jt=new HS(Qt,t,Ut,pt,wt,ht);t._transport=jt,Qt.send("Ready",null)})}).catch(t._capability.reject),t}class hp{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${hp.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}let Xy=class{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#s=[];constructor(t,e,i=!1,r=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=r}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#s)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#n)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){De("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class BS{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ee(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class US{#t=!1;constructor(t,e,i,r=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=r?new Iv:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new Gy,this._intentStates=new Map,this.destroyed=!1,this.recordedGroups=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:r=0,dontFlip:a=!1}={}){return new uc({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:r,dontFlip:a})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ee(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:r="display",annotationMode:a=gs.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:m=null,isEditing:v=!1,recordOperations:x=!1,filteredOperationIndexes:E=null}){this._stats?.time("Overall");const _=this._transport.getRenderingIntent(r,a,m,v),{renderingIntent:b,cacheKey:A}=_;this.#t=!1,h||=this._transport.getOptionalContentConfig(b);let T=this._intentStates.get(A);T||(T=Object.create(null),this._intentStates.set(A,T)),T.streamReaderCancelTimeout&&(clearTimeout(T.streamReaderCancelTimeout),T.streamReaderCancelTimeout=null);const S=!!(b&ln.PRINT);T.displayReadyCapability||(T.displayReadyCapability=Promise.withResolvers(),T.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(_));const C=!this.recordedGroups&&(x||this._pdfBug&&globalThis.StepperManager?.enabled),N=H=>{if(T.renderTasks.delete(B),C){const M=B.gfx?.dependencyTracker.take();M?(B.stepper?.setOperatorGroups(M),x&&(this.recordedGroups=M)):x&&(this.recordedGroups=[])}S&&(this.#t=!0),this.#e(),H?(B.capability.reject(H),this._abortOperatorList({intentState:T,reason:H instanceof Error?H:new Error(H)})):B.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},B=new lo({callback:N,params:{canvas:e,canvasContext:t,dependencyTracker:C?new nS(e):null,viewport:i,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:T.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,filteredOperationIndexes:E});(T.renderTasks||=new Set).add(B);const O=B.task;return Promise.all([T.displayReadyCapability.promise,h]).then(([H,M])=>{if(this.destroyed){N();return}if(this._stats?.time("Rendering"),!(M.renderingIntent&b))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");B.initializeGraphics({transparency:H,optionalContentConfig:M}),B.operatorListChanged()}).catch(N),O}getOperatorList({intent:t="display",annotationMode:e=gs.ENABLE,printAnnotationStorage:i=null,isEditing:r=!1}={}){function a(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(t,e,i,r,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=a,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Kl.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,r){function a(){l.read().then(function({value:h,done:f}){if(f){i(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),a()},r)}const l=e.getReader(),c={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new Iv),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,r=t.length;i<r;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:r}){const{map:a,transfer:l}=i,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:a,modifiedIds:r},l).getReader(),f=this._intentStates.get(e);f.streamReader=h;const p=()=>{h.read().then(({value:m,done:v})=>{if(v){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(m,f),p())},m=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const v of f.renderTasks)v.operatorListChanged();this.#e()}if(f.displayReadyCapability)f.displayReadyCapability.reject(m);else if(f.opListReadCapability)f.opListReadCapability.reject(m);else throw m}})};p()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof np){let r=IS;e.extraDelay>0&&e.extraDelay<1e3&&(r+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},r);return}}if(t.streamReader.cancel(new _s(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,a]of this._intentStates)if(a===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var ms,Gn,Mr,Zs,Ne,Rh,Js,ta,Hi,rh,Yy,$y,Fl,_o,sh;let U0=(Ne=class{constructor({name:t=null,port:e=null,verbosity:i=ww()}={}){Hn(this,Hi);Hn(this,ms,Promise.withResolvers());Hn(this,Gn,null);Hn(this,Mr,null);Hn(this,Zs,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(xe(Ne,ta).has(e))throw new Error("Cannot use more than one PDFWorker per port.");xe(Ne,ta).set(e,this),er(this,Hi,Yy).call(this,e)}else er(this,Hi,$y).call(this)}get promise(){return xe(this,ms).promise}get port(){return xe(this,Mr)}get messageHandler(){return xe(this,Gn)}destroy(){this.destroyed=!0,xe(this,Zs)?.terminate(),Xi(this,Zs,null),xe(Ne,ta).delete(xe(this,Mr)),Xi(this,Mr,null),xe(this,Gn)?.destroy(),Xi(this,Gn,null)}static create(t){const e=xe(this,ta).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Ne(t)}static get workerSrc(){if(ho.workerSrc)return ho.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ee(this,"_setupFakeWorkerGlobal",(async()=>xe(this,_o,sh)?xe(this,_o,sh):(await import(this.workerSrc)).WorkerMessageHandler)())}},ms=new WeakMap,Gn=new WeakMap,Mr=new WeakMap,Zs=new WeakMap,Rh=new WeakMap,Js=new WeakMap,ta=new WeakMap,Hi=new WeakSet,rh=function(){xe(this,ms).resolve(),xe(this,Gn).send("configure",{verbosity:this.verbosity})},Yy=function(t){Xi(this,Mr,t),Xi(this,Gn,new kl("main","worker",t)),xe(this,Gn).on("ready",()=>{}),er(this,Hi,rh).call(this)},$y=function(){if(xe(Ne,Js)||xe(Ne,_o,sh)){er(this,Hi,Fl).call(this);return}let{workerSrc:t}=Ne;try{Ne._isSameOrigin(window.location,t)||(t=Ne._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new kl("main","worker",e),r=()=>{a.abort(),i.destroy(),e.terminate(),this.destroyed?xe(this,ms).reject(new Error("Worker was destroyed")):er(this,Hi,Fl).call(this)},a=new AbortController;e.addEventListener("error",()=>{xe(this,Zs)||r()},{signal:a.signal}),i.on("test",c=>{if(a.abort(),this.destroyed||!c){r();return}Xi(this,Gn,i),Xi(this,Mr,e),Xi(this,Zs,e),er(this,Hi,rh).call(this)}),i.on("ready",c=>{if(a.abort(),this.destroyed){r();return}try{l()}catch{er(this,Hi,Fl).call(this)}});const l=()=>{const c=new Uint8Array;i.send("test",c,[c.buffer])};l();return}catch{Nh("The worker has been disabled.")}er(this,Hi,Fl).call(this)},Fl=function(){xe(Ne,Js)||(qt("Setting up fake worker."),Xi(Ne,Js,!0)),Ne._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){xe(this,ms).reject(new Error("Worker was destroyed"));return}const e=new qw;Xi(this,Mr,e);const i=`fake${wv(Ne,Rh)._++}`,r=new kl(i+"_worker",i,e);t.setup(r,e),Xi(this,Gn,new kl(i,i+"_worker",e)),er(this,Hi,rh).call(this)}).catch(t=>{xe(this,ms).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},_o=new WeakSet,sh=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Hn(Ne,_o),Hn(Ne,Rh,0),Hn(Ne,Js,!1),Hn(Ne,ta,new WeakMap),Fi&&(Xi(Ne,Js,!0),ho.workerSrc||="./pdf.worker.mjs"),Ne._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const r=new URL(e,i);return i.origin===r.origin},Ne._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Ne.fromPort=t=>{if(Fw("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Ne.create(t)},Ne);class HS{#t=new Map;#e=new Map;#i=new Map;#n=new Map;#s=null;constructor(t,e,i,r,a,l){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new Gy,this.fontLoader=new Vw({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#r(t,e=null){const i=this.#t.get(t);if(i)return i;const r=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,r),r}get annotationStorage(){return ee(this,"annotationStorage",new op)}getRenderingIntent(t,e=gs.ENABLE,i=null,r=!1,a=!1){let l=ln.DISPLAY,c=k0;switch(t){case"any":l=ln.ANY;break;case"display":break;case"print":l=ln.PRINT;break;default:qt(`getRenderingIntent - invalid intent: ${t}`)}const h=l&ln.PRINT&&i instanceof Oy?i:this.annotationStorage;switch(e){case gs.DISABLE:l+=ln.ANNOTATIONS_DISABLE;break;case gs.ENABLE:break;case gs.ENABLE_FORMS:l+=ln.ANNOTATIONS_FORMS;break;case gs.ENABLE_STORAGE:l+=ln.ANNOTATIONS_STORAGE,c=h.serializable;break;default:qt(`getRenderingIntent - invalid annotationMode: ${e}`)}r&&(l+=ln.IS_EDITING),a&&(l+=ln.OPLIST);const{ids:f,hash:p}=h.modifiedIds,m=[l,c.hash,p];return{renderingIntent:l,cacheKey:m.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#e.values())t.push(i._destroy());this.#e.clear(),this.#i.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),B0.cleanup(),this._networkStream?.cancelAllRequests(new _s("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,r)=>{Ze(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},r.onPull=()=>{this._fullReader.read().then(function({value:a,done:l}){if(l){r.close();return}Ze(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{r.error(a)})},r.onCancel=a=>{this._fullReader.cancel(a),r.ready.catch(l=>{if(!this.destroyed)throw l})}}),t.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:r,isRangeSupported:a,contentLength:l}=this._fullReader;return(!r||!a)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{e.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:r,isRangeSupported:a,contentLength:l}}),t.on("GetRangeReader",(i,r)=>{Ze(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(i.begin,i.end);if(!a){r.close();return}r.onPull=()=>{a.read().then(function({value:l,done:c}){if(c){r.close();return}Ze(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{a.cancel(l),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new BS(i,this))}),t.on("DocException",i=>{e._capability.reject(Yi(i))}),t.on("PasswordRequest",i=>{this.#s=Promise.withResolvers();try{if(!e.onPassword)throw Yi(i);const r=a=>{a instanceof Error?this.#s.reject(a):this.#s.resolve({password:a})};e.onPassword(r,i.code)}catch(r){this.#s.reject(r)}return this.#s.promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,r,a])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(r){case"Font":if("error"in a){const f=a.error;qt(`Error during font loading: ${f}`),this.commonObjs.resolve(i,f);break}const l=this._params.pdfBug&&globalThis.FontInspector?.enabled?(f,p)=>globalThis.FontInspector.fontAdded(f,p):null,c=new Gw(a,l);this.fontLoader.bind(c).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!c.fontExtraProperties&&c.data&&(c.data=null),this.commonObjs.resolve(i,c)});break;case"CopyLocalImage":const{imageRef:h}=a;Ze(h,"The imageRef must be defined.");for(const f of this.#e.values())for(const[,p]of f.objs)if(p?.ref===h)return p.dataLen?(this.commonObjs.resolve(i,structuredClone(p)),p.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,a);break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([i,r,a,l])=>{if(this.destroyed)return;const c=this.#e.get(r);if(!c.objs.has(i)){if(c._intentStates.size===0){l?.bitmap?.close();return}switch(a){case"Image":case"Pattern":c.objs.resolve(i,l);break;default:throw new Error(`Got unknown object type ${a}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[i.type];if(!r)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&qt("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#i.get(e);if(i)return i;const r=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#n.set(a.refStr,t);const l=new US(e,a,this,this._params.pdfBug);return this.#e.set(e,l),l});return this.#i.set(e,r),r}getPageIndex(t){return F0(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#r("GetOptionalContentConfig").then(e=>new xS(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new mS(r[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#t.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),B0.cleanup()}}cachedPageNumber(t){if(!F0(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#n.get(e)??null}}class jS{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class lo{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:r,annotationCanvasMap:a,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:m=!1,pageColors:v=null,enableHWA:x=!1,filteredOperationIndexes:E=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=m,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new jS(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=x,this._dependencyTracker=e.dependencyTracker,this._filteredOperationIndexes=E}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(lo.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");lo.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:r,background:a,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new uo(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:r,viewport:i,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),lo.#e.delete(this._canvas),t||=new np(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._filteredOperationIndexes),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),lo.#e.delete(this._canvas),this.callback())))}}const zS="5.4.149",VS="9e2e9e209";let qy=class rr{#t=null;#e=null;#i;#n=null;#s=!1;#r=!1;#a=null;#o;#c=null;#l=null;static#f=null;static get _keyboardManager(){return ee(this,"_keyboardManager",new hc([[["Escape","mac+Escape"],rr.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],rr.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],rr.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],rr.prototype._moveToPrevious],[["Home","mac+Home"],rr.prototype._moveToBeginning],[["End","mac+End"],rr.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#a=t):this.#r=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#i=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",rr.#f||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#a&&(t.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#p.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#i,t.append(i),t}renderMainDropdown(){const t=this.#n=this.#u();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#u(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",Nn,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(t.id=`${this.#a.id}_colorpicker_dropdown`);for(const[i,r]of this.#l.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",r),a.title=i,a.setAttribute("data-l10n-id",rr.#f[i]);const l=document.createElement("span");a.append(l),l.className="swatch",l.style.backgroundColor=r,a.ariaSelected=r===this.#i,a.addEventListener("click",this.#d.bind(this,r),{signal:e}),t.append(a)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#d(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:se.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#p(t);return}const e=t.target.getAttribute("data-color");e&&this.#d(e,t)}_moveToNext(t){if(!this.#m){this.#p(t);return}if(t.target===this.#t){this.#n.firstChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstChild||t.target===this.#t){this.#m&&this._hideDropdownFromKeyboard();return}this.#m||this.#p(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#m){this.#p(t);return}this.#n.firstChild?.focus()}_moveToEnd(t){if(!this.#m){this.#p(t);return}this.#n.lastChild?.focus()}#g(t){rr._keyboardManager.exec(this,t)}#p(t){if(this.#m){this.hideDropdown();return}if(this.#s=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#h.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#u();this.#t.append(e)}#h(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#m(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#m){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#l.highlightColors.values();for(const i of this.#n.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}};class Ql{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,Ql.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,colorValue:i}=this.#e,r=this.#t=document.createElement("input");return r.type="color",r.value=i||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",Ql.#n[t]),r.addEventListener("input",()=>{this.#i.updateParams(e,r.value)},{signal:this.#i._signal}),r}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function Jv(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Ml(n){return Math.max(0,Math.min(255,255*n))}class tx{static CMYK_G([t,e,i,r]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Ml(t),[t,t,t]}static G_HTML([t]){const e=Jv(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Ml)}static RGB_HTML(t){return`#${t.map(Jv).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,i+r),1-Math.min(1,e+r)]}static CMYK_rgb([t,e,i,r]){return[Ml(1-Math.min(1,t+r)),Ml(1-Math.min(1,i+r)),Ml(1-Math.min(1,e+r))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const r=1-t,a=1-e,l=1-i,c=Math.min(r,a,l);return["CMYK",r,a,l,c]}}class GS{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),i||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${e}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${e}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){De("Abstract method `_createSVG` called.")}}let uh=class extends GS{_createSVG(t){return document.createElementNS(Rr,t)}},Ky=class{static setupStorage(t,e,i,r,a){const l=r.getValue(e,{value:null});switch(i.name){case"textarea":if(l.value!==null&&(t.textContent=l.value),a==="print")break;t.addEventListener("input",c=>{r.setValue(e,{value:c.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(l.value===i.attributes.xfaOn?t.setAttribute("checked",!0):l.value===i.attributes.xfaOff&&t.removeAttribute("checked"),a==="print")break;t.addEventListener("change",c=>{r.setValue(e,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&t.setAttribute("value",l.value),a==="print")break;t.addEventListener("input",c=>{r.setValue(e,{value:c.target.value})})}break;case"select":if(l.value!==null){t.setAttribute("value",l.value);for(const c of i.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}t.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;r.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:r,linkService:a}){const{attributes:l}=e,c=t instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${r}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&t.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,f)}c&&a.addLinkAttributes(t,l.href,l.newWindow),i&&l.dataId&&this.setupStorage(t,l.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,r=t.xfaHtml,a=t.intent||"display",l=document.createElement(r.name);r.attributes&&this.setAttributes({html:l,element:r,intent:a,linkService:i});const c=a!=="richText",h=t.div;if(h.append(l),t.viewport){const m=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=m}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const m=document.createTextNode(r.value);l.append(m),c&&Kl.shouldBuildText(r.name)&&f.push(m)}return{textDivs:f}}const p=[[r,-1,l]];for(;p.length>0;){const[m,v,x]=p.at(-1);if(v+1===m.children.length){p.pop();continue}const E=m.children[++p.at(-1)[1]];if(E===null)continue;const{name:_}=E;if(_==="#text"){const A=document.createTextNode(E.value);f.push(A),x.append(A);continue}const b=E?.attributes?.xmlns?document.createElementNS(E.attributes.xmlns,_):document.createElement(_);if(x.append(b),E.attributes&&this.setAttributes({html:b,element:E,storage:e,intent:a,linkService:i}),E.children?.length>0)p.push([E,-1,b]);else if(E.value){const A=document.createTextNode(E.value);c&&Kl.shouldBuildText(_)&&f.push(A),b.append(A)}}for(const m of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}};const WS=9,ra=new WeakSet,XS=new Date().getTimezoneOffset()*60*1e3;class ex{static create(t){switch(t.data.annotationType){case Ke.LINK:return new fp(t);case Ke.TEXT:return new YS(t);case Ke.WIDGET:switch(t.data.fieldType){case"Tx":return new $S(t);case"Btn":return t.data.radioButton?new Qy(t):t.data.checkBox?new KS(t):new QS(t);case"Ch":return new ZS(t);case"Sig":return new qS(t)}return new ca(t);case Ke.POPUP:return new H0(t);case Ke.FREETEXT:return new Zy(t);case Ke.LINE:return new tT(t);case Ke.SQUARE:return new eT(t);case Ke.CIRCLE:return new iT(t);case Ke.POLYLINE:return new Jy(t);case Ke.CARET:return new rT(t);case Ke.INK:return new dp(t);case Ke.POLYGON:return new nT(t);case Ke.HIGHLIGHT:return new t_(t);case Ke.UNDERLINE:return new sT(t);case Ke.SQUIGGLY:return new aT(t);case Ke.STRIKEOUT:return new oT(t);case Ke.STAMP:return new e_(t);case Ke.FILEATTACHMENT:return new lT(t);default:return new We(t)}}}class We{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,e&&(this.container=this._createContainer(i)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return We._hasPopupData(this.data)}get hasCommentButton(){return this.enableComment&&this._isEditable&&this.hasPopupElement}get commentButtonPosition(){const{quadPoints:t,rect:e}=this.data;let i=-1/0,r=-1/0;if(t?.length>=8){for(let a=0;a<t.length;a+=8)t[a+1]>r?(r=t[a+1],i=t[a+2]):t[a+1]===r&&(i=Math.max(i,t[a+2]));return[i,r]}return e?[e[2],e[3]]:null}get commentButtonColor(){if(!this.data.color)return null;const[t,e,i]=this.data.color,a=255*(1-(this.data.opacity??1));return this.#n(Math.min(t+a,255),Math.min(e+a,255),Math.min(i+a,255))}#n(t,e,i){t/=255,e/=255,i/=255;const r=Math.max(t,e,i),a=Math.min(t,e,i),l=(r+a)/2,c=((1+Math.sqrt(l))/2*100).toFixed(2);if(r===a)return`hsl(0, 0%, ${c}%)`;const h=r-a;let f;r===t?f=(e-i)/h+(e<i?6:0):r===e?f=(i-t)/h+2:f=(t-e)/h+4,f=(f*60).toFixed(2);const p=(h/(1-Math.abs(2*l-1))*100).toFixed(2);return`hsl(${f}, ${p}%, ${c}%)`}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:r,pageX:a,pageY:l}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-a)/i,t[1]=100*(t[1]-l)/r,t}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#s(e);let r=this.#i?.popup||this.popup;!r&&i?.text&&(this._createPopup(i),r=this.#i.popup),r&&(r.updateEdited(t),i?.deleted&&(r.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#s(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#s(t){const{container:{style:e},data:{rect:i,rotation:r},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:h}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-c)/a}%`,e.top=`${100*(l-t[3]+h)/l}%`,r===0?(e.width=`${100*(t[2]-t[0])/a}%`,e.height=`${100*(t[3]-t[1])/l}%`):this.setRotation(r)}_createContainer(t){const{data:e,parent:{page:i,viewport:r}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",e.id),!(this instanceof ca)&&!(this instanceof fp)&&(a.tabIndex=0);const{style:l}=a;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(a.title=e.alternativeText),e.noRotate&&a.classList.add("norotate"),!e.rect||this instanceof H0){const{rotation:_}=e;return!e.hasOwnCanvas&&_!==0&&this.setRotation(_,a),a}const{width:c,height:h}=this;if(!t&&e.borderStyle.width>0){l.borderWidth=`${e.borderStyle.width}px`;const _=e.borderStyle.horizontalCornerRadius,b=e.borderStyle.verticalCornerRadius;if(_>0||b>0){const T=`calc(${_}px * var(--total-scale-factor)) / calc(${b}px * var(--total-scale-factor))`;l.borderRadius=T}else if(this instanceof Qy){const T=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=T}switch(e.borderStyle.style){case no.SOLID:l.borderStyle="solid";break;case no.DASHED:l.borderStyle="dashed";break;case no.BEVELED:qt("Unimplemented border style: beveled");break;case no.INSET:qt("Unimplemented border style: inset");break;case no.UNDERLINE:l.borderBottomStyle="solid";break}const A=e.borderColor||null;A?(this.#e=!0,l.borderColor=Bt.makeHexColor(A[0]|0,A[1]|0,A[2]|0)):l.borderWidth=0}const f=Bt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:p,pageHeight:m,pageX:v,pageY:x}=r.rawDims;l.left=`${100*(f[0]-v)/p}%`,l.top=`${100*(f[1]-x)/m}%`;const{rotation:E}=e;return e.hasOwnCanvas||E===0?(l.width=`${100*c/p}%`,l.height=`${100*h/m}%`):this.setRotation(E,a),a}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:r}=this.parent.viewport.rawDims;let{width:a,height:l}=this;t%180!==0&&([a,l]=[l,a]),e.style.width=`${100*a/i}%`,e.style.height=`${100*l/r}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,r)=>{const a=r.detail[e],l=a[0],c=a.slice(1);r.target.style[i]=tx[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[i]:tx[`${l}_rgb`](c)})};return ee(this,"_commonActions",{display:e=>{const{display:i}=e.detail,r=i%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const r of Object.keys(e.detail))(t[r]||i[r])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[r,a]of Object.entries(e)){const l=i[r];if(l){const c={detail:{[r]:a},target:t};l(c),delete e[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,r,a]=this.data.rect.map(_=>Math.fround(_));if(t.length===8){const[_,b,A,T]=t.subarray(2,6);if(r===_&&a===b&&e===A&&i===T)return}const{style:l}=this.container;let c;if(this.#e){const{borderColor:_,borderWidth:b}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${b}">`],this.container.classList.add("hasBorder")}const h=r-e,f=a-i,{svgFactory:p}=this,m=p.createElement("svg");m.classList.add("quadrilateralsContainer"),m.setAttribute("width",0),m.setAttribute("height",0),m.role="none";const v=p.createElement("defs");m.append(v);const x=p.createElement("clipPath"),E=`clippath_${this.data.id}`;x.setAttribute("id",E),x.setAttribute("clipPathUnits","objectBoundingBox"),v.append(x);for(let _=2,b=t.length;_<b;_+=8){const A=t[_],T=t[_+1],S=t[_+2],C=t[_+3],N=p.createElement("rect"),B=(S-e)/h,O=(a-T)/f,H=(A-S)/h,M=(T-C)/f;N.setAttribute("x",B),N.setAttribute("y",O),N.setAttribute("width",H),N.setAttribute("height",M),x.append(N),c?.push(`<rect vector-effect="non-scaling-stroke" x="${B}" y="${O}" width="${H}" height="${M}"/>`)}this.#e&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(m),this.container.style.clipPath=`url(#${E})`}_createPopup(t=null){const{data:e}=this;let i,r;t?(i={str:t.text},r=t.date):(i=e.contentsObj,r=e.modificationDate);const a=this.#i=new H0({data:{color:e.color,titleObj:e.titleObj,modificationDate:r,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent.div.append(a.render())}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}render(){De("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:a,id:l,exportValues:c}of r){if(a===-1||l===e)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!ra.has(f)){qt(`_getElementsByName - element not allowed: ${l}`);continue}i.push({id:l,exportValue:h,domElement:f})}return i}for(const r of document.getElementsByName(t)){const{exportValue:a}=r,l=r.getAttribute("data-element-id");l!==e&&ra.has(r)&&i.push({id:l,exportValue:a,domElement:r})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class fp extends We{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),r=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(this.#i(i,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(i),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",r=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,r),!1),this.#t()}#i(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(e.actions)){const a=i.get(r);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:r}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){qt('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:r,refs:a,include:l}=e,c=[];if(r.length!==0||a.length!==0){const p=new Set(a);for(const m of r){const v=this._fieldObjects[m]||[];for(const{id:x}of v)p.add(x)}for(const m of Object.values(this._fieldObjects))for(const v of m)p.has(v.id)===l&&c.push(v)}else for(const p of Object.values(this._fieldObjects))c.push(...p);const h=this.annotationStorage,f=[];for(const p of c){const{id:m}=p;switch(f.push(m),p.type){case"text":{const x=p.defaultValue||"";h.setValue(m,{value:x});break}case"checkbox":case"radiobutton":{const x=p.defaultValue===p.exportValues;h.setValue(m,{value:x});break}case"combobox":case"listbox":{const x=p.defaultValue||"";h.setValue(m,{value:x});break}default:continue}const v=document.querySelector(`[data-element-id="${m}"]`);if(v){if(!ra.has(v)){qt(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class YS extends We{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(t),this.container}}class ca extends We{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return wi.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,r,a){i.includes("mouse")?t.addEventListener(i,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):t.addEventListener(i,l=>{if(i==="blur"){if(!e.focused||!l.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:a(l)}})})}_setEventListeners(t,e,i,r){for(const[a,l]of i)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,a,l,r),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Bt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||WS,a=t.style;let l;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),p=Math.round(f/(s0*r))||1,m=f/p;l=Math.min(r,h(m/s0))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(r,h(f/s0))}a.fontSize=`calc(${l}px * var(--total-scale-factor))`,a.color=Bt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(a.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class $S extends ca{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,r){const a=this.annotationStorage;for(const l of this._getElementsByName(t.name,t.id))l.domElement&&(l.domElement[e]=i),a.setValue(l.id,{[r]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const r=t.getValue(e,{value:this.data.fieldValue});let a=r.value||"";const l=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let c=r.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=c??a,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",c??a),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),ra.add(i),i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:m}=this.data,v=!!p&&this.enableScripting;f&&(i.title=f),this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",E=>{t.setValue(e,{value:E.target.value}),this.setPropertyOnSiblings(i,"value",E.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",E=>{const _=this.data.defaultFieldValue??"";i.value=h.userValue=_,h.formattedValue=null});let x=E=>{const{formattedValue:_}=h;_!=null&&(E.target.value=_),E.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",_=>{if(h.focused)return;const{target:b}=_;if(v&&(b.type=p,m&&(b.step=m)),h.userValue){const A=h.userValue;if(v)if(p==="time"){const T=new Date(A),S=[T.getHours(),T.getMinutes(),T.getSeconds()];b.value=S.map(C=>C.toString().padStart(2,"0")).join(":")}else b.value=new Date(A-XS).toISOString().split(p==="date"?"T":".",1)[0];else b.value=A}h.lastCommittedValue=b.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",_=>{this.showElementAndHideCanvas(_.target);const b={value(A){h.userValue=A.detail.value??"",v||t.setValue(e,{value:h.userValue.toString()}),A.target.value=h.userValue},formattedValue(A){const{formattedValue:T}=A.detail;h.formattedValue=T,T!=null&&A.target!==document.activeElement&&(A.target.value=T);const S={formattedValue:T};v&&(S.value=T),t.setValue(e,S)},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:A=>{const{charLimit:T}=A.detail,{target:S}=A;if(T===0){S.removeAttribute("maxLength");return}S.setAttribute("maxLength",T);let C=h.userValue;!C||C.length<=T||(C=C.slice(0,T),S.value=h.userValue=C,t.setValue(e,{value:C}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:C,willCommit:!0,commitKey:1,selStart:S.selectionStart,selEnd:S.selectionEnd}}))}};this._dispatchEventFromSandbox(b,_)}),i.addEventListener("keydown",_=>{h.commitKey=1;let b=-1;if(_.key==="Escape"?b=0:_.key==="Enter"&&!this.data.multiLine?b=2:_.key==="Tab"&&(h.commitKey=3),b===-1)return;const{value:A}=_.target;h.lastCommittedValue!==A&&(h.lastCommittedValue=A,h.userValue=A,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:A,willCommit:!0,commitKey:b,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}))});const E=x;x=null,i.addEventListener("blur",_=>{if(!h.focused||!_.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:b}=_;let{value:A}=b;if(v){if(A&&p==="time"){const T=A.split(":").map(S=>parseInt(S,10));A=new Date(2e3,0,1,T[0],T[1],T[2]||0).valueOf(),b.step=""}else A=new Date(A).valueOf();b.type="text"}h.userValue=A,h.lastCommittedValue!==A&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:A,willCommit:!0,commitKey:h.commitKey,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}),E(_)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",_=>{h.lastCommittedValue=null;const{data:b,target:A}=_,{value:T,selectionStart:S,selectionEnd:C}=A;let N=S,B=C;switch(_.inputType){case"deleteWordBackward":{const O=T.substring(0,S).match(/\w*[^\w]*$/);O&&(N-=O[0].length);break}case"deleteWordForward":{const O=T.substring(S).match(/^[^\w]*\w*/);O&&(B+=O[0].length);break}case"deleteContentBackward":S===C&&(N-=1);break;case"deleteContentForward":S===C&&(B+=1);break}_.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:T,change:b||"",willCommit:!1,selStart:N,selEnd:B}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_=>_.target.value)}if(x&&i.addEventListener("blur",x),this.data.comb){const _=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${_}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class qS extends ca{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class KS extends ca{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let r=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return ra.add(a),a.setAttribute("data-element-id",i),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=e.fieldName,r&&a.setAttribute("checked",!0),a.setAttribute("exportValue",e.exportValue),a.tabIndex=0,a.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,i)){const p=h&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(i,{value:h})}),a.addEventListener("resetform",l=>{const c=e.defaultFieldValue||"Off";l.target.checked=c===e.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(i,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class Qy extends ca{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let r=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof r=="string"&&(r=r!==e.buttonValue,t.setValue(i,{value:r})),r)for(const l of this._getElementsByName(e.fieldName,i))t.setValue(l.id,{value:!1});const a=document.createElement("input");if(ra.add(a),a.setAttribute("data-element-id",i),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=e.fieldName,r&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,i))t.setValue(f.id,{value:!1});t.setValue(i,{value:h})}),a.addEventListener("resetform",l=>{const c=e.defaultFieldValue;l.target.checked=c!=null&&c===e.buttonValue}),this.enableScripting&&this.hasJSActions){const l=e.buttonValue;a.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const p=l===f.detail.value;for(const m of this._getElementsByName(f.target.name)){const v=p&&m.id===i;m.domElement&&(m.domElement.checked=v),t.setValue(m.id,{value:v})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class QS extends fp{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class ZS extends ca{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),r=document.createElement("select");ra.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",p=>{const m=this.data.defaultFieldValue;for(const v of r.options)v.selected=v.value===m});for(const p of this.data.options){const m=document.createElement("option");m.textContent=p.displayValue,m.value=p.exportValue,i.value.includes(p.exportValue)&&(m.setAttribute("selected",!0),a=!1),r.append(m)}let l=null;if(a){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),r.prepend(p),l=()=>{p.remove(),r.removeEventListener("input",l),l=null},r.addEventListener("input",l)}const c=p=>{const m=p?"value":"textContent",{options:v,multiple:x}=r;return x?Array.prototype.filter.call(v,E=>E.selected).map(E=>E[m]):v.selectedIndex===-1?null:v[v.selectedIndex][m]};let h=c(!1);const f=p=>{const m=p.target.options;return Array.prototype.map.call(m,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",p=>{const m={value(v){l?.();const x=v.detail.value,E=new Set(Array.isArray(x)?x:[x]);for(const _ of r.options)_.selected=E.has(_.value);t.setValue(e,{value:c(!0)}),h=c(!1)},multipleSelection(v){r.multiple=!0},remove(v){const x=r.options,E=v.detail.remove;x[E].selected=!1,r.remove(E),x.length>0&&Array.prototype.findIndex.call(x,b=>b.selected)===-1&&(x[0].selected=!0),t.setValue(e,{value:c(!0),items:f(v)}),h=c(!1)},clear(v){for(;r.length!==0;)r.remove(0);t.setValue(e,{value:null,items:[]}),h=c(!1)},insert(v){const{index:x,displayValue:E,exportValue:_}=v.detail.insert,b=r.children[x],A=document.createElement("option");A.textContent=E,A.value=_,b?b.before(A):r.append(A),t.setValue(e,{value:c(!0),items:f(v)}),h=c(!1)},items(v){const{items:x}=v.detail;for(;r.length!==0;)r.remove(0);for(const E of x){const{displayValue:_,exportValue:b}=E,A=document.createElement("option");A.textContent=_,A.value=b,r.append(A)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(e,{value:c(!0),items:f(v)}),h=c(!1)},indices(v){const x=new Set(v.detail.indices);for(const E of v.target.options)E.selected=x.has(E.index);t.setValue(e,{value:c(!0)}),h=c(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(m,p)}),r.addEventListener("input",p=>{const m=c(!0),v=c(!1);t.setValue(e,{value:m}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:v,changeEx:m,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):r.addEventListener("input",function(p){t.setValue(e,{value:c(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class H0 extends We{constructor(t){const{data:e,elements:i}=t;super(t,{isRenderable:We._hasPopupData(e)}),this.elements=i,this.popup=null}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=new JS({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,eventBus:this.linkService.eventBus}),i=[];for(const r of this.elements)r.popup=e,r.container.ariaHasPopup="dialog",i.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(r=>`${ip}${r}`).join(",")),this.container}}class JS{#t=this.#N.bind(this);#e=this.#R.bind(this);#i=this.#j.bind(this);#n=this.#L.bind(this);#s=null;#r=null;#a=null;#o=null;#c=null;#l=null;#f=null;#u=null;#d=!1;#g=null;#p=null;#h=null;#m=null;#y=null;#v=null;#_=null;#E=null;#x=null;#A=null;#T=!1;constructor({container:t,color:e,elements:i,titleObj:r,modificationDate:a,contentsObj:l,richText:c,parent:h,rect:f,parentRect:p,open:m,eventBus:v=null}){this.#r=t,this.#x=r,this.#a=l,this.#E=c,this.#f=h,this.#s=e,this.#_=f,this.#u=p,this.#c=i,this.#l=v,this.#o=N0.toDateObject(a),this.trigger=i.flatMap(x=>x.getElementsToTriggerPopup()),this.#w(),this.#r.hidden=!0,m&&this.#L()}#w(){if(this.#p)return;this.#p=new AbortController;const{signal:t}=this.#p;for(const e of this.trigger)e.addEventListener("click",this.#n,{signal:t}),e.addEventListener("mouseenter",this.#i,{signal:t}),e.addEventListener("mouseleave",this.#e,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#c)e.container?.addEventListener("keydown",this.#t,{signal:t});this.#M()}#S(){const t=this.#c.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition),this.#v=t.commentButtonColor)}#M(){if(this.#m||(this.#y||this.#S(),!this.#y))return;const t=this.#m=document.createElement("button");t.className="annotationCommentButton";const e=this.#c[0].container;t.style.zIndex=e.style.zIndex+1,t.tabIndex=0;const{signal:i}=this.#p;t.addEventListener("hover",this.#n,{signal:i}),t.addEventListener("keydown",this.#t,{signal:i}),t.addEventListener("click",()=>{const[{data:{id:a},annotationEditorType:l}]=this.#c;this.#l?.dispatch("switchannotationeditormode",{source:this,editId:a,mode:l,editComment:!0})},{signal:i});const{style:r}=t;r.left=`calc(${this.#y[0]}%)`,r.top=`calc(${this.#y[1]}% - var(--comment-button-dim))`,this.#v&&(r.backgroundColor=this.#v),e.after(t)}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#s){const r=t.style.outlineColor=Bt.makeHexColor(...this.#s);t.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#x?.str){const r=document.createElement("span");r.className="title",e.append(r),{dir:r.dir,str:r.textContent}=this.#x}if(t.append(e),this.#o){const r=document.createElement("time");r.className="popupDate",r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#o.valueOf()})),r.dateTime=this.#o.toISOString(),e.append(r)}const i=this.#C;if(i)Ky.render({xfaHtml:i,intent:"richText",div:t}),t.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(this.#a);t.append(r)}this.#r.append(t)}get#C(){const t=this.#E,e=this.#a;return t?.str&&(!e?.str||e.str===t.str)&&this.#E.html||null}get#D(){return this.#C?.attributes?.style?.fontSize||0}get#P(){return this.#C?.attributes?.style?.color||null}#O(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},r={style:{color:this.#P,fontSize:this.#D?`calc(${this.#D}px * var(--total-scale-factor))`:""}};for(const a of t.split(`
`))e.push({name:"span",value:a,attributes:r});return i}_formatContents({str:t,dir:e}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=e;const r=t.split(/(?:\r\n?|\n)/);for(let a=0,l=r.length;a<l;++a){const c=r[a];i.append(document.createTextNode(c)),a<l-1&&i.append(document.createElement("br"))}return i}#N(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#d)&&this.#L()}updateEdited({rect:t,popup:e,deleted:i}){if(i||e?.deleted){this.remove();return}this.#w(),this.#A||={contentsObj:this.#a,richText:this.#E},t&&(this.#h=null),e&&(this.#E=this.#O(e.text),this.#o=N0.toDateObject(e.date),this.#a=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#A&&({contentsObj:this.#a,richText:this.#E}=this.#A,this.#A=null,this.#g?.remove(),this.#g=null,this.#h=null)}remove(){this.#p?.abort(),this.#p=null,this.#g?.remove(),this.#g=null,this.#T=!1,this.#d=!1;for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#F(){if(this.#h!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:r,pageY:a}}}=this.#f;let l=!!this.#u,c=l?this.#u:this.#_;for(const E of this.#c)if(!c||Bt.intersect(E.data.rect,c)!==null){c=E.data.rect,l=!0;break}const h=Bt.normalizeRect([c[0],t[3]-c[1]+t[1],c[2],t[3]-c[3]+t[1]]),p=l?c[2]-c[0]+5:0,m=h[0]+p,v=h[1];this.#h=[100*(m-r)/e,100*(v-a)/i];const{style:x}=this.#r;x.left=`${this.#h[0]}%`,x.top=`${this.#h[1]}%`}#L(){this.#d=!this.#d,this.#d?(this.#j(),this.#r.addEventListener("click",this.#n),this.#r.addEventListener("keydown",this.#t)):(this.#R(),this.#r.removeEventListener("click",this.#n),this.#r.removeEventListener("keydown",this.#t))}#j(){this.#g||this.render(),this.isVisible?this.#d&&this.#r.classList.add("focused"):(this.#F(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#R(){this.#r.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#T=this.isVisible,this.#T&&(this.#r.hidden=!0)}maybeShow(){this.#w(),this.#T&&(this.#g||this.#j(),this.#T=!1,this.#r.hidden=!1)}get isVisible(){return this.#r.hidden===!1}}class Zy extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=Yt.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class tT extends We{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),a=this.#t=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class eT extends We{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),a=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",a/2),l.setAttribute("y",a/2),l.setAttribute("width",e-a),l.setAttribute("height",i-a),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class iT extends We{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),a=t.borderStyle.width,l=this.#t=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",e/2),l.setAttribute("cy",i/2),l.setAttribute("rx",e/2-a/2),l.setAttribute("ry",i/2-a/2),l.setAttribute("stroke-width",a||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class Jy extends We{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:r},width:a,height:l}=this;if(!e)return this.container;const c=this.svgFactory.create(a,l,!0);let h=[];for(let p=0,m=e.length;p<m;p+=2){const v=e[p]-t[0],x=t[3]-e[p+1];h.push(`${v},${x}`)}h=h.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),c.append(f),this.container.append(c),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class nT extends Jy{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class rT extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class dp extends We{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Yt.HIGHLIGHT:Yt.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:r,popupRef:a}}=this,{transform:l,width:c,height:h}=this.#i(e,t),f=this.svgFactory.create(c,h,!0),p=this.#t=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",r.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",l);for(let m=0,v=i.length;m<v;m++){const x=this.svgFactory.createElement(this.svgElementName);this.#e.push(x),x.setAttribute("points",i[m].join(",")),p.append(x)}return!a&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:r}=t,a=this.#t;if(e>=0&&a.setAttribute("stroke-width",e||1),i)for(let l=0,c=this.#e.length;l<c;l++)this.#e[l].setAttribute("points",i[l].join(","));if(r){const{transform:l,width:c,height:h}=this.#i(this.data.rotation,r);a.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),a.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}get commentButtonPosition(){const{inkLists:t,rect:e}=this.data;if(t?.length>=1){let i=-1/0,r=-1/0;for(const a of t)for(let l=0,c=a.length;l<c;l+=2)a[l+1]>r?(r=a[l+1],i=a[l]):a[l+1]===r&&(i=Math.max(i,a[l]));if(i!==1/0)return[i,r]}return e?[e[2],e[3]]:null}}class t_ extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Yt.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class sT extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class aT extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class oT extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class e_ extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Yt.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class lT extends We{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:r}=wi.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(r?a.metaKey:a.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?this._createPopup():i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let cT=class i_{#t=null;#e=null;#i=new Map;#n=null;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:r,page:a,viewport:l,structTreeLayer:c}){this.div=t,this.#t=e,this.#e=i,this.#n=c||null,this.page=a,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=r}hasEditableAnnotations(){return this.#i.size>0}async#s(t,e,i){const r=t.firstChild||t,a=r.id=`${ip}${e}`,l=await this.#n?.getAriaAttributes(a);if(l)for(const[c,h]of l)r.setAttribute(c,h);i?i.at(-1).container.after(t):(this.div.append(t),this.#t?.moveElementInDOM(this.div,t,r,!1))}async render(t){const{annotations:e}=t,i=this.div;ia(i,this.viewport);const r=new Map,a={data:null,layer:i,linkService:t.linkService,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new uh,annotationStorage:t.annotationStorage||new op,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const l of e){if(l.noHTML)continue;const c=l.annotationType===Ke.POPUP;if(c){const p=r.get(l.id);if(!p)continue;a.elements=p}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;a.data=l;const h=ex.create(a);if(!h.isRenderable)continue;if(!c&&l.popupRef){const p=r.get(l.popupRef);p?p.push(h):r.set(l.popupRef,[h])}const f=h.render();l.hidden&&(f.style.visibility="hidden"),await this.#s(f,l.id,a.elements),h._isEditable&&(this.#i.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#r()}async addLinkAnnotations(t,e){const i={data:null,layer:this.div,linkService:e,svgFactory:new uh,parent:this};for(const r of t){r.borderStyle||=i_._defaultBorderStyle,i.data=r;const a=ex.create(i);if(!a.isRenderable)continue;const l=a.render();await this.#s(l,r.id,null)}}update({viewport:t}){const e=this.div;this.viewport=t,ia(e,{rotation:t.rotation}),this.#r(),e.hidden=!1}#r(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const r=t.querySelector(`[data-annotation-id="${e}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:a}=r;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):r.append(i);const l=this.#i.get(e);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,r.id,i),l._hasNoCanvas=!1):l.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}static get _defaultBorderStyle(){return ee(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:no.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const zu=/\r\n?|\n/g;class ui extends zt{#t;#e="";#i=`${this.id}-editor`;#n=null;#s;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=ui.prototype,e=a=>a.isEmpty(),i=ql.TRANSLATE_SMALL,r=ql.TRANSLATE_BIG;return ee(this,"_keyboardManager",new hc([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:e}]]))}static _type="freetext";static _editorType=Yt.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.#t=t.color||ui._defaultColor||zt._defaultLineColor,this.#s=t.fontSize||ui._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(t,e){zt.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case se.FREETEXT_SIZE:ui._defaultFontSize=e;break;case se.FREETEXT_COLOR:ui._defaultColor=e;break}}updateParams(t,e){switch(t){case se.FREETEXT_SIZE:this.#r(e);break;case se.FREETEXT_COLOR:this.#a(e);break}}static get defaultPropertiesToUpdate(){return[[se.FREETEXT_SIZE,ui._defaultFontSize],[se.FREETEXT_COLOR,ui._defaultColor||zt._defaultLineColor]]}get propertiesToUpdate(){return[[se.FREETEXT_SIZE,this.#s],[se.FREETEXT_COLOR,this.#t]]}get toolbarButtons(){return this._colorPicker||=new Ql(this),[["colorPicker",this._colorPicker]]}get colorType(){return se.FREETEXT_COLOR}get colorValue(){return this.#t}#r(t){const e=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#s)*this.parentScale),this.#s=r,this.#c()},i=this.#s;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:se.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#a(t){const e=r=>{this.#t=this.editorDiv.style.color=r,this._colorPicker?.update(r)},i=this.#t;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:se.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-ui._internalPadding*t,-(ui._internalPadding+this.#s)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#i),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#o(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(ui.#l(i)),e=i);return t.join(`
`)}#c(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:a}=this,l=a.style.display,c=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",r.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=l,a.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#e,e=this.#e=this.#o().trimEnd();if(t===e)return;const i=r=>{if(this.#e=r,!r){this.remove();return}this.#f(),this._uiManager.rebuild(this),this.#c()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#c()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){ui._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#i),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,i.color=this.#t,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,a]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[f,p]=this.pageDimensions,[m,v]=this.pageTranslation;let x,E;switch(this.rotation){case 0:x=t+(l[0]-m)/f,E=e+this.height-(l[1]-v)/p;break;case 90:x=t+(l[0]-m)/f,E=e-(l[1]-v)/p,[c,h]=[h,-c];break;case 180:x=t-this.width+(l[0]-m)/f,E=e-(l[1]-v)/p,[c,h]=[-c,-h];break;case 270:x=t+(l[0]-m-this.height*p)/f,E=e+(l[1]-v-this.width*f)/p,[c,h]=[-h,c];break}this.setAt(x*r,E*a,c,h)}else this._moveAfterPaste(t,e);this.#f(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#l(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(zu,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=ui.#d(e.getData("text")||"").replaceAll(zu,`
`);if(!r)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const l=a.getRangeAt(0);if(!r.includes(`
`)){l.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:c,startOffset:h}=l,f=[],p=[];if(c.nodeType===Node.TEXT_NODE){const x=c.parentElement;if(p.push(c.nodeValue.slice(h).replaceAll(zu,"")),x!==this.editorDiv){let E=f;for(const _ of this.editorDiv.childNodes){if(_===x){E=p;continue}E.push(ui.#l(_))}}f.push(c.nodeValue.slice(0,h).replaceAll(zu,""))}else if(c===this.editorDiv){let x=f,E=0;for(const _ of this.editorDiv.childNodes)E++===h&&(x=p),x.push(ui.#l(_))}this.#e=`${f.join(`
`)}${r}${p.join(`
`)}`,this.#f();const m=new Range;let v=Math.sumPrecise(f.map(x=>x.length));for(const{firstChild:x}of this.editorDiv.childNodes)if(x.nodeType===Node.TEXT_NODE){const E=x.nodeValue.length;if(v<=E){m.setStart(x,v),m.setEnd(x,v);break}v-=E}a.removeAllRanges(),a.addRange(m)}#f(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const t of this.#e.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#u(){return this.#e.replaceAll(" "," ")}static#d(t){return t.replaceAll(" "," ")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=ui._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let r=null;if(t instanceof Zy){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:f,id:p,popupRef:m,contentsObj:v},textContent:x,textPosition:E,parent:{page:{pageNumber:_}}}=t;if(!x||x.length===0)return null;r=t={annotationType:Yt.FREETEXT,color:Array.from(c),fontSize:l,value:x.join(`
`),position:E,pageIndex:_-1,rect:h.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:m,comment:v?.str||null}}const a=await super.deserialize(t,e,i);return a.#s=t.fontSize,a.#t=Bt.makeHexColor(...t.color),a.#e=ui.#d(t.value),a._initialData=r,t.comment&&a.setCommentData(t.comment),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=this.getPDFRect(),i=zt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#t),r={annotationType:Yt.FREETEXT,color:i,fontSize:this.#s,value:this.#u(),pageIndex:this.pageIndex,rect:e,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(r),t?(r.isCopy=!0,r):this.annotationElementId&&!this.#g(r)?null:(r.id=this.annotationElementId,r)}#g(t){const{value:e,fontSize:i,color:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((l,c)=>l!==r[c])||t.pageIndex!==a}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#s}px * var(--total-scale-factor))`,i.color=this.#t,e.replaceChildren();for(const a of this.#e.split(`
`)){const l=document.createElement("div");l.append(a?document.createTextNode(a):document.createElement("br")),e.append(l)}const r={rect:this.getPDFRect()};return r.popup=this.hasEditedComment?this.comment:{text:this.#e},t.updateEdited(r),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Ft{static PRECISION=1e-4;toSVGPath(){De("Abstract method `toSVGPath` must be implemented.")}get box(){De("Abstract getter `box` must be implemented.")}serialize(t,e){De("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,r,a,l){l||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c]*r,l[c+1]=i+t[c+1]*a;return l}static _rescaleAndSwap(t,e,i,r,a,l){l||=new Float32Array(t.length);for(let c=0,h=t.length;c<h;c+=2)l[c]=e+t[c+1]*r,l[c+1]=i+t[c]*a;return l}static _translate(t,e,i,r){r||=new Float32Array(t.length);for(let a=0,l=t.length;a<l;a+=2)r[a]=e+t[a],r[a+1]=i+t[a+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,r,a){switch(a){case 90:return[1-e/i,t/r];case 180:return[1-t/i,1-e/r];case 270:return[e/i,1-t/r];default:return[t/i,e/r]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,r,a,l){return[(t+5*i)/6,(e+5*r)/6,(5*i+a)/6,(5*r+l)/6,(i+a)/2,(r+l)/2]}}class Qs{#t;#e=[];#i;#n;#s=[];#r=new Float32Array(18);#a;#o;#c;#l;#f;#u;#d=[];static#g=8;static#p=2;static#h=Qs.#g+Qs.#p;constructor({x:t,y:e},i,r,a,l,c=0){this.#t=i,this.#u=a*r,this.#n=l,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=c,this.#l=Qs.#g*r,this.#c=Qs.#h*r,this.#f=r,this.#d.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#m(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[i,r,a,l]=this.#t;return[(this.#a+(t[0]-e[0])/2-i)/a,(this.#o+(t[1]-e[1])/2-r)/l,(this.#a+(e[0]-t[0])/2-i)/a,(this.#o+(e[1]-t[1])/2-r)/l]}add({x:t,y:e}){this.#a=t,this.#o=e;const[i,r,a,l]=this.#t;let[c,h,f,p]=this.#r.subarray(8,12);const m=t-f,v=e-p,x=Math.hypot(m,v);if(x<this.#c)return!1;const E=x-this.#l,_=E/x,b=_*m,A=_*v;let T=c,S=h;c=f,h=p,f+=b,p+=A,this.#d?.push(t,e);const C=-A/E,N=b/E,B=C*this.#u,O=N*this.#u;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+B,p+O],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-B,p-O],16),isNaN(this.#r[6])?(this.#s.length===0&&(this.#r.set([c+B,h+O],2),this.#s.push(NaN,NaN,NaN,NaN,(c+B-i)/a,(h+O-r)/l),this.#r.set([c-B,h-O],14),this.#e.push(NaN,NaN,NaN,NaN,(c-B-i)/a,(h-O-r)/l)),this.#r.set([T,S,c,h,f,p],6),!this.isEmpty()):(this.#r.set([T,S,c,h,f,p],6),Math.abs(Math.atan2(S-h,T-c)-Math.atan2(A,b))<Math.PI/2?([c,h,f,p]=this.#r.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((c+f)/2-i)/a,((h+p)/2-r)/l),[c,h,T,S]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((T+c)/2-i)/a,((S+h)/2-r)/l),!0):([T,S,c,h,f,p]=this.#r.subarray(0,6),this.#s.push(((T+5*c)/6-i)/a,((S+5*h)/6-r)/l,((5*c+f)/6-i)/a,((5*h+p)/6-r)/l,((c+f)/2-i)/a,((h+p)/2-r)/l),[f,p,c,h,T,S]=this.#r.subarray(12,18),this.#e.push(((T+5*c)/6-i)/a,((S+5*h)/6-r)/l,((5*c+f)/6-i)/a,((5*h+p)/6-r)/l,((c+f)/2-i)/a,((h+p)/2-r)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#y();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?i.push(`L${t[r+4]} ${t[r+5]}`):i.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#_(i);for(let r=e.length-6;r>=6;r-=6)isNaN(e[r])?i.push(`L${e[r+4]} ${e[r+5]}`):i.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);return this.#v(i),i.join(" ")}#y(){const[t,e,i,r]=this.#t,[a,l,c,h]=this.#m();return`M${(this.#r[2]-t)/i} ${(this.#r[3]-e)/r} L${(this.#r[4]-t)/i} ${(this.#r[5]-e)/r} L${a} ${l} L${c} ${h} L${(this.#r[16]-t)/i} ${(this.#r[17]-e)/r} L${(this.#r[14]-t)/i} ${(this.#r[15]-e)/r} Z`}#v(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#_(t){const[e,i,r,a]=this.#t,l=this.#r.subarray(4,6),c=this.#r.subarray(16,18),[h,f,p,m]=this.#m();t.push(`L${(l[0]-e)/r} ${(l[1]-i)/a} L${h} ${f} L${p} ${m} L${(c[0]-e)/r} ${(c[1]-i)/a}`)}newFreeDrawOutline(t,e,i,r,a,l){return new n_(t,e,i,r,a,l)}getOutlines(){const t=this.#s,e=this.#e,i=this.#r,[r,a,l,c]=this.#t,h=new Float32Array((this.#d?.length??0)+2);for(let m=0,v=h.length-2;m<v;m+=2)h[m]=(this.#d[m]-r)/l,h[m+1]=(this.#d[m+1]-a)/c;if(h[h.length-2]=(this.#a-r)/l,h[h.length-1]=(this.#o-a)/c,isNaN(i[6])&&!this.isEmpty())return this.#E(h);const f=new Float32Array(this.#s.length+24+this.#e.length);let p=t.length;for(let m=0;m<p;m+=2){if(isNaN(t[m])){f[m]=f[m+1]=NaN;continue}f[m]=t[m],f[m+1]=t[m+1]}p=this.#A(f,p);for(let m=e.length-6;m>=6;m-=6)for(let v=0;v<6;v+=2){if(isNaN(e[m+v])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=e[m+v],f[p+1]=e[m+v+1],p+=2}return this.#x(f,p),this.newFreeDrawOutline(f,h,this.#t,this.#f,this.#i,this.#n)}#E(t){const e=this.#r,[i,r,a,l]=this.#t,[c,h,f,p]=this.#m(),m=new Float32Array(36);return m.set([NaN,NaN,NaN,NaN,(e[2]-i)/a,(e[3]-r)/l,NaN,NaN,NaN,NaN,(e[4]-i)/a,(e[5]-r)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(e[16]-i)/a,(e[17]-r)/l,NaN,NaN,NaN,NaN,(e[14]-i)/a,(e[15]-r)/l],0),this.newFreeDrawOutline(m,t,this.#t,this.#f,this.#i,this.#n)}#x(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#A(t,e){const i=this.#r.subarray(4,6),r=this.#r.subarray(16,18),[a,l,c,h]=this.#t,[f,p,m,v]=this.#m();return t.set([NaN,NaN,NaN,NaN,(i[0]-a)/c,(i[1]-l)/h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,m,v,NaN,NaN,NaN,NaN,(r[0]-a)/c,(r[1]-l)/h],e),e+=24}}class n_ extends Ft{#t;#e=new Float32Array(4);#i;#n;#s;#r;#a;constructor(t,e,i,r,a,l){super(),this.#a=t,this.#s=e,this.#t=i,this.#r=r,this.#i=a,this.#n=l,this.lastPoint=[NaN,NaN],this.#o(l);const[c,h,f,p]=this.#e;for(let m=0,v=t.length;m<v;m+=2)t[m]=(t[m]-c)/f,t[m+1]=(t[m+1]-h)/p;for(let m=0,v=e.length;m<v;m+=2)e[m]=(e[m]-c)/f,e[m+1]=(e[m+1]-h)/p}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let e=6,i=this.#a.length;e<i;e+=6){if(isNaN(this.#a[e])){t.push(`L${this.#a[e+4]} ${this.#a[e+5]}`);continue}t.push(`C${this.#a[e]} ${this.#a[e+1]} ${this.#a[e+2]} ${this.#a[e+3]} ${this.#a[e+4]} ${this.#a[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,r],a){const l=i-t,c=r-e;let h,f;switch(a){case 0:h=Ft._rescale(this.#a,t,r,l,-c),f=Ft._rescale(this.#s,t,r,l,-c);break;case 90:h=Ft._rescaleAndSwap(this.#a,t,e,l,c),f=Ft._rescaleAndSwap(this.#s,t,e,l,c);break;case 180:h=Ft._rescale(this.#a,i,e,-l,c),f=Ft._rescale(this.#s,i,e,-l,c);break;case 270:h=Ft._rescaleAndSwap(this.#a,i,r,-l,-c),f=Ft._rescaleAndSwap(this.#s,i,r,-l,-c);break}return{outline:Array.from(h),points:[Array.from(f)]}}#o(t){const e=this.#a;let i=e[4],r=e[5];const a=[i,r,i,r];let l=i,c=r;const h=t?Math.max:Math.min;for(let p=6,m=e.length;p<m;p+=6){const v=e[p+4],x=e[p+5];if(isNaN(e[p]))Bt.pointBoundingBox(v,x,a),c<x?(l=v,c=x):c===x&&(l=h(l,v));else{const E=[1/0,1/0,-1/0,-1/0];Bt.bezierBoundingBox(i,r,...e.slice(p,p+6),E),Bt.rectBoundingBox(...E,a),c<E[3]?(l=E[2],c=E[3]):c===E[3]&&(l=h(l,E[2]))}i=v,r=x}const f=this.#e;f[0]=a[0]-this.#i,f[1]=a[1]-this.#i,f[2]=a[2]-a[0]+2*this.#i,f[3]=a[3]-a[1]+2*this.#i,this.lastPoint=[l,c]}get box(){return this.#e}newOutliner(t,e,i,r,a,l=0){return new Qs(t,e,i,r,a,l)}getNewOutline(t,e){const[i,r,a,l]=this.#e,[c,h,f,p]=this.#t,m=a*f,v=l*p,x=i*f+c,E=r*p+h,_=this.newOutliner({x:this.#s[0]*m+x,y:this.#s[1]*v+E},this.#t,this.#r,t,this.#n,e??this.#i);for(let b=2;b<this.#s.length;b+=2)_.add({x:this.#s[b]*m+x,y:this.#s[b+1]*v+E});return _.getOutlines()}}class j0{#t;#e;#i=[];#n=[];constructor(t,e=0,i=0,r=!0){const a=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x,y:E,width:_,height:b}of t){const A=Math.floor((x-e)/l)*l,T=Math.ceil((x+_+e)/l)*l,S=Math.floor((E-e)/l)*l,C=Math.ceil((E+b+e)/l)*l,N=[A,S,C,!0],B=[T,S,C,!1];this.#i.push(N,B),Bt.rectBoundingBox(A,S,T,C,a)}const c=a[2]-a[0]+2*i,h=a[3]-a[1]+2*i,f=a[0]-i,p=a[1]-i,m=this.#i.at(r?-1:-2),v=[m[0],m[2]];for(const x of this.#i){const[E,_,b]=x;x[0]=(E-f)/c,x[1]=(_-p)/h,x[2]=(b-p)/h}this.#t=new Float32Array([f,p,c,h]),this.#e=v}getOutlines(){this.#i.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#i)e[3]?(t.push(...this.#c(e)),this.#a(e)):(this.#o(e),t.push(...this.#c(e)));return this.#s(t)}#s(t){const e=[],i=new Set;for(const l of t){const[c,h,f]=l;e.push([c,h,l],[c,f,l])}e.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=e.length;l<c;l+=2){const h=e[l][2],f=e[l+1][2];h.push(f),f.push(h),i.add(h),i.add(f)}const r=[];let a;for(;i.size>0;){const l=i.values().next().value;let[c,h,f,p,m]=l;i.delete(l);let v=c,x=h;for(a=[c,f],r.push(a);;){let E;if(i.has(p))E=p;else if(i.has(m))E=m;else break;i.delete(E),[c,h,f,p,m]=E,v!==c&&(a.push(v,x,c,x===h?h:f),v=c),x=x===h?f:h}a.push(v,x)}return new uT(r,this.#t,this.#e)}#r(t){const e=this.#n;let i=0,r=e.length-1;for(;i<=r;){const a=i+r>>1,l=e[a][0];if(l===t)return a;l<t?i=a+1:r=a-1}return r+1}#a([,t,e]){const i=this.#r(t);this.#n.splice(i,0,[t,e])}#o([,t,e]){const i=this.#r(t);for(let r=i;r<this.#n.length;r++){const[a,l]=this.#n[r];if(a!==t)break;if(a===t&&l===e){this.#n.splice(r,1);return}}for(let r=i-1;r>=0;r--){const[a,l]=this.#n[r];if(a!==t)break;if(a===t&&l===e){this.#n.splice(r,1);return}}}#c(t){const[e,i,r]=t,a=[[e,i,r]],l=this.#r(r);for(let c=0;c<l;c++){const[h,f]=this.#n[c];for(let p=0,m=a.length;p<m;p++){const[,v,x]=a[p];if(!(f<=v||x<=h)){if(v>=h){if(x>f)a[p][1]=f;else{if(m===1)return[];a.splice(p,1),p--,m--}continue}a[p][2]=h,x>f&&a.push([e,f,x])}}}return a}}class uT extends Ft{#t;#e;constructor(t,e,i){super(),this.#e=t,this.#t=e,this.lastPoint=i}toSVGPath(){const t=[];for(const e of this.#e){let[i,r]=e;t.push(`M${i} ${r}`);for(let a=2;a<e.length;a+=2){const l=e[a],c=e[a+1];l===i?(t.push(`V${c}`),r=c):c===r&&(t.push(`H${l}`),i=l)}t.push("Z")}return t.join(" ")}serialize([t,e,i,r],a){const l=[],c=i-t,h=r-e;for(const f of this.#e){const p=new Array(f.length);for(let m=0;m<f.length;m+=2)p[m]=t+f[m]*c,p[m+1]=r-f[m+1]*h;l.push(p)}return l}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class z0 extends Qs{newFreeDrawOutline(t,e,i,r,a,l){return new hT(t,e,i,r,a,l)}}class hT extends n_{newOutliner(t,e,i,r,a,l=0){return new z0(t,e,i,r,a,l)}}class Ge extends zt{#t=null;#e=0;#i;#n=null;#s=null;#r=null;#a=null;#o=0;#c=null;#l=null;#f=null;#u=!1;#d=null;#g;#p=null;#h="";#m;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Yt.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=Ge.prototype;return ee(this,"_keyboardManager",new hc([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||Ge._defaultColor,this.#m=t.thickness||Ge._defaultThickness,this.#g=t.opacity||Ge._defaultOpacity,this.#i=t.boxes||null,this.#y=t.methodOfCreation||"",this.#h=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#u=!0,this.#_(t),this.#w()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#w(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#u?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#m,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}get commentColor(){return this.color}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new j0(this.#i,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new j0(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{lastPoint:i}=this.#r;this.#d=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#_({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#l=t;const r=1.5;if(this.#r=t.getNewOutline(this.#m/2+r,.0025),e>=0)this.#f=e,this.#n=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#f,{bbox:Ge.#S(this.#l.box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:Ge.#S(this.#r.box,p),path:{d:this.#r.toSVGPath()}})}const[a,l,c,h]=t.box;switch(this.rotation){case 0:this.x=a,this.y=l,this.width=c,this.height=h;break;case 90:{const[p,m]=this.parentDimensions;this.x=l,this.y=1-a,this.width=c*m/p,this.height=h*p/m;break}case 180:this.x=1-a,this.y=1-l,this.width=c,this.height=h;break;case 270:{const[p,m]=this.parentDimensions;this.x=1-l,this.y=a,this.width=c*m/p,this.height=h*p/m;break}}const{lastPoint:f}=this.#r;this.#d=[(f[0]-a)/c,(f[1]-l)/h]}static initialize(t,e){zt.initialize(t,e),Ge._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case se.HIGHLIGHT_COLOR:Ge._defaultColor=e;break;case se.HIGHLIGHT_THICKNESS:Ge._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#d}updateParams(t,e){switch(t){case se.HIGHLIGHT_COLOR:this.#E(e);break;case se.HIGHLIGHT_THICKNESS:this.#x(e);break}}static get defaultPropertiesToUpdate(){return[[se.HIGHLIGHT_COLOR,Ge._defaultColor],[se.HIGHLIGHT_THICKNESS,Ge._defaultThickness]]}get propertiesToUpdate(){return[[se.HIGHLIGHT_COLOR,this.color||Ge._defaultColor],[se.HIGHLIGHT_THICKNESS,this.#m||Ge._defaultThickness],[se.HIGHLIGHT_FREE,this.#u]]}#E(t){const e=(a,l)=>{this.color=a,this.#g=l,this.parent?.drawLayer.updateProperties(this.#f,{root:{fill:a,"fill-opacity":l}}),this.#s?.updateColor(a)},i=this.color,r=this.#g;this.addCommands({cmd:e.bind(this,t,Ge._defaultOpacity),undo:e.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:se.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#x(t){const e=this.#m,i=r=>{this.#m=r,this.#A(r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:se.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#s=new qy({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#D())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#D())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#T(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#w(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#T():t&&(this.#w(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#A(t){if(!this.#u)return;this.#_({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition();const[e,i]=this.parentDimensions;this.setDims(this.width*e,this.height*i)}#T(){this.#f===null||!this.parent||(this.parent.drawLayer.remove(this.#f),this.#f=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#w(t=this.parent){this.#f===null&&({id:this.#f,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.#g},rootClass:{highlight:!0,free:this.#u},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#u},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#u),this.#c&&(this.#c.style.clipPath=this.#n))}static#S([t,e,i,r],a){switch(a){case 90:return[1-e-r,t,r,i];case 180:return[1-t-i,1-e-r,i,r];case 270:return[e,1-t-i,r,i]}return[t,e,i,r]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#u?(t=(t-this.rotation+360)%360,i=Ge.#S(this.#l.box,t)):i=Ge.#S([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#f,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#p,{bbox:Ge.#S(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#h&&(t.setAttribute("aria-label",this.#h),t.setAttribute("role","mark")),this.#u?t.classList.add("free"):this.div.addEventListener("keydown",this.#M.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n;const[i,r]=this.parentDimensions;return this.setDims(this.width*i,this.height*r),Ry(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#M(t){Ge._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#C(!0);break;case 1:case 3:this.#C(!1);break}}#C(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#a,this.#o)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#u||this.#C(!1))}get _mustFixPosition(){return!this.#u}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#f,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!t}}))}#D(){return this.#u?this.rotation:0}#P(){if(this.#u)return null;const[t,e]=this.pageDimensions,[i,r]=this.pageTranslation,a=this.#i,l=new Float32Array(a.length*8);let c=0;for(const{x:h,y:f,width:p,height:m}of a){const v=h*t+i,x=(1-f)*e+r;l[c]=l[c+4]=v,l[c+1]=l[c+3]=x,l[c+2]=l[c+6]=v+p*t,l[c+5]=l[c+7]=x-m*e,c+=8}return l}#O(t){return this.#l.serialize(t,this.#D())}static startHighlighting(t,e,{target:i,x:r,y:a}){const{x:l,y:c,width:h,height:f}=i.getBoundingClientRect(),p=new AbortController,m=t.combinedSignal(p),v=x=>{p.abort(),this.#F(t,x)};window.addEventListener("blur",v,{signal:m}),window.addEventListener("pointerup",v,{signal:m}),window.addEventListener("pointerdown",Qe,{capture:!0,passive:!1,signal:m}),window.addEventListener("contextmenu",Nn,{signal:m}),i.addEventListener("pointermove",this.#N.bind(this,t),{signal:m}),this._freeHighlight=new z0({x:r,y:a},[l,c,h,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#N(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let r=null;if(t instanceof t_){const{data:{quadPoints:E,rect:_,rotation:b,id:A,color:T,opacity:S,popupRef:C,contentsObj:N},parent:{page:{pageNumber:B}}}=t;r=t={annotationType:Yt.HIGHLIGHT,color:Array.from(T),opacity:S,quadPoints:E,boxes:null,pageIndex:B-1,rect:_.slice(0),rotation:b,annotationElementId:A,id:A,deleted:!1,popupRef:C,comment:N?.str||null}}else if(t instanceof dp){const{data:{inkLists:E,rect:_,rotation:b,id:A,color:T,borderStyle:{rawWidth:S},popupRef:C,contentsObj:N},parent:{page:{pageNumber:B}}}=t;r=t={annotationType:Yt.HIGHLIGHT,color:Array.from(T),thickness:S,inkLists:E,boxes:null,pageIndex:B-1,rect:_.slice(0),rotation:b,annotationElementId:A,id:A,deleted:!1,popupRef:C,comment:N?.str||null}}const{color:a,quadPoints:l,inkLists:c,opacity:h}=t,f=await super.deserialize(t,e,i);f.color=Bt.makeHexColor(...a),f.#g=h||1,c&&(f.#m=t.thickness),f._initialData=r,t.comment&&f.setCommentData(t.comment);const[p,m]=f.pageDimensions,[v,x]=f.pageTranslation;if(l){const E=f.#i=[];for(let _=0;_<l.length;_+=8)E.push({x:(l[_]-v)/p,y:1-(l[_+1]-x)/m,width:(l[_+2]-l[_])/p,height:(l[_+1]-l[_+5])/m});f.#v(),f.#w(),f.rotate(f.rotation)}else if(c){f.#u=!0;const E=c[0],_={x:E[0]-v,y:m-(E[1]-x)},b=new z0(_,[0,0,p,m],1,f.#m/2,!0,.001);for(let S=0,C=E.length;S<C;S+=2)_.x=E[S]-v,_.y=m-(E[S+1]-x),b.add(_);const{id:A,clipPathId:T}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:b.toSVGPath()}},!0,!0);f.#_({highlightOutlines:b.getOutlines(),highlightId:A,clipPathId:T}),f.#w(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=this.getPDFRect(),i=zt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),r={annotationType:Yt.HIGHLIGHT,color:i,opacity:this.#g,thickness:this.#m,quadPoints:this.#P(),outlines:this.#O(e),pageIndex:this.pageIndex,rect:e,rotation:this.#D(),structTreeParentId:this._structTreeParentId};return this.addComment(r),this.annotationElementId&&!this.#L(r)?null:(r.id=this.annotationElementId,r)}#L(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,r)=>i!==e[r])}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const e={rect:this.getPDFRect()};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}static canCreateNewEmptyEditor(){return!1}}class r_{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){De("Not implemented")}}class Wt extends zt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#s=null;static#r=NaN;static#a=null;static#o=null;static#c=NaN;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}_addOutlines(t){t.drawOutlines&&(this.#l(t),this.#d())}#l({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#f(t,this.parent),this.#h(t.box)}#f(t,e){const{id:i}=e.drawLayer.draw(Wt._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[r,a]of Object.entries(e))i.has(r)?Object.assign(t[r],a):t[r]=a;return t}static getDefaultDrawingOptions(t){De("Not implemented")}static get typesMap(){De("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(Wt.#i.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,e[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,e[r]]);return t}_updateProperty(t,e,i){const r=this._drawingOptions,a=r[e],l=c=>{r.updateProperty(e,c);const h=this.#t.updateProperty(e,c);h&&this.#h(h),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this._colorPicker?.update(c)};this.addCommands({cmd:l.bind(this,i),undo:l.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#p()),{bbox:this.#m()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#p()),{bbox:this.#m()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#m()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#m()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#u(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#d(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#u()):t&&(this._uiManager.addShouldRescale(this),this.#d(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#u(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#d(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#f(this.#t,t)}}#g([t,e,i,r]){const{parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[e,1-t,i*(l/a),r*(a/l)];case 180:return[1-t,1-e,i,r];case 270:return[1-e,t,i*(l/a),r*(a/l)];default:return[t,e,i,r]}}#p(){const{x:t,y:e,width:i,height:r,parentDimensions:[a,l],rotation:c}=this;switch(c){case 90:return[1-e,t,i*(a/l),r*(l/a)];case 180:return[1-t,1-e,i,r];case 270:return[e,1-t,i*(a/l),r*(l/a)];default:return[t,e,i,r]}}#h(t){if([this.x,this.y,this.width,this.height]=this.#g(t),this.div){this.fixAndSetPosition();const[e,i]=this.parentDimensions;this.setDims(this.width*e,this.height*i)}this._onResized()}#m(){const{x:t,y:e,width:i,height:r,rotation:a,parentRotation:l,parentDimensions:[c,h]}=this;switch((a*4+l)/90){case 1:return[1-e-r,t,r,i];case 2:return[1-t-i,1-e-r,i,r];case 3:return[e,1-t-i,r,i];case 4:return[t,e-i*(c/h),r*(h/c),i*(c/h)];case 5:return[1-e,t,i*(c/h),r*(h/c)];case 6:return[1-t-r*(h/c),1-e,r*(h/c),i*(c/h)];case 7:return[e-i*(c/h),1-t-r*(h/c),i*(c/h),r*(h/c)];case 8:return[t-i,e-r,i,r];case 9:return[1-e,t-i,r,i];case 10:return[1-t,1-e,i,r];case 11:return[e-r,1-t,r,i];case 12:return[t-r*(h/c),e,r*(h/c),i*(c/h)];case 13:return[1-e-i*(c/h),t-r*(h/c),i*(c/h),r*(h/c)];case 14:return[1-t,1-e-i*(c/h),r*(h/c),i*(c/h)];case 15:return[e,1-t,i*(c/h),r*(h/c)];default:return[t,e,i,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Wt._mergeSVGProperties({bbox:this.#m()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal";const[a,l]=this.parentDimensions;return this.setDims(this.width*a,this.height*l),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,r,a){De("Not implemented")}static startDrawing(t,e,i,r){const{target:a,offsetX:l,offsetY:c,pointerId:h,pointerType:f}=r;if(Wt.#a&&Wt.#a!==f)return;const{viewport:{rotation:p}}=t,{width:m,height:v}=a.getBoundingClientRect(),x=Wt.#n=new AbortController,E=t.combinedSignal(x);if(Wt.#r||=h,Wt.#a??=f,window.addEventListener("pointerup",_=>{Wt.#r===_.pointerId?this._endDraw(_):Wt.#o?.delete(_.pointerId)},{signal:E}),window.addEventListener("pointercancel",_=>{Wt.#r===_.pointerId?this._currentParent.endDrawingSession():Wt.#o?.delete(_.pointerId)},{signal:E}),window.addEventListener("pointerdown",_=>{Wt.#a===_.pointerType&&((Wt.#o||=new Set).add(_.pointerId),Wt.#i.isCancellable()&&(Wt.#i.removeLastElement(),Wt.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:E}),window.addEventListener("contextmenu",Nn,{signal:E}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:E}),a.addEventListener("touchmove",_=>{_.timeStamp===Wt.#c&&Qe(_)},{signal:E}),t.toggleDrawing(),e._editorUndoBar?.hide(),Wt.#i){t.drawLayer.updateProperties(this._currentDrawId,Wt.#i.startNew(l,c,m,v,p));return}e.updateUIForDefaultProperties(this),Wt.#i=this.createDrawerInstance(l,c,m,v,p),Wt.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Wt.#s.toSVGProperties(),Wt.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Wt.#c=-1,!Wt.#i)return;const{offsetX:e,offsetY:i,pointerId:r}=t;if(Wt.#r===r){if(Wt.#o?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Wt.#i.add(e,i)),Wt.#c=t.timeStamp,Qe(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Wt.#i=null,Wt.#s=null,Wt.#a=null,Wt.#c=NaN),Wt.#n&&(Wt.#n.abort(),Wt.#n=null,Wt.#r=NaN,Wt.#o=null)}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Wt.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=Wt.#i,r=this._currentDrawId,a=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(r,i.setLastElement(a))},undo:()=>{e.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:se.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(se.DRAW_STEP),!Wt.#i.isEmpty()){const{pageDimensions:[i,r],scale:a}=e,l=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Wt.#i.getOutlines(i*a,r*a,a,this._INNER_MARGIN),drawingOptions:Wt.#s,mustBeCommitted:!t});return this._cleanup(!0),l}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,r,a,l){De("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:r,pageHeight:a,pageX:l,pageY:c}}=e.viewport,h=this.deserializeDraw(l,c,r,a,this._INNER_MARGIN,t),f=await super.deserialize(t,e,i);return f.createDrawingOptions(t),f.#l({drawOutlines:h}),f.#d(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,i]=this.pageTranslation,[r,a]=this.pageDimensions;return this.#t.serialize([e,i,r,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class fT{#t=new Float64Array(6);#e;#i;#n;#s;#r;#a="";#o=0;#c=new dc;#l;#f;constructor(t,e,i,r,a,l){this.#l=i,this.#f=r,this.#n=a,this.#s=l,[t,e]=this.#u(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#i=[{line:c,points:this.#r}],this.#t.set(c,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#u(t,e){return Ft._normalizePoint(t,e,this.#l,this.#f,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#u(t,e);const[i,r,a,l]=this.#t.subarray(2,6),c=t-a,h=e-l;return Math.hypot(this.#l*c,this.#f*h)<=2?null:(this.#r.push(t,e),isNaN(i)?(this.#t.set([a,l,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,r,a,l,t,e],0),this.#e.push(...Ft.createBezierPoints(i,r,a,l,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,r,a){this.#l=i,this.#f=r,this.#n=a,[t,e]=this.#u(t,e);const l=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const c=this.#i.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#i.push({line:l,points:this.#r}),this.#t.set(l,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#a="";for(let t=0,e=this.#i.length;t<e;t++){const{line:i,points:r}=this.#i[t];this.#e=i,this.#r=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=Ft.svgRound(this.#e[4]),e=Ft.svgRound(this.#e[5]);if(this.#r.length===2)return this.#a=`${this.#a} M ${t} ${e} Z`,this.#a;if(this.#r.length<=6){const r=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,r)} M ${t} ${e}`,this.#o=6}if(this.#r.length===4){const r=Ft.svgRound(this.#e[10]),a=Ft.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${r} ${a}`,this.#o=12,this.#a}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let r=this.#o,a=this.#e.length;r<a;r+=6){const[l,c,h,f,p,m]=this.#e.slice(r,r+6).map(Ft.svgRound);i.push(`C${l} ${c} ${h} ${f} ${p} ${m}`)}return this.#a+=i.join(" "),this.#o=this.#e.length,this.#a}getOutlines(t,e,i,r){const a=this.#i.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#c.build(this.#i,t,e,i,this.#n,this.#s,r),this.#t=null,this.#e=null,this.#i=null,this.#a=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class dc extends Ft{#t;#e=0;#i;#n;#s;#r;#a;#o;#c;build(t,e,i,r,a,l,c){this.#s=e,this.#r=i,this.#a=r,this.#o=a,this.#c=l,this.#i=c??0,this.#n=t,this.#u()}get thickness(){return this.#c}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${Ft.svgRound(e[4])} ${Ft.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${Ft.svgRound(e[10])} ${Ft.svgRound(e[11])}`);continue}for(let i=6,r=e.length;i<r;i+=6){const[a,l,c,h,f,p]=e.subarray(i,i+6).map(Ft.svgRound);t.push(`C${a} ${l} ${c} ${h} ${f} ${p}`)}}return t.join("")}serialize([t,e,i,r],a){const l=[],c=[],[h,f,p,m]=this.#f();let v,x,E,_,b,A,T,S,C;switch(this.#o){case 0:C=Ft._rescale,v=t,x=e+r,E=i,_=-r,b=t+h*i,A=e+(1-f-m)*r,T=t+(h+p)*i,S=e+(1-f)*r;break;case 90:C=Ft._rescaleAndSwap,v=t,x=e,E=i,_=r,b=t+f*i,A=e+h*r,T=t+(f+m)*i,S=e+(h+p)*r;break;case 180:C=Ft._rescale,v=t+i,x=e,E=-i,_=r,b=t+(1-h-p)*i,A=e+f*r,T=t+(1-h)*i,S=e+(f+m)*r;break;case 270:C=Ft._rescaleAndSwap,v=t+i,x=e+r,E=-i,_=-r,b=t+(1-f-m)*i,A=e+(1-h-p)*r,T=t+(1-f)*i,S=e+(1-h)*r;break}for(const{line:N,points:B}of this.#n)l.push(C(N,v,x,E,_,a?new Array(N.length):null)),c.push(C(B,v,x,E,_,a?new Array(B.length):null));return{lines:l,points:c,rect:[b,A,T,S]}}static deserialize(t,e,i,r,a,{paths:{lines:l,points:c},rotation:h,thickness:f}){const p=[];let m,v,x,E,_;switch(h){case 0:_=Ft._rescale,m=-t/i,v=e/r+1,x=1/i,E=-1/r;break;case 90:_=Ft._rescaleAndSwap,m=-e/r,v=-t/i,x=1/r,E=1/i;break;case 180:_=Ft._rescale,m=t/i+1,v=-e/r,x=-1/i,E=1/r;break;case 270:_=Ft._rescaleAndSwap,m=e/r+1,v=t/i+1,x=-1/r,E=-1/i;break}if(!l){l=[];for(const A of c){const T=A.length;if(T===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1]]));continue}if(T===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,A[0],A[1],NaN,NaN,NaN,NaN,A[2],A[3]]));continue}const S=new Float32Array(3*(T-2));l.push(S);let[C,N,B,O]=A.subarray(0,4);S.set([NaN,NaN,NaN,NaN,C,N],0);for(let H=4;H<T;H+=2){const M=A[H],W=A[H+1];S.set(Ft.createBezierPoints(C,N,B,O,M,W),(H-2)*3),[C,N,B,O]=[B,O,M,W]}}}for(let A=0,T=l.length;A<T;A++)p.push({line:_(l[A].map(S=>S??NaN),m,v,x,E),points:_(c[A].map(S=>S??NaN),m,v,x,E)});const b=new this.prototype.constructor;return b.build(p,i,r,1,h,f,a),b}#l(t=this.#c){const e=this.#i+t/2*this.#a;return this.#o%180===0?[e/this.#s,e/this.#r]:[e/this.#r,e/this.#s]}#f(){const[t,e,i,r]=this.#t,[a,l]=this.#l(0);return[t+a,e+l,i-2*a,r-2*l]}#u(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#n){if(r.length<=12){for(let c=4,h=r.length;c<h;c+=6)Bt.pointBoundingBox(r[c],r[c+1],t);continue}let a=r[4],l=r[5];for(let c=6,h=r.length;c<h;c+=6){const[f,p,m,v,x,E]=r.subarray(c,c+6);Bt.bezierBoundingBox(a,l,f,p,m,v,x,E,t),a=x,l=E}}const[e,i]=this.#l();t[0]=Ii(t[0]-e,0,1),t[1]=Ii(t[1]-i,0,1),t[2]=Ii(t[2]+e,0,1),t[3]=Ii(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#d(e):null}#d(t){const[e,i]=this.#l();this.#c=t;const[r,a]=this.#l(),[l,c]=[r-e,a-i],h=this.#t;return h[0]-=l,h[1]-=c,h[2]+=2*l,h[3]+=2*c,h}updateParentDimensions([t,e],i){const[r,a]=this.#l();this.#s=t,this.#r=e,this.#a=i;const[l,c]=this.#l(),h=l-r,f=c-a,p=this.#t;return p[0]-=h,p[1]-=f,p[2]+=2*h,p[3]+=2*f,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(Ft.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ft.svgRound(t)} ${Ft.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,r=0,a=0,l=0,c=0,h=0;switch(this.#e){case 90:r=e/t,a=-t/e,c=t;break;case 180:i=-1,l=-1,c=t,h=e;break;case 270:r=-e/t,a=t/e,h=e;break;default:return""}return`matrix(${i} ${r} ${a} ${l} ${Ft.svgRound(c)} ${Ft.svgRound(h)})`}getPathResizingSVGProperties([t,e,i,r]){const[a,l]=this.#l(),[c,h,f,p]=this.#t;if(Math.abs(f-a)<=Ft.PRECISION||Math.abs(p-l)<=Ft.PRECISION){const _=t+i/2-(c+f/2),b=e+r/2-(h+p/2);return{path:{"transform-origin":`${Ft.svgRound(t)} ${Ft.svgRound(e)}`,transform:`${this.rotationTransform} translate(${_} ${b})`}}}const m=(i-2*a)/(f-2*a),v=(r-2*l)/(p-2*l),x=f/i,E=p/r;return{path:{"transform-origin":`${Ft.svgRound(c)} ${Ft.svgRound(h)}`,transform:`${this.rotationTransform} scale(${x} ${E}) translate(${Ft.svgRound(a)} ${Ft.svgRound(l)}) scale(${m} ${v}) translate(${Ft.svgRound(-a)} ${Ft.svgRound(-l)})`}}}getPathResizedSVGProperties([t,e,i,r]){const[a,l]=this.#l(),c=this.#t,[h,f,p,m]=c;if(c[0]=t,c[1]=e,c[2]=i,c[3]=r,Math.abs(p-a)<=Ft.PRECISION||Math.abs(m-l)<=Ft.PRECISION){const b=t+i/2-(h+p/2),A=e+r/2-(f+m/2);for(const{line:T,points:S}of this.#n)Ft._translate(T,b,A,T),Ft._translate(S,b,A,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ft.svgRound(t)} ${Ft.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(i-2*a)/(p-2*a),x=(r-2*l)/(m-2*l),E=-v*(h+a)+t+a,_=-x*(f+l)+e+l;if(v!==1||x!==1||E!==0||_!==0)for(const{line:b,points:A}of this.#n)Ft._rescale(b,E,_,v,x,b),Ft._rescale(A,E,_,v,x,A);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ft.svgRound(t)} ${Ft.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[r,a]=i,l=this.#t,c=t-l[0],h=e-l[1];if(this.#s===r&&this.#r===a)for(const{line:f,points:p}of this.#n)Ft._translate(f,c,h,f),Ft._translate(p,c,h,p);else{const f=this.#s/r,p=this.#r/a;this.#s=r,this.#r=a;for(const{line:m,points:v}of this.#n)Ft._rescale(m,c,h,f,p,m),Ft._rescale(v,c,h,f,p,v);l[2]*=f,l[3]*=p}return l[0]=t,l[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Ft.svgRound(t)} ${Ft.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Ft.svgRound(t[0])} ${Ft.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class kh extends r_{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:zt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new kh(this._viewParameters);return t.updateAll(this),t}}class pp extends Wt{static _type="ink";static _editorType=Yt.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){zt.initialize(t,e),this._defaultDrawingOptions=new kh(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return ee(this,"typesMap",new Map([[se.INK_THICKNESS,"stroke-width"],[se.INK_COLOR,"stroke"],[se.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,r,a){return new fT(t,e,i,r,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,r,a,l){return dc.deserialize(t,e,i,r,a,l)}static async deserialize(t,e,i){let r=null;if(t instanceof dp){const{data:{inkLists:l,rect:c,rotation:h,id:f,color:p,opacity:m,borderStyle:{rawWidth:v},popupRef:x,contentsObj:E},parent:{page:{pageNumber:_}}}=t;r=t={annotationType:Yt.INK,color:Array.from(p),thickness:v,opacity:m,paths:{points:l},boxes:null,pageIndex:_-1,rect:c.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:x,comment:E?.str||null}}const a=await super.deserialize(t,e,i);return a._initialData=r,t.comment&&a.setCommentData(t.comment),a}get toolbarButtons(){return this._colorPicker||=new Ql(this),[["colorPicker",this._colorPicker]]}get colorType(){return se.INK_COLOR}get colorValue(){return this._drawingOptions.stroke}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=pp.getDefaultDrawingOptions({stroke:Bt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":l,"stroke-width":c}}=this,h={annotationType:Yt.INK,color:zt._colorManager.convert(a),opacity:l,thickness:c,paths:{lines:e,points:i},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(h),t?(h.isCopy=!0,h):this.annotationElementId&&!this.#t(h)?null:(h.id=this.annotationElementId,h)}#t(t){const{color:e,thickness:i,opacity:r,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((l,c)=>l!==e[c])||t.thickness!==i||t.opacity!==r||t.pageIndex!==a}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1),r={rect:i,thickness:this._drawingOptions["stroke-width"],points:e};return this.hasEditedComment&&(r.popup=this.comment),t.updateEdited(r),null}}class V0 extends dc{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Vu=8,Nl=3;let so=class{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,r){return i-=t,r-=e,i===0?r>0?0:4:i===1?r+6:2-r}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,i,r,a,l,c){const h=this.#e(i,r,a,l);for(let f=0;f<8;f++){const p=(-f+h-c+16)%8,m=this.#i[2*p],v=this.#i[2*p+1];if(t[(i+m)*e+(r+v)]!==0)return p}return-1}static#s(t,e,i,r,a,l,c){const h=this.#e(i,r,a,l);for(let f=0;f<8;f++){const p=(f+h+c+16)%8,m=this.#i[2*p],v=this.#i[2*p+1];if(t[(i+m)*e+(r+v)]!==0)return p}return-1}static#r(t,e,i,r){const a=t.length,l=new Int32Array(a);for(let p=0;p<a;p++)l[p]=t[p]<=r?1:0;for(let p=1;p<i-1;p++)l[p*e]=l[p*e+e-1]=0;for(let p=0;p<e;p++)l[p]=l[e*i-1-p]=0;let c=1,h;const f=[];for(let p=1;p<i-1;p++){h=1;for(let m=1;m<e-1;m++){const v=p*e+m,x=l[v];if(x===0)continue;let E=p,_=m;if(x===1&&l[v-1]===0)c+=1,_-=1;else if(x>=1&&l[v+1]===0)c+=1,_+=1,x>1&&(h=x);else{x!==1&&(h=Math.abs(x));continue}const b=[m,p],A=_===m+1,T={isHole:A,points:b,id:c,parent:0};f.push(T);let S;for(const Y of f)if(Y.id===h){S=Y;break}S?S.isHole?T.parent=A?S.parent:h:T.parent=A?h:S.parent:T.parent=A?h:0;const C=this.#n(l,e,p,m,E,_,0);if(C===-1){l[v]=-c,l[v]!==1&&(h=Math.abs(l[v]));continue}let N=this.#i[2*C],B=this.#i[2*C+1];const O=p+N,H=m+B;E=O,_=H;let M=p,W=m;for(;;){const Y=this.#s(l,e,M,W,E,_,1);N=this.#i[2*Y],B=this.#i[2*Y+1];const J=M+N,ut=W+B;b.push(ut,J);const At=M*e+W;if(l[At+1]===0?l[At]=-c:l[At]===1&&(l[At]=c),J===p&&ut===m&&M===O&&W===H){l[v]!==1&&(h=Math.abs(l[v]));break}else E=M,_=W,M=J,W=ut}}}return f}static#a(t,e,i,r){if(i-e<=4){for(let O=e;O<i-2;O+=2)r.push(t[O],t[O+1]);return}const a=t[e],l=t[e+1],c=t[i-4]-a,h=t[i-3]-l,f=Math.hypot(c,h),p=c/f,m=h/f,v=p*l-m*a,x=h/c,E=1/f,_=Math.atan(x),b=Math.cos(_),A=Math.sin(_),T=E*(Math.abs(b)+Math.abs(A)),S=E*(1-T+T**2),C=Math.max(Math.atan(Math.abs(A+b)*S),Math.atan(Math.abs(A-b)*S));let N=0,B=e;for(let O=e+2;O<i-2;O+=2){const H=Math.abs(v-p*t[O+1]+m*t[O]);H>N&&(B=O,N=H)}N>(f*C)**2?(this.#a(t,e,B+2,r),this.#a(t,B,i,r)):r.push(a,l)}static#o(t){const e=[],i=t.length;return this.#a(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#c(t,e,i,r,a,l){const c=new Float32Array(l**2),h=-2*r**2,f=l>>1;for(let _=0;_<l;_++){const b=(_-f)**2;for(let A=0;A<l;A++)c[_*l+A]=Math.exp((b+(A-f)**2)/h)}const p=new Float32Array(256),m=-2*a**2;for(let _=0;_<256;_++)p[_]=Math.exp(_**2/m);const v=t.length,x=new Uint8Array(v),E=new Uint32Array(256);for(let _=0;_<i;_++)for(let b=0;b<e;b++){const A=_*e+b,T=t[A];let S=0,C=0;for(let B=0;B<l;B++){const O=_+B-f;if(!(O<0||O>=i))for(let H=0;H<l;H++){const M=b+H-f;if(M<0||M>=e)continue;const W=t[O*e+M],Y=c[B*l+H]*p[Math.abs(W-T)];S+=W*Y,C+=Y}}const N=x[A]=Math.round(S/C);E[N]++}return[x,E]}static#l(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#f(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let r=-1/0,a=1/0;for(let c=0,h=i.length;c<h;c++){const f=i[c]=t[c<<2];r=Math.max(r,f),a=Math.min(a,f)}const l=255/(r-a);for(let c=0,h=i.length;c<h;c++)i[c]=(i[c]-a)*l;return i}static#u(t){let e,i=-1/0,r=-1/0;const a=t.findIndex(h=>h!==0);let l=a,c=a;for(e=a;e<256;e++){const h=t[e];h>i&&(e-l>r&&(r=e-l,c=e-1),i=h,l=e)}for(e=c-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#d(t){const e=t,{width:i,height:r}=t,{maxDim:a}=this.#t;let l=i,c=r;if(i>a||r>a){let v=i,x=r,E=Math.log2(Math.max(i,r)/a);const _=Math.floor(E);E=E===_?_-1:_;for(let A=0;A<E;A++){l=Math.ceil(v/2),c=Math.ceil(x/2);const T=new OffscreenCanvas(l,c);T.getContext("2d").drawImage(t,0,0,v,x,0,0,l,c),v=l,x=c,t!==e&&t.close(),t=T.transferToImageBitmap()}const b=Math.min(a/l,a/c);l=Math.round(l*b),c=Math.round(c*b)}const f=new OffscreenCanvas(l,c).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,c),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,l,c);const p=f.getImageData(0,0,l,c).data;return[this.#f(p),l,c]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:r},a,l,c,h){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const m=200,v=p.font=`${i} ${r} ${m}px ${e}`,{actualBoundingBoxLeft:x,actualBoundingBoxRight:E,actualBoundingBoxAscent:_,actualBoundingBoxDescent:b,fontBoundingBoxAscent:A,fontBoundingBoxDescent:T,width:S}=p.measureText(t),C=1.5,N=Math.ceil(Math.max(Math.abs(x)+Math.abs(E)||0,S)*C),B=Math.ceil(Math.max(Math.abs(_)+Math.abs(b)||m,Math.abs(A)+Math.abs(T)||m)*C);f=new OffscreenCanvas(N,B),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=v,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,N,B),p.fillStyle="black",p.fillText(t,N*(C-1)/2,B*(3-C)/2);const O=this.#f(p.getImageData(0,0,N,B).data),H=this.#l(O),M=this.#u(H),W=this.#r(O,N,B,M);return this.processDrawnLines({lines:{curves:W,width:N,height:B},pageWidth:a,pageHeight:l,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,e,i,r,a){const[l,c,h]=this.#d(t),[f,p]=this.#c(l,c,h,Math.hypot(c,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),m=this.#u(p),v=this.#r(f,c,h,m);return this.processDrawnLines({lines:{curves:v,width:c,height:h},pageWidth:e,pageHeight:i,rotation:r,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:r,innerMargin:a,mustSmooth:l,areContours:c}){r%180!==0&&([e,i]=[i,e]);const{curves:h,width:f,height:p}=t,m=t.thickness??0,v=[],x=Math.min(e/f,i/p),E=x/e,_=x/i,b=[];for(const{points:T}of h){const S=l?this.#o(T):T;if(!S)continue;b.push(S);const C=S.length,N=new Float32Array(C),B=new Float32Array(3*(C===2?2:C-2));if(v.push({line:B,points:N}),C===2){N[0]=S[0]*E,N[1]=S[1]*_,B.set([NaN,NaN,NaN,NaN,N[0],N[1]],0);continue}let[O,H,M,W]=S;O*=E,H*=_,M*=E,W*=_,N.set([O,H,M,W],0),B.set([NaN,NaN,NaN,NaN,O,H],0);for(let Y=4;Y<C;Y+=2){const J=N[Y]=S[Y]*E,ut=N[Y+1]=S[Y+1]*_;B.set(Ft.createBezierPoints(O,H,M,W,J,ut),(Y-2)*3),[O,H,M,W]=[M,W,J,ut]}}if(v.length===0)return null;const A=c?new V0:new dc;return A.build(v,e,i,1,r,c?0:m,a),{outline:A,newCurves:b,areContours:c,thickness:m,width:f,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:r,height:a}){let l=1/0,c=-1/0,h=0;for(const S of t){h+=S.length;for(let C=2,N=S.length;C<N;C++){const B=S[C]-S[C-2];l=Math.min(l,B),c=Math.max(c,B)}}let f;l>=-128&&c<=127?f=Int8Array:l>=-32768&&c<=32767?f=Int16Array:f=Int32Array;const p=t.length,m=Vu+Nl*p,v=new Uint32Array(m);let x=0;v[x++]=m*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*f.BYTES_PER_ELEMENT,v[x++]=0,v[x++]=r,v[x++]=a,v[x++]=e?0:1,v[x++]=Math.max(0,Math.floor(i??0)),v[x++]=p,v[x++]=f.BYTES_PER_ELEMENT;for(const S of t)v[x++]=S.length-2,v[x++]=S[0],v[x++]=S[1];const E=new CompressionStream("deflate-raw"),_=E.writable.getWriter();await _.ready,_.write(v);const b=f.prototype.constructor;for(const S of t){const C=new b(S.length-2);for(let N=2,B=S.length;N<B;N++)C[N-2]=S[N]-S[N-2];_.write(C)}_.close();const A=await new Response(E.readable).arrayBuffer(),T=new Uint8Array(A);return Cy(T)}static async decompressSignature(t){try{const e=Lw(t),{readable:i,writable:r}=new DecompressionStream("deflate-raw"),a=r.getWriter();await a.ready,a.write(e).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let l=null,c=0;for await(const S of i)l||=new Uint8Array(new Uint32Array(S.buffer,0,4)[0]),l.set(S,c),c+=S.length;const h=new Uint32Array(l.buffer,0,l.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=h[2],m=h[3],v=h[4]===0,x=h[5],E=h[6],_=h[7],b=[],A=(Vu+Nl*E)*Uint32Array.BYTES_PER_ELEMENT;let T;switch(_){case Int8Array.BYTES_PER_ELEMENT:T=new Int8Array(l.buffer,A);break;case Int16Array.BYTES_PER_ELEMENT:T=new Int16Array(l.buffer,A);break;case Int32Array.BYTES_PER_ELEMENT:T=new Int32Array(l.buffer,A);break}c=0;for(let S=0;S<E;S++){const C=h[Nl*S+Vu],N=new Float32Array(C+2);b.push(N);for(let B=0;B<Nl-1;B++)N[B]=h[Nl*S+Vu+B+1];for(let B=0;B<C;B++)N[B+2]=N[B]+T[c++]}return{areContours:v,thickness:x,outlines:b,width:p,height:m}}catch(e){return qt(`decompressSignature: ${e}`),null}}};class gp extends r_{constructor(){super(),super.updateProperties({fill:zt._defaultLineColor,"stroke-width":0})}clone(){const t=new gp;return t.updateAll(this),t}}class mp extends kh{constructor(t){super(t),super.updateProperties({stroke:zt._defaultLineColor,"stroke-width":1})}clone(){const t=new mp(this._viewParameters);return t.updateAll(this),t}}class or extends Wt{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=Yt.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){zt.initialize(t,e),this._defaultDrawingOptions=new gp,this._defaultDrawnSignatureOptions=new mp(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return ee(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:r,mustSmooth:a,areContours:l,description:c,uuid:h,heightInPage:f}=this.#i,{rawDims:{pageWidth:p,pageHeight:m},rotation:v}=this.parent.viewport,x=so.processDrawnLines({lines:r,pageWidth:p,pageHeight:m,rotation:v,innerMargin:or._INNER_MARGIN,mustSmooth:a,areContours:l});this.addSignature(x,f,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:r,height:a}=this.#i,l=Math.max(r,a),c=so.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:i,width:r,height:a},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,r){const{x:a,y:l}=this,{outline:c}=this.#i=t;this.#t=c instanceof V0,this.description=i;let h;this.#t?h=or.getDefaultDrawingOptions():(h=or._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[f,p]=this.parentDimensions,[,m]=this.pageDimensions;let v=e/m;v=v>=1?.5:v,this.width*=v/this.height,this.width>=1&&(v*=.9/this.width,this.width=.9),this.height=v,this.setDims(f*this.width,p*this.height),this.x=a,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:r}=this.parent.viewport;return so.process(t,e,i,r,or._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:r},rotation:a}=this.parent.viewport;return so.extractContoursFromText(t,e,i,r,a,or._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:r}=this.parent.viewport;return so.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:r,innerMargin:or._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=or.getDefaultDrawingOptions():(this._drawingOptions=or._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i,rect:r}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,l={annotationType:Yt.SIGNATURE,isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a,pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return this.addComment(l),t?(l.paths={lines:e,points:i},l.uuid=this.#n,l.isCopy=!0):l.lines=e,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,e,i,r,a,l){return l.areContours?V0.deserialize(t,e,i,r,a,l):dc.deserialize(t,e,i,r,a,l)}static async deserialize(t,e,i){const r=await super.deserialize(t,e,i);return r.#t=t.areContours,r.description=t.accessibilityData?.alt||"",r.#n=t.uuid,r}}class dT extends zt{#t=null;#e=null;#i=null;#n=null;#s=null;#r="";#a=null;#o=!1;#c=null;#l=!1;#f=!1;static _type="stamp";static _editorType=Yt.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){zt.initialize(t,e)}static isHandlingMimeForPasting(t){return L0.includes(t)}static paste(t,e){e.pasteEditor({mode:Yt.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#u(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#r=t.file.name),this.#p()}#d(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:a,height:l}=t||this.copyCanvas(null,null,!0).imageData,c=await i.guess({name:"altText",request:{data:r,width:a,height:l,channels:r.length/(a*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),e&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#u(i,!0)).finally(()=>this.#d());return}if(this.#n){const i=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(i).then(r=>this.#u(r)).finally(()=>this.#d());return}if(this.#s){const i=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(i).then(r=>this.#u(r)).finally(()=>this.#d());return}const t=document.createElement("input");t.type="file",t.accept=L0.join(",");const e=this._uiManager._signal;this.#i=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#u(r)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#d()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#s||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#p():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,r&&(this.#t=r),this.#o=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#m()},t)}#p(){const{div:t}=this;let{width:e,height:i}=this.#t;const[r,a]=this.pageDimensions,l=.75;if(this.width)e=this.width*r,i=this.height*a;else if(e>l*r||i>l*a){const p=Math.min(l*r/e,l*a/i);e*=p,i*=p}const[c,h]=this.parentDimensions;this.setDims(e*c/r,i*h/a),this._uiManager.enableWaiting(!1);const f=this.#a=document.createElement("canvas");f.setAttribute("role","img"),this.addContainer(f),this.width=e/r,this.height=i/a,this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#m(),this.#f||(this.parent.addUndoableEditor(this),this.#f=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:r,height:a}=this.#t,l=new na;let c=this.#t,h=r,f=a,p=null;if(e){if(r>e||a>e){const B=Math.min(e/r,e/a);h=Math.floor(r*B),f=Math.floor(a*B)}p=document.createElement("canvas");const v=p.width=Math.ceil(h*l.sx),x=p.height=Math.ceil(f*l.sy);this.#l||(c=this.#h(v,x));const E=p.getContext("2d");E.filter=this._uiManager.hcmFilter;let _="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":window.matchMedia?.("(prefers-color-scheme: dark)").matches&&(_="#8f8f9d",b="#42414d");const A=15,T=A*l.sx,S=A*l.sy,C=new OffscreenCanvas(T*2,S*2),N=C.getContext("2d");N.fillStyle=_,N.fillRect(0,0,T*2,S*2),N.fillStyle=b,N.fillRect(0,0,T,S),N.fillRect(T,S,T,S),E.fillStyle=E.createPattern(C,"repeat"),E.fillRect(0,0,v,x),E.drawImage(c,0,0,c.width,c.height,0,0,v,x)}let m=null;if(i){let v,x;if(l.symmetric&&c.width<t&&c.height<t)v=c.width,x=c.height;else if(c=this.#t,r>t||a>t){const b=Math.min(t/r,t/a);v=Math.floor(r*b),x=Math.floor(a*b),this.#l||(c=this.#h(v,x))}const _=new OffscreenCanvas(v,x).getContext("2d",{willReadFrequently:!0});_.drawImage(c,0,0,c.width,c.height,0,0,v,x),m={width:v,height:x,data:_.getImageData(0,0,v,x).data}}return{canvas:p,width:h,height:f,imageData:m}}#h(t,e){const{width:i,height:r}=this.#t;let a=i,l=r,c=this.#t;for(;a>2*t||l>2*e;){const h=a,f=l;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),l>2*e&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const p=new OffscreenCanvas(a,l);p.getContext("2d").drawImage(c,0,0,h,f,0,0,a,l),c=p.transferToImageBitmap()}return c}#m(){const[t,e]=this.parentDimensions,{width:i,height:r}=this,a=new na,l=Math.ceil(i*t*a.sx),c=Math.ceil(r*e*a.sy),h=this.#a;if(!h||h.width===l&&h.height===c)return;h.width=l,h.height=c;const f=this.#l?this.#t:this.#h(l,c),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,l,c)}#y(t){if(t){if(this.#l){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,i]=this.pageDimensions,r=Math.round(this.width*e*Eo.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*Eo.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(r,a);return l.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,a),l.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let r=null,a=!1;if(t instanceof e_){const{data:{rect:_,rotation:b,id:A,structParent:T,popupRef:S,contentsObj:C},container:N,parent:{page:{pageNumber:B}},canvas:O}=t;let H,M;O?(delete t.canvas,{id:H,bitmap:M}=i.imageManager.getFromCanvas(N.id,O),O.remove()):(a=!0,t._hasNoCanvas=!0);const W=(await e._structTree.getAriaAttributes(`${ip}${A}`))?.get("aria-label")||"";r=t={annotationType:Yt.STAMP,bitmapId:H,bitmap:M,pageIndex:B-1,rect:_.slice(0),rotation:b,annotationElementId:A,id:A,deleted:!1,accessibilityData:{decorative:!1,altText:W},isSvg:!1,structParent:T,popupRef:S,comment:C?.str||null}}const l=await super.deserialize(t,e,i),{rect:c,bitmap:h,bitmapUrl:f,bitmapId:p,isSvg:m,accessibilityData:v}=t;a?(i.addMissingCanvas(t.id,l),l.#o=!0):p&&i.imageManager.isValidId(p)?(l.#e=p,h&&(l.#t=h)):l.#n=f,l.#l=m;const[x,E]=l.pageDimensions;return l.width=(c[2]-c[0])/x,l.height=(c[3]-c[1])/E,v&&(l.altTextData=v),l._initialData=r,t.comment&&l.setCommentData(t.comment),l.#f=!!r,l}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i={annotationType:Yt.STAMP,bitmapId:this.#e,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,isSvg:this.#l,structTreeParentId:this._structTreeParentId};if(this.addComment(i),t)return i.bitmapUrl=this.#y(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:a}=this.serializeAltText(!1);if(!r&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const c=this.#v(i);if(c.isSame)return null;c.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1}if(i.id=this.annotationElementId,e===null)return i;e.stamps||=new Map;const l=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:l,serialized:i}),i.bitmap=this.#y(!1);else if(this.#l){const c=e.stamps.get(this.#e);l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=this.#y(!1))}return i}#v(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===e,a=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&a,isSameAltText:a}}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const e={rect:this.getPDFRect()};return this.hasEditedComment&&(e.popup=this.comment),t.updateEdited(e),null}}let pT=class ds{#t;#e=!1;#i=null;#n=null;#s=null;#r=new Map;#a=!1;#o=!1;#c=!1;#l=null;#f=null;#u=null;#d=null;#g=null;#p=-1;#h;static _initialized=!1;static#m=new Map([ui,pp,dT,Ge,or].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:r,accessibilityManager:a,annotationLayer:l,drawLayer:c,textLayer:h,viewport:f,l10n:p}){const m=[...ds.#m.values()];if(!ds._initialized){ds._initialized=!0;for(const v of m)v.initialize(p,t)}t.registerEditorTypes(m),this.#h=t,this.pageIndex=e,this.div=i,this.#t=a,this.#i=l,this.viewport=f,this.#u=h,this.drawLayer=c,this._structTree=r,this.#h.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#h.getMode()===Yt.NONE}updateToolbar(t){this.#h.updateToolbar(t)}updateMode(t=this.#h.getMode()){switch(this.#x(),t){case Yt.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Yt.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Yt.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;for(const i of ds.#m.values())e.toggle(`${i._type}Editing`,t===i._editorType);this.div.hidden=!1}hasTextLayer(t){return t===this.#u?.div}setEditingState(t){this.#h.setEditingState(t)}addCommands(t){this.#h.addCommands(t)}cleanUndoStack(t){this.#h.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.div.classList.toggle("disabled",!t)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.#g?.abort(),this.#g=null;const t=new Set;for(const i of this.#r.values())i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#h.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));if(!this.#i){this.#c=!1;return}const e=this.#i.getEditableAnnotations();for(const i of e){if(i.hide(),this.#h.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.#u&&!this.#g){this.#g=new AbortController;const r=this.#h.combinedSignal(this.#g);this.#u.div.addEventListener("pointerdown",a=>{const{clientX:c,clientY:h,timeStamp:f}=a,p=this.#p;if(f-p>500){this.#p=f;return}this.#p=-1;const{classList:m}=this.div;m.toggle("getElements",!0);const v=document.elementsFromPoint(c,h);if(m.toggle("getElements",!1),!this.div.contains(v[0]))return;let x;const E=new RegExp(`^${by}[0-9]+$`);for(const b of v)if(E.test(b.id)){x=b.id;break}if(!x)return;const _=this.#r.get(x);_?.annotationElementId===null&&(a.stopPropagation(),a.preventDefault(),_.dblclick())},{signal:r,capture:!0})}const t=new Map,e=new Map;for(const r of this.#r.values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){t.set(r.annotationElementId,r);continue}else e.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}if(this.#i){const r=this.#i.getEditableAnnotations();for(const a of r){const{id:l}=a.data;if(this.#h.isDeletedAnnotationElement(l)){a.updateEdited({deleted:!0});continue}let c=e.get(l);if(c){c.resetAnnotationElement(a),c.show(!1),a.show();continue}c=t.get(l),c&&(this.#h.addChangedExistingAnnotation(c),c.renderAnnotationElement(a)&&c.show(!1)),a.show()}}this.#x(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of ds.#m.values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#h.getActive()!==t&&this.#h.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#u?.div&&!this.#d){this.#d=new AbortController;const t=this.#h.combinedSignal(this.#d);this.#u.div.addEventListener("pointerdown",this.#y.bind(this),{signal:t}),this.#u.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#u?.div&&this.#d&&(this.#d.abort(),this.#d=null,this.#u.div.classList.remove("highlighting"))}#y(t){this.#h.unselectAll();const{target:e}=t;if(e===this.#u.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#u.div.contains(e)){const{isMac:i}=wi.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#h.showAllEditors("highlight",!0,!0),this.#u.div.classList.add("free"),this.toggleDrawing(),Ge.startHighlighting(this,this.#h.direction==="ltr",{target:this.#u.div,x:t.x,y:t.y}),this.#u.div.addEventListener("pointerup",()=>{this.#u.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#h._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#h.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#h.isDeletedAnnotationElement(e)&&this.#h.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#h.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#h.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#h.addDeletedAnnotationElement(t.annotationElementId),zt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#h.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#h.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#h._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getNextId(){return this.#h.getId()}get#v(){return ds.#m.get(this.#h.getMode())}combinedSignal(t){return this.#h.combinedSignal(t)}#_(t){const e=this.#v;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#h.updateMode(t.mode);const{offsetX:i,offsetY:r}=this.#E(),a=this.getNextId(),l=this.#_({parent:this,id:a,x:i,y:r,uiManager:this.#h,isCentered:!0,...e});l&&this.add(l)}async deserialize(t){return await ds.#m.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#h)||null}createAndAddNewEditor(t,e,i={}){const r=this.getNextId(),a=this.#_({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#h,isCentered:e,...i});return a&&this.add(a),a}#E(){const{x:t,y:e,width:i,height:r}=this.div.getBoundingClientRect(),a=Math.max(0,t),l=Math.max(0,e),c=Math.min(window.innerWidth,t+i),h=Math.min(window.innerHeight,e+r),f=(a+c)/2-t,p=(l+h)/2-e,[m,v]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:m,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#E(),!0,t)}setSelected(t){this.#h.setSelected(t)}toggleSelected(t){this.#h.toggleSelected(t)}unselect(t){this.#h.unselect(t)}pointerup(t){const{isMac:e}=wi.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#a||(this.#a=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#h.getMode();if(i===Yt.STAMP||i===Yt.SIGNATURE){this.#h.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#h.getMode()===Yt.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:e}=wi.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#a=!0,this.#v?.isDrawer){this.startDrawingSession(t);return}const i=this.#h.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#h,!1,t);return}this.#h.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#h.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#f=null,this.commitOrRemove())},{signal:e}),this.#v.startDrawing(this,this.#h,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#f=e);return}this.#f&&setTimeout(()=>{this.#f?.focus(),this.#f=null},0)}endDrawingSession(t=!1){return this.#l?(this.#h.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#f=null,this.#v.endDrawing(t)):null}findNewParent(t,e,i){const r=this.#h.findParent(e,i);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#h.getActive()?.parent===this&&(this.#h.commitOrRemove(),this.#h.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#h.removeLayer(this)}#x(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,ia(this.div,t);for(const e of this.#h.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#h.commitOrRemove(),this.#x();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,ia(this.div,{rotation:i}),e!==i)for(const r of this.#r.values())r.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#h.viewParameters.realScale}},gT=class Mi{#t=null;#e=new Map;#i=new Map;static#n=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return ee(this,"_svgFactory",new uh)}static#s(t,[e,i,r,a]){const{style:l}=t;l.top=`${100*i}%`,l.left=`${100*e}%`,l.width=`${100*r}%`,l.height=`${100*a}%`}#r(){const t=Mi._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,e){const i=Mi._svgFactory.createElement("clipPath");t.append(i);const r=`clip_${e}`;i.setAttribute("id",r),i.setAttribute("clipPathUnits","objectBoundingBox");const a=Mi._svgFactory.createElement("use");return i.append(a),a.setAttribute("href",`#${e}`),a.classList.add("clip"),r}#o(t,e){for(const[i,r]of Object.entries(e))r===null?t.removeAttribute(i):t.setAttribute(i,r)}draw(t,e=!1,i=!1){const r=Mi.#n++,a=this.#r(),l=Mi._svgFactory.createElement("defs");a.append(l);const c=Mi._svgFactory.createElement("path");l.append(c);const h=`path_p${this.pageIndex}_${r}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(r,c);const f=i?this.#a(l,h):null,p=Mi._svgFactory.createElement("use");return a.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(a,t),this.#e.set(r,a),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,e){const i=Mi.#n++,r=this.#r(),a=Mi._svgFactory.createElement("defs");r.append(a);const l=Mi._svgFactory.createElement("path");a.append(l);const c=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const m=Mi._svgFactory.createElement("mask");a.append(m),h=`mask_p${this.pageIndex}_${i}`,m.setAttribute("id",h),m.setAttribute("maskUnits","objectBoundingBox");const v=Mi._svgFactory.createElement("rect");m.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const x=Mi._svgFactory.createElement("use");m.append(x),x.setAttribute("href",`#${c}`),x.setAttribute("stroke","none"),x.setAttribute("fill","black"),x.setAttribute("fill-rule","nonzero"),x.classList.add("mask")}const f=Mi._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const p=f.cloneNode();return r.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(i,r),i}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:r,rootClass:a,path:l}=e,c=typeof t=="number"?this.#e.get(t):t;if(c){if(i&&this.#o(c,i),r&&Mi.#s(c,r),a){const{classList:h}=c;for(const[f,p]of Object.entries(a))h.toggle(f,p)}if(l){const f=c.firstChild.firstChild;this.#o(f,l)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}};globalThis._pdfjsTestingUtils={HighlightOutliner:j0};globalThis.pdfjsLib={AbortException:_s,AnnotationEditorLayer:pT,AnnotationEditorParamsType:se,AnnotationEditorType:Yt,AnnotationEditorUIManager:ql,AnnotationLayer:cT,AnnotationMode:gs,AnnotationType:Ke,build:VS,ColorPicker:qy,createValidAbsoluteUrl:Ay,DOMSVGFactory:uh,DrawLayer:gT,FeatureTest:wi,fetchData:cc,getDocument:Wy,getFilenameFromUrl:Pw,getPdfFilenameFromUrl:kw,getRGB:Lh,getUuid:Ty,getXfaPageViewport:Iw,GlobalWorkerOptions:ho,ImageKind:nh,InvalidPDFException:M0,isDataScheme:Oh,isPdfFile:rp,isValidExplicitDest:$w,MathClamp:Ii,noContextMenu:Nn,normalizeUnicode:Nw,OPS:$l,OutputScale:na,PasswordResponses:bw,PDFDataRangeTransport:Xy,PDFDateString:N0,PDFWorker:U0,PermissionFlag:Ew,PixelsPerInch:Eo,RenderingCancelledException:np,ResponseException:lh,setLayerDimensions:ia,shadow:ee,SignatureExtractor:so,stopEvent:Qe,SupportedImageMimeTypes:L0,TextLayer:B0,TouchManager:Dy,updateUrlHash:wy,Util:Bt,VerbosityLevel:Dh,version:zS,XfaLayer:Ky};const mT="/Doc_Review/assets/pdf.worker.min-r-TJsTTt.mjs",{AbortException:vT,AnnotationEditorLayer:xT,AnnotationEditorParamsType:X4,AnnotationEditorType:$i,AnnotationEditorUIManager:yT,AnnotationLayer:_T,AnnotationMode:Nr,AnnotationType:s_,build:Y4,ColorPicker:$4,createValidAbsoluteUrl:a_,DOMSVGFactory:q4,DrawLayer:ET,FeatureTest:bT,fetchData:ix,getDocument:K4,getFilenameFromUrl:Q4,getPdfFilenameFromUrl:AT,getRGB:Z4,getUuid:J4,getXfaPageViewport:t3,GlobalWorkerOptions:e3,ImageKind:i3,InvalidPDFException:n3,isDataScheme:r3,isPdfFile:wT,isValidExplicitDest:ST,MathClamp:vp,noContextMenu:s3,normalizeUnicode:TT,OPS:a3,OutputScale:ah,PasswordResponses:o3,PDFDataRangeTransport:l3,PDFDateString:c3,PDFWorker:u3,PermissionFlag:Ja,PixelsPerInch:Dr,RenderingCancelledException:G0,ResponseException:h3,setLayerDimensions:o_,shadow:hh,SignatureExtractor:f3,stopEvent:W0,SupportedImageMimeTypes:d3,TextLayer:CT,TouchManager:p3,updateUrlHash:RT,Util:xp,VerbosityLevel:g3,version:nx,XfaLayer:d0}=globalThis.pdfjsLib,DT="auto",l_=1,rx=1.1,MT=.1,NT=10,p0=0,OT=1.25,sx=40,ax=5,de={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3},fo={UNKNOWN:0,NORMAL:1,CHANGING:2,FULLSCREEN:3},ur={DISABLE:0,ENABLE:1,ENABLE_PERMISSIONS:2},le={UNKNOWN:-1,VERTICAL:0,HORIZONTAL:1,WRAPPED:2,PAGE:3},Ni={UNKNOWN:-1,NONE:0,ODD:1,EVEN:2};function c_(n,t,e=!1){let i=n.offsetParent;if(!i){console.error("offsetParent is not set -- cannot scroll");return}let r=n.offsetTop+n.clientTop,a=n.offsetLeft+n.clientLeft;for(;i.clientHeight===i.scrollHeight&&i.clientWidth===i.scrollWidth||e&&(i.classList.contains("markedContent")||getComputedStyle(i).overflow==="hidden");)if(r+=i.offsetTop,a+=i.offsetLeft,i=i.offsetParent,!i)return;if(t&&(t.top!==void 0&&(r+=t.top),t.left!==void 0)){if(e){const l=n.getBoundingClientRect().width,c=vp((i.clientWidth-l)/2,20,400);a+=t.left-c}else a+=t.left;i.scrollLeft=a}i.scrollTop=r}function LT(n,t,e=void 0){const i=function(l){a||(a=window.requestAnimationFrame(function(){a=null;const h=n.scrollLeft,f=r.lastX;h!==f&&(r.right=h>f),r.lastX=h;const p=n.scrollTop,m=r.lastY;p!==m&&(r.down=p>m),r.lastY=p,t(r)}))},r={right:!0,down:!0,lastX:n.scrollLeft,lastY:n.scrollTop,_eventHandler:i};let a=null;return n.addEventListener("scroll",i,{useCapture:!0,signal:e}),e?.addEventListener("abort",()=>window.cancelAnimationFrame(a),{once:!0}),r}function Fh(n){const t=new Map;for(const[e,i]of new URLSearchParams(n))t.set(e.toLowerCase(),i);return t}const ox=/[\x00-\x1F]/g;function Ul(n,t=!1){return ox.test(n)?t?n.replaceAll(ox,e=>e==="\0"?"":" "):n.replaceAll("\0",""):n}function Zl(n,t,e=0){let i=e,r=n.length-1;if(r<0||!t(n[r]))return n.length;if(t(n[i]))return i;for(;i<r;){const a=i+r>>1,l=n[a];t(l)?r=a:i=a+1}return i}function lx(n){if(Math.floor(n)===n)return[n,1];const t=1/n,e=8;if(t>e)return[1,e];if(Math.floor(t)===t)return[1,t];const i=n>1?t:n;let r=0,a=1,l=1,c=1;for(;;){const f=r+l,p=a+c;if(p>e)break;i<=f/p?(l=f,c=p):(r=f,a=p)}let h;return i-r/a<l/c-i?h=i===n?[r,a]:[a,r]:h=i===n?[l,c]:[c,l],h}function Gu(n,t){return n-n%t}function PT(n,t,e){if(n<2)return n;let i=t[n].div,r=i.offsetTop+i.clientTop;r>=e&&(i=t[n-1].div,r=i.offsetTop+i.clientTop);for(let a=n-2;a>=0&&(i=t[a].div,!(i.offsetTop+i.clientTop+i.clientHeight<=r));--a)n=a;return n}function kT({scrollEl:n,views:t,sortByVisibility:e=!1,horizontal:i=!1,rtl:r=!1}){const a=n.scrollTop,l=a+n.clientHeight,c=n.scrollLeft,h=c+n.clientWidth;function f(T){const S=T.div;return S.offsetTop+S.clientTop+S.clientHeight>a}function p(T){const S=T.div,C=S.offsetLeft+S.clientLeft,N=C+S.clientWidth;return r?C<h:N>c}const m=[],v=new Set,x=t.length;let E=Zl(t,i?p:f);E>0&&E<x&&!i&&(E=PT(E,t,a));let _=i?h:-1;for(let T=E;T<x;T++){const S=t[T],C=S.div,N=C.offsetLeft+C.clientLeft,B=C.offsetTop+C.clientTop,O=C.clientWidth,H=C.clientHeight,M=N+O,W=B+H;if(_===-1)W>=l&&(_=W);else if((i?N:B)>_)break;if(W<=a||B>=l||M<=c||N>=h)continue;const Y=Math.max(0,a-B),J=Math.max(0,c-N),ut=Y+Math.max(0,W-l),At=J+Math.max(0,M-h),Et=(H-ut)/H,q=(O-At)/O,nt=Et*q*100|0;m.push({id:S.id,x:N,y:B,visibleArea:nt===100?null:{minX:J,minY:Y,maxX:Math.min(M,h)-N,maxY:Math.min(W,l)-B},view:S,percent:nt,widthPercent:q*100|0}),v.add(S.id)}const b=m[0],A=m.at(-1);return e&&m.sort(function(T,S){const C=T.percent-S.percent;return Math.abs(C)>.001?-C:T.id-S.id}),{first:b,last:A,views:m,ids:v}}function u_(n){return Number.isInteger(n)&&n%90===0}function FT(n){return Number.isInteger(n)&&Object.values(le).includes(n)&&n!==le.UNKNOWN}function IT(n){return Number.isInteger(n)&&Object.values(Ni).includes(n)&&n!==Ni.UNKNOWN}function cx(n){return n.width<=n.height}new Promise(function(n){window.requestAnimationFrame(n)});const BT=document.documentElement.style;class UT{#t=null;#e=null;#i=0;#n=null;#s=!0;constructor(t){this.#t=t.classList,this.#n=t.style}get percent(){return this.#i}set percent(t){if(this.#i=vp(t,0,100),isNaN(t)){this.#t.add("indeterminate");return}this.#t.remove("indeterminate"),this.#n.setProperty("--progressBar-percent",`${this.#i}%`)}setWidth(t){if(!t)return;const i=t.parentNode.offsetWidth-t.offsetWidth;i>0&&this.#n.setProperty("--progressBar-end-offset",`${i}px`)}setDisableAutoFetch(t=5e3){this.#i===100||isNaN(this.#i)||(this.#e&&clearTimeout(this.#e),this.show(),this.#e=setTimeout(()=>{this.#e=null,this.hide()},t))}hide(){this.#s&&(this.#s=!1,this.#t.add("hidden"))}show(){this.#s||(this.#s=!0,this.#t.remove("hidden"))}}function HT(n){let t=le.VERTICAL,e=Ni.NONE;switch(n){case"SinglePage":t=le.PAGE;break;case"OneColumn":break;case"TwoPageLeft":t=le.PAGE;case"TwoColumnLeft":e=Ni.ODD;break;case"TwoPageRight":t=le.PAGE;case"TwoColumnRight":e=Ni.EVEN;break}return{scrollMode:t,spreadMode:e}}const Wu=(function(){const n=document.createElement("div");return n.style.width="round(down, calc(1.6666666666666665 * 792px), 1px)",n.style.width==="calc(1320px)"?Math.fround:t=>t})(),jn={SPACE:0,ALPHA_LETTER:1,PUNCT:2,HAN_LETTER:3,KATAKANA_LETTER:4,HIRAGANA_LETTER:5,HALFWIDTH_KATAKANA_LETTER:6,THAI_LETTER:7};function jT(n){return n<11904}function zT(n){return(n&65408)===0}function VT(n){return n>=97&&n<=122||n>=65&&n<=90}function GT(n){return n>=48&&n<=57}function WT(n){return n===32||n===9||n===13||n===10}function XT(n){return n>=13312&&n<=40959||n>=63744&&n<=64255}function YT(n){return n>=12448&&n<=12543}function $T(n){return n>=12352&&n<=12447}function qT(n){return n>=65376&&n<=65439}function KT(n){return(n&65408)===3584}function Xu(n){return jT(n)?zT(n)?WT(n)?jn.SPACE:VT(n)||GT(n)||n===95?jn.ALPHA_LETTER:jn.PUNCT:KT(n)?jn.THAI_LETTER:n===160?jn.SPACE:jn.ALPHA_LETTER:XT(n)?jn.HAN_LETTER:YT(n)?jn.KATAKANA_LETTER:$T(n)?jn.HIRAGANA_LETTER:qT(n)?jn.HALFWIDTH_KATAKANA_LETTER:jn.ALPHA_LETTER}let ux;function QT(){return ux||=" ¨ª¯²-µ¸-º¼-¾Ĳ-ĳĿ-ŀŉſǄ-ǌǱ-ǳʰ-ʸ˘-˝ˠ-ˤʹͺ;΄-΅·ϐ-ϖϰ-ϲϴ-ϵϹևٵ-ٸक़-य़ড়-ঢ়য়ਲ਼ਸ਼ਖ਼-ਜ਼ਫ਼ଡ଼-ଢ଼ำຳໜ-ໝ༌གྷཌྷདྷབྷཛྷཀྵჼᴬ-ᴮᴰ-ᴺᴼ-ᵍᵏ-ᵪᵸᶛ-ᶿẚ-ẛάέήίόύώΆ᾽-῁ΈΉ῍-῏ΐΊ῝-῟ΰΎ῭-`ΌΏ´-῾ - ‑‗․-… ″-‴‶-‷‼‾⁇-⁉⁗ ⁰-ⁱ⁴-₎ₐ-ₜ₨℀-℃℅-ℇ℉-ℓℕ-№ℙ-ℝ℠-™ℤΩℨK-ℭℯ-ℱℳ-ℹ℻-⅀ⅅ-ⅉ⅐-ⅿ↉∬-∭∯-∰〈-〉①-⓪⨌⩴-⩶⫝̸ⱼ-ⱽⵯ⺟⻳⼀-⿕　〶〸-〺゛-゜ゟヿㄱ-ㆎ㆒-㆟㈀-㈞㈠-㉇㉐-㉾㊀-㏿ꚜ-ꚝꝰꟲ-ꟴꟸ-ꟹꭜ-ꭟꭩ豈-嗀塚晴凞-羽蘒諸逸-都飯-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-זּטּ-לּמּנּ-סּףּ-פּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-﷼︐-︙︰-﹄﹇-﹒﹔-﹦﹨-﹫ﹰ-ﹲﹴﹶ-ﻼ！-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ￠-￦",ux}const ps={FOUND:0,NOT_FOUND:1,WRAPPED:2,PENDING:3},ZT=250,JT=-50,hx={"‐":"-","‘":"'","’":"'","‚":"'","‛":"'","“":'"',"”":'"',"„":'"',"‟":'"',"¼":"1/4","½":"1/2","¾":"3/4"},fx=new Set([12441,12442,2381,2509,2637,2765,2893,3021,3149,3277,3387,3388,3405,3530,3642,3770,3972,4153,4154,5908,5940,6098,6752,6980,7082,7083,7154,7155,11647,43014,43052,43204,43347,43456,43766,44013,3158,3953,3954,3962,3963,3964,3965,3968,3956]);let dx;const t2=new RegExp("\\p{M}+","gu"),e2=new RegExp("([.*+?^${}()|[\\]\\\\])|(\\p{P})|(\\s+)|(\\p{M})|(\\p{L})","gu"),i2=new RegExp("([^\\p{M}])\\p{M}*$","u"),n2=new RegExp("^\\p{M}*([^\\p{M}])","u"),r2=/[\uAC00-\uD7AF\uFA6C\uFACF-\uFAD1\uFAD5-\uFAD7]+/g,px=new Map,s2="[\\u1100-\\u1112\\ud7a4-\\ud7af\\ud84a\\ud84c\\ud850\\ud854\\ud857\\ud85f]",gx=new Map;let g0=null,m0=null;function oh(n,t={}){const e=[];let i;for(;(i=r2.exec(n))!==null;){let{index:T}=i;for(const S of i[0]){let C=px.get(S);C||(C=S.normalize("NFD").length,px.set(S,C)),e.push([C,T++])}}const r=e.length>0,a=t.ignoreDashEOL??!1;let l;if(!r&&g0)l=g0;else if(r&&m0)l=m0;else{const T=Object.keys(hx).join(""),S=QT(),O=[`[${T}]`,`[${S}]`,"(?:゙|゚)\\n","\\p{M}+(?:-\\n)?","\\p{Ll}-\\n(?=\\p{Ll})|\\p{Lu}-\\n(?=\\p{L})","\\S-\\n","(?:\\p{Ideographic}|[぀-ヿ])\\n","\\n",r?s2:"\\u0000"];l=new RegExp(O.map(H=>`(${H})`).join("|"),"gum"),r?m0=l:g0=l}const c=[];for(;(i=t2.exec(n))!==null;)c.push([i[0].length,i.index]);let h=n.normalize("NFD");const f=[0,0];let p=0,m=0,v=0,x=0,E=0,_=!1;h=h.replace(l,(T,S,C,N,B,O,H,M,W,Y,J)=>{if(J-=x,S){const ut=hx[S],At=ut.length;for(let Et=1;Et<At;Et++)f.push(J-v+Et,v-Et);return v-=At-1,ut}if(C){let ut=gx.get(C);ut||(ut=C.normalize("NFKC"),gx.set(C,ut));const At=ut.length;for(let Et=1;Et<At;Et++)f.push(J-v+Et,v-Et);return v-=At-1,ut}if(N)return _=!0,J+E===c[p]?.[1]?++p:(f.push(J-1-v+1,v-1),v-=1,x+=1),f.push(J-v+1,v),x+=1,E+=1,N.charAt(0);if(B){const ut=B.endsWith(`
`),At=ut?B.length-2:B.length;_=!0;let Et=At;J+E===c[p]?.[1]&&(Et-=c[p][0],++p);for(let q=1;q<=Et;q++)f.push(J-1-v+q,v-q);return v-=Et,x+=Et,ut?(J+=At-1,f.push(J-v+1,1+v),v+=1,x+=1,E+=1,B.slice(0,At)):B}if(O){if(a)return x+=1,E+=1,O.slice(0,-1);const ut=O.length-2;return f.push(J-v+ut,1+v),v+=1,x+=1,E+=1,O.slice(0,-2)}if(H)return x+=1,E+=1,H.slice(0,-1);if(M){const ut=M.length-1;return f.push(J-v+ut,v),x+=1,E+=1,M.slice(0,-1)}if(W)return f.push(J-v+1,v-1),v-=1,x+=1,E+=1," ";if(J+E===e[m]?.[1]){const ut=e[m][0]-1;++m;for(let At=1;At<=ut;At++)f.push(J-(v-At),v-At);v-=ut,x+=ut}return Y}),f.push(h.length,v);const b=new Uint32Array(f.length>>1),A=new Int32Array(f.length>>1);for(let T=0,S=f.length;T<S;T+=2)b[T>>1]=f[T],A[T>>1]=f[T+1];return[h,[b,A],_]}function h_(n,t,e){if(!n)return[t,e];const[i,r]=n,a=t,l=t+e-1;let c=Zl(i,v=>v>=a);i[c]>a&&--c;let h=Zl(i,v=>v>=l,c);i[h]>l&&--h;const f=a+r[c],m=l+r[h]+1-f;return[f,m]}class a2{#t=null;#e=!0;#i=0;constructor({linkService:t,eventBus:e,updateMatchesCountOnProgress:i=!0}){this._linkService=t,this._eventBus=e,this.#e=i,this.onIsPageVisible=null,this.#s(),e._on("find",this.#n.bind(this)),e._on("findbarclose",this.#v.bind(this))}get highlightMatches(){return this._highlightMatches}get pageMatches(){return this._pageMatches}get pageMatchesLength(){return this._pageMatchesLength}get selected(){return this._selected}get state(){return this.#t}setDocument(t){this._pdfDocument&&this.#s(),t&&(this._pdfDocument=t,this._firstPageCapability.resolve())}#n(t){if(!t)return;const e=this._pdfDocument,{type:i}=t;(this.#t===null||this.#a(t))&&(this._dirtyMatch=!0),this.#t=t,i!=="highlightallchange"&&this.#x(ps.PENDING),this._firstPageCapability.promise.then(()=>{if(!this._pdfDocument||e&&this._pdfDocument!==e)return;this.#f();const r=!this._highlightMatches,a=!!this._findTimeout;this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),i?this._dirtyMatch?this.#g():i==="again"?(this.#g(),r&&this.#t.highlightAll&&this.#d()):i==="highlightallchange"?(a?this.#g():this._highlightMatches=!0,this.#d()):this.#g():this._findTimeout=setTimeout(()=>{this.#g(),this._findTimeout=null},ZT)})}scrollMatchIntoView({element:t=null,selectedLeft:e=0,pageIndex:i=-1,matchIndex:r=-1}){if(!this._scrollMatches||!t)return;if(r===-1||r!==this._selected.matchIdx)return;if(i===-1||i!==this._selected.pageIdx)return;this._scrollMatches=!1,c_(t,{top:JT,left:e},!0)}#s(){this._highlightMatches=!1,this._scrollMatches=!1,this._pdfDocument=null,this._pageMatches=[],this._pageMatchesLength=[],this.#i=0,this.#t=null,this._selected={pageIdx:-1,matchIdx:-1},this._offset={pageIdx:null,matchIdx:null,wrapped:!1},this._extractTextPromises=[],this._pageContents=[],this._pageDiffs=[],this._hasDiacritics=[],this._matchesCountTotal=0,this._pagesToSearch=null,this._pendingFindMatches=new Set,this._resumePageIdx=null,this._dirtyMatch=!1,clearTimeout(this._findTimeout),this._findTimeout=null,this._firstPageCapability=Promise.withResolvers()}get#r(){const{query:t}=this.#t;return typeof t=="string"?(t!==this._rawQuery&&(this._rawQuery=t,[this._normalizedQuery]=oh(t)),this._normalizedQuery):(t||[]).filter(e=>!!e).map(e=>oh(e)[0])}#a(t){const e=t.query,i=this.#t.query,r=typeof e;if(r!==typeof i)return!0;if(r==="string"){if(e!==i)return!0}else if(JSON.stringify(e)!==JSON.stringify(i))return!0;switch(t.type){case"again":const l=this._selected.pageIdx+1,c=this._linkService;return l>=1&&l<=c.pagesCount&&l!==c.page&&!(this.onIsPageVisible?.(l)??!0);case"highlightallchange":return!1}return!0}#o(t,e,i){let r=t.slice(0,e).match(i2);if(r){const a=t.charCodeAt(e),l=r[1].charCodeAt(0);if(Xu(a)===Xu(l))return!1}if(r=t.slice(e+i).match(n2),r){const a=t.charCodeAt(e+i-1),l=r[1].charCodeAt(0);if(Xu(a)===Xu(l))return!1}return!0}#c(t,e){const{matchDiacritics:i}=this.#t;let r=!1;t=t.replaceAll(e2,(l,c,h,f,p,m)=>c?`[ ]*\\${c}[ ]*`:h?`[ ]*${h}[ ]*`:f?"[ ]+":i?p||m:p?fx.has(p.charCodeAt(0))?p:"":e?(r=!0,`${m}\\p{M}*`):m);const a="[ ]*";return t.endsWith(a)&&(t=t.slice(0,t.length-a.length)),i&&e&&(dx||=String.fromCharCode(...fx),r=!0,t=`${t}(?=[${dx}]|[^\\p{M}]|$)`),[r,t]}#l(t){if(!this.#t)return;const e=this.#r;if(e.length===0)return;const i=this._pageContents[t],r=this.match(e,i,t),a=this._pageMatches[t]=[],l=this._pageMatchesLength[t]=[],c=this._pageDiffs[t];r?.forEach(({index:f,length:p})=>{const[m,v]=h_(c,f,p);v&&(a.push(m),l.push(v))}),this.#t.highlightAll&&this.#u(t),this._resumePageIdx===t&&(this._resumePageIdx=null,this.#h());const h=a.length;this._matchesCountTotal+=h,this.#e?h>0&&this.#E():++this.#i===this._linkService.pagesCount&&this.#E()}match(t,e,i){const r=this._hasDiacritics[i];let a=!1;if(typeof t=="string"?[a,t]=this.#c(t,r):t=t.sort().reverse().map(m=>{const[v,x]=this.#c(m,r);return a||=v,`(${x})`}).join("|"),!t)return;const{caseSensitive:l,entireWord:c}=this.#t,h=`g${a?"u":""}${l?"":"i"}`;t=new RegExp(t,h);const f=[];let p;for(;(p=t.exec(e))!==null;)c&&!this.#o(e,p.index,p[0].length)||f.push({index:p.index,length:p[0].length});return f}#f(){if(this._extractTextPromises.length>0)return;let t=Promise.resolve();const e={disableNormalization:!0},i=this._pdfDocument;for(let r=0,a=this._linkService.pagesCount;r<a;r++){const{promise:l,resolve:c}=Promise.withResolvers();this._extractTextPromises[r]=l,t=t.then(async()=>{if(i!==this._pdfDocument){c();return}await i.getPage(r+1).then(h=>h.getTextContent(e)).then(h=>{const f=[];for(const p of h.items)f.push(p.str),p.hasEOL&&f.push(`
`);[this._pageContents[r],this._pageDiffs[r],this._hasDiacritics[r]]=oh(f.join("")),c()},h=>{console.error(`Unable to get text content for page ${r+1}`,h),this._pageContents[r]="",this._pageDiffs[r]=null,this._hasDiacritics[r]=!1,c()})})}}#u(t){this._scrollMatches&&this._selected.pageIdx===t&&(this._linkService.page=t+1),this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:t})}#d(){this._eventBus.dispatch("updatetextlayermatches",{source:this,pageIndex:-1})}#g(){const t=this.#t.findPrevious,e=this._linkService.page-1,i=this._linkService.pagesCount;if(this._highlightMatches=!0,this._dirtyMatch){this._dirtyMatch=!1,this._selected.pageIdx=this._selected.matchIdx=-1,this._offset.pageIdx=e,this._offset.matchIdx=null,this._offset.wrapped=!1,this._resumePageIdx=null,this._pageMatches.length=0,this._pageMatchesLength.length=0,this.#i=0,this._matchesCountTotal=0,this.#d();for(let l=0;l<i;l++)this._pendingFindMatches.has(l)||(this._pendingFindMatches.add(l),this._extractTextPromises[l].then(()=>{this._pendingFindMatches.delete(l),this.#l(l)}))}if(this.#r.length===0){this.#x(ps.FOUND);return}if(this._resumePageIdx)return;const a=this._offset;if(this._pagesToSearch=i,a.matchIdx!==null){const l=this._pageMatches[a.pageIdx].length;if(!t&&a.matchIdx+1<l||t&&a.matchIdx>0){a.matchIdx=t?a.matchIdx-1:a.matchIdx+1,this.#y(!0);return}this.#m(t)}this.#h()}#p(t){const e=this._offset,i=t.length,r=this.#t.findPrevious;return i?(e.matchIdx=r?i-1:0,this.#y(!0),!0):(this.#m(r),e.wrapped&&(e.matchIdx=null,this._pagesToSearch<0)?(this.#y(!1),!0):!1)}#h(){this._resumePageIdx!==null&&console.error("There can only be one pending page.");let t=null;do{const e=this._offset.pageIdx;if(t=this._pageMatches[e],!t){this._resumePageIdx=e;break}}while(!this.#p(t))}#m(t){const e=this._offset,i=this._linkService.pagesCount;e.pageIdx=t?e.pageIdx-1:e.pageIdx+1,e.matchIdx=null,this._pagesToSearch--,(e.pageIdx>=i||e.pageIdx<0)&&(e.pageIdx=t?i-1:0,e.wrapped=!0)}#y(t=!1){let e=ps.NOT_FOUND;const i=this._offset.wrapped;if(this._offset.wrapped=!1,t){const r=this._selected.pageIdx;this._selected.pageIdx=this._offset.pageIdx,this._selected.matchIdx=this._offset.matchIdx,e=i?ps.WRAPPED:ps.FOUND,r!==-1&&r!==this._selected.pageIdx&&this.#u(r)}this.#x(e,this.#t.findPrevious),this._selected.pageIdx!==-1&&(this._scrollMatches=!0,this.#u(this._selected.pageIdx))}#v(t){const e=this._pdfDocument;this._firstPageCapability.promise.then(()=>{!this._pdfDocument||e&&this._pdfDocument!==e||(this._findTimeout&&(clearTimeout(this._findTimeout),this._findTimeout=null),this._resumePageIdx&&(this._resumePageIdx=null,this._dirtyMatch=!0),this.#x(ps.FOUND),this._highlightMatches=!1,this.#d())})}#_(){const{pageIdx:t,matchIdx:e}=this._selected;let i=0,r=this._matchesCountTotal;if(e!==-1){for(let a=0;a<t;a++)i+=this._pageMatches[a]?.length||0;i+=e+1}return(i<1||i>r)&&(i=r=0),{current:i,total:r}}#E(){this._eventBus.dispatch("updatefindmatchescount",{source:this,matchesCount:this.#_()})}#x(t,e=!1){!this.#e&&(this.#i!==this._linkService.pagesCount||t===ps.PENDING)||this._eventBus.dispatch("updatefindcontrolstate",{source:this,state:t,previous:e,entireWord:this.#t?.entireWord??null,matchesCount:this.#_(),rawQuery:this.#t?.query??null})}}const o2="noopener noreferrer nofollow",Ys={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};class yp{externalLinkEnabled=!0;constructor({eventBus:t,externalLinkTarget:e=null,externalLinkRel:i=null,ignoreDestinationZoom:r=!1}={}){this.eventBus=t,this.externalLinkTarget=e,this.externalLinkRel=i,this._ignoreDestinationZoom=r,this.baseUrl=null,this.pdfDocument=null,this.pdfViewer=null,this.pdfHistory=null}setDocument(t,e=null){this.baseUrl=e,this.pdfDocument=t}setViewer(t){this.pdfViewer=t}setHistory(t){this.pdfHistory=t}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return this.pdfDocument?this.pdfViewer.currentPageNumber:1}set page(t){this.pdfDocument&&(this.pdfViewer.currentPageNumber=t)}get rotation(){return this.pdfDocument?this.pdfViewer.pagesRotation:0}set rotation(t){this.pdfDocument&&(this.pdfViewer.pagesRotation=t)}get isInPresentationMode(){return this.pdfDocument?this.pdfViewer.isInPresentationMode:!1}async goToDestination(t){if(!this.pdfDocument)return;let e,i,r;if(typeof t=="string"?(e=t,i=await this.pdfDocument.getDestination(t)):(e=null,i=await t),!Array.isArray(i)){console.error(`goToDestination: "${i}" is not a valid destination array, for dest="${t}".`);return}const[a]=i;if(a&&typeof a=="object"){if(r=this.pdfDocument.cachedPageNumber(a),!r)try{r=await this.pdfDocument.getPageIndex(a)+1}catch{console.error(`goToDestination: "${a}" is not a valid page reference, for dest="${t}".`);return}}else Number.isInteger(a)&&(r=a+1);if(!r||r<1||r>this.pagesCount){console.error(`goToDestination: "${r}" is not a valid page number, for dest="${t}".`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.push({namedDest:e,explicitDest:i,pageNumber:r})),this.pdfViewer.scrollPageIntoView({pageNumber:r,destArray:i,ignoreDestinationZoom:this._ignoreDestinationZoom});const l=new AbortController;this.eventBus._on("textlayerrendered",c=>{c.pageNumber===r&&(c.source.textLayer.div.focus(),l.abort())},{signal:l.signal})}goToPage(t){if(!this.pdfDocument)return;const e=typeof t=="string"&&this.pdfViewer.pageLabelToPageNumber(t)||t|0;if(!(Number.isInteger(e)&&e>0&&e<=this.pagesCount)){console.error(`PDFLinkService.goToPage: "${t}" is not a valid page.`);return}this.pdfHistory&&(this.pdfHistory.pushCurrentPosition(),this.pdfHistory.pushPage(e)),this.pdfViewer.scrollPageIntoView({pageNumber:e})}goToXY(t,e,i){this.pdfViewer.scrollPageIntoView({pageNumber:t,destArray:[null,{name:"XYZ"},e,i],ignoreDestinationZoom:!0})}addLinkAttributes(t,e,i=!1){if(!e||typeof e!="string")throw new Error('A valid "url" parameter must provided.');const r=i?Ys.BLANK:this.externalLinkTarget,a=this.externalLinkRel;this.externalLinkEnabled?t.href=t.title=e:(t.href="",t.title=`Disabled: ${e}`,t.onclick=()=>!1);let l="";switch(r){case Ys.NONE:break;case Ys.SELF:l="_self";break;case Ys.BLANK:l="_blank";break;case Ys.PARENT:l="_parent";break;case Ys.TOP:l="_top";break}t.target=l,t.rel=typeof a=="string"?a:o2}getDestinationHash(t){if(typeof t=="string"){if(t.length>0)return this.getAnchorUrl("#"+escape(t))}else if(Array.isArray(t)){const e=JSON.stringify(t);if(e.length>0)return this.getAnchorUrl("#"+escape(e))}return this.getAnchorUrl("")}getAnchorUrl(t){return this.baseUrl?this.baseUrl+t:t}setHash(t){if(!this.pdfDocument)return;let e,i;if(t.includes("=")){const r=Fh(t);if(r.has("search")){const a=r.get("search").replaceAll('"',""),l=r.get("phrase")==="true";this.eventBus.dispatch("findfromurlhash",{source:this,query:l?a:a.match(/\S+/g)})}if(r.has("page")&&(e=r.get("page")|0||1),r.has("zoom")){const a=r.get("zoom").split(","),l=a[0],c=parseFloat(l);l.includes("Fit")?l==="Fit"||l==="FitB"?i=[null,{name:l}]:l==="FitH"||l==="FitBH"||l==="FitV"||l==="FitBV"?i=[null,{name:l},a.length>1?a[1]|0:null]:l==="FitR"?a.length!==5?console.error('PDFLinkService.setHash: Not enough parameters for "FitR".'):i=[null,{name:l},a[1]|0,a[2]|0,a[3]|0,a[4]|0]:console.error(`PDFLinkService.setHash: "${l}" is not a valid zoom value.`):i=[null,{name:"XYZ"},a.length>1?a[1]|0:null,a.length>2?a[2]|0:null,c?c/100:l]}i?this.pdfViewer.scrollPageIntoView({pageNumber:e||this.page,destArray:i,allowNegativeOffset:!0}):e&&(this.page=e),r.has("pagemode")&&this.eventBus.dispatch("pagemode",{source:this,mode:r.get("pagemode")}),r.has("nameddest")&&this.goToDestination(r.get("nameddest"));return}i=unescape(t);try{i=JSON.parse(i),Array.isArray(i)||(i=i.toString())}catch{}if(typeof i=="string"||ST(i)){this.goToDestination(i);return}console.error(`PDFLinkService.setHash: "${unescape(t)}" is not a valid destination.`)}executeNamedAction(t){if(this.pdfDocument){switch(t){case"GoBack":this.pdfHistory?.back();break;case"GoForward":this.pdfHistory?.forward();break;case"NextPage":this.pdfViewer.nextPage();break;case"PrevPage":this.pdfViewer.previousPage();break;case"LastPage":this.page=this.pagesCount;break;case"FirstPage":this.page=1;break}this.eventBus.dispatch("namedaction",{source:this,action:t})}}async executeSetOCGState(t){if(!this.pdfDocument)return;const e=this.pdfDocument,i=await this.pdfViewer.optionalContentConfigPromise;e===this.pdfDocument&&(i.setOCGState(t),this.pdfViewer.optionalContentConfigPromise=Promise.resolve(i))}}class _p extends yp{setDocument(t,e=null){}}class f_{#t=null;#e=!1;#i=null;#n=null;#s=!1;constructor({pdfPage:t,linkService:e,downloadManager:i,annotationStorage:r=null,imageResourcesPath:a="",renderForms:l=!0,enableComment:c=!1,enableScripting:h=!1,hasJSActionsPromise:f=null,fieldObjectsPromise:p=null,annotationCanvasMap:m=null,accessibilityManager:v=null,annotationEditorUIManager:x=null,onAppend:E=null}){this.pdfPage=t,this.linkService=e,this.downloadManager=i,this.imageResourcesPath=a,this.renderForms=l,this.annotationStorage=r,this.enableComment=c,this.enableScripting=h,this._hasJSActionsPromise=f||Promise.resolve(!1),this._fieldObjectsPromise=p||Promise.resolve(null),this._annotationCanvasMap=m,this._accessibilityManager=v,this._annotationEditorUIManager=x,this.#i=E,this.annotationLayer=null,this.div=null,this._cancelled=!1,this._eventBus=e.eventBus}async render({viewport:t,intent:e="display",structTreeLayer:i=null}){if(this.div){if(this._cancelled||!this.annotationLayer)return;this.annotationLayer.update({viewport:t.clone({dontFlip:!0})});return}const[r,a,l]=await Promise.all([this.pdfPage.getAnnotations({intent:e}),this._hasJSActionsPromise,this._fieldObjectsPromise]);if(this._cancelled)return;const c=this.div=document.createElement("div");if(c.className="annotationLayer",this.#i?.(c),r.length===0){this.#t=r,this.hide(!0);return}this.#r(t,i),await this.annotationLayer.render({annotations:r,imageResourcesPath:this.imageResourcesPath,renderForms:this.renderForms,linkService:this.linkService,downloadManager:this.downloadManager,annotationStorage:this.annotationStorage,enableComment:this.enableComment,enableScripting:this.enableScripting,hasJSActions:a,fieldObjects:l}),this.#t=r,this.linkService.isInPresentationMode&&this.#a(fo.FULLSCREEN),this.#n||(this.#n=new AbortController,this._eventBus?._on("presentationmodechanged",h=>{this.#a(h.state)},{signal:this.#n.signal}))}#r(t,e){this.annotationLayer=new _T({div:this.div,accessibilityManager:this._accessibilityManager,annotationCanvasMap:this._annotationCanvasMap,annotationEditorUIManager:this._annotationEditorUIManager,page:this.pdfPage,viewport:t.clone({dontFlip:!0}),structTreeLayer:e})}cancel(){this._cancelled=!0,this.#n?.abort(),this.#n=null}hide(t=!1){this.#e=!t,this.div&&(this.div.hidden=!0)}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}async injectLinkAnnotations({inferredLinks:t,viewport:e,structTreeLayer:i=null}){if(this.#t===null)throw new Error("`render` method must be called before `injectLinkAnnotations`.");if(this._cancelled||this.#s)return;this.#s=!0;const r=this.#t.length?this.#o(t):t;r.length&&(this.annotationLayer||(this.#r(e,i),o_(this.div,e)),await this.annotationLayer.addLinkAnnotations(r,this.linkService),this.#e||(this.div.hidden=!1))}#a(t){if(!this.div)return;let e=!1;switch(t){case fo.FULLSCREEN:e=!0;break;case fo.NORMAL:break;default:return}for(const i of this.div.childNodes)i.hasAttribute("data-internal-link")||(i.inert=e)}#o(t){function e(a){if(!a.quadPoints)return[a.rect];const l=[];for(let c=2,h=a.quadPoints.length;c<h;c+=8){const f=a.quadPoints[c],p=a.quadPoints[c+1],m=a.quadPoints[c+2],v=a.quadPoints[c+3];l.push([m,v,f,p])}return l}function i(a,l){const c=[],h=e(a),f=e(l);for(const p of h)for(const m of f){const v=xp.intersect(p,m);v&&c.push(v)}return c}function r(a){let l=0;for(const c of a)l+=Math.abs((c[2]-c[0])*(c[3]-c[1]));return l}return t.filter(a=>{let l;for(const c of this.#t){if(c.annotationType!==s_.LINK||!c.url)continue;const h=i(c,a);if(h.length!==0&&(l??=r(e(a)),r(h)/l>.5))return!1}return!0})}}function mx(n,t){const e=document.createElement("a");if(!e.click)throw new Error('DownloadManager: "a.click()" is not supported.');e.href=n,e.target="_parent","download"in e&&(e.download=t),(document.body||document.documentElement).append(e),e.click(),e.remove()}class l2{#t=new WeakMap;downloadData(t,e,i){const r=URL.createObjectURL(new Blob([t],{type:i}));mx(r,e)}openOrDownloadData(t,e,i=null){const a=wT(e)?"application/pdf":"";return this.downloadData(t,e,a),!1}download(t,e,i){let r;if(t)r=URL.createObjectURL(new Blob([t],{type:"application/pdf"}));else{if(!a_(e,"http://example.com")){console.error(`download - not a valid URL: ${e}`);return}r=e+"#pdfjs.action=download"}mx(r,i)}}const vx={EVENT:"event",TIMEOUT:"timeout"};async function c2({target:n,name:t,delay:e=0}){if(typeof n!="object"||!(Number.isInteger(e)&&e>=0))throw new Error("waitOnEventOrTimeout - invalid parameters.");const{promise:i,resolve:r}=Promise.withResolvers(),a=new AbortController;function l(f){a.abort(),clearTimeout(h),r(f)}const c=n instanceof Ep?"_on":"addEventListener";n[c](t,l.bind(null,vx.EVENT),{signal:a.signal});const h=setTimeout(l.bind(null,vx.TIMEOUT),e);return i}class Ep{#t=Object.create(null);on(t,e,i=null){this._on(t,e,{external:!0,once:i?.once,signal:i?.signal})}off(t,e,i=null){this._off(t,e)}dispatch(t,e){const i=this.#t[t];if(!i||i.length===0)return;let r;for(const{listener:a,external:l,once:c}of i.slice(0)){if(c&&this._off(t,a),l){(r||=[]).push(a);continue}a(e)}if(r){for(const a of r)a(e);r=null}}_on(t,e,i=null){let r=null;if(i?.signal instanceof AbortSignal){const{signal:l}=i;if(l.aborted){console.error("Cannot use an `aborted` signal.");return}const c=()=>this._off(t,e);r=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}(this.#t[t]||=[]).push({listener:e,external:i?.external===!0,once:i?.once===!0,rmAbort:r})}_off(t,e,i=null){const r=this.#t[t];if(r)for(let a=0,l=r.length;a<l;a++){const c=r[a];if(c.listener===e){c.rmAbort?.(),r.splice(a,1);return}}}}class po{constructor(t){this.value=t}valueOf(){return this.value}}class Je extends po{constructor(t="???"){super(t)}toString(t){return`{${this.value}}`}}class kr extends po{constructor(t,e={}){super(t),this.opts=e}toString(t){if(t)try{return t.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(e){t.reportError(e)}return this.value.toString(10)}}class Es extends po{static supportsValue(t){if(typeof t=="number"||t instanceof Date)return!0;if(t instanceof po)return Es.supportsValue(t.valueOf());if("Temporal"in globalThis){const e=globalThis.Temporal;if(t instanceof e.Instant||t instanceof e.PlainDateTime||t instanceof e.PlainDate||t instanceof e.PlainMonthDay||t instanceof e.PlainTime||t instanceof e.PlainYearMonth)return!0}return!1}constructor(t,e={}){t instanceof Es?(e={...t.opts,...e},t=t.value):t instanceof po&&(t=t.valueOf()),typeof t=="object"&&"calendarId"in t&&e.calendar===void 0&&(e={...e,calendar:t.calendarId}),super(t),this.opts=e}[Symbol.toPrimitive](t){return t==="string"?this.toString():this.toNumber()}toNumber(){const t=this.value;if(typeof t=="number")return t;if(t instanceof Date)return t.getTime();if("epochMilliseconds"in t)return t.epochMilliseconds;if("toZonedDateTime"in t)return t.toZonedDateTime("UTC").epochMilliseconds;throw new TypeError("Unwrapping a non-number value as a number")}toString(t){if(t)try{return t.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(e){t.reportError(e)}return typeof this.value=="number"||this.value instanceof Date?new Date(this.value).toISOString():this.value.toString()}}const xx=100,u2="⁨",h2="⁩";function f2(n,t,e){if(e===t||e instanceof kr&&t instanceof kr&&e.value===t.value)return!0;if(t instanceof kr&&typeof e=="string"){let i=n.memoizeIntlObject(Intl.PluralRules,t.opts).select(t.value);if(e===i)return!0}return!1}function yx(n,t,e){return t[e]?bo(n,t[e].value):(n.reportError(new RangeError("No default")),new Je)}function X0(n,t){const e=[],i=Object.create(null);for(const r of t)r.type==="narg"?i[r.name]=Jl(n,r.value):e.push(Jl(n,r));return{positional:e,named:i}}function Jl(n,t){switch(t.type){case"str":return t.value;case"num":return new kr(t.value,{minimumFractionDigits:t.precision});case"var":return d2(n,t);case"mesg":return p2(n,t);case"term":return g2(n,t);case"func":return m2(n,t);case"select":return v2(n,t);default:return new Je}}function d2(n,{name:t}){let e;if(n.params)if(Object.prototype.hasOwnProperty.call(n.params,t))e=n.params[t];else return new Je(`$${t}`);else if(n.args&&Object.prototype.hasOwnProperty.call(n.args,t))e=n.args[t];else return n.reportError(new ReferenceError(`Unknown variable: $${t}`)),new Je(`$${t}`);if(e instanceof po)return e;switch(typeof e){case"string":return e;case"number":return new kr(e);case"object":if(Es.supportsValue(e))return new Es(e);default:return n.reportError(new TypeError(`Variable type not supported: $${t}, ${typeof e}`)),new Je(`$${t}`)}}function p2(n,{name:t,attr:e}){const i=n.bundle._messages.get(t);if(!i)return n.reportError(new ReferenceError(`Unknown message: ${t}`)),new Je(t);if(e){const r=i.attributes[e];return r?bo(n,r):(n.reportError(new ReferenceError(`Unknown attribute: ${e}`)),new Je(`${t}.${e}`))}return i.value?bo(n,i.value):(n.reportError(new ReferenceError(`No value: ${t}`)),new Je(t))}function g2(n,{name:t,attr:e,args:i}){const r=`-${t}`,a=n.bundle._terms.get(r);if(!a)return n.reportError(new ReferenceError(`Unknown term: ${r}`)),new Je(r);if(e){const c=a.attributes[e];if(c){n.params=X0(n,i).named;const h=bo(n,c);return n.params=null,h}return n.reportError(new ReferenceError(`Unknown attribute: ${e}`)),new Je(`${r}.${e}`)}n.params=X0(n,i).named;const l=bo(n,a.value);return n.params=null,l}function m2(n,{name:t,args:e}){let i=n.bundle._functions[t];if(!i)return n.reportError(new ReferenceError(`Unknown function: ${t}()`)),new Je(`${t}()`);if(typeof i!="function")return n.reportError(new TypeError(`Function ${t}() is not callable`)),new Je(`${t}()`);try{let r=X0(n,e);return i(r.positional,r.named)}catch(r){return n.reportError(r),new Je(`${t}()`)}}function v2(n,{selector:t,variants:e,star:i}){let r=Jl(n,t);if(r instanceof Je)return yx(n,e,i);for(const a of e){const l=Jl(n,a.key);if(f2(n,r,l))return bo(n,a.value)}return yx(n,e,i)}function d_(n,t){if(n.dirty.has(t))return n.reportError(new RangeError("Cyclic reference")),new Je;n.dirty.add(t);const e=[],i=n.bundle._useIsolating&&t.length>1;for(const r of t){if(typeof r=="string"){e.push(n.bundle._transform(r));continue}if(n.placeables++,n.placeables>xx)throw n.dirty.delete(t),new RangeError(`Too many placeables expanded: ${n.placeables}, max allowed is ${xx}`);i&&e.push(u2),e.push(Jl(n,r).toString(n)),i&&e.push(h2)}return n.dirty.delete(t),e.join("")}function bo(n,t){return typeof t=="string"?n.bundle._transform(t):d_(n,t)}class x2{constructor(t,e,i){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=t,this.errors=e,this.args=i}reportError(t){if(!this.errors||!(t instanceof Error))throw t;this.errors.push(t)}memoizeIntlObject(t,e){let i=this.bundle._intls.get(t);i||(i={},this.bundle._intls.set(t,i));let r=JSON.stringify(e);return i[r]||(i[r]=new t(this.bundle.locales,e)),i[r]}}function Y0(n,t){const e=Object.create(null);for(const[i,r]of Object.entries(n))t.includes(i)&&(e[i]=r.valueOf());return e}const _x=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function y2(n,t){let e=n[0];if(e instanceof Je)return new Je(`NUMBER(${e.valueOf()})`);if(e instanceof kr)return new kr(e.valueOf(),{...e.opts,...Y0(t,_x)});if(e instanceof Es)return new kr(e.toNumber(),{...Y0(t,_x)});throw new TypeError("Invalid argument to NUMBER")}const _2=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function E2(n,t){let e=n[0];if(e instanceof Je)return new Je(`DATETIME(${e.valueOf()})`);if(e instanceof Es||e instanceof kr)return new Es(e,Y0(t,_2));throw new TypeError("Invalid argument to DATETIME")}const Ex=new Map;function b2(n){const t=Array.isArray(n)?n.join(" "):n;let e=Ex.get(t);return e===void 0&&(e=new Map,Ex.set(t,e)),e}class A2{constructor(t,{functions:e,useIsolating:i=!0,transform:r=a=>a}={}){this._terms=new Map,this._messages=new Map,this.locales=Array.isArray(t)?t:[t],this._functions={NUMBER:y2,DATETIME:E2,...e},this._useIsolating=i,this._transform=r,this._intls=b2(t)}hasMessage(t){return this._messages.has(t)}getMessage(t){return this._messages.get(t)}addResource(t,{allowOverrides:e=!1}={}){const i=[];for(let r=0;r<t.body.length;r++){let a=t.body[r];if(a.id.startsWith("-")){if(e===!1&&this._terms.has(a.id)){i.push(new Error(`Attempt to override an existing term: "${a.id}"`));continue}this._terms.set(a.id,a)}else{if(e===!1&&this._messages.has(a.id)){i.push(new Error(`Attempt to override an existing message: "${a.id}"`));continue}this._messages.set(a.id,a)}}return i}formatPattern(t,e=null,i=null){if(typeof t=="string")return this._transform(t);let r=new x2(this,i,e);try{return d_(r,t).toString(r)}catch(a){if(r.errors&&a instanceof Error)return r.errors.push(a),new Je().toString(r);throw a}}}const v0=/^(-?[a-zA-Z][\w-]*) *= */gm,bx=/\.([a-zA-Z][\w-]*) *= */y,w2=/\*?\[/y,x0=/(-?[0-9]+(?:\.([0-9]+))?)/y,S2=/([a-zA-Z][\w-]*)/y,Ax=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,T2=/^[A-Z][A-Z0-9_-]*$/,Yu=/([^{}\n\r]+)/y,C2=/([^\\"\n\r]*)/y,wx=/\\([\\"])/y,Sx=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,R2=/^\n+/,Tx=/ +$/,D2=/ *\r?\n/g,M2=/( *)$/,N2=/{\s*/y,Cx=/\s*}/y,O2=/\[\s*/y,L2=/\s*] */y,P2=/\s*\(\s*/y,k2=/\s*->\s*/y,F2=/\s*:\s*/y,I2=/\s*,?\s*/y,B2=/\s+/y;class U2{constructor(t){this.body=[],v0.lastIndex=0;let e=0;for(;;){let M=v0.exec(t);if(M===null)break;e=v0.lastIndex;try{this.body.push(h(M[1]))}catch(W){if(W instanceof SyntaxError)continue;throw W}}function i(M){return M.lastIndex=e,M.test(t)}function r(M,W){if(t[e]===M)return e++,!0;if(W)throw new W(`Expected ${M}`);return!1}function a(M,W){if(i(M))return e=M.lastIndex,!0;if(W)throw new W(`Expected ${M.toString()}`);return!1}function l(M){M.lastIndex=e;let W=M.exec(t);if(W===null)throw new SyntaxError(`Expected ${M.toString()}`);return e=M.lastIndex,W}function c(M){return l(M)[1]}function h(M){let W=p(),Y=f();if(W===null&&Object.keys(Y).length===0)throw new SyntaxError("Expected message value or attributes");return{id:M,value:W,attributes:Y}}function f(){let M=Object.create(null);for(;i(bx);){let W=c(bx),Y=p();if(Y===null)throw new SyntaxError("Expected attribute value");M[W]=Y}return M}function p(){let M;if(i(Yu)&&(M=c(Yu)),t[e]==="{"||t[e]==="}")return m(M?[M]:[],1/0);let W=B();return W?M?m([M,W],W.length):(W.value=O(W.value,R2),m([W],W.length)):M?O(M,Tx):null}function m(M=[],W){for(;;){if(i(Yu)){M.push(c(Yu));continue}if(t[e]==="{"){M.push(v());continue}if(t[e]==="}")throw new SyntaxError("Unbalanced closing brace");let At=B();if(At){M.push(At),W=Math.min(W,At.length);continue}break}let Y=M.length-1,J=M[Y];typeof J=="string"&&(M[Y]=O(J,Tx));let ut=[];for(let At of M)At instanceof Rx&&(At=At.value.slice(0,At.value.length-W)),At&&ut.push(At);return ut}function v(){a(N2,SyntaxError);let M=x();if(a(Cx))return M;if(a(k2)){let W=b();return a(Cx,SyntaxError),{type:"select",selector:M,...W}}throw new SyntaxError("Unclosed placeable")}function x(){if(t[e]==="{")return v();if(i(Ax)){let[,M,W,Y=null]=l(Ax);if(M==="$")return{type:"var",name:W};if(a(P2)){let J=E();if(M==="-")return{type:"term",name:W,attr:Y,args:J};if(T2.test(W))return{type:"func",name:W,args:J};throw new SyntaxError("Function names must be all upper-case")}return M==="-"?{type:"term",name:W,attr:Y,args:[]}:{type:"mesg",name:W,attr:Y}}return T()}function E(){let M=[];for(;;){switch(t[e]){case")":return e++,M;case void 0:throw new SyntaxError("Unclosed argument list")}M.push(_()),a(I2)}}function _(){let M=x();return M.type!=="mesg"?M:a(F2)?{type:"narg",name:M.name,value:T()}:M}function b(){let M=[],W=0,Y;for(;i(w2);){r("*")&&(Y=W);let J=A(),ut=p();if(ut===null)throw new SyntaxError("Expected variant value");M[W++]={key:J,value:ut}}if(W===0)return null;if(Y===void 0)throw new SyntaxError("Expected default variant");return{variants:M,star:Y}}function A(){a(O2,SyntaxError);let M;return i(x0)?M=S():M={type:"str",value:c(S2)},a(L2,SyntaxError),M}function T(){if(i(x0))return S();if(t[e]==='"')return C();throw new SyntaxError("Invalid expression")}function S(){let[,M,W=""]=l(x0),Y=W.length;return{type:"num",value:parseFloat(M),precision:Y}}function C(){r('"',SyntaxError);let M="";for(;;){if(M+=c(C2),t[e]==="\\"){M+=N();continue}if(r('"'))return{type:"str",value:M};throw new SyntaxError("Unclosed string literal")}}function N(){if(i(wx))return c(wx);if(i(Sx)){let[,M,W]=l(Sx),Y=parseInt(M||W,16);return Y<=55295||57344<=Y?String.fromCodePoint(Y):"�"}throw new SyntaxError("Unknown escape sequence")}function B(){let M=e;switch(a(B2),t[e]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return H(t.slice(M,e))}return t[e-1]===" "?H(t.slice(M,e)):!1}function O(M,W){return M.replace(W,"")}function H(M){let W=M.replace(D2,`
`),Y=M2.exec(M)[1].length;return new Rx(W,Y)}}}class Rx{constructor(t,e){this.value=t,this.length=e}}const H2=/<|&#?\w+;/,j2={"http://www.w3.org/1999/xhtml":["em","strong","small","s","cite","q","dfn","abbr","data","time","code","var","samp","kbd","sub","sup","i","b","u","mark","bdi","bdo","span","br","wbr"]},z2={"http://www.w3.org/1999/xhtml":{global:["title","aria-description","aria-label","aria-valuetext"],a:["download"],area:["download","alt"],input:["alt","placeholder"],menuitem:["label"],menu:["label"],optgroup:["label"],option:["label"],track:["label"],img:["alt"],textarea:["placeholder"],th:["abbr"]},"http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul":{global:["accesskey","aria-label","aria-valuetext","label","title","tooltiptext"],description:["value"],key:["key","keycode"],label:["value"],textbox:["placeholder","value"]}};function V2(n,t){const{value:e}=t;if(typeof e=="string")if(n.localName==="title"&&n.namespaceURI==="http://www.w3.org/1999/xhtml")n.textContent=e;else if(!H2.test(e))n.textContent=e;else{const i=n.ownerDocument.createElementNS("http://www.w3.org/1999/xhtml","template");i.innerHTML=e,G2(i.content,n)}p_(t,n)}function G2(n,t){for(const e of n.childNodes)if(e.nodeType!==e.TEXT_NODE){if(e.hasAttribute("data-l10n-name")){const i=X2(t,e);n.replaceChild(i,e);continue}if($2(e)){const i=Y2(e);n.replaceChild(i,e);continue}console.warn(`An element of forbidden type "${e.localName}" was found in the translation. Only safe text-level elements and elements with data-l10n-name are allowed.`),n.replaceChild($0(e),e)}t.textContent="",t.appendChild(n)}function W2(n,t){if(!n)return!1;for(let e of n)if(e.name===t)return!0;return!1}function p_(n,t){const e=t.hasAttribute("data-l10n-attrs")?t.getAttribute("data-l10n-attrs").split(",").map(i=>i.trim()):null;for(const i of Array.from(t.attributes))Dx(i.name,t,e)&&!W2(n.attributes,i.name)&&t.removeAttribute(i.name);if(n.attributes)for(const i of Array.from(n.attributes))Dx(i.name,t,e)&&t.getAttribute(i.name)!==i.value&&t.setAttribute(i.name,i.value)}function X2(n,t){const e=t.getAttribute("data-l10n-name"),i=n.querySelector(`[data-l10n-name="${e}"]`);if(!i)return console.warn(`An element named "${e}" wasn't found in the source.`),$0(t);if(i.localName!==t.localName)return console.warn(`An element named "${e}" was found in the translation but its type ${t.localName} didn't match the element found in the source (${i.localName}).`),$0(t);n.removeChild(i);const r=i.cloneNode(!1);return g_(t,r)}function Y2(n){const t=n.ownerDocument.createElement(n.localName);return g_(n,t)}function $0(n){return n.ownerDocument.createTextNode(n.textContent)}function $2(n){const t=j2[n.namespaceURI];return t&&t.includes(n.localName)}function Dx(n,t,e=null){if(e&&e.includes(n))return!0;const i=z2[t.namespaceURI];if(!i)return!1;const r=n.toLowerCase(),a=t.localName;if(i.global.includes(r))return!0;if(!i[a])return!1;if(i[a].includes(r))return!0;if(t.namespaceURI==="http://www.w3.org/1999/xhtml"&&a==="input"&&r==="value"){const l=t.type.toLowerCase();if(l==="submit"||l==="button"||l==="reset")return!0}return!1}function g_(n,t){return t.textContent=n.textContent,p_(n,t),t}class q2 extends Array{static from(t){return t instanceof this?t:new this(t)}}class K2 extends q2{constructor(t){if(super(),Symbol.asyncIterator in Object(t))this.iterator=t[Symbol.asyncIterator]();else if(Symbol.iterator in Object(t))this.iterator=t[Symbol.iterator]();else throw new TypeError("Argument must implement the iteration protocol.")}[Symbol.asyncIterator](){const t=this;let e=0;return{async next(){return t.length<=e&&t.push(t.iterator.next()),t[e++]}}}async touchNext(t=1){let e=0;for(;e++<t;){const i=this[this.length-1];if(i&&(await i).done)break;this.push(this.iterator.next())}return this[this.length-1]}}class Q2{constructor(t=[],e){this.resourceIds=t,this.generateBundles=e,this.onChange(!0)}addResourceIds(t,e=!1){return this.resourceIds.push(...t),this.onChange(e),this.resourceIds.length}removeResourceIds(t){return this.resourceIds=this.resourceIds.filter(e=>!t.includes(e)),this.onChange(),this.resourceIds.length}async formatWithFallback(t,e){const i=[];let r=!1;for await(const a of this.bundles){r=!0;const l=tC(e,a,t,i);if(l.size===0)break;if(typeof console<"u"){const c=a.locales[0],h=Array.from(l).join(", ");console.warn(`[fluent] Missing translations in ${c}: ${h}`)}}return!r&&typeof console<"u"&&console.warn(`[fluent] Request for keys failed because no resource bundles got generated.
  keys: ${JSON.stringify(t)}.
  resourceIds: ${JSON.stringify(this.resourceIds)}.`),i}formatMessages(t){return this.formatWithFallback(t,J2)}formatValues(t){return this.formatWithFallback(t,Z2)}async formatValue(t,e){const[i]=await this.formatValues([{id:t,args:e}]);return i}handleEvent(){this.onChange()}onChange(t=!1){this.bundles=K2.from(this.generateBundles(this.resourceIds)),t&&this.bundles.touchNext(2)}}function Z2(n,t,e,i){return e.value?n.formatPattern(e.value,i,t):null}function J2(n,t,e,i){const r={value:null,attributes:null};e.value&&(r.value=n.formatPattern(e.value,i,t));let a=Object.keys(e.attributes);if(a.length>0){r.attributes=new Array(a.length);for(let[l,c]of a.entries()){let h=n.formatPattern(e.attributes[c],i,t);r.attributes[l]={name:c,value:h}}}return r}function tC(n,t,e,i){const r=[],a=new Set;return e.forEach(({id:l,args:c},h)=>{if(i[h]!==void 0)return;let f=t.getMessage(l);if(f){if(r.length=0,i[h]=n(t,r,f,c),r.length>0&&typeof console<"u"){const p=t.locales[0],m=r.join(", ");console.warn(`[fluent][resolver] errors in ${p}/${l}: ${m}.`)}}else a.add(l)}),a}const $s="data-l10n-id",Ol="data-l10n-args",eC=`[${$s}]`;class iC extends Q2{constructor(t,e){super(t,e),this.roots=new Set,this.pendingrAF=null,this.pendingElements=new Set,this.windowElement=null,this.mutationObserver=null,this.observerConfig={attributes:!0,characterData:!1,childList:!0,subtree:!0,attributeFilter:[$s,Ol]}}onChange(t=!1){super.onChange(t),this.roots&&this.translateRoots()}setAttributes(t,e,i){return t.setAttribute($s,e),i?t.setAttribute(Ol,JSON.stringify(i)):t.removeAttribute(Ol),t}getAttributes(t){return{id:t.getAttribute($s),args:JSON.parse(t.getAttribute(Ol)||null)}}connectRoot(t){for(const e of this.roots)if(e===t||e.contains(t)||t.contains(e))throw new Error("Cannot add a root that overlaps with existing root.");if(this.windowElement){if(this.windowElement!==t.ownerDocument.defaultView)throw new Error(`Cannot connect a root:
          DOMLocalization already has a root from a different window.`)}else this.windowElement=t.ownerDocument.defaultView,this.mutationObserver=new this.windowElement.MutationObserver(e=>this.translateMutations(e));this.roots.add(t),this.mutationObserver.observe(t,this.observerConfig)}disconnectRoot(t){return this.roots.delete(t),this.pauseObserving(),this.roots.size===0?(this.mutationObserver=null,this.windowElement&&this.pendingrAF&&this.windowElement.cancelAnimationFrame(this.pendingrAF),this.windowElement=null,this.pendingrAF=null,this.pendingElements.clear(),!0):(this.resumeObserving(),!1)}translateRoots(){const t=Array.from(this.roots);return Promise.all(t.map(e=>this.translateFragment(e)))}pauseObserving(){this.mutationObserver&&(this.translateMutations(this.mutationObserver.takeRecords()),this.mutationObserver.disconnect())}resumeObserving(){if(this.mutationObserver)for(const t of this.roots)this.mutationObserver.observe(t,this.observerConfig)}translateMutations(t){for(const e of t)switch(e.type){case"attributes":e.target.hasAttribute("data-l10n-id")&&this.pendingElements.add(e.target);break;case"childList":for(const i of e.addedNodes)if(i.nodeType===i.ELEMENT_NODE)if(i.childElementCount)for(const r of this.getTranslatables(i))this.pendingElements.add(r);else i.hasAttribute($s)&&this.pendingElements.add(i);break}this.pendingElements.size>0&&this.pendingrAF===null&&(this.pendingrAF=this.windowElement.requestAnimationFrame(()=>{this.translateElements(Array.from(this.pendingElements)),this.pendingElements.clear(),this.pendingrAF=null}))}translateFragment(t){return this.translateElements(this.getTranslatables(t))}async translateElements(t){if(!t.length)return;const e=t.map(this.getKeysForElement),i=await this.formatMessages(e);return this.applyTranslations(t,i)}applyTranslations(t,e){this.pauseObserving();for(let i=0;i<t.length;i++)e[i]!==void 0&&V2(t[i],e[i]);this.resumeObserving()}getTranslatables(t){const e=Array.from(t.querySelectorAll(eC));return typeof t.hasAttribute=="function"&&t.hasAttribute($s)&&e.push(t),e}getKeysForElement(t){return{id:t.getAttribute($s),args:JSON.parse(t.getAttribute(Ol)||null)}}}class fh{#t;#e;#i;#n;constructor({lang:t,isRTL:e},i=null){this.#i=fh.#s(t),this.#n=i,this.#t=e??fh.#r(this.#i)?"rtl":"ltr"}_setL10n(t){this.#n=t}getLanguage(){return this.#i}getDirection(){return this.#t}async get(t,e=null,i){return Array.isArray(t)?(t=t.map(l=>({id:l})),(await this.#n.formatMessages(t)).map(l=>l.value)):(await this.#n.formatMessages([{id:t,args:e}]))[0]?.value||i}async translate(t){(this.#e||=new Set).add(t);try{this.#n.connectRoot(t),await this.#n.translateRoots()}catch{}}async translateOnce(t){try{await this.#n.translateElements([t])}catch(e){console.error("translateOnce:",e)}}async destroy(){if(this.#e){for(const t of this.#e)this.#n.disconnectRoot(t);this.#e.clear(),this.#e=null}this.#n.pauseObserving()}pause(){this.#n.pauseObserving()}resume(){this.#n.resumeObserving()}static#s(t){return t=t?.toLowerCase()||"en-us",{en:"en-us",es:"es-es",fy:"fy-nl",ga:"ga-ie",gu:"gu-in",hi:"hi-in",hy:"hy-am",nb:"nb-no",ne:"ne-np",nn:"nn-no",pa:"pa-in",pt:"pt-pt",sv:"sv-se",zh:"zh-cn"}[t]||t}static#r(t){const e=t.split("-",1)[0];return["ar","he","fa","ps","ur"].includes(e)}}function nC(){const{isAndroid:n,isLinux:t,isMac:e,isWindows:i}=bT.platform;return t?"linux":i?"windows":e?"macos":n?"android":"other"}function Mx(n,t){const e=new U2(t),i=new A2(n,{functions:{PLATFORM:nC}}),r=i.addResource(e);return r.length&&console.error("L10n errors",r),i}class Lr extends fh{constructor(t){super({lang:t});const e=t?Lr.#t.bind(Lr,"en-us",this.getLanguage()):Lr.#n.bind(Lr,this.getLanguage());this._setL10n(new iC([],e))}static async*#t(t,e){const{baseURL:i,paths:r}=await this.#i(),a=[e];if(t!==e){const c=e.split("-",1)[0];c!==e&&a.push(c),a.push(t)}const l=a.map(c=>[c,this.#e(c,i,r)]);for(const[c,h]of l){const f=await h;f?yield f:c==="en-us"&&(yield this.#s(c))}}static async#e(t,e,i){const r=i[t];if(!r)return null;const a=new URL(r,e),l=await ix(a,"text");return Mx(t,l)}static async#i(){try{const{href:t}=document.querySelector('link[type="application/l10n"]'),e=await ix(t,"json");return{baseURL:t.substring(0,t.lastIndexOf("/")+1)||"./",paths:e}}catch{}return{baseURL:"./",paths:Object.create(null)}}static async*#n(t){yield this.#s(t)}static async#s(t){return Mx(t,`pdfjs-previous-button =
    .title = Previous Page
pdfjs-previous-button-label = Previous
pdfjs-next-button =
    .title = Next Page
pdfjs-next-button-label = Next
pdfjs-page-input =
    .title = Page
pdfjs-of-pages = of { $pagesCount }
pdfjs-page-of-pages = ({ $pageNumber } of { $pagesCount })
pdfjs-zoom-out-button =
    .title = Zoom Out
pdfjs-zoom-out-button-label = Zoom Out
pdfjs-zoom-in-button =
    .title = Zoom In
pdfjs-zoom-in-button-label = Zoom In
pdfjs-zoom-select =
    .title = Zoom
pdfjs-presentation-mode-button =
    .title = Switch to Presentation Mode
pdfjs-presentation-mode-button-label = Presentation Mode
pdfjs-open-file-button =
    .title = Open File
pdfjs-open-file-button-label = Open
pdfjs-print-button =
    .title = Print
pdfjs-print-button-label = Print
pdfjs-save-button =
    .title = Save
pdfjs-save-button-label = Save
pdfjs-download-button =
    .title = Download
pdfjs-download-button-label = Download
pdfjs-bookmark-button =
    .title = Current Page (View URL from Current Page)
pdfjs-bookmark-button-label = Current Page
pdfjs-tools-button =
    .title = Tools
pdfjs-tools-button-label = Tools
pdfjs-first-page-button =
    .title = Go to First Page
pdfjs-first-page-button-label = Go to First Page
pdfjs-last-page-button =
    .title = Go to Last Page
pdfjs-last-page-button-label = Go to Last Page
pdfjs-page-rotate-cw-button =
    .title = Rotate Clockwise
pdfjs-page-rotate-cw-button-label = Rotate Clockwise
pdfjs-page-rotate-ccw-button =
    .title = Rotate Counterclockwise
pdfjs-page-rotate-ccw-button-label = Rotate Counterclockwise
pdfjs-cursor-text-select-tool-button =
    .title = Enable Text Selection Tool
pdfjs-cursor-text-select-tool-button-label = Text Selection Tool
pdfjs-cursor-hand-tool-button =
    .title = Enable Hand Tool
pdfjs-cursor-hand-tool-button-label = Hand Tool
pdfjs-scroll-page-button =
    .title = Use Page Scrolling
pdfjs-scroll-page-button-label = Page Scrolling
pdfjs-scroll-vertical-button =
    .title = Use Vertical Scrolling
pdfjs-scroll-vertical-button-label = Vertical Scrolling
pdfjs-scroll-horizontal-button =
    .title = Use Horizontal Scrolling
pdfjs-scroll-horizontal-button-label = Horizontal Scrolling
pdfjs-scroll-wrapped-button =
    .title = Use Wrapped Scrolling
pdfjs-scroll-wrapped-button-label = Wrapped Scrolling
pdfjs-spread-none-button =
    .title = Do not join page spreads
pdfjs-spread-none-button-label = No Spreads
pdfjs-spread-odd-button =
    .title = Join page spreads starting with odd-numbered pages
pdfjs-spread-odd-button-label = Odd Spreads
pdfjs-spread-even-button =
    .title = Join page spreads starting with even-numbered pages
pdfjs-spread-even-button-label = Even Spreads
pdfjs-document-properties-button =
    .title = Document Properties…
pdfjs-document-properties-button-label = Document Properties…
pdfjs-document-properties-file-name = File name:
pdfjs-document-properties-file-size = File size:
pdfjs-document-properties-size-kb = { NUMBER($kb, maximumSignificantDigits: 3) } KB ({ $b } bytes)
pdfjs-document-properties-size-mb = { NUMBER($mb, maximumSignificantDigits: 3) } MB ({ $b } bytes)
pdfjs-document-properties-title = Title:
pdfjs-document-properties-author = Author:
pdfjs-document-properties-subject = Subject:
pdfjs-document-properties-keywords = Keywords:
pdfjs-document-properties-creation-date = Creation Date:
pdfjs-document-properties-modification-date = Modification Date:
pdfjs-document-properties-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-document-properties-creator = Creator:
pdfjs-document-properties-producer = PDF Producer:
pdfjs-document-properties-version = PDF Version:
pdfjs-document-properties-page-count = Page Count:
pdfjs-document-properties-page-size = Page Size:
pdfjs-document-properties-page-size-unit-inches = in
pdfjs-document-properties-page-size-unit-millimeters = mm
pdfjs-document-properties-page-size-orientation-portrait = portrait
pdfjs-document-properties-page-size-orientation-landscape = landscape
pdfjs-document-properties-page-size-name-a-three = A3
pdfjs-document-properties-page-size-name-a-four = A4
pdfjs-document-properties-page-size-name-letter = Letter
pdfjs-document-properties-page-size-name-legal = Legal
pdfjs-document-properties-page-size-dimension-string = { $width } × { $height } { $unit } ({ $orientation })
pdfjs-document-properties-page-size-dimension-name-string = { $width } × { $height } { $unit } ({ $name }, { $orientation })
pdfjs-document-properties-linearized = Fast Web View:
pdfjs-document-properties-linearized-yes = Yes
pdfjs-document-properties-linearized-no = No
pdfjs-document-properties-close-button = Close
pdfjs-print-progress-message = Preparing document for printing…
pdfjs-print-progress-percent = { $progress }%
pdfjs-print-progress-close-button = Cancel
pdfjs-printing-not-supported = Warning: Printing is not fully supported by this browser.
pdfjs-printing-not-ready = Warning: The PDF is not fully loaded for printing.
pdfjs-toggle-sidebar-button =
    .title = Toggle Sidebar
pdfjs-toggle-sidebar-notification-button =
    .title = Toggle Sidebar (document contains outline/attachments/layers)
pdfjs-toggle-sidebar-button-label = Toggle Sidebar
pdfjs-document-outline-button =
    .title = Show Document Outline (double-click to expand/collapse all items)
pdfjs-document-outline-button-label = Document Outline
pdfjs-attachments-button =
    .title = Show Attachments
pdfjs-attachments-button-label = Attachments
pdfjs-layers-button =
    .title = Show Layers (double-click to reset all layers to the default state)
pdfjs-layers-button-label = Layers
pdfjs-thumbs-button =
    .title = Show Thumbnails
pdfjs-thumbs-button-label = Thumbnails
pdfjs-current-outline-item-button =
    .title = Find Current Outline Item
pdfjs-current-outline-item-button-label = Current Outline Item
pdfjs-findbar-button =
    .title = Find in Document
pdfjs-findbar-button-label = Find
pdfjs-additional-layers = Additional Layers
pdfjs-thumb-page-title =
    .title = Page { $page }
pdfjs-thumb-page-canvas =
    .aria-label = Thumbnail of Page { $page }
pdfjs-find-input =
    .title = Find
    .placeholder = Find in document…
pdfjs-find-previous-button =
    .title = Find the previous occurrence of the phrase
pdfjs-find-previous-button-label = Previous
pdfjs-find-next-button =
    .title = Find the next occurrence of the phrase
pdfjs-find-next-button-label = Next
pdfjs-find-highlight-checkbox = Highlight All
pdfjs-find-match-case-checkbox-label = Match Case
pdfjs-find-match-diacritics-checkbox-label = Match Diacritics
pdfjs-find-entire-word-checkbox-label = Whole Words
pdfjs-find-reached-top = Reached top of document, continued from bottom
pdfjs-find-reached-bottom = Reached end of document, continued from top
pdfjs-find-match-count =
    { $total ->
        [one] { $current } of { $total } match
       *[other] { $current } of { $total } matches
    }
pdfjs-find-match-count-limit =
    { $limit ->
        [one] More than { $limit } match
       *[other] More than { $limit } matches
    }
pdfjs-find-not-found = Phrase not found
pdfjs-page-scale-width = Page Width
pdfjs-page-scale-fit = Page Fit
pdfjs-page-scale-auto = Automatic Zoom
pdfjs-page-scale-actual = Actual Size
pdfjs-page-scale-percent = { $scale }%
pdfjs-page-landmark =
    .aria-label = Page { $page }
pdfjs-loading-error = An error occurred while loading the PDF.
pdfjs-invalid-file-error = Invalid or corrupted PDF file.
pdfjs-missing-file-error = Missing PDF file.
pdfjs-unexpected-response-error = Unexpected server response.
pdfjs-rendering-error = An error occurred while rendering the page.
pdfjs-annotation-date-time-string = { DATETIME($dateObj, dateStyle: "short", timeStyle: "medium") }
pdfjs-text-annotation-type =
    .alt = [{ $type } Annotation]
pdfjs-password-label = Enter the password to open this PDF file.
pdfjs-password-invalid = Invalid password. Please try again.
pdfjs-password-ok-button = OK
pdfjs-password-cancel-button = Cancel
pdfjs-web-fonts-disabled = Web fonts are disabled: unable to use embedded PDF fonts.
pdfjs-editor-free-text-button =
    .title = Text
pdfjs-editor-color-picker-free-text-input =
    .title = Change text color
pdfjs-editor-free-text-button-label = Text
pdfjs-editor-ink-button =
    .title = Draw
pdfjs-editor-color-picker-ink-input =
    .title = Change drawing color
pdfjs-editor-ink-button-label = Draw
pdfjs-editor-stamp-button =
    .title = Add or edit images
pdfjs-editor-stamp-button-label = Add or edit images
pdfjs-editor-highlight-button =
    .title = Highlight
pdfjs-editor-highlight-button-label = Highlight
pdfjs-highlight-floating-button1 =
    .title = Highlight
    .aria-label = Highlight
pdfjs-highlight-floating-button-label = Highlight
pdfjs-comment-floating-button =
    .title = Comment
    .aria-label = Comment
pdfjs-comment-floating-button-label = Comment
pdfjs-editor-comment-button =
    .title = Comment
    .aria-label = Comment
pdfjs-editor-comment-button-label = Comment
pdfjs-editor-signature-button =
    .title = Add signature
pdfjs-editor-signature-button-label = Add signature
pdfjs-editor-highlight-editor =
    .aria-label = Highlight editor
pdfjs-editor-ink-editor =
    .aria-label = Drawing editor
pdfjs-editor-signature-editor1 =
    .aria-description = Signature editor: { $description }
pdfjs-editor-stamp-editor =
    .aria-label = Image editor
pdfjs-editor-remove-ink-button =
    .title = Remove drawing
pdfjs-editor-remove-freetext-button =
    .title = Remove text
pdfjs-editor-remove-stamp-button =
    .title = Remove image
pdfjs-editor-remove-highlight-button =
    .title = Remove highlight
pdfjs-editor-remove-signature-button =
    .title = Remove signature
pdfjs-editor-free-text-color-input = Color
pdfjs-editor-free-text-size-input = Size
pdfjs-editor-ink-color-input = Color
pdfjs-editor-ink-thickness-input = Thickness
pdfjs-editor-ink-opacity-input = Opacity
pdfjs-editor-stamp-add-image-button =
    .title = Add image
pdfjs-editor-stamp-add-image-button-label = Add image
pdfjs-editor-free-highlight-thickness-input = Thickness
pdfjs-editor-free-highlight-thickness-title =
    .title = Change thickness when highlighting items other than text
pdfjs-editor-add-signature-container =
    .aria-label = Signature controls and saved signatures
pdfjs-editor-signature-add-signature-button =
    .title = Add new signature
pdfjs-editor-signature-add-signature-button-label = Add new signature
pdfjs-editor-add-saved-signature-button =
    .title = Saved signature: { $description }
pdfjs-free-text2 =
    .aria-label = Text Editor
    .default-content = Start typing…
pdfjs-editor-comments-sidebar-title =
    { $count ->
        [one] Comment
       *[other] Comments
    }
pdfjs-editor-comments-sidebar-close-button =
    .title = Close the sidebar
    .aria-label = Close the sidebar
pdfjs-editor-comments-sidebar-close-button-label = Close the sidebar
pdfjs-editor-comments-sidebar-no-comments = Add a comment by selecting text or an annotation.
pdfjs-editor-alt-text-button =
    .aria-label = Alt text
pdfjs-editor-alt-text-button-label = Alt text
pdfjs-editor-alt-text-edit-button =
    .aria-label = Edit alt text
pdfjs-editor-alt-text-dialog-label = Choose an option
pdfjs-editor-alt-text-dialog-description = Alt text (alternative text) helps when people can’t see the image or when it doesn’t load.
pdfjs-editor-alt-text-add-description-label = Add a description
pdfjs-editor-alt-text-add-description-description = Aim for 1-2 sentences that describe the subject, setting, or actions.
pdfjs-editor-alt-text-mark-decorative-label = Mark as decorative
pdfjs-editor-alt-text-mark-decorative-description = This is used for ornamental images, like borders or watermarks.
pdfjs-editor-alt-text-cancel-button = Cancel
pdfjs-editor-alt-text-save-button = Save
pdfjs-editor-alt-text-decorative-tooltip = Marked as decorative
pdfjs-editor-alt-text-textarea =
    .placeholder = For example, “A young man sits down at a table to eat a meal”
pdfjs-editor-resizer-top-left =
    .aria-label = Top left corner — resize
pdfjs-editor-resizer-top-middle =
    .aria-label = Top middle — resize
pdfjs-editor-resizer-top-right =
    .aria-label = Top right corner — resize
pdfjs-editor-resizer-middle-right =
    .aria-label = Middle right — resize
pdfjs-editor-resizer-bottom-right =
    .aria-label = Bottom right corner — resize
pdfjs-editor-resizer-bottom-middle =
    .aria-label = Bottom middle — resize
pdfjs-editor-resizer-bottom-left =
    .aria-label = Bottom left corner — resize
pdfjs-editor-resizer-middle-left =
    .aria-label = Middle left — resize
pdfjs-editor-highlight-colorpicker-label = Highlight color
pdfjs-editor-colorpicker-button =
    .title = Change color
pdfjs-editor-colorpicker-dropdown =
    .aria-label = Color choices
pdfjs-editor-colorpicker-yellow =
    .title = Yellow
pdfjs-editor-colorpicker-green =
    .title = Green
pdfjs-editor-colorpicker-blue =
    .title = Blue
pdfjs-editor-colorpicker-pink =
    .title = Pink
pdfjs-editor-colorpicker-red =
    .title = Red
pdfjs-editor-highlight-show-all-button-label = Show all
pdfjs-editor-highlight-show-all-button =
    .title = Show all
pdfjs-editor-new-alt-text-dialog-edit-label = Edit alt text (image description)
pdfjs-editor-new-alt-text-dialog-add-label = Add alt text (image description)
pdfjs-editor-new-alt-text-textarea =
    .placeholder = Write your description here…
pdfjs-editor-new-alt-text-description = Short description for people who can’t see the image or when the image doesn’t load.
pdfjs-editor-new-alt-text-disclaimer1 = This alt text was created automatically and may be inaccurate.
pdfjs-editor-new-alt-text-disclaimer-learn-more-url = Learn more
pdfjs-editor-new-alt-text-create-automatically-button-label = Create alt text automatically
pdfjs-editor-new-alt-text-not-now-button = Not now
pdfjs-editor-new-alt-text-error-title = Couldn’t create alt text automatically
pdfjs-editor-new-alt-text-error-description = Please write your own alt text or try again later.
pdfjs-editor-new-alt-text-error-close-button = Close
pdfjs-editor-new-alt-text-ai-model-downloading-progress = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
    .aria-valuetext = Downloading alt text AI model ({ $downloadedSize } of { $totalSize } MB)
pdfjs-editor-new-alt-text-added-button =
    .aria-label = Alt text added
pdfjs-editor-new-alt-text-added-button-label = Alt text added
pdfjs-editor-new-alt-text-missing-button =
    .aria-label = Missing alt text
pdfjs-editor-new-alt-text-missing-button-label = Missing alt text
pdfjs-editor-new-alt-text-to-review-button =
    .aria-label = Review alt text
pdfjs-editor-new-alt-text-to-review-button-label = Review alt text
pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer = Created automatically: { $generatedAltText }
pdfjs-image-alt-text-settings-button =
    .title = Image alt text settings
pdfjs-image-alt-text-settings-button-label = Image alt text settings
pdfjs-editor-alt-text-settings-dialog-label = Image alt text settings
pdfjs-editor-alt-text-settings-automatic-title = Automatic alt text
pdfjs-editor-alt-text-settings-create-model-button-label = Create alt text automatically
pdfjs-editor-alt-text-settings-create-model-description = Suggests descriptions to help people who can’t see the image or when the image doesn’t load.
pdfjs-editor-alt-text-settings-download-model-label = Alt text AI model ({ $totalSize } MB)
pdfjs-editor-alt-text-settings-ai-model-description = Runs locally on your device so your data stays private. Required for automatic alt text.
pdfjs-editor-alt-text-settings-delete-model-button = Delete
pdfjs-editor-alt-text-settings-download-model-button = Download
pdfjs-editor-alt-text-settings-downloading-model-button = Downloading…
pdfjs-editor-alt-text-settings-editor-title = Alt text editor
pdfjs-editor-alt-text-settings-show-dialog-button-label = Show alt text editor right away when adding an image
pdfjs-editor-alt-text-settings-show-dialog-description = Helps you make sure all your images have alt text.
pdfjs-editor-alt-text-settings-close-button = Close
pdfjs-editor-highlight-added-alert = Highlight added
pdfjs-editor-freetext-added-alert = Text added
pdfjs-editor-ink-added-alert = Drawing added
pdfjs-editor-stamp-added-alert = Image added
pdfjs-editor-signature-added-alert = Signature added
pdfjs-editor-undo-bar-message-highlight = Highlight removed
pdfjs-editor-undo-bar-message-freetext = Text removed
pdfjs-editor-undo-bar-message-ink = Drawing removed
pdfjs-editor-undo-bar-message-stamp = Image removed
pdfjs-editor-undo-bar-message-signature = Signature removed
pdfjs-editor-undo-bar-message-multiple =
    { $count ->
        [one] { $count } annotation removed
       *[other] { $count } annotations removed
    }
pdfjs-editor-undo-bar-undo-button =
    .title = Undo
pdfjs-editor-undo-bar-undo-button-label = Undo
pdfjs-editor-undo-bar-close-button =
    .title = Close
pdfjs-editor-undo-bar-close-button-label = Close
pdfjs-editor-add-signature-dialog-label = This modal allows the user to create a signature to add to a PDF document. The user can edit the name (which also serves as the alt text), and optionally save the signature for repeated use.
pdfjs-editor-add-signature-dialog-title = Add a signature
pdfjs-editor-add-signature-type-button = Type
    .title = Type
pdfjs-editor-add-signature-draw-button = Draw
    .title = Draw
pdfjs-editor-add-signature-image-button = Image
    .title = Image
pdfjs-editor-add-signature-type-input =
    .aria-label = Type your signature
    .placeholder = Type your signature
pdfjs-editor-add-signature-draw-placeholder = Draw your signature
pdfjs-editor-add-signature-draw-thickness-range-label = Thickness
pdfjs-editor-add-signature-draw-thickness-range =
    .title = Drawing thickness: { $thickness }
pdfjs-editor-add-signature-image-placeholder = Drag a file here to upload
pdfjs-editor-add-signature-image-browse-link =
    { PLATFORM() ->
        [macos] Or choose image files
       *[other] Or browse image files
    }
pdfjs-editor-add-signature-description-label = Description (alt text)
pdfjs-editor-add-signature-description-input =
    .title = Description (alt text)
pdfjs-editor-add-signature-description-default-when-drawing = Signature
pdfjs-editor-add-signature-clear-button-label = Clear signature
pdfjs-editor-add-signature-clear-button =
    .title = Clear signature
pdfjs-editor-add-signature-save-checkbox = Save signature
pdfjs-editor-add-signature-save-warning-message = You’ve reached the limit of 5 saved signatures. Remove one to save more.
pdfjs-editor-add-signature-image-upload-error-title = Couldn’t upload image
pdfjs-editor-add-signature-image-upload-error-description = Check your network connection or try another image.
pdfjs-editor-add-signature-image-no-data-error-title = Can’t convert this image into a signature
pdfjs-editor-add-signature-image-no-data-error-description = Please try uploading a different image.
pdfjs-editor-add-signature-error-close-button = Close
pdfjs-editor-add-signature-cancel-button = Cancel
pdfjs-editor-add-signature-add-button = Add
pdfjs-editor-delete-signature-button1 =
    .title = Remove saved signature
pdfjs-editor-delete-signature-button-label1 = Remove saved signature
pdfjs-editor-add-signature-edit-button-label = Edit description
pdfjs-editor-edit-signature-dialog-title = Edit description
pdfjs-editor-edit-signature-update-button = Update
pdfjs-editor-edit-comment-actions-button-label = Actions
pdfjs-editor-edit-comment-actions-button =
    .title = Actions
pdfjs-editor-edit-comment-close-button-label = Close
pdfjs-editor-edit-comment-close-button =
    .title = Close
pdfjs-editor-edit-comment-actions-edit-button-label = Edit
pdfjs-editor-edit-comment-actions-delete-button-label = Delete
pdfjs-editor-edit-comment-manager-text-input =
    .placeholder = Enter your comment
pdfjs-editor-edit-comment-manager-cancel-button = Cancel
pdfjs-editor-edit-comment-manager-save-button = Save
pdfjs-editor-edit-comment-button =
    .title = Edit comment`)}}const rC=1e3,sC=50,aC=1e3;function y0(){return document.location.hash}class oC{#t=null;constructor({linkService:t,eventBus:e}){this.linkService=t,this.eventBus=e,this._initialized=!1,this._fingerprint="",this.reset(),this.eventBus._on("pagesinit",()=>{this._isPagesLoaded=!1,this.eventBus._on("pagesloaded",i=>{this._isPagesLoaded=!!i.pagesCount},{once:!0})})}initialize({fingerprint:t,resetHistory:e=!1,updateUrl:i=!1}){if(!t||typeof t!="string"){console.error('PDFHistory.initialize: The "fingerprint" must be a non-empty string.');return}this._initialized&&this.reset();const r=this._fingerprint!==""&&this._fingerprint!==t;this._fingerprint=t,this._updateUrl=i===!0,this._initialized=!0,this.#f();const a=window.history.state;if(this._popStateInProgress=!1,this._blockHashChange=0,this._currentHash=y0(),this._numPositionUpdates=0,this._uid=this._maxUid=0,this._destination=null,this._position=null,!this.#s(a,!0)||e){const{hash:c,page:h,rotation:f}=this.#a(!0);if(!c||r||e){this.#e(null,!0);return}this.#e({hash:c,page:h,rotation:f},!0);return}const l=a.destination;this.#r(l,a.uid,!0),l.rotation!==void 0&&(this._initialRotation=l.rotation),l.dest?(this._initialBookmark=JSON.stringify(l.dest),this._destination.page=null):l.hash?this._initialBookmark=l.hash:l.page&&(this._initialBookmark=`page=${l.page}`)}reset(){this._initialized&&(this.#l(),this._initialized=!1,this.#u()),this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._initialBookmark=null,this._initialRotation=null}push({namedDest:t=null,explicitDest:e,pageNumber:i}){if(!this._initialized)return;if(t&&typeof t!="string"){console.error(`PDFHistory.push: "${t}" is not a valid namedDest parameter.`);return}else if(Array.isArray(e)){if(!this.#n(i)&&(i!==null||this._destination)){console.error(`PDFHistory.push: "${i}" is not a valid pageNumber parameter.`);return}}else{console.error(`PDFHistory.push: "${e}" is not a valid explicitDest parameter.`);return}const r=t||JSON.stringify(e);if(!r)return;let a=!1;if(this._destination&&(lC(this._destination.hash,r)||cC(this._destination.dest,e))){if(this._destination.page)return;a=!0}this._popStateInProgress&&!a||(this.#e({dest:e,hash:r,page:i,rotation:this.linkService.rotation},a),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1})))}pushPage(t){if(this._initialized){if(!this.#n(t)){console.error(`PDFHistory.pushPage: "${t}" is not a valid page number.`);return}this._destination?.page!==t&&(this._popStateInProgress||(this.#e({dest:null,hash:`page=${t}`,page:t,rotation:this.linkService.rotation}),this._popStateInProgress||(this._popStateInProgress=!0,Promise.resolve().then(()=>{this._popStateInProgress=!1}))))}}pushCurrentPosition(){!this._initialized||this._popStateInProgress||this.#i()}back(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;this.#s(t)&&t.uid>0&&window.history.back()}forward(){if(!this._initialized||this._popStateInProgress)return;const t=window.history.state;this.#s(t)&&t.uid<this._maxUid&&window.history.forward()}get popStateInProgress(){return this._initialized&&(this._popStateInProgress||this._blockHashChange>0)}get initialBookmark(){return this._initialized?this._initialBookmark:null}get initialRotation(){return this._initialized?this._initialRotation:null}#e(t,e=!1){const i=e||!this._destination,r={fingerprint:this._fingerprint,uid:i?this._uid:this._uid+1,destination:t};this.#r(t,r.uid);let a;if(this._updateUrl&&t?.hash){const{href:l,protocol:c}=document.location;c!=="file:"&&(a=RT(l,t.hash))}i?window.history.replaceState(r,"",a):window.history.pushState(r,"",a)}#i(t=!1){if(!this._position)return;let e=this._position;if(t&&(e=Object.assign(Object.create(null),this._position),e.temporary=!0),!this._destination){this.#e(e);return}if(this._destination.temporary){this.#e(e,!0);return}if(this._destination.hash===e.hash||!this._destination.page&&this._numPositionUpdates<=sC)return;let i=!1;if(this._destination.page>=e.first&&this._destination.page<=e.page){if(this._destination.dest!==void 0||!this._destination.first)return;i=!0}this.#e(e,i)}#n(t){return Number.isInteger(t)&&t>0&&t<=this.linkService.pagesCount}#s(t,e=!1){if(!t)return!1;if(t.fingerprint!==this._fingerprint)if(e){if(typeof t.fingerprint!="string"||t.fingerprint.length!==this._fingerprint.length)return!1;const[i]=performance.getEntriesByType("navigation");if(i?.type!=="reload")return!1}else return!1;return!(!Number.isInteger(t.uid)||t.uid<0||t.destination===null||typeof t.destination!="object")}#r(t,e,i=!1){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),i&&t?.temporary&&delete t.temporary,this._destination=t,this._uid=e,this._maxUid=Math.max(this._maxUid,e),this._numPositionUpdates=0}#a(t=!1){const e=unescape(y0()).substring(1),i=Fh(e),r=i.get("nameddest")||"";let a=i.get("page")|0;return(!this.#n(a)||t&&r.length>0)&&(a=null),{hash:e,page:a,rotation:this.linkService.rotation}}#o({location:t}){this._updateViewareaTimeout&&(clearTimeout(this._updateViewareaTimeout),this._updateViewareaTimeout=null),this._position={hash:t.pdfOpenParams.substring(1),page:this.linkService.page,first:t.pageNumber,rotation:t.rotation},!this._popStateInProgress&&(this._isPagesLoaded&&this._destination&&!this._destination.page&&this._numPositionUpdates++,this._updateViewareaTimeout=setTimeout(()=>{this._popStateInProgress||this.#i(!0),this._updateViewareaTimeout=null},aC))}#c({state:t}){const e=y0(),i=this._currentHash!==e;if(this._currentHash=e,!t){this._uid++;const{hash:a,page:l,rotation:c}=this.#a();this.#e({hash:a,page:l,rotation:c},!0);return}if(!this.#s(t))return;this._popStateInProgress=!0,i&&(this._blockHashChange++,c2({target:window,name:"hashchange",delay:rC}).then(()=>{this._blockHashChange--}));const r=t.destination;this.#r(r,t.uid,!0),u_(r.rotation)&&(this.linkService.rotation=r.rotation),r.dest?this.linkService.goToDestination(r.dest):r.hash?this.linkService.setHash(r.hash):r.page&&(this.linkService.page=r.page),Promise.resolve().then(()=>{this._popStateInProgress=!1})}#l(){(!this._destination||this._destination.temporary)&&this.#i()}#f(){if(this.#t)return;this.#t=new AbortController;const{signal:t}=this.#t;this.eventBus._on("updateviewarea",this.#o.bind(this),{signal:t}),window.addEventListener("popstate",this.#c.bind(this),{signal:t}),window.addEventListener("pagehide",this.#l.bind(this),{signal:t})}#u(){this.#t?.abort(),this.#t=null}}function lC(n,t){return typeof n!="string"||typeof t!="string"?!1:n===t||Fh(n).get("nameddest")===t}function cC(n,t){function e(i,r){if(typeof i!=typeof r||Array.isArray(i)||Array.isArray(r))return!1;if(i!==null&&typeof i=="object"&&r!==null){if(Object.keys(i).length!==Object.keys(r).length)return!1;for(const a in i)if(!e(i[a],r[a]))return!1;return!0}return i===r||Number.isNaN(i)&&Number.isNaN(r)}if(!(Array.isArray(n)&&Array.isArray(t))||n.length!==t.length)return!1;for(let i=0,r=n.length;i<r;i++)if(!e(n[i],t[i]))return!1;return!0}class uC{#t=null;#e=null;#i=null;#n=null;#s=null;#r;constructor(t){this.pdfPage=t.pdfPage,this.accessibilityManager=t.accessibilityManager,this.l10n=t.l10n,this.l10n||=new Lr,this.annotationEditorLayer=null,this.div=null,this._cancelled=!1,this.#r=t.uiManager,this.#t=t.annotationLayer||null,this.#s=t.textLayer||null,this.#e=t.drawLayer||null,this.#i=t.onAppend||null,this.#n=t.structTreeLayer||null}async render({viewport:t,intent:e="display"}){if(e!=="display"||this._cancelled)return;const i=t.clone({dontFlip:!0});if(this.div){this.annotationEditorLayer.update({viewport:i}),this.show();return}const r=this.div=document.createElement("div");r.className="annotationEditorLayer",r.hidden=!0,r.dir=this.#r.direction,this.#i?.(r),this.annotationEditorLayer=new xT({uiManager:this.#r,div:r,structTreeLayer:this.#n,accessibilityManager:this.accessibilityManager,pageIndex:this.pdfPage.pageNumber-1,l10n:this.l10n,viewport:i,annotationLayer:this.#t,textLayer:this.#s,drawLayer:this.#e});const a={viewport:i,div:r,annotations:null,intent:e};this.annotationEditorLayer.render(a),this.show()}cancel(){this._cancelled=!0,this.div&&this.annotationEditorLayer.destroy()}hide(){this.div&&(this.annotationEditorLayer.pause(!0),this.div.hidden=!0)}show(){!this.div||this.annotationEditorLayer.isInvisible||(this.div.hidden=!1,this.annotationEditorLayer.pause(!1))}}{var q0=new Map;const{maxTouchPoints:n,platform:t,userAgent:e}=navigator,i=/Android/.test(e),r=/\b(iPad|iPhone|iPod)(?=;)/.test(e)||t==="MacIntel"&&n>1;(function(){(r||i)&&q0.set("maxCanvasPixels",5242880)})(),(function(){i&&q0.set("useSystemFonts",!1)})()}const ft={BROWSER:1,VIEWER:2,API:4,WORKER:8,EVENT_DISPATCH:16,PREFERENCE:128},K0={BOOLEAN:1,NUMBER:2,OBJECT:4,STRING:8,UNDEFINED:16},Or={allowedGlobalEvents:{value:null,kind:ft.BROWSER},canvasMaxAreaInBytes:{value:-1,kind:ft.BROWSER+ft.API},isInAutomation:{value:!1,kind:ft.BROWSER},localeProperties:{value:{lang:navigator.language||"en-US"},kind:ft.BROWSER},maxCanvasDim:{value:32767,kind:ft.BROWSER+ft.VIEWER},nimbusDataStr:{value:"",kind:ft.BROWSER},supportsCaretBrowsingMode:{value:!1,kind:ft.BROWSER},supportsDocumentFonts:{value:!0,kind:ft.BROWSER},supportsIntegratedFind:{value:!1,kind:ft.BROWSER},supportsMouseWheelZoomCtrlKey:{value:!0,kind:ft.BROWSER},supportsMouseWheelZoomMetaKey:{value:!0,kind:ft.BROWSER},supportsPinchToZoom:{value:!0,kind:ft.BROWSER},supportsPrinting:{value:!0,kind:ft.BROWSER},toolbarDensity:{value:0,kind:ft.BROWSER+ft.EVENT_DISPATCH},altTextLearnMoreUrl:{value:"",kind:ft.VIEWER+ft.PREFERENCE},annotationEditorMode:{value:0,kind:ft.VIEWER+ft.PREFERENCE},annotationMode:{value:2,kind:ft.VIEWER+ft.PREFERENCE},capCanvasAreaFactor:{value:200,kind:ft.VIEWER+ft.PREFERENCE},cursorToolOnLoad:{value:0,kind:ft.VIEWER+ft.PREFERENCE},debuggerSrc:{value:"./debugger.mjs",kind:ft.VIEWER},defaultZoomDelay:{value:400,kind:ft.VIEWER+ft.PREFERENCE},defaultZoomValue:{value:"",kind:ft.VIEWER+ft.PREFERENCE},disableHistory:{value:!1,kind:ft.VIEWER},disablePageLabels:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},enableAltText:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},enableAltTextModelDownload:{value:!0,kind:ft.VIEWER+ft.PREFERENCE+ft.EVENT_DISPATCH},enableAutoLinking:{value:!0,kind:ft.VIEWER+ft.PREFERENCE},enableComment:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},enableDetailCanvas:{value:!0,kind:ft.VIEWER},enableGuessAltText:{value:!0,kind:ft.VIEWER+ft.PREFERENCE+ft.EVENT_DISPATCH},enableHighlightFloatingButton:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},enableNewAltTextWhenAddingImage:{value:!0,kind:ft.VIEWER+ft.PREFERENCE},enableOptimizedPartialRendering:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},enablePermissions:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},enablePrintAutoRotate:{value:!0,kind:ft.VIEWER+ft.PREFERENCE},enableScripting:{value:!0,kind:ft.VIEWER+ft.PREFERENCE},enableSignatureEditor:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},enableUpdatedAddImage:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},externalLinkRel:{value:"noopener noreferrer nofollow",kind:ft.VIEWER},externalLinkTarget:{value:0,kind:ft.VIEWER+ft.PREFERENCE},highlightEditorColors:{value:"yellow=#FFFF98,green=#53FFBC,blue=#80EBFF,pink=#FFCBE6,red=#FF4F5F,yellow_HCM=#FFFFCC,green_HCM=#53FFBC,blue_HCM=#80EBFF,pink_HCM=#F6B8FF,red_HCM=#C50043",kind:ft.VIEWER+ft.PREFERENCE},historyUpdateUrl:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},ignoreDestinationZoom:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},imageResourcesPath:{value:"./images/",kind:ft.VIEWER},maxCanvasPixels:{value:2**25,kind:ft.VIEWER},minDurationToUpdateCanvas:{value:500,kind:ft.VIEWER},forcePageColors:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},pageColorsBackground:{value:"Canvas",kind:ft.VIEWER+ft.PREFERENCE},pageColorsForeground:{value:"CanvasText",kind:ft.VIEWER+ft.PREFERENCE},pdfBugEnabled:{value:!1,kind:ft.VIEWER+ft.PREFERENCE},printResolution:{value:150,kind:ft.VIEWER},sidebarViewOnLoad:{value:-1,kind:ft.VIEWER+ft.PREFERENCE},scrollModeOnLoad:{value:-1,kind:ft.VIEWER+ft.PREFERENCE},spreadModeOnLoad:{value:-1,kind:ft.VIEWER+ft.PREFERENCE},textLayerMode:{value:1,kind:ft.VIEWER+ft.PREFERENCE},viewerCssTheme:{value:0,kind:ft.VIEWER+ft.PREFERENCE},viewOnLoad:{value:0,kind:ft.VIEWER+ft.PREFERENCE},cMapPacked:{value:!0,kind:ft.API},cMapUrl:{value:"../web/cmaps/",kind:ft.API},disableAutoFetch:{value:!1,kind:ft.API+ft.PREFERENCE},disableFontFace:{value:!1,kind:ft.API+ft.PREFERENCE},disableRange:{value:!1,kind:ft.API+ft.PREFERENCE},disableStream:{value:!1,kind:ft.API+ft.PREFERENCE},docBaseUrl:{value:"",kind:ft.API},enableHWA:{value:!0,kind:ft.API+ft.VIEWER+ft.PREFERENCE},enableXfa:{value:!0,kind:ft.API+ft.PREFERENCE},fontExtraProperties:{value:!1,kind:ft.API},iccUrl:{value:"../web/iccs/",kind:ft.API},isEvalSupported:{value:!0,kind:ft.API},isOffscreenCanvasSupported:{value:!0,kind:ft.API},maxImageSize:{value:-1,kind:ft.API},pdfBug:{value:!1,kind:ft.API},standardFontDataUrl:{value:"../web/standard_fonts/",kind:ft.API},useSystemFonts:{value:void 0,kind:ft.API,type:K0.BOOLEAN+K0.UNDEFINED},verbosity:{value:1,kind:ft.API},wasmUrl:{value:"../web/wasm/",kind:ft.API},workerPort:{value:null,kind:ft.WORKER},workerSrc:{value:"../build/pdf.worker.mjs",kind:ft.WORKER}};Or.defaultUrl={value:"compressed.tracemonkey-pldi-09.pdf",kind:ft.VIEWER},Or.sandboxBundleSrc={value:"../build/pdf.sandbox.mjs",kind:ft.VIEWER},Or.enableFakeMLManager={value:!0,kind:ft.VIEWER};Or.disablePreferences={value:!1,kind:ft.VIEWER};var vs;const lr=class lr{static get(t){return xe(this,vs).get(t)}static getAll(t=null,e=!1){const i=Object.create(null);for(const r in Or){const a=Or[r];t&&!(t&a.kind)||(i[r]=e?a.value:xe(this,vs).get(r))}return i}static set(t,e){this.setAll({[t]:e})}static setAll(t,e=!1){this._hasInvokedSet||=!0;let i;for(const r in t){const a=Or[r],l=t[r];if(!a||!(typeof l==typeof a.value||K0[(typeof l).toUpperCase()]&a.type))continue;const{kind:c}=a;e&&!(c&ft.BROWSER||c&ft.PREFERENCE)||(this.eventBus&&c&ft.EVENT_DISPATCH&&(i||=new Map).set(r,l),xe(this,vs).set(r,l))}if(i)for(const[r,a]of i)this.eventBus.dispatch(r.toLowerCase(),{source:this,value:a})}};vs=new WeakMap,Av(lr,"eventBus"),Hn(lr,vs,new Map),(()=>{for(const t in Or)xe(lr,vs).set(t,Or[t].value);for(const[t,e]of q0)xe(lr,vs).set(t,e);lr._hasInvokedSet=!1,lr._checkDisablePreferences=()=>lr.get("disablePreferences")?!0:(lr._hasInvokedSet&&console.warn('The Preferences may override manually set AppOptions; please use the "disablePreferences"-option to prevent that.'),!1)})();let Hl=lr;function Nx({width:n,height:t,left:e,top:i},r){if(n===0||t===0)return null;const a=r.textLayer.div.getBoundingClientRect(),l=r.getPagePoint(e-a.left,i-a.top),c=r.getPagePoint(e-a.left+n,i-a.top+t);return xp.normalizeRect([l[0],l[1],c[0],c[1]])}function hC(n,t){const e=n.getClientRects();if(e.length===1)return{rect:Nx(e[0],t)};const i=[1/0,1/0,-1/0,-1/0],r=[];let a=0;for(const l of e){const c=Nx(l,t);c!==null&&(r[a]=r[a+4]=c[0],r[a+1]=r[a+3]=c[3],r[a+2]=r[a+6]=c[2],r[a+5]=r[a+7]=c[1],xp.rectBoundingBox(...c,i),a+=8)}return{quadPoints:r,rect:i}}function Ox(n,t){let e=n;do{if(e.nodeType===Node.TEXT_NODE){const i=e.textContent.length;if(t<=i)return[e,t];t-=i}else if(e.firstChild){e=e.firstChild;continue}for(;!e.nextSibling&&e!==n;)e=e.parentNode;e!==n&&(e=e.nextSibling)}while(e!==n);throw new Error("Offset is bigger than container's contents length.")}function fC({url:n,index:t,length:e},i,r){const a=i._textHighlighter,[{begin:l,end:c}]=a._convertMatches([t],[e]),h=new Range;return h.setStart(...Ox(a.textDivs[l.divIdx],l.offset)),h.setEnd(...Ox(a.textDivs[c.divIdx],c.offset)),{id:`inferred_link_${r}`,unsafeUrl:n,url:n,annotationType:s_.LINK,rotation:0,...hC(h,i),borderStyle:null}}class dC{static#t=0;static#e;static findLinks(t){this.#e??=new RegExp("\\b(?:https?:\\/\\/|mailto:|www\\.)(?:[\\S--[\\p{P}<>]]|\\/|[\\S--[\\[\\]]]+[\\S--[\\p{P}<>]])+|\\b[\\S--[@\\p{Ps}\\p{Pe}<>]]+@([\\S--[\\p{P}<>]]+(?:\\.[\\S--[\\p{P}<>]]+)+)","gmv");const[e,i]=oh(t,{ignoreDashEOL:!0}),r=e.matchAll(this.#e),a=[];for(const l of r){const[c,h]=l;let f;if(c.startsWith("www.")||c.startsWith("http://")||c.startsWith("https://"))f=c;else if(URL.canParse(`http://${h}`))f=c.startsWith("mailto:")?c:`mailto:${c}`;else continue;const p=a_(f,null,{addDefaultProtocol:!0});if(p){const[m,v]=h_(i,l.index,c.length);a.push({url:p.href,index:m,length:v})}}return a}static processLinks(t){return this.findLinks(t._textHighlighter.textContentItemsStr.join(`
`)).map(e=>fC(e,t,this.#t++))}}class m_{#t=null;#e=0;#i=null;#n=de.INITIAL;#s=null;#r=0;#a=null;canvas=null;div=null;enableOptimizedPartialRendering=!1;eventBus=null;id=null;pageColors=null;recordedGroups=null;renderingQueue=null;renderTask=null;resume=null;constructor(t){this.eventBus=t.eventBus,this.id=t.id,this.pageColors=t.pageColors||null,this.renderingQueue=t.renderingQueue,this.enableOptimizedPartialRendering=t.enableOptimizedPartialRendering??!1,this.#e=t.minDurationToUpdateCanvas??500}get renderingState(){return this.#n}set renderingState(t){if(t!==this.#n)switch(this.#n=t,this.#t&&(clearTimeout(this.#t),this.#t=null),t){case de.PAUSED:this.div.classList.remove("loading"),this.#r=0,this.#s?.(!1);break;case de.RUNNING:this.div.classList.add("loadingIcon"),this.#t=setTimeout(()=>{this.div.classList.add("loading"),this.#t=null},0),this.#r=Date.now();break;case de.INITIAL:case de.FINISHED:this.div.classList.remove("loadingIcon","loading"),this.#r=0;break}}_createCanvas(t,e=!1){const{pageColors:i}=this,r=!!(i?.background&&i?.foreground),a=this.canvas,l=!a&&!r&&!e;let c=this.canvas=document.createElement("canvas");return this.#s=h=>{if(l){let f=this.#a;if(!h&&this.#e>0){if(Date.now()-this.#r<this.#e)return;f||(f=this.#a=c,c=this.canvas=c.cloneNode(!1),t(c))}if(f){c.getContext("2d",{alpha:!1}).drawImage(f,0,0),h?this.#c():this.#r=Date.now();return}t(c),this.#s=null;return}h&&(a?(a.replaceWith(c),a.width=a.height=0):t(c))},{canvas:c,prevCanvas:a}}#o=t=>{if(this.#s?.(!1),this.renderingQueue&&!this.renderingQueue.isHighestPriority(this)){this.renderingState=de.PAUSED,this.resume=()=>{this.renderingState=de.RUNNING,t()};return}t()};_resetCanvas(){const{canvas:t}=this;t&&(t.remove(),t.width=t.height=0,this.canvas=null,this.#c())}#c(){this.#a&&(this.#a.width=this.#a.height=0,this.#a=null)}async _drawCanvas(t,e,i){const r=this.renderTask=this.pdfPage.render(t);r.onContinue=this.#o,r.onError=l=>{l instanceof G0&&(e(),this.#i=null)};let a=null;try{await r.promise,this.#s?.(!0)}catch(l){if(l instanceof G0)return;a=l,this.#s?.(!0)}finally{this.#i=a,r===this.renderTask&&(this.renderTask=null,this.enableOptimizedPartialRendering&&(this.recordedGroups??=r.recordedGroups))}if(this.renderingState=de.FINISHED,i(r),a)throw a}cancelRendering({cancelExtraDelay:t=0}={}){this.renderTask&&(this.renderTask.cancel(t),this.renderTask=null),this.resume=null}dispatchPageRender(){this.eventBus.dispatch("pagerender",{source:this,pageNumber:this.id})}dispatchPageRendered(t,e){this.eventBus.dispatch("pagerendered",{source:this,pageNumber:this.id,cssTransform:t,isDetailView:e,timestamp:performance.now(),error:this.#i})}}class pC{#t=null;constructor(t){this.pageIndex=t.pageIndex}async render({intent:t="display"}){t!=="display"||this.#t||this._cancelled||(this.#t=new ET({pageIndex:this.pageIndex}))}cancel(){this._cancelled=!0,this.#t&&(this.#t.destroy(),this.#t=null)}setParent(t){this.#t?.setParent(t)}getDrawLayer(){return this.#t}}class gC extends m_{#t=null;renderingCancelled=!1;constructor({pageView:t}){super(t),this.pageView=t,this.renderingId="detail"+this.id,this.div=t.div}setPdfPage(t){this.pageView.setPdfPage(t)}get pdfPage(){return this.pageView.pdfPage}get renderingState(){return super.renderingState}set renderingState(t){this.renderingCancelled=!1,super.renderingState=t}reset({keepCanvas:t=!1}={}){const e=this.renderingCancelled||this.renderingState===de.RUNNING||this.renderingState===de.PAUSED;this.cancelRendering(),this.renderingState=de.INITIAL,this.renderingCancelled=e,t||this._resetCanvas()}#e(t){if(!this.#t)return!0;const e=this.#t.minX,i=this.#t.minY,r=this.#t.width+e,a=this.#t.height+i;if(t.minX<e||t.minY<i||t.maxX>r||t.maxY>a)return!0;const{width:l,height:c,scale:h}=this.pageView.viewport;if(this.#t.scale!==h)return!0;const f=t.minX-e,p=r-t.maxX,m=t.minY-i,v=a-t.maxY,x=.5,E=(1+x)/x;return e>0&&p/f>E||r<l&&f/p>E||i>0&&v/m>E||a<c&&m/v>E}update({visibleArea:t=null,underlyingViewUpdated:e=!1}={}){if(e){this.cancelRendering(),this.renderingState=de.INITIAL;return}if(!this.#e(t))return;const{viewport:i,maxCanvasPixels:r,capCanvasAreaFactor:a}=this.pageView,l=t.maxX-t.minX,c=t.maxY-t.minY,h=l*c*ah.pixelRatio**2,p=(Math.sqrt(ah.capPixels(r,a)/h)-1)/2;let m=Math.min(1,p);m<0&&(m=0);const v=l*m,x=c*m,E=Math.max(0,t.minX-v),_=Math.min(i.width,t.maxX+v),b=Math.max(0,t.minY-x),A=Math.min(i.height,t.maxY+x),T=_-E,S=A-b;this.#t={minX:E,minY:b,width:T,height:S,scale:i.scale},this.reset({keepCanvas:!0})}_getRenderingContext(t,e){const i=this.pageView._getRenderingContext(t,e),r=this.pdfPage.recordedGroups;if(!r||!this.enableOptimizedPartialRendering)return{...i,recordOperations:!1};const a=new Set,{viewport:{width:l,height:c}}=this.pageView,{width:h,height:f,minX:p,minY:m}=this.#t,v=p/l,x=m/c,E=(p+h)/l,_=(m+f)/c;for(let b=0,A=r.length;b<A;b++){const T=r[b];T.minX<=E&&T.maxX>=v&&T.minY<=_&&T.maxY>=x&&(a.add(T.idx),T.dependencies.forEach(a.add,a))}return{...i,recordOperations:!1,filteredOperationIndexes:a}}async draw(){if(this.pageView.detailView!==this)return;const t=this.pageView.renderingState===de.FINISHED||this.renderingState===de.FINISHED;this.renderingState!==de.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:e,pdfPage:i,viewport:r}=this.pageView;if(!i)throw this.renderingState=de.FINISHED,new Error("pdfPage is not loaded");this.renderingState=de.RUNNING;const a=this.pageView._ensureCanvasWrapper(),{canvas:l,prevCanvas:c}=this._createCanvas(_=>{a.firstElementChild?.tagName==="CANVAS"?a.firstElementChild.after(_):a.prepend(_)},t);l.setAttribute("aria-hidden","true");const{width:h,height:f}=r,p=this.#t,{pixelRatio:m}=ah,v=[m,0,0,m,-p.minX*m,-p.minY*m];l.width=p.width*m,l.height=p.height*m;const{style:x}=l;x.width=`${p.width*100/h}%`,x.height=`${p.height*100/f}%`,x.top=`${p.minY*100/f}%`,x.left=`${p.minX*100/h}%`;const E=this._drawCanvas(this._getRenderingContext(l,v),()=>{this.canvas?.remove(),this.canvas=c},()=>{this.dispatchPageRendered(!1,!0)});return e.setAttribute("data-loaded",!0),this.dispatchPageRender(),E}}const Lx={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},mC=/^H(\d+)$/;class v_{#t;#e=null;#i;#n=new Map;#s;#r=null;constructor(t,e){this.#t=t.getStructTree(),this.#s=e}async render(){if(this.#i)return this.#i;const{promise:t,resolve:e,reject:i}=Promise.withResolvers();this.#i=t;try{this.#e=this.#c(await this.#t)}catch(r){i(r)}return this.#t=null,this.#e?.classList.add("structTree"),e(this.#e),t}async getAriaAttributes(t){try{return await this.render(),this.#n.get(t)}catch{}return null}hide(){this.#e&&!this.#e.hidden&&(this.#e.hidden=!0)}show(){this.#e?.hidden&&(this.#e.hidden=!1)}#a(t,e){const{alt:i,id:r,lang:a}=t;if(i!==void 0){let l=!1;const c=Ul(i);for(const h of t.children)if(h.type==="annotation"){let f=this.#n.get(h.id);f||(f=new Map,this.#n.set(h.id,f)),f.set("aria-label",c),l=!0}l||e.setAttribute("aria-label",c)}r!==void 0&&e.setAttribute("aria-owns",r),a!==void 0&&e.setAttribute("lang",Ul(a,!0))}#o(t,e){const{alt:i,bbox:r,children:a}=t,l=a?.[0];if(!this.#s||!i||!r||l?.type!=="content")return!1;const{id:c}=l;if(!c)return!1;e.setAttribute("aria-owns",c);const h=document.createElement("span");(this.#r||=new Map).set(c,h),h.setAttribute("role","img"),h.setAttribute("aria-label",Ul(i));const{pageHeight:f,pageX:p,pageY:m}=this.#s,v="calc(var(--total-scale-factor) *",{style:x}=h;return x.width=`${v}${r[2]-r[0]}px)`,x.height=`${v}${r[3]-r[1]}px)`,x.left=`${v}${r[0]-p}px)`,x.top=`${v}${f-r[3]+m}px)`,!0}addElementsToTextLayer(){if(this.#r){for(const[t,e]of this.#r)document.getElementById(t)?.append(e);this.#r.clear(),this.#r=null}}#c(t){if(!t)return null;const e=document.createElement("span");if("role"in t){const{role:i}=t,r=i.match(mC);if(r?(e.setAttribute("role","heading"),e.setAttribute("aria-level",r[1])):Lx[i]&&e.setAttribute("role",Lx[i]),i==="Figure"&&this.#o(t,e))return e}if(this.#a(t,e),t.children)if(t.children.length===1&&"id"in t.children[0])this.#a(t.children[0],e);else for(const i of t.children)e.append(this.#c(i));return e}}class jl{#t=!1;#e=null;#i=new Map;#n=new Map;setTextMapping(t){this.#e=t}static#s(t,e){const i=t.getBoundingClientRect(),r=e.getBoundingClientRect();if(i.width===0&&i.height===0)return 1;if(r.width===0&&r.height===0)return-1;const a=i.y,l=i.y+i.height,c=i.y+i.height/2,h=r.y,f=r.y+r.height,p=r.y+r.height/2;if(c<=h&&p>=l)return-1;if(p<=a&&c>=f)return 1;const m=i.x+i.width/2,v=r.x+r.width/2;return m-v}enable(){if(this.#t)throw new Error("TextAccessibilityManager is already enabled.");if(!this.#e)throw new Error("Text divs and strings have not been set.");if(this.#t=!0,this.#e=this.#e.slice(),this.#e.sort(jl.#s),this.#i.size>0){const t=this.#e;for(const[e,i]of this.#i){if(!document.getElementById(e)){this.#i.delete(e);continue}this.#r(e,t[i])}}for(const[t,e]of this.#n)this.addPointerInTextLayer(t,e);this.#n.clear()}disable(){this.#t&&(this.#n.clear(),this.#e=null,this.#t=!1)}removePointerInTextLayer(t){if(!this.#t){this.#n.delete(t);return}const e=this.#e;if(!e||e.length===0)return;const{id:i}=t,r=this.#i.get(i);if(r===void 0)return;const a=e[r];this.#i.delete(i);let l=a.getAttribute("aria-owns");l?.includes(i)&&(l=l.split(" ").filter(c=>c!==i).join(" "),l?a.setAttribute("aria-owns",l):(a.removeAttribute("aria-owns"),a.setAttribute("role","presentation")))}#r(t,e){const i=e.getAttribute("aria-owns");i?.includes(t)||e.setAttribute("aria-owns",i?`${i} ${t}`:t),e.removeAttribute("role")}addPointerInTextLayer(t,e){const{id:i}=t;if(!i)return null;if(!this.#t)return this.#n.set(t,e),null;e&&this.removePointerInTextLayer(t);const r=this.#e;if(!r||r.length===0)return null;const a=Zl(r,f=>jl.#s(t,f)<0),l=Math.max(0,a-1),c=r[l];this.#r(i,c),this.#i.set(i,l);const h=c.parentNode;return h?.classList.contains("markedContent")?h.id:null}moveElementInDOM(t,e,i,r){const a=this.addPointerInTextLayer(i,r);if(!t.hasChildNodes())return t.append(e),a;const l=Array.from(t.childNodes).filter(f=>f!==e);if(l.length===0)return a;const c=i||e,h=Zl(l,f=>jl.#s(c,f)<0);return h===0?l[0].before(e):l[h-1].after(e),a}}class vC{#t=null;constructor({findController:t,eventBus:e,pageIndex:i}){this.findController=t,this.matches=[],this.eventBus=e,this.pageIdx=i,this.textDivs=null,this.textContentItemsStr=null,this.enabled=!1}setTextMapping(t,e){this.textDivs=t,this.textContentItemsStr=e}enable(){if(!this.textDivs||!this.textContentItemsStr)throw new Error("Text divs and strings have not been set.");if(this.enabled)throw new Error("TextHighlighter is already enabled.");this.enabled=!0,this.#t||(this.#t=new AbortController,this.eventBus._on("updatetextlayermatches",t=>{(t.pageIndex===this.pageIdx||t.pageIndex===-1)&&this._updateMatches()},{signal:this.#t.signal})),this._updateMatches()}disable(){this.enabled&&(this.enabled=!1,this.#t?.abort(),this.#t=null,this._updateMatches(!0))}_convertMatches(t,e){if(!t)return[];const{textContentItemsStr:i}=this;let r=0,a=0;const l=i.length-1,c=[];for(let h=0,f=t.length;h<f;h++){let p=t[h];for(;r!==l&&p>=a+i[r].length;)a+=i[r].length,r++;r===i.length&&console.error("Could not find a matching mapping");const m={begin:{divIdx:r,offset:p-a}};for(p+=e[h];r!==l&&p>a+i[r].length;)a+=i[r].length,r++;m.end={divIdx:r,offset:p-a},c.push(m)}return c}_renderMatches(t){if(t.length===0)return;const{findController:e,pageIdx:i}=this,{textContentItemsStr:r,textDivs:a}=this,l=i===e.selected.pageIdx,c=e.selected.matchIdx,h=e.state.highlightAll;let f=null;const p={offset:void 0};function m(A,T){const S=A.divIdx;return a[S].textContent="",v(S,0,A.offset,T)}function v(A,T,S,C){let N=a[A];if(N.nodeType===Node.TEXT_NODE){const H=document.createElement("span");N.before(H),H.append(N),a[A]=H,N=H}const B=r[A].substring(T,S),O=document.createTextNode(B);if(C){const H=document.createElement("span");if(H.className=`${C} appended`,H.append(O),N.append(H),C.includes("selected")){const{left:M}=H.getClientRects()[0],W=N.getBoundingClientRect().left;return M-W}return 0}return N.append(O),0}let x=c,E=x+1;if(h)x=0,E=t.length;else if(!l)return;let _=-1,b=-1;for(let A=x;A<E;A++){const T=t[A],S=T.begin;if(S.divIdx===_&&S.offset===b)continue;_=S.divIdx,b=S.offset;const C=T.end,N=l&&A===c,B=N?" selected":"";let O=0;if(!f||S.divIdx!==f.divIdx?(f!==null&&v(f.divIdx,f.offset,p.offset),m(S)):v(f.divIdx,f.offset,S.offset),S.divIdx===C.divIdx)O=v(S.divIdx,S.offset,C.offset,"highlight"+B);else{O=v(S.divIdx,S.offset,p.offset,"highlight begin"+B);for(let H=S.divIdx+1,M=C.divIdx;H<M;H++)a[H].className="highlight middle"+B;m(C,"highlight end"+B)}f=C,N&&e.scrollMatchIntoView({element:a[S.divIdx],selectedLeft:O,pageIndex:i,matchIndex:c})}f&&v(f.divIdx,f.offset,p.offset)}_updateMatches(t=!1){if(!this.enabled&&!t)return;const{findController:e,matches:i,pageIdx:r}=this,{textContentItemsStr:a,textDivs:l}=this;let c=-1;for(const p of i){const m=Math.max(c,p.begin.divIdx);for(let v=m,x=p.end.divIdx;v<=x;v++){const E=l[v];E.textContent=a[v],E.className=""}c=p.end.divIdx+1}if(!e?.highlightMatches||t)return;const h=e.pageMatches[r]||null,f=e.pageMatchesLength[r]||null;this.matches=this._convertMatches(h,f),this._renderMatches(this.matches)}}class go{#t=!1;#e=null;#i=!1;#n=null;static#s=new Map;static#r=null;constructor({pdfPage:t,highlighter:e=null,accessibilityManager:i=null,enablePermissions:r=!1,onAppend:a=null}){this.pdfPage=t,this.highlighter=e,this.accessibilityManager=i,this.#t=r===!0,this.#e=a,this.div=document.createElement("div"),this.div.tabIndex=0,this.div.className="textLayer"}async render({viewport:t,textContentParams:e=null}){if(this.#i&&this.#n){this.#n.update({viewport:t,onBefore:this.hide.bind(this)}),this.show();return}this.cancel(),this.#n=new CT({textContentSource:this.pdfPage.streamTextContent(e||{includeMarkedContent:!0,disableNormalization:!0}),container:this.div,viewport:t});const{textDivs:i,textContentItemsStr:r}=this.#n;this.highlighter?.setTextMapping(i,r),this.accessibilityManager?.setTextMapping(i),await this.#n.render(),this.#i=!0;const a=document.createElement("div");a.className="endOfContent",this.div.append(a),this.#a(a),this.#e?.(this.div),this.highlighter?.enable(),this.accessibilityManager?.enable()}hide(){!this.div.hidden&&this.#i&&(this.highlighter?.disable(),this.div.hidden=!0)}show(){this.div.hidden&&this.#i&&(this.div.hidden=!1,this.highlighter?.enable())}cancel(){this.#n?.cancel(),this.#n=null,this.highlighter?.disable(),this.accessibilityManager?.disable(),go.#o(this.div)}#a(t){const{div:e}=this;e.addEventListener("mousedown",()=>{e.classList.add("selecting")}),e.addEventListener("copy",i=>{if(!this.#t){const r=document.getSelection();i.clipboardData.setData("text/plain",Ul(TT(r.toString())))}W0(i)}),go.#s.set(e,t),go.#c()}static#o(t){this.#s.delete(t),this.#s.size===0&&(this.#r?.abort(),this.#r=null)}static#c(){if(this.#r)return;this.#r=new AbortController;const{signal:t}=this.#r,e=(l,c)=>{c.append(l),l.style.width="",l.style.height="",c.classList.remove("selecting")};let i=!1;document.addEventListener("pointerdown",()=>{i=!0},{signal:t}),document.addEventListener("pointerup",()=>{i=!1,this.#s.forEach(e)},{signal:t}),window.addEventListener("blur",()=>{i=!1,this.#s.forEach(e)},{signal:t}),document.addEventListener("keyup",()=>{i||this.#s.forEach(e)},{signal:t});var r,a;document.addEventListener("selectionchange",()=>{const l=document.getSelection();if(l.rangeCount===0){this.#s.forEach(e);return}const c=new Set;for(let x=0;x<l.rangeCount;x++){const E=l.getRangeAt(x);for(const _ of this.#s.keys())!c.has(_)&&E.intersectsNode(_)&&c.add(_)}for(const[x,E]of this.#s)c.has(x)?x.classList.add("selecting"):e(E,x);if(r??=getComputedStyle(this.#s.values().next().value).getPropertyValue("-moz-user-select")==="none",r)return;const h=l.getRangeAt(0),f=a&&(h.compareBoundaryPoints(Range.END_TO_END,a)===0||h.compareBoundaryPoints(Range.START_TO_END,a)===0);let p=f?h.startContainer:h.endContainer;if(p.nodeType===Node.TEXT_NODE&&(p=p.parentNode),!f&&h.endOffset===0)do{for(;!p.previousSibling;)p=p.parentNode;p=p.previousSibling}while(!p.childNodes.length);const m=p.parentElement?.closest(".textLayer"),v=this.#s.get(m);v&&(v.style.width=m.style.width,v.style.height=m.style.height,p.parentElement.insertBefore(v,f?p:p.nextSibling)),a=h.cloneRange()},{signal:t})}}class x_{constructor({pdfPage:t,annotationStorage:e=null,linkService:i,xfaHtml:r=null}){this.pdfPage=t,this.annotationStorage=e,this.linkService=i,this.xfaHtml=r,this.div=null,this._cancelled=!1}async render({viewport:t,intent:e="display"}){if(e==="print"){const a={viewport:t.clone({dontFlip:!0}),div:this.div,xfaHtml:this.xfaHtml,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:e};return this.div=document.createElement("div"),a.div=this.div,d0.render(a)}const i=await this.pdfPage.getXfa();if(this._cancelled||!i)return{textDivs:[]};const r={viewport:t.clone({dontFlip:!0}),div:this.div,xfaHtml:i,annotationStorage:this.annotationStorage,linkService:this.linkService,intent:e};return this.div?d0.update(r):(this.div=document.createElement("div"),r.div=this.div,d0.render(r))}cancel(){this._cancelled=!0}hide(){this.div&&(this.div.hidden=!0)}}const xC={annotationEditorUIManager:null,annotationStorage:null,downloadManager:null,enableScripting:!1,fieldObjectsPromise:null,findController:null,hasJSActionsPromise:null,get linkService(){return new _p}},yC=new Map([["canvasWrapper",0],["textLayer",1],["annotationLayer",2],["annotationEditorLayer",3],["xfaLayer",3]]);class y_ extends m_{#t=Nr.ENABLE_FORMS;#e=null;#i=!0;#n=!1;#s=!1;#r=null;#a=!1;#o=null;#c=null;#l=1;#f=1;#u=ur.ENABLE;#d=1;#g={directDrawing:!0,initialOptionalContent:!0,regularAnnotations:!0};#p=[null,null,null,null];constructor(t){super(t);const e=t.container,i=t.defaultViewport;this.renderingId="page"+this.id,this.#r=t.layerProperties||xC,this.pdfPage=null,this.pageLabel=null,this.rotation=0,this.scale=t.scale||l_,this.viewport=i,this.pdfPageRotate=i.rotation,this._optionalContentConfigPromise=t.optionalContentConfigPromise||null,this.#u=t.textLayerMode??ur.ENABLE,this.#t=t.annotationMode??Nr.ENABLE_FORMS,this.imageResourcesPath=t.imageResourcesPath||"",this.enableDetailCanvas=t.enableDetailCanvas??!0,this.maxCanvasPixels=t.maxCanvasPixels??Hl.get("maxCanvasPixels"),this.maxCanvasDim=t.maxCanvasDim||Hl.get("maxCanvasDim"),this.capCanvasAreaFactor=t.capCanvasAreaFactor??Hl.get("capCanvasAreaFactor"),this.#i=t.enableAutoLinking!==!1,this.l10n=t.l10n,this.l10n||=new Lr,this._isStandalone=!this.renderingQueue?.hasViewer(),this._container=e,this._annotationCanvasMap=null,this.annotationLayer=null,this.annotationEditorLayer=null,this.textLayer=null,this.xfaLayer=null,this.structTreeLayer=null,this.drawLayer=null,this.detailView=null;const r=document.createElement("div");if(r.className="page",r.setAttribute("data-page-number",this.id),r.setAttribute("role","region"),r.setAttribute("data-l10n-id","pdfjs-page-landmark"),r.setAttribute("data-l10n-args",JSON.stringify({page:this.id})),this.div=r,this.#m(),e?.append(r),this._isStandalone){e?.style.setProperty("--scale-factor",this.scale*Dr.PDF_TO_CSS_UNITS),this.pageColors?.background&&e?.style.setProperty("--page-bg-color",this.pageColors.background);const{optionalContentConfigPromise:a}=t;a&&a.then(l=>{a===this._optionalContentConfigPromise&&(this.#g.initialOptionalContent=l.hasInitialVisibility)}),t.l10n||this.l10n.translate(this.div)}}#h(t,e){const i=yC.get(e),r=this.#p[i];if(this.#p[i]=t,r){r.replaceWith(t);return}for(let a=i-1;a>=0;a--){const l=this.#p[a];if(l){l.after(t);return}}this.div.prepend(t)}#m(){const{div:t,viewport:e}=this;if(e.userUnit!==this.#d&&(e.userUnit!==1?t.style.setProperty("--user-unit",e.userUnit):t.style.removeProperty("--user-unit"),this.#d=e.userUnit),this.pdfPage){if(this.#c===e.rotation)return;this.#c=e.rotation}o_(t,e,!0,!1)}setPdfPage(t){this._isStandalone&&(this.pageColors?.foreground==="CanvasText"||this.pageColors?.background==="Canvas")&&(this._container?.style.setProperty("--hcm-highlight-filter",t.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),this._container?.style.setProperty("--hcm-highlight-selected-filter",t.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","Highlight"))),this.pdfPage=t,this.pdfPageRotate=t.rotate;const e=(this.rotation+this.pdfPageRotate)%360;this.viewport=t.getViewport({scale:this.scale*Dr.PDF_TO_CSS_UNITS,rotation:e}),this.#m(),this.reset()}destroy(){this.reset(),this.pdfPage?.cleanup()}hasEditableAnnotations(){return!!this.annotationLayer?.hasEditableAnnotations()}get _textHighlighter(){return hh(this,"_textHighlighter",new vC({pageIndex:this.id-1,eventBus:this.eventBus,findController:this.#r.findController}))}#y(t,e){this.eventBus.dispatch(t,{source:this,pageNumber:this.id,error:e})}async#v(){let t=null;try{await this.annotationLayer.render({viewport:this.viewport,intent:"display",structTreeLayer:this.structTreeLayer})}catch(e){console.error("#renderAnnotationLayer:",e),t=e}finally{this.#y("annotationlayerrendered",t)}}async#_(){let t=null;try{await this.annotationEditorLayer.render({viewport:this.viewport,intent:"display"})}catch(e){console.error("#renderAnnotationEditorLayer:",e),t=e}finally{this.#y("annotationeditorlayerrendered",t)}}async#E(){try{await this.drawLayer.render({intent:"display"})}catch(t){console.error("#renderDrawLayer:",t)}}async#x(){let t=null;try{const e=await this.xfaLayer.render({viewport:this.viewport,intent:"display"});e?.textDivs&&this._textHighlighter&&this.#w(e.textDivs)}catch(e){console.error("#renderXfaLayer:",e),t=e}finally{this.xfaLayer?.div&&(this.l10n.pause(),this.#h(this.xfaLayer.div,"xfaLayer"),this.l10n.resume()),this.#y("xfalayerrendered",t)}}async#A(){if(!this.textLayer)return;let t=null;try{await this.textLayer.render({viewport:this.viewport})}catch(e){if(e instanceof vT)return;console.error("#renderTextLayer:",e),t=e}this.#y("textlayerrendered",t),this.#T()}async#T(){if(!this.textLayer)return;const t=await this.structTreeLayer?.render();t&&(this.l10n.pause(),this.structTreeLayer?.addElementsToTextLayer(),this.canvas&&t.parentNode!==this.canvas&&this.canvas.append(t),this.l10n.resume()),this.structTreeLayer?.show()}async#w(t){const e=await this.pdfPage.getTextContent(),i=[];for(const r of e.items)i.push(r.str);this._textHighlighter.setTextMapping(t,i),this._textHighlighter.enable()}async#S(t){try{if(await t,!this.annotationLayer)return;await this.annotationLayer.injectLinkAnnotations({inferredLinks:dC.processLinks(this),viewport:this.viewport,structTreeLayer:this.structTreeLayer})}catch(e){console.error("#injectLinkAnnotations:",e)}}_resetCanvas(){super._resetCanvas(),this.#o=null}reset({keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:e=!1,keepXfaLayer:i=!1,keepTextLayer:r=!1,keepCanvasWrapper:a=!1,preserveDetailViewState:l=!1}={}){const c=this.pdfPage?._pdfBug??!1;this.cancelRendering({keepAnnotationLayer:t,keepAnnotationEditorLayer:e,keepXfaLayer:i,keepTextLayer:r}),this.renderingState=de.INITIAL;const h=this.div,f=h.childNodes,p=t&&this.annotationLayer?.div||null,m=e&&this.annotationEditorLayer?.div||null,v=i&&this.xfaLayer?.div||null,x=r&&this.textLayer?.div||null,E=a&&this.#e||null;for(let _=f.length-1;_>=0;_--){const b=f[_];switch(b){case p:case m:case v:case x:case E:continue}if(c&&b.classList.contains("pdfBugGroupsLayer"))continue;b.remove();const A=this.#p.indexOf(b);A>=0&&(this.#p[A]=null)}h.removeAttribute("data-loaded"),p&&this.annotationLayer.hide(),m&&this.annotationEditorLayer.hide(),v&&this.xfaLayer.hide(),x&&this.textLayer.hide(),this.structTreeLayer?.hide(),!a&&this.#e&&(this.#e=null,this._resetCanvas()),l||(this.detailView?.reset({keepCanvas:a}),a||(this.detailView=null))}toggleEditingMode(t){this.#s=t,this.hasEditableAnnotations()&&this.reset({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,keepCanvasWrapper:!0})}updateVisibleArea(t){this.enableDetailCanvas&&(this.#a&&this.maxCanvasPixels>0&&t?(this.detailView??=new gC({pageView:this,enableOptimizedPartialRendering:this.enableOptimizedPartialRendering}),this.detailView.update({visibleArea:t})):this.detailView&&(this.detailView.reset(),this.detailView=null))}update({scale:t=0,rotation:e=null,optionalContentConfigPromise:i=null,drawingDelay:r=-1}){this.scale=t||this.scale,typeof e=="number"&&(this.rotation=e),i instanceof Promise&&(this._optionalContentConfigPromise=i,i.then(l=>{i===this._optionalContentConfigPromise&&(this.#g.initialOptionalContent=l.hasInitialVisibility)})),this.#g.directDrawing=!0;const a=(this.rotation+this.pdfPageRotate)%360;if(this.viewport=this.viewport.clone({scale:this.scale*Dr.PDF_TO_CSS_UNITS,rotation:a}),this.#m(),this._isStandalone&&this._container?.style.setProperty("--scale-factor",this.viewport.scale),this.#M(),this.canvas){const l=this.#n&&this.#a,c=r>=0&&r<1e3;if(c||l){c&&!l&&this.renderingState!==de.FINISHED&&(this.cancelRendering({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,cancelExtraDelay:r}),this.renderingState=de.FINISHED,this.#g.directDrawing=!1),this.cssTransform({redrawAnnotationLayer:!0,redrawAnnotationEditorLayer:!0,redrawXfaLayer:!0,redrawTextLayer:!c,hideTextLayer:c}),c||(this.detailView?.update({underlyingViewUpdated:!0}),this.dispatchPageRendered(!0,!1));return}}this.cssTransform({}),this.reset({keepAnnotationLayer:!0,keepAnnotationEditorLayer:!0,keepXfaLayer:!0,keepTextLayer:!0,keepCanvasWrapper:!0,preserveDetailViewState:!0}),this.detailView?.update({underlyingViewUpdated:!0})}#M(){const{width:t,height:e}=this.viewport,i=this.outputScale=new ah;if(this.maxCanvasPixels===0){const r=1/this.scale;i.sx*=r,i.sy*=r,this.#a=!0}else this.#a=i.limitCanvas(t,e,this.maxCanvasPixels,this.maxCanvasDim,this.capCanvasAreaFactor)}cancelRendering({keepAnnotationLayer:t=!1,keepAnnotationEditorLayer:e=!1,keepXfaLayer:i=!1,keepTextLayer:r=!1,cancelExtraDelay:a=0}={}){super.cancelRendering({cancelExtraDelay:a}),this.textLayer&&(!r||!this.textLayer.div)&&(this.textLayer.cancel(),this.textLayer=null),this.annotationLayer&&(!t||!this.annotationLayer.div)&&(this.annotationLayer.cancel(),this.annotationLayer=null,this._annotationCanvasMap=null),this.structTreeLayer&&!this.textLayer&&(this.structTreeLayer=null),this.annotationEditorLayer&&(!e||!this.annotationEditorLayer.div)&&(this.drawLayer&&(this.drawLayer.cancel(),this.drawLayer=null),this.annotationEditorLayer.cancel(),this.annotationEditorLayer=null),this.xfaLayer&&(!i||!this.xfaLayer.div)&&(this.xfaLayer.cancel(),this.xfaLayer=null,this._textHighlighter?.disable())}cssTransform({redrawAnnotationLayer:t=!1,redrawAnnotationEditorLayer:e=!1,redrawXfaLayer:i=!1,redrawTextLayer:r=!1,hideTextLayer:a=!1}){const{canvas:l}=this;if(!l)return;const c=this.#o;if(this.viewport!==c){const h=(360+this.viewport.rotation-c.rotation)%360;if(h===90||h===270){const{width:f,height:p}=this.viewport,m=p/f,v=f/p;l.style.transform=`rotate(${h}deg) scale(${m},${v})`}else l.style.transform=h===0?"":`rotate(${h}deg)`}t&&this.annotationLayer&&this.#v(),e&&this.annotationEditorLayer&&(this.drawLayer&&this.#E(),this.#_()),i&&this.xfaLayer&&this.#x(),this.textLayer&&(a?(this.textLayer.hide(),this.structTreeLayer?.hide()):r&&this.#A())}get width(){return this.viewport.width}get height(){return this.viewport.height}getPagePoint(t,e){return this.viewport.convertToPdfPoint(t,e)}_ensureCanvasWrapper(){let t=this.#e;return t||(t=this.#e=document.createElement("div"),t.classList.add("canvasWrapper"),this.#h(t,"canvasWrapper")),t}_getRenderingContext(t,e){return{canvas:t,transform:e,viewport:this.viewport,annotationMode:this.#t,optionalContentConfigPromise:this._optionalContentConfigPromise,annotationCanvasMap:this._annotationCanvasMap,pageColors:this.pageColors,isEditing:this.#s,recordOperations:this.enableOptimizedPartialRendering&&!this.recordedGroups}}async draw(){this.renderingState!==de.INITIAL&&(console.error("Must be in new state before drawing"),this.reset());const{div:t,l10n:e,pdfPage:i,viewport:r}=this;if(!i)throw this.renderingState=de.FINISHED,new Error("pdfPage is not loaded");this.renderingState=de.RUNNING;const a=this._ensureCanvasWrapper();if(!this.textLayer&&this.#u!==ur.DISABLE&&!i.isPureXfa&&(this._accessibilityManager||=new jl,this.textLayer=new go({pdfPage:i,highlighter:this._textHighlighter,accessibilityManager:this._accessibilityManager,enablePermissions:this.#u===ur.ENABLE_PERMISSIONS,onAppend:S=>{this.l10n.pause(),this.#h(S,"textLayer"),this.l10n.resume()}})),!this.annotationLayer&&this.#t!==Nr.DISABLE){const{annotationStorage:S,annotationEditorUIManager:C,downloadManager:N,enableComment:B,enableScripting:O,fieldObjectsPromise:H,hasJSActionsPromise:M,linkService:W}=this.#r;this._annotationCanvasMap||=new Map,this.annotationLayer=new f_({pdfPage:i,annotationStorage:S,imageResourcesPath:this.imageResourcesPath,renderForms:this.#t===Nr.ENABLE_FORMS,linkService:W,downloadManager:N,enableComment:B,enableScripting:O,hasJSActionsPromise:M,fieldObjectsPromise:H,annotationCanvasMap:this._annotationCanvasMap,accessibilityManager:this._accessibilityManager,annotationEditorUIManager:C,onAppend:Y=>{this.#h(Y,"annotationLayer")}})}const{width:l,height:c}=r;this.#o=r;const{canvas:h,prevCanvas:f}=this._createCanvas(S=>{a.prepend(S)});h.setAttribute("role","presentation"),this.outputScale||this.#M();const{outputScale:p}=this;this.#n=this.#a;const m=lx(p.sx),v=lx(p.sy),x=h.width=Gu(Wu(l*p.sx),m[0]),E=h.height=Gu(Wu(c*p.sy),v[0]),_=Gu(Wu(l),m[1]),b=Gu(Wu(c),v[1]);p.sx=x/_,p.sy=E/b,this.#l!==m[1]&&(t.style.setProperty("--scale-round-x",`${m[1]}px`),this.#l=m[1]),this.#f!==v[1]&&(t.style.setProperty("--scale-round-y",`${v[1]}px`),this.#f=v[1]);const A=p.scaled?[p.sx,0,0,p.sy,0,0]:null,T=this._drawCanvas(this._getRenderingContext(h,A),()=>{f?.remove(),this._resetCanvas()},S=>{this.#g.regularAnnotations=!S.separateAnnots,this.dispatchPageRendered(!1,!1)}).then(async()=>{this.structTreeLayer||=new v_(i,r.rawDims);const S=this.#A();this.annotationLayer&&(await this.#v(),this.#i&&this.annotationLayer&&this.textLayer&&await this.#S(S));const{annotationEditorUIManager:C}=this.#r;C&&(this.drawLayer||=new pC({pageIndex:this.id}),await this.#E(),this.drawLayer.setParent(a),this.annotationEditorLayer||=new uC({uiManager:C,pdfPage:i,l10n:e,structTreeLayer:this.structTreeLayer,accessibilityManager:this._accessibilityManager,annotationLayer:this.annotationLayer?.annotationLayer,textLayer:this.textLayer,drawLayer:this.drawLayer.getDrawLayer(),onAppend:N=>{this.#h(N,"annotationEditorLayer")}}),this.#_())});if(i.isPureXfa){if(!this.xfaLayer){const{annotationStorage:S,linkService:C}=this.#r;this.xfaLayer=new x_({pdfPage:i,annotationStorage:S,linkService:C})}this.#x()}return t.setAttribute("data-loaded",!0),this.dispatchPageRender(),T}setPageLabel(t){this.pageLabel=typeof t=="string"?t:null,this.div.setAttribute("data-l10n-args",JSON.stringify({page:this.pageLabel??this.id})),this.pageLabel!==null?this.div.setAttribute("data-page-label",this.pageLabel):this.div.removeAttribute("data-page-label")}get thumbnailCanvas(){const{directDrawing:t,initialOptionalContent:e,regularAnnotations:i}=this.#g;return t&&e&&i?this.canvas:null}}async function _C(n){const{info:i,metadata:r,contentDispositionFilename:a,contentLength:l}=await n.getMetadata();return{...i,baseURL:"",filesize:l||(await n.getDownloadInfo()).length,filename:a||AT(""),metadata:r?.getRaw(),authors:r?.get("dc:creator"),numPages:n.numPages,URL:""}}class EC{constructor(t){this._ready=new Promise((e,i)=>{import(t).then(a=>{e(a.QuickJSSandbox())}).catch(i)})}async createSandbox(t){(await this._ready).create(t)}async dispatchEventInSandbox(t){const e=await this._ready;setTimeout(()=>e.dispatchEvent(t),0)}async destroySandbox(){(await this._ready).nukeSandbox()}}class bC{#t=null;#e=null;#i=null;#n=null;#s=null;#r=null;#a=null;#o=null;#c=!1;#l=null;#f=null;constructor({eventBus:t,externalServices:e=null,docProperties:i=null}){this.#s=t,this.#r=e,this.#i=i}setViewer(t){this.#o=t}async setDocument(t){if(this.#a&&await this.#h(),this.#a=t,!t)return;const[e,i,r]=await Promise.all([t.getFieldObjects(),t.getCalculationOrderIds(),t.getJSActions()]);if(!e&&!r){await this.#h();return}if(t!==this.#a)return;try{this.#l=this.#p()}catch(c){console.error("setDocument:",c),await this.#h();return}const a=this.#s;this.#n=new AbortController;const{signal:l}=this.#n;a._on("updatefromsandbox",c=>{c?.source===window&&this.#u(c.detail)},{signal:l}),a._on("dispatcheventinsandbox",c=>{this.#l?.dispatchEventInSandbox(c.detail)},{signal:l}),a._on("pagechanging",({pageNumber:c,previous:h})=>{c!==h&&(this.#g(h),this.#d(c))},{signal:l}),a._on("pagerendered",({pageNumber:c})=>{this._pageOpenPending.has(c)&&c===this.#o.currentPageNumber&&this.#d(c)},{signal:l}),a._on("pagesdestroy",async()=>{await this.#g(this.#o.currentPageNumber),await this.#l?.dispatchEventInSandbox({id:"doc",name:"WillClose"}),this.#t?.resolve()},{signal:l});try{const c=await this.#i(t);if(t!==this.#a)return;await this.#l.createSandbox({objects:e,calculationOrder:i,appInfo:{platform:navigator.platform,language:navigator.language},docInfo:{...c,actions:r}}),a.dispatch("sandboxcreated",{source:this})}catch(c){console.error("setDocument:",c),await this.#h();return}await this.#l?.dispatchEventInSandbox({id:"doc",name:"Open"}),await this.#d(this.#o.currentPageNumber,!0),Promise.resolve().then(()=>{t===this.#a&&(this.#c=!0)})}async dispatchWillSave(){return this.#l?.dispatchEventInSandbox({id:"doc",name:"WillSave"})}async dispatchDidSave(){return this.#l?.dispatchEventInSandbox({id:"doc",name:"DidSave"})}async dispatchWillPrint(){if(this.#l){await this.#f?.promise,this.#f=Promise.withResolvers();try{await this.#l.dispatchEventInSandbox({id:"doc",name:"WillPrint"})}catch(t){throw this.#f.resolve(),this.#f=null,t}await this.#f.promise}}async dispatchDidPrint(){return this.#l?.dispatchEventInSandbox({id:"doc",name:"DidPrint"})}get destroyPromise(){return this.#e?.promise||null}get ready(){return this.#c}get _pageOpenPending(){return hh(this,"_pageOpenPending",new Set)}get _visitedPages(){return hh(this,"_visitedPages",new Map)}async#u(t){const e=this.#o,i=e.isInPresentationMode||e.isChangingPresentationMode,{id:r,siblings:a,command:l,value:c}=t;if(!r){switch(l){case"clear":console.clear();break;case"error":console.error(c);break;case"layout":if(!i){const f=HT(c);e.spreadMode=f.spreadMode}break;case"page-num":e.currentPageNumber=c+1;break;case"print":await e.pagesPromise,this.#s.dispatch("print",{source:this});break;case"println":console.log(c);break;case"zoom":i||(e.currentScaleValue=c);break;case"SaveAs":this.#s.dispatch("download",{source:this});break;case"FirstPage":e.currentPageNumber=1;break;case"LastPage":e.currentPageNumber=e.pagesCount;break;case"NextPage":e.nextPage();break;case"PrevPage":e.previousPage();break;case"ZoomViewIn":i||e.increaseScale();break;case"ZoomViewOut":i||e.decreaseScale();break;case"WillPrintFinished":this.#f?.resolve(),this.#f=null;break}return}if(i&&t.focus)return;delete t.id,delete t.siblings;const h=a?[r,...a]:[r];for(const f of h){const p=document.querySelector(`[data-element-id="${f}"]`);p?p.dispatchEvent(new CustomEvent("updatefromsandbox",{detail:t})):this.#a?.annotationStorage.setValue(f,t)}}async#d(t,e=!1){const i=this.#a,r=this._visitedPages;if(e&&(this.#t=Promise.withResolvers()),!this.#t)return;const a=this.#o.getPageView(t-1);if(a?.renderingState!==de.FINISHED){this._pageOpenPending.add(t);return}this._pageOpenPending.delete(t);const l=(async()=>{const c=await(r.has(t)?null:a.pdfPage?.getJSActions());i===this.#a&&await this.#l?.dispatchEventInSandbox({id:"page",name:"PageOpen",pageNumber:t,actions:c})})();r.set(t,l)}async#g(t){const e=this.#a,i=this._visitedPages;if(!this.#t||this._pageOpenPending.has(t))return;const r=i.get(t);r&&(i.set(t,null),await r,e===this.#a&&await this.#l?.dispatchEventInSandbox({id:"page",name:"PageClose",pageNumber:t}))}#p(){if(this.#e=Promise.withResolvers(),this.#l)throw new Error("#initScripting: Scripting already exists.");return this.#r.createScripting()}async#h(){if(!this.#l){this.#a=null,this.#e?.resolve();return}this.#t&&(await Promise.race([this.#t.promise,new Promise(t=>{setTimeout(t,1e3)})]).catch(()=>{}),this.#t=null),this.#a=null;try{await this.#l.destroySandbox()}catch{}this.#f?.reject(new Error("Scripting destroyed.")),this.#f=null,this.#n?.abort(),this.#n=null,this._pageOpenPending.clear(),this._visitedPages.clear(),this.#l=null,this.#c=!1,this.#e?.resolve()}}class AC extends bC{constructor(t){t.externalServices||window.addEventListener("updatefromsandbox",e=>{t.eventBus.dispatch("updatefromsandbox",{source:window,detail:e.detail})}),t.externalServices||={createScripting:()=>new EC(t.sandboxBundleSrc)},t.docProperties||=e=>_C(e),super(t)}}const wC=3e4;class SC{constructor(){this.pdfViewer=null,this.pdfThumbnailViewer=null,this.onIdle=null,this.highestPriorityPage=null,this.idleTimeout=null,this.printing=!1,this.isThumbnailViewEnabled=!1,Object.defineProperty(this,"hasViewer",{value:()=>!!this.pdfViewer})}setViewer(t){this.pdfViewer=t}setThumbnailViewer(t){this.pdfThumbnailViewer=t}isHighestPriority(t){return this.highestPriorityPage===t.renderingId}renderHighestPriority(t){this.idleTimeout&&(clearTimeout(this.idleTimeout),this.idleTimeout=null),!this.pdfViewer.forceRendering(t)&&(this.isThumbnailViewEnabled&&this.pdfThumbnailViewer?.forceRendering()||this.printing||this.onIdle&&(this.idleTimeout=setTimeout(this.onIdle.bind(this),wC)))}getHighestPriority(t,e,i,r=!1,a=!1){const l=t.views,c=l.length;if(c===0)return null;for(let v=0;v<c;v++){const x=l[v].view;if(!this.isViewFinished(x))return x}if(!a)for(let v=0;v<c;v++){const{detailView:x}=l[v].view;if(x&&!this.isViewFinished(x))return x}const h=t.first.id,f=t.last.id;if(f-h+1>c){const v=t.ids;for(let x=1,E=f-h;x<E;x++){const _=i?h+x:f-x;if(v.has(_))continue;const b=e[_-1];if(!this.isViewFinished(b))return b}}let p=i?f:h-2,m=e[p];return m&&!this.isViewFinished(m)||r&&(p+=i?1:-1,m=e[p],m&&!this.isViewFinished(m))?m:null}isViewFinished(t){return t.renderingState===de.FINISHED}renderView(t){switch(t.renderingState){case de.FINISHED:return!1;case de.PAUSED:this.highestPriorityPage=t.renderingId,t.resume();break;case de.RUNNING:this.highestPriorityPage=t.renderingId;break;case de.INITIAL:this.highestPriorityPage=t.renderingId,t.draw().finally(()=>{this.renderHighestPriority()}).catch(e=>{e instanceof G0||console.error("renderView:",e)});break}return!0}}const Px=10,$u={FORCE_SCROLL_MODE_PAGE:1e4,FORCE_LAZY_PAGE_INIT:5e3,PAUSE_EAGER_PAGE_INIT:250};function kx(n){return Object.values($i).includes(n)&&n!==$i.DISABLE}class TC{#t=new Set;#e=0;constructor(t){this.#e=t}push(t){const e=this.#t;e.has(t)&&e.delete(t),e.add(t),e.size>this.#e&&this.#i()}resize(t,e=null){this.#e=t;const i=this.#t;if(e){const r=i.size;let a=1;for(const l of i)if(e.has(l.id)&&(i.delete(l),i.add(l)),++a>r)break}for(;i.size>this.#e;)this.#i()}has(t){return this.#t.has(t)}[Symbol.iterator](){return this.#t.keys()}#i(){const t=this.#t.keys().next().value;t?.destroy(),this.#t.delete(t)}}class bp{#t=null;#e=null;#i=null;#n=$i.NONE;#s=null;#r=Nr.ENABLE_FORMS;#a=null;#o=null;#c=null;#l=!1;#f=!1;#u=!1;#d=!1;#g=!1;#p=!0;#h=null;#m=0;#y=null;#v=!0;#_=null;#E=null;#x=null;#A=!1;#T=null;#w=!1;#S=0;#M=new ResizeObserver(this.#Z.bind(this));#C=null;#D=null;#P=null;#O=!0;#N=ur.ENABLE;#F=null;constructor(t){const e="5.4.149";if(nx!==e)throw new Error(`The API version "${nx}" does not match the Viewer version "${e}".`);if(this.container=t.container,this.viewer=t.viewer||t.container.firstElementChild,this.#F=t.viewerAlert||null,this.container?.tagName!=="DIV"||this.viewer?.tagName!=="DIV")throw new Error("Invalid `container` and/or `viewer` option.");if(this.container.offsetParent&&getComputedStyle(this.container).position!=="absolute")throw new Error("The `container` must be absolutely positioned.");this.#M.observe(this.container),this.eventBus=t.eventBus,this.linkService=t.linkService||new _p,this.downloadManager=t.downloadManager||null,this.findController=t.findController||null,this.#e=t.altTextManager||null,this.#a=t.commentManager||null,this.#P=t.signatureManager||null,this.#c=t.editorUndoBar||null,this.findController&&(this.findController.onIsPageVisible=r=>this._getVisiblePages().ids.has(r)),this._scriptingManager=t.scriptingManager||null,this.#N=t.textLayerMode??ur.ENABLE,this.#r=t.annotationMode??Nr.ENABLE_FORMS,this.#n=t.annotationEditorMode??$i.NONE,this.#i=t.annotationEditorHighlightColors||null,this.#f=t.enableHighlightFloatingButton===!0,this.#d=t.enableUpdatedAddImage===!0,this.#g=t.enableNewAltTextWhenAddingImage===!0,this.imageResourcesPath=t.imageResourcesPath||"",this.enablePrintAutoRotate=t.enablePrintAutoRotate||!1,this.removePageBorders=t.removePageBorders||!1,this.maxCanvasPixels=t.maxCanvasPixels,this.maxCanvasDim=t.maxCanvasDim,this.capCanvasAreaFactor=t.capCanvasAreaFactor,this.enableDetailCanvas=t.enableDetailCanvas??!0,this.enableOptimizedPartialRendering=t.enableOptimizedPartialRendering??!1,this.l10n=t.l10n,this.l10n||=new Lr,this.#u=t.enablePermissions||!1,this.pageColors=t.pageColors||null,this.#y=t.mlManager||null,this.#l=t.enableHWA||!1,this.#O=t.supportsPinchToZoom!==!1,this.#p=t.enableAutoLinking!==!1,this.#m=t.minDurationToUpdateCanvas??500,this.defaultRenderingQueue=!t.renderingQueue,this.defaultRenderingQueue?(this.renderingQueue=new SC,this.renderingQueue.setViewer(this)):this.renderingQueue=t.renderingQueue;const{abortSignal:i}=t;i?.addEventListener("abort",()=>{this.#M.disconnect(),this.#M=null},{once:!0}),this.scroll=LT(this.container,this._scrollUpdate.bind(this),i),this.presentationModeState=fo.UNKNOWN,this._resetView(),this.removePageBorders&&this.viewer.classList.add("removePageBorders"),this.#K(),this.eventBus._on("thumbnailrendered",({pageNumber:r,pdfPage:a})=>{const l=this._pages[r-1];this.#t.has(l)||a?.cleanup()}),t.l10n||this.l10n.translate(this.container)}get printingAllowed(){return this.#v}get pagesCount(){return this._pages.length}getPageView(t){return this._pages[t]}getCachedPageViews(){return new Set(this.#t)}get pageViewsReady(){return this._pages.every(t=>t?.pdfPage)}get renderForms(){return this.#r===Nr.ENABLE_FORMS}get enableScripting(){return!!this._scriptingManager}get currentPageNumber(){return this._currentPageNumber}set currentPageNumber(t){if(!Number.isInteger(t))throw new Error("Invalid page number.");this.pdfDocument&&(this._setCurrentPageNumber(t,!0)||console.error(`currentPageNumber: "${t}" is not a valid page.`))}_setCurrentPageNumber(t,e=!1){if(this._currentPageNumber===t)return e&&this.#W(),!0;if(!(0<t&&t<=this.pagesCount))return!1;const i=this._currentPageNumber;return this._currentPageNumber=t,this.eventBus.dispatch("pagechanging",{source:this,pageNumber:t,pageLabel:this._pageLabels?.[t-1]??null,previous:i}),e&&this.#W(),!0}get currentPageLabel(){return this._pageLabels?.[this._currentPageNumber-1]??null}set currentPageLabel(t){if(!this.pdfDocument)return;let e=t|0;if(this._pageLabels){const i=this._pageLabels.indexOf(t);i>=0&&(e=i+1)}this._setCurrentPageNumber(e,!0)||console.error(`currentPageLabel: "${t}" is not a valid page.`)}get currentScale(){return this._currentScale!==p0?this._currentScale:l_}set currentScale(t){if(isNaN(t))throw new Error("Invalid numeric scale.");this.pdfDocument&&this.#I(t,{noScroll:!1})}get currentScaleValue(){return this._currentScaleValue}set currentScaleValue(t){this.pdfDocument&&this.#I(t,{noScroll:!1})}get pagesRotation(){return this._pagesRotation}set pagesRotation(t){if(!u_(t))throw new Error("Invalid pages rotation angle.");if(!this.pdfDocument||(t%=360,t<0&&(t+=360),this._pagesRotation===t))return;this._pagesRotation=t;const e=this._currentPageNumber;this.refresh(!0,{rotation:t}),this._currentScaleValue&&this.#I(this._currentScaleValue,{noScroll:!0}),this.eventBus.dispatch("rotationchanging",{source:this,pagesRotation:t,pageNumber:e}),this.defaultRenderingQueue&&this.update()}get firstPagePromise(){return this.pdfDocument?this._firstPageCapability.promise:null}get onePageRendered(){return this.pdfDocument?this._onePageRenderedCapability.promise:null}get pagesPromise(){return this.pdfDocument?this._pagesCapability.promise:null}get _layerProperties(){const t=this;return hh(this,"_layerProperties",{get annotationEditorUIManager(){return t.#s},get annotationStorage(){return t.pdfDocument?.annotationStorage},get downloadManager(){return t.downloadManager},get enableComment(){return!!t.#a},get enableScripting(){return!!t._scriptingManager},get fieldObjectsPromise(){return t.pdfDocument?.getFieldObjects()},get findController(){return t.findController},get hasJSActionsPromise(){return t.pdfDocument?.hasJSActions()},get linkService(){return t.linkService}})}#L(t){const e={annotationEditorMode:this.#n,annotationMode:this.#r,textLayerMode:this.#N};return t?(this.#v=t.includes(Ja.PRINT_HIGH_QUALITY)||t.includes(Ja.PRINT),this.eventBus.dispatch("printingallowed",{source:this,isAllowed:this.#v}),!t.includes(Ja.COPY)&&this.#N===ur.ENABLE&&(e.textLayerMode=ur.ENABLE_PERMISSIONS),t.includes(Ja.MODIFY_CONTENTS)||(e.annotationEditorMode=$i.DISABLE),!t.includes(Ja.MODIFY_ANNOTATIONS)&&!t.includes(Ja.FILL_INTERACTIVE_FORMS)&&this.#r===Nr.ENABLE_FORMS&&(e.annotationMode=Nr.ENABLE),e):(this.#v=!0,this.eventBus.dispatch("printingallowed",{source:this,isAllowed:this.#v}),e)}async#j(t){if(document.visibilityState==="hidden"||!this.container.offsetParent||this._getVisiblePages().views.length===0)return;const e=Promise.withResolvers(),i=new AbortController;document.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&e.resolve()},{signal:AbortSignal.any([t,i.signal])}),await Promise.race([this._onePageRenderedCapability.promise,e.promise]),i.abort()}async getAllText(){const t=[],e=[];for(let i=1,r=this.pdfDocument.numPages;i<=r;++i){if(this.#w)return null;e.length=0;const a=await this.pdfDocument.getPage(i),{items:l}=await a.getTextContent();for(const c of l)c.str&&e.push(c.str),c.hasEOL&&e.push(`
`);t.push(Ul(e.join("")))}return t.join(`
`)}#R(t,e){const i=document.getSelection(),{focusNode:r,anchorNode:a}=i;if(a&&r&&i.containsNode(this.#T)){if(this.#A||t===ur.ENABLE_PERMISSIONS){W0(e);return}this.#A=!0;const{classList:l}=this.viewer;l.add("copyAll");const c=new AbortController;window.addEventListener("keydown",h=>this.#w=h.key==="Escape",{signal:c.signal}),this.getAllText().then(async h=>{h!==null&&await navigator.clipboard.writeText(h)}).catch(h=>{console.warn(`Something goes wrong when extracting the text: ${h.message}`)}).finally(()=>{this.#A=!1,this.#w=!1,c.abort(),l.remove("copyAll")}),W0(e)}}setDocument(t){if(this.pdfDocument&&(this.eventBus.dispatch("pagesdestroy",{source:this}),this._cancelRendering(),this._resetView(),this.findController?.setDocument(null),this._scriptingManager?.setDocument(null),this.#s?.destroy(),this.#s=null,this.#n=$i.NONE,this.#v=!0),this.pdfDocument=t,!t)return;const e=t.numPages,i=t.getPage(1),r=t.getOptionalContentConfig({intent:"display"}),a=this.#u?t.getPermissions():Promise.resolve(),{eventBus:l,pageColors:c,viewer:h}=this;this.#h=new AbortController;const{signal:f}=this.#h;if(e>$u.FORCE_SCROLL_MODE_PAGE){console.warn("Forcing PAGE-scrolling for performance reasons, given the length of the document.");const v=this._scrollMode=le.PAGE;l.dispatch("scrollmodechanged",{source:this,mode:v})}this._pagesCapability.promise.then(()=>{l.dispatch("pagesloaded",{source:this,pagesCount:e})},()=>{});const p=v=>{const x=this._pages[v.pageNumber-1];x&&this.#t.push(x)};l._on("pagerender",p,{signal:f});const m=v=>{v.cssTransform||v.isDetailView||(this._onePageRenderedCapability.resolve({timestamp:v.timestamp}),l._off("pagerendered",m))};l._on("pagerendered",m,{signal:f}),Promise.all([i,a]).then(([v,x])=>{if(t!==this.pdfDocument)return;this._firstPageCapability.resolve(v),this._optionalContentConfigPromise=r;const{annotationEditorMode:E,annotationMode:_,textLayerMode:b}=this.#L(x);if(b!==ur.DISABLE){const C=this.#T=document.createElement("div");C.id="hiddenCopyElement",h.before(C)}if(E!==$i.DISABLE){const C=E;t.isPureXfa?console.warn("Warning: XFA-editing is not implemented."):kx(C)?(this.#s=new yT(this.container,h,this.#F,this.#e,this.#a,this.#P,l,t,c,this.#i,this.#f,this.#d,this.#g,this.#y,this.#c,this.#O),l.dispatch("annotationeditoruimanager",{source:this,uiManager:this.#s}),C!==$i.NONE&&(this.#Q(C),this.#s.updateMode(C))):console.error(`Invalid AnnotationEditor mode: ${C}`)}const A=this._scrollMode===le.PAGE?null:h,T=this.currentScale,S=v.getViewport({scale:T*Dr.PDF_TO_CSS_UNITS});h.style.setProperty("--scale-factor",S.scale),c?.background&&h.style.setProperty("--page-bg-color",c.background),(c?.foreground==="CanvasText"||c?.background==="Canvas")&&(h.style.setProperty("--hcm-highlight-filter",t.filterFactory.addHighlightHCMFilter("highlight","CanvasText","Canvas","HighlightText","Highlight")),h.style.setProperty("--hcm-highlight-selected-filter",t.filterFactory.addHighlightHCMFilter("highlight_selected","CanvasText","Canvas","HighlightText","ButtonText")));for(let C=1;C<=e;++C){const N=new y_({container:A,eventBus:l,id:C,scale:T,defaultViewport:S.clone(),optionalContentConfigPromise:r,renderingQueue:this.renderingQueue,textLayerMode:b,annotationMode:_,imageResourcesPath:this.imageResourcesPath,maxCanvasPixels:this.maxCanvasPixels,maxCanvasDim:this.maxCanvasDim,capCanvasAreaFactor:this.capCanvasAreaFactor,enableDetailCanvas:this.enableDetailCanvas,enableOptimizedPartialRendering:this.enableOptimizedPartialRendering,pageColors:c,l10n:this.l10n,layerProperties:this._layerProperties,enableHWA:this.#l,enableAutoLinking:this.#p,minDurationToUpdateCanvas:this.#m});this._pages.push(N)}this._pages[0]?.setPdfPage(v),this._scrollMode===le.PAGE?this.#b():this._spreadMode!==Ni.NONE&&this._updateSpreadMode(),this.#j(f).then(async()=>{if(t!==this.pdfDocument)return;if(this.findController?.setDocument(t),this._scriptingManager?.setDocument(t),this.#T&&document.addEventListener("copy",this.#R.bind(this,b),{signal:f}),this.#s&&l.dispatch("annotationeditormodechanged",{source:this,mode:this.#n}),t.loadingParams.disableAutoFetch||e>$u.FORCE_LAZY_PAGE_INIT){this._pagesCapability.resolve();return}let C=e-1;if(C<=0){this._pagesCapability.resolve();return}for(let N=2;N<=e;++N){const B=t.getPage(N).then(O=>{const H=this._pages[N-1];H.pdfPage||H.setPdfPage(O),--C===0&&this._pagesCapability.resolve()},O=>{console.error(`Unable to get page ${N} to initialize viewer`,O),--C===0&&this._pagesCapability.resolve()});N%$u.PAUSE_EAGER_PAGE_INIT===0&&await B}}),l.dispatch("pagesinit",{source:this}),t.getMetadata().then(({info:C})=>{t===this.pdfDocument&&C.Language&&(h.lang=C.Language)}),this.defaultRenderingQueue&&this.update()}).catch(v=>{console.error("Unable to initialize viewer",v),this._pagesCapability.reject(v)})}setPageLabels(t){if(this.pdfDocument){t?Array.isArray(t)&&this.pdfDocument.numPages===t.length?this._pageLabels=t:(this._pageLabels=null,console.error("setPageLabels: Invalid page labels.")):this._pageLabels=null;for(let e=0,i=this._pages.length;e<i;e++)this._pages[e].setPageLabel(this._pageLabels?.[e]??null)}}_resetView(){this._pages=[],this._currentPageNumber=1,this._currentScale=p0,this._currentScaleValue=null,this._pageLabels=null,this.#t=new TC(Px),this._location=null,this._pagesRotation=0,this._optionalContentConfigPromise=null,this._firstPageCapability=Promise.withResolvers(),this._onePageRenderedCapability=Promise.withResolvers(),this._pagesCapability=Promise.withResolvers(),this._scrollMode=le.VERTICAL,this._previousScrollMode=le.UNKNOWN,this._spreadMode=Ni.NONE,this.#C={previousPageNumber:1,scrollDown:!0,pages:[]},this.#h?.abort(),this.#h=null,this.viewer.textContent="",this._updateScrollMode(),this.viewer.removeAttribute("lang"),this.#T?.remove(),this.#T=null,this.#H(),this.#$()}#b(){if(this._scrollMode!==le.PAGE)throw new Error("#ensurePageViewVisible: Invalid scrollMode value.");const t=this._currentPageNumber,e=this.#C,i=this.viewer;if(i.textContent="",e.pages.length=0,this._spreadMode===Ni.NONE&&!this.isInPresentationMode){const r=this._pages[t-1];i.append(r.div),e.pages.push(r)}else{const r=new Set,a=this._spreadMode-1;a===-1?r.add(t-1):t%2!==a?(r.add(t-1),r.add(t)):(r.add(t-2),r.add(t-1));const l=document.createElement("div");if(l.className="spread",this.isInPresentationMode){const c=document.createElement("div");c.className="dummyPage",l.append(c)}for(const c of r){const h=this._pages[c];h&&(l.append(h.div),e.pages.push(h))}i.append(l)}e.scrollDown=t>=e.previousPageNumber,e.previousPageNumber=t}_scrollUpdate(){this.pagesCount!==0&&(this.#_&&clearTimeout(this.#_),this.#_=setTimeout(()=>{this.#_=null,this.update()},100),this.update())}#B(t,e=null){const{div:i,id:r}=t;if(this._currentPageNumber!==r&&this._setCurrentPageNumber(r),this._scrollMode===le.PAGE&&(this.#b(),this.update()),!e&&!this.isInPresentationMode){const a=i.offsetLeft+i.clientLeft,l=a+i.clientWidth,{scrollLeft:c,clientWidth:h}=this.container;(this._scrollMode===le.HORIZONTAL||a<c||l>c+h)&&(e={left:0,top:0})}c_(i,e),!this._currentScaleValue&&this._location&&(this._location=null)}#z(t){return t===this._currentScale||Math.abs(t-this._currentScale)<1e-15}#V(t,e,{noScroll:i=!1,preset:r=!1,drawingDelay:a=-1,origin:l=null}){if(this._currentScaleValue=e.toString(),this.#z(t)){r&&this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:e});return}this.viewer.style.setProperty("--scale-factor",t*Dr.PDF_TO_CSS_UNITS);const c=a>=0&&a<1e3;this.refresh(!0,{scale:t,drawingDelay:c?a:-1}),c&&(this.#D=setTimeout(()=>{this.#D=null,this.refresh()},a));const h=this._currentScale;if(this._currentScale=t,!i){let f=this._currentPageNumber,p;if(this._location&&!(this.isInPresentationMode||this.isChangingPresentationMode)&&(f=this._location.pageNumber,p=[null,{name:"XYZ"},this._location.left,this._location.top,null]),this.scrollPageIntoView({pageNumber:f,destArray:p,allowNegativeOffset:!0}),Array.isArray(l)){const m=t/h-1,[v,x]=this.containerTopLeft;this.container.scrollLeft+=(l[0]-x)*m,this.container.scrollTop+=(l[1]-v)*m}}this.eventBus.dispatch("scalechanging",{source:this,scale:t,presetValue:r?e:void 0}),this.defaultRenderingQueue&&this.update()}get#q(){return this._spreadMode!==Ni.NONE&&this._scrollMode!==le.HORIZONTAL?2:1}#I(t,e){let i=parseFloat(t);if(i>0)e.preset=!1,this.#V(i,t,e);else{const r=this._pages[this._currentPageNumber-1];if(!r)return;let a=sx,l=ax;this.isInPresentationMode?(a=l=4,this._spreadMode!==Ni.NONE&&(a*=2)):this.removePageBorders?a=l=0:this._scrollMode===le.HORIZONTAL&&([a,l]=[l,a]);const c=(this.container.clientWidth-a)/r.width*r.scale/this.#q,h=(this.container.clientHeight-l)/r.height*r.scale;switch(t){case"page-actual":i=1;break;case"page-width":i=c;break;case"page-height":i=h;break;case"page-fit":i=Math.min(c,h);break;case"auto":const f=cx(r)?c:Math.min(h,c);i=Math.min(OT,f);break;default:console.error(`#setScale: "${t}" is an unknown zoom value.`);return}e.preset=!0,this.#V(i,t,e)}}#W(){const t=this._pages[this._currentPageNumber-1];this.isInPresentationMode&&this.#I(this._currentScaleValue,{noScroll:!0}),this.#B(t)}pageLabelToPageNumber(t){if(!this._pageLabels)return null;const e=this._pageLabels.indexOf(t);return e<0?null:e+1}scrollPageIntoView({pageNumber:t,destArray:e=null,allowNegativeOffset:i=!1,ignoreDestinationZoom:r=!1}){if(!this.pdfDocument)return;const a=Number.isInteger(t)&&this._pages[t-1];if(!a){console.error(`scrollPageIntoView: "${t}" is not a valid pageNumber parameter.`);return}if(this.isInPresentationMode||!e){this._setCurrentPageNumber(t,!0);return}let l=0,c=0,h=0,f=0,p,m;const v=a.rotation%180!==0,x=(v?a.height:a.width)/a.scale/Dr.PDF_TO_CSS_UNITS,E=(v?a.width:a.height)/a.scale/Dr.PDF_TO_CSS_UNITS;let _=0;switch(e[1].name){case"XYZ":l=e[2],c=e[3],_=e[4],l=l!==null?l:0,c=c!==null?c:E;break;case"Fit":case"FitB":_="page-fit";break;case"FitH":case"FitBH":c=e[2],_="page-width",c===null&&this._location?(l=this._location.left,c=this._location.top):(typeof c!="number"||c<0)&&(c=E);break;case"FitV":case"FitBV":l=e[2],h=x,f=E,_="page-height";break;case"FitR":l=e[2],c=e[3],h=e[4]-l,f=e[5]-c;let S=sx,C=ax;this.removePageBorders&&(S=C=0),p=(this.container.clientWidth-S)/h/Dr.PDF_TO_CSS_UNITS,m=(this.container.clientHeight-C)/f/Dr.PDF_TO_CSS_UNITS,_=Math.min(Math.abs(p),Math.abs(m));break;default:console.error(`scrollPageIntoView: "${e[1].name}" is not a valid destination type.`);return}if(r||(_&&_!==this._currentScale?this.currentScaleValue=_:this._currentScale===p0&&(this.currentScaleValue=DT)),_==="page-fit"&&!e[4]){this.#B(a);return}const b=[a.viewport.convertToViewportPoint(l,c),a.viewport.convertToViewportPoint(l+h,c+f)];let A=Math.min(b[0][0],b[1][0]),T=Math.min(b[0][1],b[1][1]);i||(A=Math.max(A,0),T=Math.max(T,0)),this.#B(a,{left:A,top:T})}_updateLocation(t){const e=this._currentScale,i=this._currentScaleValue,r=parseFloat(i)===e?Math.round(e*1e4)/100:i,a=t.id,l=this._pages[a-1],c=this.container,h=l.getPagePoint(c.scrollLeft-t.x,c.scrollTop-t.y),f=Math.round(h[0]),p=Math.round(h[1]);let m=`#page=${a}`;this.isInPresentationMode||(m+=`&zoom=${r},${f},${p}`),this._location={pageNumber:a,scale:r,top:p,left:f,rotation:this._pagesRotation,pdfOpenParams:m}}update(){const t=this._getVisiblePages(),e=t.views,i=e.length;if(i===0)return;const r=Math.max(Px,2*i+1);this.#t.resize(r,t.ids);for(const{view:h,visibleArea:f}of e)h.updateVisibleArea(f);for(const h of this.#t)t.ids.has(h.id)||h.updateVisibleArea(null);this.renderingQueue.renderHighestPriority(t);const a=this._spreadMode===Ni.NONE&&(this._scrollMode===le.PAGE||this._scrollMode===le.VERTICAL),l=this._currentPageNumber;let c=!1;for(const h of e){if(h.percent<100)break;if(h.id===l&&a){c=!0;break}}this._setCurrentPageNumber(c?l:e[0].id),this._updateLocation(t.first),this.eventBus.dispatch("updateviewarea",{source:this,location:this._location})}#U(){const t=this._getVisiblePages(),e=[],{ids:i,views:r}=t;for(const a of r){const{view:l}=a;if(!l.hasEditableAnnotations()){i.delete(l.id);continue}e.push(a)}return e.length===0?null:(this.renderingQueue.renderHighestPriority({first:e[0],last:e.at(-1),views:e,ids:i}),i)}containsElement(t){return this.container.contains(t)}focus(){this.container.focus()}get _isContainerRtl(){return getComputedStyle(this.container).direction==="rtl"}get isInPresentationMode(){return this.presentationModeState===fo.FULLSCREEN}get isChangingPresentationMode(){return this.presentationModeState===fo.CHANGING}get isHorizontalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollWidth>this.container.clientWidth}get isVerticalScrollbarEnabled(){return this.isInPresentationMode?!1:this.container.scrollHeight>this.container.clientHeight}_getVisiblePages(){const t=this._scrollMode===le.PAGE?this.#C.pages:this._pages,e=this._scrollMode===le.HORIZONTAL,i=e&&this._isContainerRtl;return kT({scrollEl:this.container,views:t,sortByVisibility:!0,horizontal:e,rtl:i})}cleanup(){for(const t of this._pages)t.renderingState!==de.FINISHED&&t.reset()}_cancelRendering(){for(const t of this._pages)t.cancelRendering()}async#G(t){if(t.pdfPage)return t.pdfPage;try{const e=await this.pdfDocument.getPage(t.id);return t.pdfPage||t.setPdfPage(e),e}catch(e){return console.error("Unable to get page for page view",e),null}}#X(t){if(t.first?.id===1)return!0;if(t.last?.id===this.pagesCount)return!1;switch(this._scrollMode){case le.PAGE:return this.#C.scrollDown;case le.HORIZONTAL:return this.scroll.right}return this.scroll.down}forceRendering(t){const e=t||this._getVisiblePages(),i=this.#X(e),r=this._spreadMode!==Ni.NONE&&this._scrollMode!==le.HORIZONTAL,a=this.#D!==null||this.#_!==null&&e.views.some(c=>c.detailView?.renderingCancelled),l=this.renderingQueue.getHighestPriority(e,this._pages,i,r,a);return l?(this.#G(l).then(()=>{this.renderingQueue.renderView(l)}),!0):!1}get hasEqualPageSizes(){const t=this._pages[0];for(let e=1,i=this._pages.length;e<i;++e){const r=this._pages[e];if(r.width!==t.width||r.height!==t.height)return!1}return!0}getPagesOverview(){let t;return this._pages.map(e=>{const i=e.pdfPage.getViewport({scale:1}),r=cx(i);if(t===void 0)t=r;else if(this.enablePrintAutoRotate&&r!==t)return{width:i.height,height:i.width,rotation:(i.rotation-90)%360};return{width:i.width,height:i.height,rotation:i.rotation}})}get optionalContentConfigPromise(){return this.pdfDocument?this._optionalContentConfigPromise?this._optionalContentConfigPromise:(console.error("optionalContentConfigPromise: Not initialized yet."),this.pdfDocument.getOptionalContentConfig({intent:"display"})):Promise.resolve(null)}set optionalContentConfigPromise(t){if(!(t instanceof Promise))throw new Error(`Invalid optionalContentConfigPromise: ${t}`);this.pdfDocument&&this._optionalContentConfigPromise&&(this._optionalContentConfigPromise=t,this.refresh(!1,{optionalContentConfigPromise:t}),this.eventBus.dispatch("optionalcontentconfigchanged",{source:this,promise:t}))}get scrollMode(){return this._scrollMode}set scrollMode(t){if(this._scrollMode!==t){if(!FT(t))throw new Error(`Invalid scroll mode: ${t}`);this.pagesCount>$u.FORCE_SCROLL_MODE_PAGE||(this._previousScrollMode=this._scrollMode,this._scrollMode=t,this.eventBus.dispatch("scrollmodechanged",{source:this,mode:t}),this._updateScrollMode(this._currentPageNumber))}}_updateScrollMode(t=null){const e=this._scrollMode,i=this.viewer;i.classList.toggle("scrollHorizontal",e===le.HORIZONTAL),i.classList.toggle("scrollWrapped",e===le.WRAPPED),!(!this.pdfDocument||!t)&&(e===le.PAGE?this.#b():this._previousScrollMode===le.PAGE&&this._updateSpreadMode(),this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#I(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(t,!0),this.update())}get spreadMode(){return this._spreadMode}set spreadMode(t){if(this._spreadMode!==t){if(!IT(t))throw new Error(`Invalid spread mode: ${t}`);this._spreadMode=t,this.eventBus.dispatch("spreadmodechanged",{source:this,mode:t}),this._updateSpreadMode(this._currentPageNumber)}}_updateSpreadMode(t=null){if(!this.pdfDocument)return;const e=this.viewer,i=this._pages;if(this._scrollMode===le.PAGE)this.#b();else if(e.textContent="",this._spreadMode===Ni.NONE)for(const r of this._pages)e.append(r.div);else{const r=this._spreadMode-1;let a=null;for(let l=0,c=i.length;l<c;++l)a===null?(a=document.createElement("div"),a.className="spread",e.append(a)):l%2===r&&(a=a.cloneNode(!1),e.append(a)),a.append(i[l].div)}t&&(this._currentScaleValue&&isNaN(this._currentScaleValue)&&this.#I(this._currentScaleValue,{noScroll:!0}),this._setCurrentPageNumber(t,!0),this.update())}_getPageAdvance(t,e=!1){switch(this._scrollMode){case le.WRAPPED:{const{views:i}=this._getVisiblePages(),r=new Map;for(const{id:a,y:l,percent:c,widthPercent:h}of i){if(c===0||h<100)continue;let f=r.get(l);f||r.set(l,f||=[]),f.push(a)}for(const a of r.values()){const l=a.indexOf(t);if(l===-1)continue;const c=a.length;if(c===1)break;if(e)for(let h=l-1,f=0;h>=f;h--){const p=a[h],m=a[h+1]-1;if(p<m)return t-m}else for(let h=l+1,f=c;h<f;h++){const p=a[h],m=a[h-1]+1;if(p>m)return m-t}if(e){const h=a[0];if(h<t)return t-h+1}else{const h=a[c-1];if(h>t)return h-t+1}break}break}case le.HORIZONTAL:break;case le.PAGE:case le.VERTICAL:{if(this._spreadMode===Ni.NONE)break;const i=this._spreadMode-1;if(e&&t%2!==i)break;if(!e&&t%2===i)break;const{views:r}=this._getVisiblePages(),a=e?t-1:t+1;for(const{id:l,percent:c,widthPercent:h}of r)if(l===a){if(c>0&&h===100)return 2;break}break}}return 1}nextPage(){const t=this._currentPageNumber,e=this.pagesCount;if(t>=e)return!1;const i=this._getPageAdvance(t,!1)||1;return this.currentPageNumber=Math.min(t+i,e),!0}previousPage(){const t=this._currentPageNumber;if(t<=1)return!1;const e=this._getPageAdvance(t,!0)||1;return this.currentPageNumber=Math.max(t-e,1),!0}updateScale({drawingDelay:t,scaleFactor:e=null,steps:i=null,origin:r}){if(i===null&&e===null)throw new Error("Invalid updateScale options: either `steps` or `scaleFactor` must be provided.");if(!this.pdfDocument)return;let a=this._currentScale;if(e>0&&e!==1)a=Math.round(a*e*100)/100;else if(i){const l=i>0?rx:1/rx,c=i>0?Math.ceil:Math.floor;i=Math.abs(i);do a=c((a*l).toFixed(2)*10)/10;while(--i>0)}a=vp(a,MT,NT),this.#I(a,{noScroll:!1,drawingDelay:t,origin:r})}increaseScale(t={}){this.updateScale({...t,steps:t.steps??1})}decreaseScale(t={}){this.updateScale({...t,steps:-(t.steps??1)})}#K(t=this.container.clientHeight){t!==this.#S&&(this.#S=t,BT.setProperty("--viewer-container-height",`${t}px`))}#Z(t){for(const e of t)if(e.target===this.container){this.#K(Math.floor(e.borderBoxSize[0].blockSize)),this.#o=null;break}}get containerTopLeft(){return this.#o||=[this.container.offsetTop,this.container.offsetLeft]}#H(){this.#D!==null&&(clearTimeout(this.#D),this.#D=null),this.#_!==null&&(clearTimeout(this.#_),this.#_=null)}#$(){this.#E?.abort(),this.#E=null,this.#x!==null&&(clearTimeout(this.#x),this.#x=null)}#Q(t){switch(t){case $i.STAMP:this.#y?.loadModel("altText");break;case $i.SIGNATURE:this.#P?.loadSignatures();break}}get annotationEditorMode(){return this.#s?this.#n:$i.DISABLE}set annotationEditorMode({mode:t,editId:e=null,isFromKeyboard:i=!1,mustEnterInEditMode:r=!1,editComment:a=!1}){if(!this.#s)throw new Error("The AnnotationEditor is not enabled.");if(this.#n===t)return;if(!kx(t))throw new Error(`Invalid AnnotationEditor mode: ${t}`);if(!this.pdfDocument)return;this.#Q(t);const{eventBus:l,pdfDocument:c}=this,h=async()=>{this.#$(),this.#n=t,await this.#s.updateMode(t,e,i,r,a),!(t!==this.#n||c!==this.pdfDocument)&&l.dispatch("annotationeditormodechanged",{source:this,mode:t})};if(t===$i.NONE||this.#n===$i.NONE){const f=t!==$i.NONE;f||this.pdfDocument.annotationStorage.resetModifiedIds();for(const m of this._pages)m.toggleEditingMode(f);const p=this.#U();if(f&&p){this.#$(),this.#E=new AbortController;const m=AbortSignal.any([this.#h.signal,this.#E.signal]);l._on("pagerendered",({pageNumber:v})=>{p.delete(v),p.size===0&&(this.#x=setTimeout(h,0))},{signal:m});return}}h()}refresh(t=!1,e=Object.create(null)){if(this.pdfDocument){for(const i of this._pages)i.update(e);this.#H(),t||this.update()}}}class CC extends bp{_resetView(){super._resetView(),this._scrollMode=le.PAGE,this._spreadMode=Ni.NONE}set scrollMode(t){}_updateScrollMode(){}set spreadMode(t){}_updateSpreadMode(){}}globalThis.pdfjsViewer={AnnotationLayerBuilder:f_,DownloadManager:l2,EventBus:Ep,FindState:ps,GenericL10n:Lr,LinkTarget:Ys,parseQueryString:Fh,PDFFindController:a2,PDFHistory:oC,PDFLinkService:yp,PDFPageView:y_,PDFScriptingManager:AC,PDFSinglePageViewer:CC,PDFViewer:bp,ProgressBar:UT,RenderingStates:de,ScrollMode:le,SimpleLinkService:_p,SpreadMode:Ni,StructTreeLayerBuilder:v_,TextLayerBuilder:go,XfaLayerBuilder:x_};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var dh={};dh.version="0.18.5";var __=1252,RC=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],E_=function(n){RC.indexOf(n)!=-1&&(__=n)};function DC(){E_(1252)}var tc=function(n){E_(n)};function MC(){tc(1200),DC()}var qu=function(t){return String.fromCharCode(t)},Fx=function(t){return String.fromCharCode(t)},ph,xs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ec(n){for(var t="",e=0,i=0,r=0,a=0,l=0,c=0,h=0,f=0;f<n.length;)e=n.charCodeAt(f++),a=e>>2,i=n.charCodeAt(f++),l=(e&3)<<4|i>>4,r=n.charCodeAt(f++),c=(i&15)<<2|r>>6,h=r&63,isNaN(i)?c=h=64:isNaN(r)&&(h=64),t+=xs.charAt(a)+xs.charAt(l)+xs.charAt(c)+xs.charAt(h);return t}function Ur(n){var t="",e=0,i=0,r=0,a=0,l=0,c=0,h=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<n.length;)a=xs.indexOf(n.charAt(f++)),l=xs.indexOf(n.charAt(f++)),e=a<<2|l>>4,t+=String.fromCharCode(e),c=xs.indexOf(n.charAt(f++)),i=(l&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(i)),h=xs.indexOf(n.charAt(f++)),r=(c&3)<<6|h,h!==64&&(t+=String.fromCharCode(r));return t}var pe=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),jr=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(t,e){return e?new Buffer(t,e):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function sa(n){return pe?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function Ix(n){return pe?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var Wn=function(t){return pe?jr(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)&255})};function Ih(n){if(typeof ArrayBuffer>"u")return Wn(n);for(var t=new ArrayBuffer(n.length),e=new Uint8Array(t),i=0;i!=n.length;++i)e[i]=n.charCodeAt(i)&255;return t}function pc(n){if(Array.isArray(n))return n.map(function(i){return String.fromCharCode(i)}).join("");for(var t=[],e=0;e<n.length;++e)t[e]=String.fromCharCode(n[e]);return t.join("")}function NC(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var bi=pe?function(n){return Buffer.concat(n.map(function(t){return Buffer.isBuffer(t)?t:jr(t)}))}:function(n){if(typeof Uint8Array<"u"){var t=0,e=0;for(t=0;t<n.length;++t)e+=n[t].length;var i=new Uint8Array(e),r=0;for(t=0,e=0;t<n.length;e+=r,++t)if(r=n[t].length,n[t]instanceof Uint8Array)i.set(n[t],e);else{if(typeof n[t]=="string")throw"wtf";i.set(new Uint8Array(n[t]),e)}return i}return[].concat.apply([],n.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function OC(n){for(var t=[],e=0,i=n.length+250,r=sa(n.length+255),a=0;a<n.length;++a){var l=n.charCodeAt(a);if(l<128)r[e++]=l;else if(l<2048)r[e++]=192|l>>6&31,r[e++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=n.charCodeAt(++a)&1023;r[e++]=240|l>>8&7,r[e++]=128|l>>2&63,r[e++]=128|c>>6&15|(l&3)<<4,r[e++]=128|c&63}else r[e++]=224|l>>12&15,r[e++]=128|l>>6&63,r[e++]=128|l&63;e>i&&(t.push(r.slice(0,e)),e=0,r=sa(65535),i=65530)}return t.push(r.slice(0,e)),bi(t)}var zl=/\u0000/g,Ku=/[\u0001-\u0006]/g;function mo(n){for(var t="",e=n.length-1;e>=0;)t+=n.charAt(e--);return t}function Xn(n,t){var e=""+n;return e.length>=t?e:He("0",t-e.length)+e}function Ap(n,t){var e=""+n;return e.length>=t?e:He(" ",t-e.length)+e}function gh(n,t){var e=""+n;return e.length>=t?e:e+He(" ",t-e.length)}function LC(n,t){var e=""+Math.round(n);return e.length>=t?e:He("0",t-e.length)+e}function PC(n,t){var e=""+n;return e.length>=t?e:He("0",t-e.length)+e}var Bx=Math.pow(2,32);function to(n,t){if(n>Bx||n<-Bx)return LC(n,t);var e=Math.round(n);return PC(e,t)}function mh(n,t){return t=t||0,n.length>=7+t&&(n.charCodeAt(t)|32)===103&&(n.charCodeAt(t+1)|32)===101&&(n.charCodeAt(t+2)|32)===110&&(n.charCodeAt(t+3)|32)===101&&(n.charCodeAt(t+4)|32)===114&&(n.charCodeAt(t+5)|32)===97&&(n.charCodeAt(t+6)|32)===108}var Ux=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],_0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function kC(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',n}var je={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Hx={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},FC={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vh(n,t,e){for(var i=n<0?-1:1,r=n*i,a=0,l=1,c=0,h=1,f=0,p=0,m=Math.floor(r);f<t&&(m=Math.floor(r),c=m*l+a,p=m*f+h,!(r-m<5e-8));)r=1/(r-m),a=l,l=c,h=f,f=p;if(p>t&&(f>t?(p=h,c=a):(p=f,c=l)),!e)return[0,i*c,p];var v=Math.floor(i*c/p);return[v,i*c-v*p,p]}function Qu(n,t,e){if(n>2958465||n<0)return null;var i=n|0,r=Math.floor(86400*(n-i)),a=0,l=[],c={D:i,T:r,u:86400*(n-i)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(i+=1462),c.u>.9999&&(c.u=0,++r==86400&&(c.T=r=0,++i,++c.D)),i===60)l=e?[1317,10,29]:[1900,2,29],a=3;else if(i===0)l=e?[1317,8,29]:[1900,1,0],a=6;else{i>60&&--i;var h=new Date(1900,0,1);h.setDate(h.getDate()+i-1),l=[h.getFullYear(),h.getMonth()+1,h.getDate()],a=h.getDay(),i<60&&(a=(a+6)%7),e&&(a=VC(h,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=r%60,r=Math.floor(r/60),c.M=r%60,r=Math.floor(r/60),c.H=r,c.q=a,c}var b_=new Date(1899,11,31,0,0,0),IC=b_.getTime(),BC=new Date(1900,2,1,0,0,0);function A_(n,t){var e=n.getTime();return t?e-=1461*24*60*60*1e3:n>=BC&&(e+=1440*60*1e3),(e-(IC+(n.getTimezoneOffset()-b_.getTimezoneOffset())*6e4))/(1440*60*1e3)}function wp(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function UC(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function HC(n){var t=n<0?12:11,e=wp(n.toFixed(12));return e.length<=t||(e=n.toPrecision(10),e.length<=t)?e:n.toExponential(5)}function jC(n){var t=wp(n.toFixed(11));return t.length>(n<0?12:11)||t==="0"||t==="-0"?n.toPrecision(6):t}function zC(n){var t=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),e;return t>=-4&&t<=-1?e=n.toPrecision(10+t):Math.abs(t)<=9?e=HC(n):t===10?e=n.toFixed(10).substr(0,12):e=jC(n),wp(UC(e.toUpperCase()))}function Q0(n,t){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):zC(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return bs(14,A_(n,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+n)}function VC(n,t){t[0]-=581;var e=n.getDay();return n<60&&(e=(e+6)%7),e}function GC(n,t,e,i){var r="",a=0,l=0,c=e.y,h,f=0;switch(n){case 98:c=e.y+543;case 121:switch(t.length){case 1:case 2:h=c%100,f=2;break;default:h=c%1e4,f=4;break}break;case 109:switch(t.length){case 1:case 2:h=e.m,f=t.length;break;case 3:return _0[e.m-1][1];case 5:return _0[e.m-1][0];default:return _0[e.m-1][2]}break;case 100:switch(t.length){case 1:case 2:h=e.d,f=t.length;break;case 3:return Ux[e.q][0];default:return Ux[e.q][1]}break;case 104:switch(t.length){case 1:case 2:h=1+(e.H+11)%12,f=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:h=e.H,f=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:h=e.M,f=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return e.u===0&&(t=="s"||t=="ss")?Xn(e.S,t.length):(i>=2?l=i===3?1e3:100:l=i===1?10:1,a=Math.round(l*(e.S+e.u)),a>=60*l&&(a=0),t==="s"?a===0?"0":""+a/l:(r=Xn(a,2+i),t==="ss"?r.substr(0,2):"."+r.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":h=e.D*24+e.H;break;case"[m]":case"[mm]":h=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":h=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+t}f=t.length===3?1:2;break;case 101:h=c,f=1;break}var p=f>0?Xn(h,f):"";return p}function ys(n){var t=3;if(n.length<=t)return n;for(var e=n.length%t,i=n.substr(0,e);e!=n.length;e+=t)i+=(i.length>0?",":"")+n.substr(e,t);return i}var w_=/%/g;function WC(n,t,e){var i=t.replace(w_,""),r=t.length-i.length;return Fr(n,i,e*Math.pow(10,2*r))+He("%",r)}function XC(n,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return Fr(n,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function S_(n,t){var e,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+S_(n,-t);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%r;if(a<0&&(a+=r),e=(t/Math.pow(10,a)).toPrecision(i+1+(r+a)%r),e.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(l-e.length+a):e+="E+"+(l-a);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,r)+"."+e.substr(2+r),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,p){return h+f+p.substr(0,(r+a)%r)+"."+p.substr(a)+"E"})}else e=t.toExponential(i);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var T_=/# (\?+)( ?)\/( ?)(\d+)/;function YC(n,t,e){var i=parseInt(n[4],10),r=Math.round(t*i),a=Math.floor(r/i),l=r-a*i,c=i;return e+(a===0?"":""+a)+" "+(l===0?He(" ",n[1].length+1+n[4].length):Ap(l,n[1].length)+n[2]+"/"+n[3]+Xn(c,n[4].length))}function $C(n,t,e){return e+(t===0?"":""+t)+He(" ",n[1].length+2+n[4].length)}var C_=/^#*0*\.([0#]+)/,R_=/\).*[0#]/,D_=/\(###\) ###\\?-####/;function Bi(n){for(var t="",e,i=0;i!=n.length;++i)switch(e=n.charCodeAt(i)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(e)}return t}function jx(n,t){var e=Math.pow(10,t);return""+Math.round(n*e)/e}function zx(n,t){var e=n-Math.floor(n),i=Math.pow(10,t);return t<(""+Math.round(e*i)).length?0:Math.round(e*i)}function qC(n,t){return t<(""+Math.round((n-Math.floor(n))*Math.pow(10,t))).length?1:0}function KC(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Dn(n,t,e){if(n.charCodeAt(0)===40&&!t.match(R_)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Dn("n",i,e):"("+Dn("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return XC(n,t,e);if(t.indexOf("%")!==-1)return WC(n,t,e);if(t.indexOf("E")!==-1)return S_(t,e);if(t.charCodeAt(0)===36)return"$"+Dn(n,t.substr(t.charAt(1)==" "?2:1),e);var r,a,l,c,h=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+to(h,t.length);if(t.match(/^[#?]+$/))return r=to(e,0),r==="0"&&(r=""),r.length>t.length?r:Bi(t.substr(0,t.length-r.length))+r;if(a=t.match(T_))return YC(a,h,f);if(t.match(/^#+0+$/))return f+to(h,t.length-t.indexOf("0"));if(a=t.match(C_))return r=jx(e,a[1].length).replace(/^([^\.]+)$/,"$1."+Bi(a[1])).replace(/\.$/,"."+Bi(a[1])).replace(/\.(\d*)$/,function(E,_){return"."+_+He("0",Bi(a[1]).length-_.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+jx(h,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+ys(to(h,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Dn(n,t,-e):ys(""+(Math.floor(e)+qC(e,a[1].length)))+"."+Xn(zx(e,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return Dn(n,t.replace(/^#,#*,/,""),e);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=mo(Dn(n,t.replace(/[\\-]/g,""),e)),l=0,mo(mo(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<r.length?r.charAt(l++):E==="0"?"0":""}));if(t.match(D_))return r=Dn(n,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var p="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(a[4].length,7),c=vh(h,Math.pow(10,l)-1,!1),r=""+f,p=Fr("n",a[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),r+=p+a[2]+"/"+a[3],p=gh(c[2],l),p.length<a[4].length&&(p=Bi(a[4].substr(a[4].length-p.length))+p),r+=p,r;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(a[1].length,a[4].length),7),c=vh(h,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ap(c[1],l)+a[2]+"/"+a[3]+gh(c[2],l):He(" ",2*l+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return r=to(e,0),t.length<=r.length?r:Bi(t.substr(0,t.length-r.length))+r;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),l=r.indexOf(".");var m=t.indexOf(".")-l,v=t.length-r.length-m;return Bi(t.substr(0,m)+r+t.substr(t.length-v))}if(a=t.match(/^00,000\.([#0]*0)$/))return l=zx(e,a[1].length),e<0?"-"+Dn(n,t,-e):ys(KC(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Xn(0,3-E.length):"")+E})+"."+Xn(l,a[1].length);switch(t){case"###,##0.00":return Dn(n,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var x=ys(to(h,0));return x!=="0"?f+x:"";case"###,###.00":return Dn(n,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Dn(n,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function QC(n,t,e){for(var i=t.length-1;t.charCodeAt(i-1)===44;)--i;return Fr(n,t.substr(0,i),e/Math.pow(10,3*(t.length-i)))}function ZC(n,t,e){var i=t.replace(w_,""),r=t.length-i.length;return Fr(n,i,e*Math.pow(10,2*r))+He("%",r)}function M_(n,t){var e,i=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+M_(n,-t);var r=n.indexOf(".");r===-1&&(r=n.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%r;if(a<0&&(a+=r),e=(t/Math.pow(10,a)).toPrecision(i+1+(r+a)%r),!e.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(l-e.length+a):e+="E+"+(l-a),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,h,f,p){return h+f+p.substr(0,(r+a)%r)+"."+p.substr(a)+"E"})}else e=t.toExponential(i);return n.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),n.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function sr(n,t,e){if(n.charCodeAt(0)===40&&!t.match(R_)){var i=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?sr("n",i,e):"("+sr("n",i,-e)+")"}if(t.charCodeAt(t.length-1)===44)return QC(n,t,e);if(t.indexOf("%")!==-1)return ZC(n,t,e);if(t.indexOf("E")!==-1)return M_(t,e);if(t.charCodeAt(0)===36)return"$"+sr(n,t.substr(t.charAt(1)==" "?2:1),e);var r,a,l,c,h=Math.abs(e),f=e<0?"-":"";if(t.match(/^00+$/))return f+Xn(h,t.length);if(t.match(/^[#?]+$/))return r=""+e,e===0&&(r=""),r.length>t.length?r:Bi(t.substr(0,t.length-r.length))+r;if(a=t.match(T_))return $C(a,h,f);if(t.match(/^#+0+$/))return f+Xn(h,t.length-t.indexOf("0"));if(a=t.match(C_))return r=(""+e).replace(/^([^\.]+)$/,"$1."+Bi(a[1])).replace(/\.$/,"."+Bi(a[1])),r=r.replace(/\.(\d*)$/,function(E,_){return"."+_+He("0",Bi(a[1]).length-_.length)}),t.indexOf("0.")!==-1?r:r.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return f+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return f+ys(""+h);if(a=t.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+sr(n,t,-e):ys(""+e)+"."+He("0",a[1].length);if(a=t.match(/^#,#*,#0/))return sr(n,t.replace(/^#,#*,/,""),e);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return r=mo(sr(n,t.replace(/[\\-]/g,""),e)),l=0,mo(mo(t.replace(/\\/g,"")).replace(/[0#]/g,function(E){return l<r.length?r.charAt(l++):E==="0"?"0":""}));if(t.match(D_))return r=sr(n,"##########",e),"("+r.substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var p="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(a[4].length,7),c=vh(h,Math.pow(10,l)-1,!1),r=""+f,p=Fr("n",a[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),r+=p+a[2]+"/"+a[3],p=gh(c[2],l),p.length<a[4].length&&(p=Bi(a[4].substr(a[4].length-p.length))+p),r+=p,r;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(a[1].length,a[4].length),7),c=vh(h,Math.pow(10,l)-1,!0),f+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ap(c[1],l)+a[2]+"/"+a[3]+gh(c[2],l):He(" ",2*l+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return r=""+e,t.length<=r.length?r:Bi(t.substr(0,t.length-r.length))+r;if(a=t.match(/^([#0]+)\.([#0]+)$/)){r=""+e.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),l=r.indexOf(".");var m=t.indexOf(".")-l,v=t.length-r.length-m;return Bi(t.substr(0,m)+r+t.substr(t.length-v))}if(a=t.match(/^00,000\.([#0]*0)$/))return e<0?"-"+sr(n,t,-e):ys(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(E){return"00,"+(E.length<3?Xn(0,3-E.length):"")+E})+"."+Xn(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=ys(""+h);return x!=="0"?f+x:"";default:if(t.match(/\.[0#?]*$/))return sr(n,t.slice(0,t.lastIndexOf(".")),e)+Bi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Fr(n,t,e){return(e|0)===e?sr(n,t,e):Dn(n,t,e)}function JC(n){for(var t=[],e=!1,i=0,r=0;i<n.length;++i)switch(n.charCodeAt(i)){case 34:e=!e;break;case 95:case 42:case 92:++i;break;case 59:t[t.length]=n.substr(r,i-r),r=i+1}if(t[t.length]=n.substr(r),e===!0)throw new Error("Format |"+n+"| unterminated string ");return t}var N_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function O_(n){for(var t=0,e="",i="";t<n.length;)switch(e=n.charAt(t)){case"G":mh(n,t)&&(t+=6),t++;break;case'"':for(;n.charCodeAt(++t)!==34&&t<n.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(n.charAt(t+1)==="1"||n.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(n.substr(t,3).toUpperCase()==="A/P"||n.substr(t,5).toUpperCase()==="AM/PM"||n.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(i=e;n.charAt(t++)!=="]"&&t<n.length;)i+=n.charAt(t);if(i.match(N_))return!0;break;case".":case"0":case"#":for(;t<n.length&&("0#?.,E+-%".indexOf(e=n.charAt(++t))>-1||e=="\\"&&n.charAt(t+1)=="-"&&"0#".indexOf(n.charAt(t+2))>-1););break;case"?":for(;n.charAt(++t)===e;);break;case"*":++t,(n.charAt(t)==" "||n.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<n.length&&"0123456789".indexOf(n.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function tR(n,t,e,i){for(var r=[],a="",l=0,c="",h="t",f,p,m,v="H";l<n.length;)switch(c=n.charAt(l)){case"G":if(!mh(n,l))throw new Error("unrecognized character "+c+" in "+n);r[r.length]={t:"G",v:"General"},l+=7;break;case'"':for(a="";(m=n.charCodeAt(++l))!==34&&l<n.length;)a+=String.fromCharCode(m);r[r.length]={t:"t",v:a},++l;break;case"\\":var x=n.charAt(++l),E=x==="("||x===")"?x:"t";r[r.length]={t:E,v:x},++l;break;case"_":r[r.length]={t:"t",v:" "},l+=2;break;case"@":r[r.length]={t:"T",v:t},++l;break;case"B":case"b":if(n.charAt(l+1)==="1"||n.charAt(l+1)==="2"){if(f==null&&(f=Qu(t,e,n.charAt(l+1)==="2"),f==null))return"";r[r.length]={t:"X",v:n.substr(l,2)},h=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||f==null&&(f=Qu(t,e),f==null))return"";for(a=c;++l<n.length&&n.charAt(l).toLowerCase()===c;)a+=c;c==="m"&&h.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=v),r[r.length]={t:c,v:a},h=c;break;case"A":case"a":case"上":var _={t:c,v:c};if(f==null&&(f=Qu(t,e)),n.substr(l,3).toUpperCase()==="A/P"?(f!=null&&(_.v=f.H>=12?"P":"A"),_.t="T",v="h",l+=3):n.substr(l,5).toUpperCase()==="AM/PM"?(f!=null&&(_.v=f.H>=12?"PM":"AM"),_.t="T",l+=5,v="h"):n.substr(l,5).toUpperCase()==="上午/下午"?(f!=null&&(_.v=f.H>=12?"下午":"上午"),_.t="T",l+=5,v="h"):(_.t="t",++l),f==null&&_.t==="T")return"";r[r.length]=_,h=c;break;case"[":for(a=c;n.charAt(l++)!=="]"&&l<n.length;)a+=n.charAt(l);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(N_)){if(f==null&&(f=Qu(t,e),f==null))return"";r[r.length]={t:"Z",v:a.toLowerCase()},h=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",O_(n)||(r[r.length]={t:"t",v:a}));break;case".":if(f!=null){for(a=c;++l<n.length&&(c=n.charAt(l))==="0";)a+=c;r[r.length]={t:"s",v:a};break}case"0":case"#":for(a=c;++l<n.length&&"0#?.,E+-%".indexOf(c=n.charAt(l))>-1;)a+=c;r[r.length]={t:"n",v:a};break;case"?":for(a=c;n.charAt(++l)===c;)a+=c;r[r.length]={t:c,v:a},h=c;break;case"*":++l,(n.charAt(l)==" "||n.charAt(l)=="*")&&++l;break;case"(":case")":r[r.length]={t:i===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=c;l<n.length&&"0123456789".indexOf(n.charAt(++l))>-1;)a+=n.charAt(l);r[r.length]={t:"D",v:a};break;case" ":r[r.length]={t:c,v:c},++l;break;case"$":r[r.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+n);r[r.length]={t:"t",v:c},++l;break}var b=0,A=0,T;for(l=r.length-1,h="t";l>=0;--l)switch(r[l].t){case"h":case"H":r[l].t=v,h="h",b<1&&(b=1);break;case"s":(T=r[l].v.match(/\.0+$/))&&(A=Math.max(A,T[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":h=r[l].t;break;case"m":h==="s"&&(r[l].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&r[l].v.match(/[Hh]/)&&(b=1),b<2&&r[l].v.match(/[Mm]/)&&(b=2),b<3&&r[l].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var S="",C;for(l=0;l<r.length;++l)switch(r[l].t){case"t":case"T":case" ":case"D":break;case"X":r[l].v="",r[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":r[l].v=GC(r[l].t.charCodeAt(0),r[l].v,f,A),r[l].t="t";break;case"n":case"?":for(C=l+1;r[C]!=null&&((c=r[C].t)==="?"||c==="D"||(c===" "||c==="t")&&r[C+1]!=null&&(r[C+1].t==="?"||r[C+1].t==="t"&&r[C+1].v==="/")||r[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(r[C].v==="/"||r[C].v===" "&&r[C+1]!=null&&r[C+1].t=="?"));)r[l].v+=r[C].v,r[C]={v:"",t:";"},++C;S+=r[l].v,l=C-1;break;case"G":r[l].t="t",r[l].v=Q0(t,e);break}var N="",B,O;if(S.length>0){S.charCodeAt(0)==40?(B=t<0&&S.charCodeAt(0)===45?-t:t,O=Fr("n",S,B)):(B=t<0&&i>1?-t:t,O=Fr("n",S,B),B<0&&r[0]&&r[0].t=="t"&&(O=O.substr(1),r[0].v="-"+r[0].v)),C=O.length-1;var H=r.length;for(l=0;l<r.length;++l)if(r[l]!=null&&r[l].t!="t"&&r[l].v.indexOf(".")>-1){H=l;break}var M=r.length;if(H===r.length&&O.indexOf("E")===-1){for(l=r.length-1;l>=0;--l)r[l]==null||"n?".indexOf(r[l].t)===-1||(C>=r[l].v.length-1?(C-=r[l].v.length,r[l].v=O.substr(C+1,r[l].v.length)):C<0?r[l].v="":(r[l].v=O.substr(0,C+1),C=-1),r[l].t="t",M=l);C>=0&&M<r.length&&(r[M].v=O.substr(0,C+1)+r[M].v)}else if(H!==r.length&&O.indexOf("E")===-1){for(C=O.indexOf(".")-1,l=H;l>=0;--l)if(!(r[l]==null||"n?".indexOf(r[l].t)===-1)){for(p=r[l].v.indexOf(".")>-1&&l===H?r[l].v.indexOf(".")-1:r[l].v.length-1,N=r[l].v.substr(p+1);p>=0;--p)C>=0&&(r[l].v.charAt(p)==="0"||r[l].v.charAt(p)==="#")&&(N=O.charAt(C--)+N);r[l].v=N,r[l].t="t",M=l}for(C>=0&&M<r.length&&(r[M].v=O.substr(0,C+1)+r[M].v),C=O.indexOf(".")+1,l=H;l<r.length;++l)if(!(r[l]==null||"n?(".indexOf(r[l].t)===-1&&l!==H)){for(p=r[l].v.indexOf(".")>-1&&l===H?r[l].v.indexOf(".")+1:0,N=r[l].v.substr(0,p);p<r[l].v.length;++p)C<O.length&&(N+=O.charAt(C++));r[l].v=N,r[l].t="t",M=l}}}for(l=0;l<r.length;++l)r[l]!=null&&"n?".indexOf(r[l].t)>-1&&(B=i>1&&t<0&&l>0&&r[l-1].v==="-"?-t:t,r[l].v=Fr(r[l].t,r[l].v,B),r[l].t="t");var W="";for(l=0;l!==r.length;++l)r[l]!=null&&(W+=r[l].v);return W}var Vx=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Gx(n,t){if(t==null)return!1;var e=parseFloat(t[2]);switch(t[1]){case"=":if(n==e)return!0;break;case">":if(n>e)return!0;break;case"<":if(n<e)return!0;break;case"<>":if(n!=e)return!0;break;case">=":if(n>=e)return!0;break;case"<=":if(n<=e)return!0;break}return!1}function eR(n,t){var e=JC(n),i=e.length,r=e[i-1].indexOf("@");if(i<4&&r>-1&&--i,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof t!="number")return[4,e.length===4||r>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=r>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=r>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=r>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var a=t>0?e[0]:t<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[i,a];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var l=e[0].match(Vx),c=e[1].match(Vx);return Gx(t,l)?[i,e[0]]:Gx(t,c)?[i,e[1]]:[i,e[l!=null&&c!=null?2:1]]}return[i,a]}function bs(n,t,e){e==null&&(e={});var i="";switch(typeof n){case"string":n=="m/d/yy"&&e.dateNF?i=e.dateNF:i=n;break;case"number":n==14&&e.dateNF?i=e.dateNF:i=(e.table!=null?e.table:je)[n],i==null&&(i=e.table&&e.table[Hx[n]]||je[Hx[n]]),i==null&&(i=FC[n]||"General");break}if(mh(i,0))return Q0(t,e);t instanceof Date&&(t=A_(t,e.date1904));var r=eR(i,t);if(mh(r[1]))return Q0(t,e);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return tR(r[1],t,e,r[0])}function L_(n,t){if(typeof t!="number"){t=+t||-1;for(var e=0;e<392;++e){if(je[e]==null){t<0&&(t=e);continue}if(je[e]==n){t=e;break}}t<0&&(t=391)}return je[t]=n,t}function Bh(n){for(var t=0;t!=392;++t)n[t]!==void 0&&L_(n[t],t)}function Uh(){je=kC()}var P_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function iR(n){var t=typeof n=="number"?je[n]:n;return t=t.replace(P_,"(\\d+)"),new RegExp("^"+t+"$")}function nR(n,t,e){var i=-1,r=-1,a=-1,l=-1,c=-1,h=-1;(t.match(P_)||[]).forEach(function(m,v){var x=parseInt(e[v+1],10);switch(m.toLowerCase().charAt(0)){case"y":i=x;break;case"d":a=x;break;case"h":l=x;break;case"s":h=x;break;case"m":l>=0?c=x:r=x;break}}),h>=0&&c==-1&&r>=0&&(c=r,r=-1);var f=(""+(i>=0?i:new Date().getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return l==-1&&c==-1&&h==-1?f:i==-1&&r==-1&&a==-1?p:f+"T"+p}var rR=(function(){var n={};n.version="1.2.0";function t(){for(var O=0,H=new Array(256),M=0;M!=256;++M)O=M,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,H[M]=O;return typeof Int32Array<"u"?new Int32Array(H):H}var e=t();function i(O){var H=0,M=0,W=0,Y=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)Y[W]=O[W];for(W=0;W!=256;++W)for(M=O[W],H=256+W;H<4096;H+=256)M=Y[H]=M>>>8^O[M&255];var J=[];for(W=1;W!=16;++W)J[W-1]=typeof Int32Array<"u"?Y.subarray(W*256,W*256+256):Y.slice(W*256,W*256+256);return J}var r=i(e),a=r[0],l=r[1],c=r[2],h=r[3],f=r[4],p=r[5],m=r[6],v=r[7],x=r[8],E=r[9],_=r[10],b=r[11],A=r[12],T=r[13],S=r[14];function C(O,H){for(var M=H^-1,W=0,Y=O.length;W<Y;)M=M>>>8^e[(M^O.charCodeAt(W++))&255];return~M}function N(O,H){for(var M=H^-1,W=O.length-15,Y=0;Y<W;)M=S[O[Y++]^M&255]^T[O[Y++]^M>>8&255]^A[O[Y++]^M>>16&255]^b[O[Y++]^M>>>24]^_[O[Y++]]^E[O[Y++]]^x[O[Y++]]^v[O[Y++]]^m[O[Y++]]^p[O[Y++]]^f[O[Y++]]^h[O[Y++]]^c[O[Y++]]^l[O[Y++]]^a[O[Y++]]^e[O[Y++]];for(W+=15;Y<W;)M=M>>>8^e[(M^O[Y++])&255];return~M}function B(O,H){for(var M=H^-1,W=0,Y=O.length,J=0,ut=0;W<Y;)J=O.charCodeAt(W++),J<128?M=M>>>8^e[(M^J)&255]:J<2048?(M=M>>>8^e[(M^(192|J>>6&31))&255],M=M>>>8^e[(M^(128|J&63))&255]):J>=55296&&J<57344?(J=(J&1023)+64,ut=O.charCodeAt(W++)&1023,M=M>>>8^e[(M^(240|J>>8&7))&255],M=M>>>8^e[(M^(128|J>>2&63))&255],M=M>>>8^e[(M^(128|ut>>6&15|(J&3)<<4))&255],M=M>>>8^e[(M^(128|ut&63))&255]):(M=M>>>8^e[(M^(224|J>>12&15))&255],M=M>>>8^e[(M^(128|J>>6&63))&255],M=M>>>8^e[(M^(128|J&63))&255]);return~M}return n.table=e,n.bstr=C,n.buf=N,n.str=B,n})(),Re=(function(){var t={};t.version="1.2.1";function e(R,I){for(var L=R.split("/"),k=I.split("/"),F=0,U=0,rt=Math.min(L.length,k.length);F<rt;++F){if(U=L[F].length-k[F].length)return U;if(L[F]!=k[F])return L[F]<k[F]?-1:1}return L.length-k.length}function i(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:i(R.slice(0,-1));var I=R.lastIndexOf("/");return I===-1?R:R.slice(0,I+1)}function r(R){if(R.charAt(R.length-1)=="/")return r(R.slice(0,-1));var I=R.lastIndexOf("/");return I===-1?R:R.slice(I+1)}function a(R,I){typeof I=="string"&&(I=new Date(I));var L=I.getHours();L=L<<6|I.getMinutes(),L=L<<5|I.getSeconds()>>>1,R.write_shift(2,L);var k=I.getFullYear()-1980;k=k<<4|I.getMonth()+1,k=k<<5|I.getDate(),R.write_shift(2,k)}function l(R){var I=R.read_shift(2)&65535,L=R.read_shift(2)&65535,k=new Date,F=L&31;L>>>=5;var U=L&15;L>>>=4,k.setMilliseconds(0),k.setFullYear(L+1980),k.setMonth(U-1),k.setDate(F);var rt=I&31;I>>>=5;var dt=I&63;return I>>>=6,k.setHours(I),k.setMinutes(dt),k.setSeconds(rt<<1),k}function c(R){hn(R,0);for(var I={},L=0;R.l<=R.length-4;){var k=R.read_shift(2),F=R.read_shift(2),U=R.l+F,rt={};switch(k){case 21589:L=R.read_shift(1),L&1&&(rt.mtime=R.read_shift(4)),F>5&&(L&2&&(rt.atime=R.read_shift(4)),L&4&&(rt.ctime=R.read_shift(4))),rt.mtime&&(rt.mt=new Date(rt.mtime*1e3));break}R.l=U,I[k]=rt}return I}var h;function f(){return h||(h={})}function p(R,I){if(R[0]==80&&R[1]==75)return Do(R,I);if((R[0]|32)==109&&(R[1]|32)==105)return Xh(R,I);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var L=3,k=512,F=0,U=0,rt=0,dt=0,Z=0,st=[],ot=R.slice(0,512);hn(ot,0);var bt=m(ot);switch(L=bt[0],L){case 3:k=512;break;case 4:k=4096;break;case 0:if(bt[1]==0)return Do(R,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+L)}k!==512&&(ot=R.slice(0,k),hn(ot,28));var Dt=R.slice(0,k);v(ot,L);var Pt=ot.read_shift(4,"i");if(L===3&&Pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Pt);ot.l+=4,rt=ot.read_shift(4,"i"),ot.l+=4,ot.chk("00100000","Mini Stream Cutoff Size: "),dt=ot.read_shift(4,"i"),F=ot.read_shift(4,"i"),Z=ot.read_shift(4,"i"),U=ot.read_shift(4,"i");for(var Tt=-1,Ot=0;Ot<109&&(Tt=ot.read_shift(4,"i"),!(Tt<0));++Ot)st[Ot]=Tt;var $t=x(R,k);b(Z,U,$t,k,st);var Ae=T($t,rt,st,k);Ae[rt].name="!Directory",F>0&&dt!==ut&&(Ae[dt].name="!MiniFAT"),Ae[st[0]].name="!FAT",Ae.fat_addrs=st,Ae.ssz=k;var we={},Oe=[],dr=[],Vr=[];S(rt,Ae,$t,Oe,F,we,dr,dt),E(dr,Vr,Oe),Oe.shift();var mn={FileIndex:dr,FullPaths:Vr};return I&&I.raw&&(mn.raw={header:Dt,sectors:$t}),mn}function m(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(At,"Header Signature: "),R.l+=16;var I=R.read_shift(2,"u");return[R.read_shift(2,"u"),I]}function v(R,I){var L=9;switch(R.l+=2,L=R.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+L);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+L);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+L)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function x(R,I){for(var L=Math.ceil(R.length/I)-1,k=[],F=1;F<L;++F)k[F-1]=R.slice(F*I,(F+1)*I);return k[L-1]=R.slice(L*I),k}function E(R,I,L){for(var k=0,F=0,U=0,rt=0,dt=0,Z=L.length,st=[],ot=[];k<Z;++k)st[k]=ot[k]=k,I[k]=L[k];for(;dt<ot.length;++dt)k=ot[dt],F=R[k].L,U=R[k].R,rt=R[k].C,st[k]===k&&(F!==-1&&st[F]!==F&&(st[k]=st[F]),U!==-1&&st[U]!==U&&(st[k]=st[U])),rt!==-1&&(st[rt]=k),F!==-1&&k!=st[k]&&(st[F]=st[k],ot.lastIndexOf(F)<dt&&ot.push(F)),U!==-1&&k!=st[k]&&(st[U]=st[k],ot.lastIndexOf(U)<dt&&ot.push(U));for(k=1;k<Z;++k)st[k]===k&&(U!==-1&&st[U]!==U?st[k]=st[U]:F!==-1&&st[F]!==F&&(st[k]=st[F]));for(k=1;k<Z;++k)if(R[k].type!==0){if(dt=k,dt!=st[dt])do dt=st[dt],I[k]=I[dt]+"/"+I[k];while(dt!==0&&st[dt]!==-1&&dt!=st[dt]);st[k]=-1}for(I[0]+="/",k=1;k<Z;++k)R[k].type!==2&&(I[k]+="/")}function _(R,I,L){for(var k=R.start,F=R.size,U=[],rt=k;L&&F>0&&rt>=0;)U.push(I.slice(rt*J,rt*J+J)),F-=J,rt=Ks(L,rt*4);return U.length===0?gt(0):bi(U).slice(0,R.size)}function b(R,I,L,k,F){var U=ut;if(R===ut){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var rt=L[R],dt=(k>>>2)-1;if(!rt)return;for(var Z=0;Z<dt&&(U=Ks(rt,Z*4))!==ut;++Z)F.push(U);b(Ks(rt,k-4),I-1,L,k,F)}}function A(R,I,L,k,F){var U=[],rt=[];F||(F=[]);var dt=k-1,Z=0,st=0;for(Z=I;Z>=0;){F[Z]=!0,U[U.length]=Z,rt.push(R[Z]);var ot=L[Math.floor(Z*4/k)];if(st=Z*4&dt,k<4+st)throw new Error("FAT boundary crossed: "+Z+" 4 "+k);if(!R[ot])break;Z=Ks(R[ot],st)}return{nodes:U,data:Zx([rt])}}function T(R,I,L,k){var F=R.length,U=[],rt=[],dt=[],Z=[],st=k-1,ot=0,bt=0,Dt=0,Pt=0;for(ot=0;ot<F;++ot)if(dt=[],Dt=ot+I,Dt>=F&&(Dt-=F),!rt[Dt]){Z=[];var Tt=[];for(bt=Dt;bt>=0;){Tt[bt]=!0,rt[bt]=!0,dt[dt.length]=bt,Z.push(R[bt]);var Ot=L[Math.floor(bt*4/k)];if(Pt=bt*4&st,k<4+Pt)throw new Error("FAT boundary crossed: "+bt+" 4 "+k);if(!R[Ot]||(bt=Ks(R[Ot],Pt),Tt[bt]))break}U[Dt]={nodes:dt,data:Zx([Z])}}return U}function S(R,I,L,k,F,U,rt,dt){for(var Z=0,st=k.length?2:0,ot=I[R].data,bt=0,Dt=0,Pt;bt<ot.length;bt+=128){var Tt=ot.slice(bt,bt+128);hn(Tt,64),Dt=Tt.read_shift(2),Pt=Dp(Tt,0,Dt-st),k.push(Pt);var Ot={name:Pt,type:Tt.read_shift(1),color:Tt.read_shift(1),L:Tt.read_shift(4,"i"),R:Tt.read_shift(4,"i"),C:Tt.read_shift(4,"i"),clsid:Tt.read_shift(16),state:Tt.read_shift(4,"i"),start:0,size:0},$t=Tt.read_shift(2)+Tt.read_shift(2)+Tt.read_shift(2)+Tt.read_shift(2);$t!==0&&(Ot.ct=C(Tt,Tt.l-8));var Ae=Tt.read_shift(2)+Tt.read_shift(2)+Tt.read_shift(2)+Tt.read_shift(2);Ae!==0&&(Ot.mt=C(Tt,Tt.l-8)),Ot.start=Tt.read_shift(4,"i"),Ot.size=Tt.read_shift(4,"i"),Ot.size<0&&Ot.start<0&&(Ot.size=Ot.type=0,Ot.start=ut,Ot.name=""),Ot.type===5?(Z=Ot.start,F>0&&Z!==ut&&(I[Z].name="!StreamData")):Ot.size>=4096?(Ot.storage="fat",I[Ot.start]===void 0&&(I[Ot.start]=A(L,Ot.start,I.fat_addrs,I.ssz)),I[Ot.start].name=Ot.name,Ot.content=I[Ot.start].data.slice(0,Ot.size)):(Ot.storage="minifat",Ot.size<0?Ot.size=0:Z!==ut&&Ot.start!==ut&&I[Z]&&(Ot.content=_(Ot,I[Z].data,(I[dt]||{}).data))),Ot.content&&hn(Ot.content,0),U[Pt]=Ot,rt.push(Ot)}}function C(R,I){return new Date((dn(R,I+4)/1e7*Math.pow(2,32)+dn(R,I)/1e7-11644473600)*1e3)}function N(R,I){return f(),p(h.readFileSync(R),I)}function B(R,I){var L=I&&I.type;switch(L||pe&&Buffer.isBuffer(R)&&(L="buffer"),L||"base64"){case"file":return N(R,I);case"base64":return p(Wn(Ur(R)),I);case"binary":return p(Wn(R),I)}return p(R,I)}function O(R,I){var L=I||{},k=L.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=k+"/",R.FileIndex[0]={name:k,type:5}),L.CLSID&&(R.FileIndex[0].clsid=L.CLSID),H(R)}function H(R){var I="Sh33tJ5";if(!Re.find(R,"/"+I)){var L=gt(4);L[0]=55,L[1]=L[3]=50,L[2]=54,R.FileIndex.push({name:I,type:2,content:L,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+I),M(R)}}function M(R,I){O(R);for(var L=!1,k=!1,F=R.FullPaths.length-1;F>=0;--F){var U=R.FileIndex[F];switch(U.type){case 0:k?L=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:k=!0,isNaN(U.R*U.L*U.C)&&(L=!0),U.R>-1&&U.L>-1&&U.R==U.L&&(L=!0);break;default:L=!0;break}}if(!(!L&&!I)){var rt=new Date(1987,1,19),dt=0,Z=Object.create?Object.create(null):{},st=[];for(F=0;F<R.FullPaths.length;++F)Z[R.FullPaths[F]]=!0,R.FileIndex[F].type!==0&&st.push([R.FullPaths[F],R.FileIndex[F]]);for(F=0;F<st.length;++F){var ot=i(st[F][0]);k=Z[ot],k||(st.push([ot,{name:r(ot).replace("/",""),type:1,clsid:q,ct:rt,mt:rt,content:null}]),Z[ot]=!0)}for(st.sort(function(Pt,Tt){return e(Pt[0],Tt[0])}),R.FullPaths=[],R.FileIndex=[],F=0;F<st.length;++F)R.FullPaths[F]=st[F][0],R.FileIndex[F]=st[F][1];for(F=0;F<st.length;++F){var bt=R.FileIndex[F],Dt=R.FullPaths[F];if(bt.name=r(Dt).replace("/",""),bt.L=bt.R=bt.C=-(bt.color=1),bt.size=bt.content?bt.content.length:0,bt.start=0,bt.clsid=bt.clsid||q,F===0)bt.C=st.length>1?1:-1,bt.size=0,bt.type=5;else if(Dt.slice(-1)=="/"){for(dt=F+1;dt<st.length&&i(R.FullPaths[dt])!=Dt;++dt);for(bt.C=dt>=st.length?-1:dt,dt=F+1;dt<st.length&&i(R.FullPaths[dt])!=i(Dt);++dt);bt.R=dt>=st.length?-1:dt,bt.type=1}else i(R.FullPaths[F+1]||"")==i(Dt)&&(bt.R=F+1),bt.type=2}}}function W(R,I){var L=I||{};if(L.fileType=="mad")return qn(R,L);switch(M(R),L.fileType){case"zip":return Ds(R,L)}var k=(function(Pt){for(var Tt=0,Ot=0,$t=0;$t<Pt.FileIndex.length;++$t){var Ae=Pt.FileIndex[$t];if(Ae.content){var we=Ae.content.length;we>0&&(we<4096?Tt+=we+63>>6:Ot+=we+511>>9)}}for(var Oe=Pt.FullPaths.length+3>>2,dr=Tt+7>>3,Vr=Tt+127>>7,mn=dr+Ot+Oe+Vr,kn=mn+127>>7,Ms=kn<=109?0:Math.ceil((kn-109)/127);mn+kn+Ms+127>>7>kn;)Ms=++kn<=109?0:Math.ceil((kn-109)/127);var Fn=[1,Ms,kn,Vr,Oe,Ot,Tt,0];return Pt.FileIndex[0].size=Tt<<6,Fn[7]=(Pt.FileIndex[0].start=Fn[0]+Fn[1]+Fn[2]+Fn[3]+Fn[4]+Fn[5])+(Fn[6]+7>>3),Fn})(R),F=gt(k[7]<<9),U=0,rt=0;{for(U=0;U<8;++U)F.write_shift(1,Et[U]);for(U=0;U<8;++U)F.write_shift(2,0);for(F.write_shift(2,62),F.write_shift(2,3),F.write_shift(2,65534),F.write_shift(2,9),F.write_shift(2,6),U=0;U<3;++U)F.write_shift(2,0);for(F.write_shift(4,0),F.write_shift(4,k[2]),F.write_shift(4,k[0]+k[1]+k[2]+k[3]-1),F.write_shift(4,0),F.write_shift(4,4096),F.write_shift(4,k[3]?k[0]+k[1]+k[2]-1:ut),F.write_shift(4,k[3]),F.write_shift(-4,k[1]?k[0]-1:ut),F.write_shift(4,k[1]),U=0;U<109;++U)F.write_shift(-4,U<k[2]?k[1]+U:-1)}if(k[1])for(rt=0;rt<k[1];++rt){for(;U<236+rt*127;++U)F.write_shift(-4,U<k[2]?k[1]+U:-1);F.write_shift(-4,rt===k[1]-1?ut:rt+1)}var dt=function(Pt){for(rt+=Pt;U<rt-1;++U)F.write_shift(-4,U+1);Pt&&(++U,F.write_shift(-4,ut))};for(rt=U=0,rt+=k[1];U<rt;++U)F.write_shift(-4,nt.DIFSECT);for(rt+=k[2];U<rt;++U)F.write_shift(-4,nt.FATSECT);dt(k[3]),dt(k[4]);for(var Z=0,st=0,ot=R.FileIndex[0];Z<R.FileIndex.length;++Z)ot=R.FileIndex[Z],ot.content&&(st=ot.content.length,!(st<4096)&&(ot.start=rt,dt(st+511>>9)));for(dt(k[6]+7>>3);F.l&511;)F.write_shift(-4,nt.ENDOFCHAIN);for(rt=U=0,Z=0;Z<R.FileIndex.length;++Z)ot=R.FileIndex[Z],ot.content&&(st=ot.content.length,!(!st||st>=4096)&&(ot.start=rt,dt(st+63>>6)));for(;F.l&511;)F.write_shift(-4,nt.ENDOFCHAIN);for(U=0;U<k[4]<<2;++U){var bt=R.FullPaths[U];if(!bt||bt.length===0){for(Z=0;Z<17;++Z)F.write_shift(4,0);for(Z=0;Z<3;++Z)F.write_shift(4,-1);for(Z=0;Z<12;++Z)F.write_shift(4,0);continue}ot=R.FileIndex[U],U===0&&(ot.start=ot.size?ot.start-1:ut);var Dt=U===0&&L.root||ot.name;if(st=2*(Dt.length+1),F.write_shift(64,Dt,"utf16le"),F.write_shift(2,st),F.write_shift(1,ot.type),F.write_shift(1,ot.color),F.write_shift(-4,ot.L),F.write_shift(-4,ot.R),F.write_shift(-4,ot.C),ot.clsid)F.write_shift(16,ot.clsid,"hex");else for(Z=0;Z<4;++Z)F.write_shift(4,0);F.write_shift(4,ot.state||0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,0),F.write_shift(4,ot.start),F.write_shift(4,ot.size),F.write_shift(4,0)}for(U=1;U<R.FileIndex.length;++U)if(ot=R.FileIndex[U],ot.size>=4096)if(F.l=ot.start+1<<9,pe&&Buffer.isBuffer(ot.content))ot.content.copy(F,F.l,0,ot.size),F.l+=ot.size+511&-512;else{for(Z=0;Z<ot.size;++Z)F.write_shift(1,ot.content[Z]);for(;Z&511;++Z)F.write_shift(1,0)}for(U=1;U<R.FileIndex.length;++U)if(ot=R.FileIndex[U],ot.size>0&&ot.size<4096)if(pe&&Buffer.isBuffer(ot.content))ot.content.copy(F,F.l,0,ot.size),F.l+=ot.size+63&-64;else{for(Z=0;Z<ot.size;++Z)F.write_shift(1,ot.content[Z]);for(;Z&63;++Z)F.write_shift(1,0)}if(pe)F.l=F.length;else for(;F.l<F.length;)F.write_shift(1,0);return F}function Y(R,I){var L=R.FullPaths.map(function(Z){return Z.toUpperCase()}),k=L.map(function(Z){var st=Z.split("/");return st[st.length-(Z.slice(-1)=="/"?2:1)]}),F=!1;I.charCodeAt(0)===47?(F=!0,I=L[0].slice(0,-1)+I):F=I.indexOf("/")!==-1;var U=I.toUpperCase(),rt=F===!0?L.indexOf(U):k.indexOf(U);if(rt!==-1)return R.FileIndex[rt];var dt=!U.match(Ku);for(U=U.replace(zl,""),dt&&(U=U.replace(Ku,"!")),rt=0;rt<L.length;++rt)if((dt?L[rt].replace(Ku,"!"):L[rt]).replace(zl,"")==U||(dt?k[rt].replace(Ku,"!"):k[rt]).replace(zl,"")==U)return R.FileIndex[rt];return null}var J=64,ut=-2,At="d0cf11e0a1b11ae1",Et=[208,207,17,224,161,177,26,225],q="00000000000000000000000000000000",nt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ut,FREESECT:-1,HEADER_SIGNATURE:At,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:q,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function St(R,I,L){f();var k=W(R,L);h.writeFileSync(I,k)}function kt(R){for(var I=new Array(R.length),L=0;L<R.length;++L)I[L]=String.fromCharCode(R[L]);return I.join("")}function G(R,I){var L=W(R,I);switch(I&&I.type||"buffer"){case"file":return f(),h.writeFileSync(I.filename,L),L;case"binary":return typeof L=="string"?L:kt(L);case"base64":return ec(typeof L=="string"?L:kt(L));case"buffer":if(pe)return Buffer.isBuffer(L)?L:jr(L);case"array":return typeof L=="string"?Wn(L):L}return L}var ht;function P(R){try{var I=R.InflateRaw,L=new I;if(L._processChunk(new Uint8Array([3,0]),L._finishFlushFlag),L.bytesRead)ht=R;else throw new Error("zlib does not expose bytesRead")}catch(k){console.error("cannot use native zlib: "+(k.message||k))}}function j(R,I){if(!ht)return wc(R,I);var L=ht.InflateRaw,k=new L,F=k._processChunk(R.slice(R.l),k._finishFlushFlag);return R.l+=k.bytesRead,F}function z(R){return ht?ht.deflateRawSync(R):Ec(R)}var X=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],et=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],wt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ct(R){var I=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(I>>16|I>>8|I)&255}for(var pt=typeof Uint8Array<"u",yt=pt?new Uint8Array(256):[],Ut=0;Ut<256;++Ut)yt[Ut]=Ct(Ut);function Lt(R,I){var L=yt[R&255];return I<=8?L>>>8-I:(L=L<<8|yt[R>>8&255],I<=16?L>>>16-I:(L=L<<8|yt[R>>16&255],L>>>24-I))}function Qt(R,I){var L=I&7,k=I>>>3;return(R[k]|(L<=6?0:R[k+1]<<8))>>>L&3}function jt(R,I){var L=I&7,k=I>>>3;return(R[k]|(L<=5?0:R[k+1]<<8))>>>L&7}function ge(R,I){var L=I&7,k=I>>>3;return(R[k]|(L<=4?0:R[k+1]<<8))>>>L&15}function ae(R,I){var L=I&7,k=I>>>3;return(R[k]|(L<=3?0:R[k+1]<<8))>>>L&31}function Rt(R,I){var L=I&7,k=I>>>3;return(R[k]|(L<=1?0:R[k+1]<<8))>>>L&127}function ce(R,I,L){var k=I&7,F=I>>>3,U=(1<<L)-1,rt=R[F]>>>k;return L<8-k||(rt|=R[F+1]<<8-k,L<16-k)||(rt|=R[F+2]<<16-k,L<24-k)||(rt|=R[F+3]<<24-k),rt&U}function Ji(R,I,L){var k=I&7,F=I>>>3;return k<=5?R[F]|=(L&7)<<k:(R[F]|=L<<k&255,R[F+1]=(L&7)>>8-k),I+3}function Ln(R,I,L){var k=I&7,F=I>>>3;return L=(L&1)<<k,R[F]|=L,I+1}function Pn(R,I,L){var k=I&7,F=I>>>3;return L<<=k,R[F]|=L&255,L>>>=8,R[F+1]=L,I+8}function _c(R,I,L){var k=I&7,F=I>>>3;return L<<=k,R[F]|=L&255,L>>>=8,R[F+1]=L&255,R[F+2]=L>>>8,I+16}function ga(R,I){var L=R.length,k=2*L>I?2*L:I+5,F=0;if(L>=I)return R;if(pe){var U=Ix(k);if(R.copy)R.copy(U);else for(;F<R.length;++F)U[F]=R[F];return U}else if(pt){var rt=new Uint8Array(k);if(rt.set)rt.set(R);else for(;F<L;++F)rt[F]=R[F];return rt}return R.length=k,R}function gn(R){for(var I=new Array(R),L=0;L<R;++L)I[L]=0;return I}function ma(R,I,L){var k=1,F=0,U=0,rt=0,dt=0,Z=R.length,st=pt?new Uint16Array(32):gn(32);for(U=0;U<32;++U)st[U]=0;for(U=Z;U<L;++U)R[U]=0;Z=R.length;var ot=pt?new Uint16Array(Z):gn(Z);for(U=0;U<Z;++U)st[F=R[U]]++,k<F&&(k=F),ot[U]=0;for(st[0]=0,U=1;U<=k;++U)st[U+16]=dt=dt+st[U-1]<<1;for(U=0;U<Z;++U)dt=R[U],dt!=0&&(ot[U]=st[dt+16]++);var bt=0;for(U=0;U<Z;++U)if(bt=R[U],bt!=0)for(dt=Lt(ot[U],k)>>k-bt,rt=(1<<k+4-bt)-1;rt>=0;--rt)I[dt|rt<<bt]=bt&15|U<<4;return k}var fr=pt?new Uint16Array(512):gn(512),pi=pt?new Uint16Array(32):gn(32);if(!pt){for(var Ci=0;Ci<512;++Ci)fr[Ci]=0;for(Ci=0;Ci<32;++Ci)pi[Ci]=0}(function(){for(var R=[],I=0;I<32;I++)R.push(5);ma(R,pi,32);var L=[];for(I=0;I<=143;I++)L.push(8);for(;I<=255;I++)L.push(9);for(;I<=279;I++)L.push(7);for(;I<=287;I++)L.push(8);ma(L,fr,288)})();var Pi=(function(){for(var I=pt?new Uint8Array(32768):[],L=0,k=0;L<wt.length-1;++L)for(;k<wt[L+1];++k)I[k]=L;for(;k<32768;++k)I[k]=29;var F=pt?new Uint8Array(259):[];for(L=0,k=0;L<et.length-1;++L)for(;k<et[L+1];++k)F[k]=L;function U(dt,Z){for(var st=0;st<dt.length;){var ot=Math.min(65535,dt.length-st),bt=st+ot==dt.length;for(Z.write_shift(1,+bt),Z.write_shift(2,ot),Z.write_shift(2,~ot&65535);ot-- >0;)Z[Z.l++]=dt[st++]}return Z.l}function rt(dt,Z){for(var st=0,ot=0,bt=pt?new Uint16Array(32768):[];ot<dt.length;){var Dt=Math.min(65535,dt.length-ot);if(Dt<10){for(st=Ji(Z,st,+(ot+Dt==dt.length)),st&7&&(st+=8-(st&7)),Z.l=st/8|0,Z.write_shift(2,Dt),Z.write_shift(2,~Dt&65535);Dt-- >0;)Z[Z.l++]=dt[ot++];st=Z.l*8;continue}st=Ji(Z,st,+(ot+Dt==dt.length)+2);for(var Pt=0;Dt-- >0;){var Tt=dt[ot];Pt=(Pt<<5^Tt)&32767;var Ot=-1,$t=0;if((Ot=bt[Pt])&&(Ot|=ot&-32768,Ot>ot&&(Ot-=32768),Ot<ot))for(;dt[Ot+$t]==dt[ot+$t]&&$t<250;)++$t;if($t>2){Tt=F[$t],Tt<=22?st=Pn(Z,st,yt[Tt+1]>>1)-1:(Pn(Z,st,3),st+=5,Pn(Z,st,yt[Tt-23]>>5),st+=3);var Ae=Tt<8?0:Tt-4>>2;Ae>0&&(_c(Z,st,$t-et[Tt]),st+=Ae),Tt=I[ot-Ot],st=Pn(Z,st,yt[Tt]>>3),st-=3;var we=Tt<4?0:Tt-2>>1;we>0&&(_c(Z,st,ot-Ot-wt[Tt]),st+=we);for(var Oe=0;Oe<$t;++Oe)bt[Pt]=ot&32767,Pt=(Pt<<5^dt[ot])&32767,++ot;Dt-=$t-1}else Tt<=143?Tt=Tt+48:st=Ln(Z,st,1),st=Pn(Z,st,yt[Tt]),bt[Pt]=ot&32767,++ot}st=Pn(Z,st,0)-1}return Z.l=(st+7)/8|0,Z.l}return function(Z,st){return Z.length<8?U(Z,st):rt(Z,st)}})();function Ec(R){var I=gt(50+Math.floor(R.length*1.1)),L=Pi(R,I);return I.slice(0,L)}var bc=pt?new Uint16Array(32768):gn(32768),Ac=pt?new Uint16Array(32768):gn(32768),Ts=pt?new Uint16Array(128):gn(128),Cs=1,$n=1;function va(R,I){var L=ae(R,I)+257;I+=5;var k=ae(R,I)+1;I+=5;var F=ge(R,I)+4;I+=4;for(var U=0,rt=pt?new Uint8Array(19):gn(19),dt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Z=1,st=pt?new Uint8Array(8):gn(8),ot=pt?new Uint8Array(8):gn(8),bt=rt.length,Dt=0;Dt<F;++Dt)rt[X[Dt]]=U=jt(R,I),Z<U&&(Z=U),st[U]++,I+=3;var Pt=0;for(st[0]=0,Dt=1;Dt<=Z;++Dt)ot[Dt]=Pt=Pt+st[Dt-1]<<1;for(Dt=0;Dt<bt;++Dt)(Pt=rt[Dt])!=0&&(dt[Dt]=ot[Pt]++);var Tt=0;for(Dt=0;Dt<bt;++Dt)if(Tt=rt[Dt],Tt!=0){Pt=yt[dt[Dt]]>>8-Tt;for(var Ot=(1<<7-Tt)-1;Ot>=0;--Ot)Ts[Pt|Ot<<Tt]=Tt&7|Dt<<3}var $t=[];for(Z=1;$t.length<L+k;)switch(Pt=Ts[Rt(R,I)],I+=Pt&7,Pt>>>=3){case 16:for(U=3+Qt(R,I),I+=2,Pt=$t[$t.length-1];U-- >0;)$t.push(Pt);break;case 17:for(U=3+jt(R,I),I+=3;U-- >0;)$t.push(0);break;case 18:for(U=11+Rt(R,I),I+=7;U-- >0;)$t.push(0);break;default:$t.push(Pt),Z<Pt&&(Z=Pt);break}var Ae=$t.slice(0,L),we=$t.slice(L);for(Dt=L;Dt<286;++Dt)Ae[Dt]=0;for(Dt=k;Dt<30;++Dt)we[Dt]=0;return Cs=ma(Ae,bc,286),$n=ma(we,Ac,30),I}function Rs(R,I){if(R[0]==3&&!(R[1]&3))return[sa(I),2];for(var L=0,k=0,F=Ix(I||1<<18),U=0,rt=F.length>>>0,dt=0,Z=0;(k&1)==0;){if(k=jt(R,L),L+=3,k>>>1)k>>1==1?(dt=9,Z=5):(L=va(R,L),dt=Cs,Z=$n);else{L&7&&(L+=8-(L&7));var st=R[L>>>3]|R[(L>>>3)+1]<<8;if(L+=32,st>0)for(!I&&rt<U+st&&(F=ga(F,U+st),rt=F.length);st-- >0;)F[U++]=R[L>>>3],L+=8;continue}for(;;){!I&&rt<U+32767&&(F=ga(F,U+32767),rt=F.length);var ot=ce(R,L,dt),bt=k>>>1==1?fr[ot]:bc[ot];if(L+=bt&15,bt>>>=4,(bt>>>8&255)===0)F[U++]=bt;else{if(bt==256)break;bt-=257;var Dt=bt<8?0:bt-4>>2;Dt>5&&(Dt=0);var Pt=U+et[bt];Dt>0&&(Pt+=ce(R,L,Dt),L+=Dt),ot=ce(R,L,Z),bt=k>>>1==1?pi[ot]:Ac[ot],L+=bt&15,bt>>>=4;var Tt=bt<4?0:bt-2>>1,Ot=wt[bt];for(Tt>0&&(Ot+=ce(R,L,Tt),L+=Tt),!I&&rt<Pt&&(F=ga(F,Pt+100),rt=F.length);U<Pt;)F[U]=F[U-Ot],++U}}}return I?[F,L+7>>>3]:[F.slice(0,U),L+7>>>3]}function wc(R,I){var L=R.slice(R.l||0),k=Rs(L,I);return R.l+=k[1],k[0]}function Ro(R,I){if(R)typeof console<"u"&&console.error(I);else throw new Error(I)}function Do(R,I){var L=R;hn(L,0);var k=[],F=[],U={FileIndex:k,FullPaths:F};O(U,{root:I.root});for(var rt=L.length-4;(L[rt]!=80||L[rt+1]!=75||L[rt+2]!=5||L[rt+3]!=6)&&rt>=0;)--rt;L.l=rt+4,L.l+=4;var dt=L.read_shift(2);L.l+=6;var Z=L.read_shift(4);for(L.l=Z,rt=0;rt<dt;++rt){L.l+=20;var st=L.read_shift(4),ot=L.read_shift(4),bt=L.read_shift(2),Dt=L.read_shift(2),Pt=L.read_shift(2);L.l+=8;var Tt=L.read_shift(4),Ot=c(L.slice(L.l+bt,L.l+bt+Dt));L.l+=bt+Dt+Pt;var $t=L.l;L.l=Tt+4,Mo(L,st,ot,U,Ot),L.l=$t}return U}function Mo(R,I,L,k,F){R.l+=2;var U=R.read_shift(2),rt=R.read_shift(2),dt=l(R);if(U&8257)throw new Error("Unsupported ZIP encryption");for(var Z=R.read_shift(4),st=R.read_shift(4),ot=R.read_shift(4),bt=R.read_shift(2),Dt=R.read_shift(2),Pt="",Tt=0;Tt<bt;++Tt)Pt+=String.fromCharCode(R[R.l++]);if(Dt){var Ot=c(R.slice(R.l,R.l+Dt));(Ot[21589]||{}).mt&&(dt=Ot[21589].mt),((F||{})[21589]||{}).mt&&(dt=F[21589].mt)}R.l+=Dt;var $t=R.slice(R.l,R.l+st);switch(rt){case 8:$t=j(R,ot);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+rt)}var Ae=!1;U&8&&(Z=R.read_shift(4),Z==134695760&&(Z=R.read_shift(4),Ae=!0),st=R.read_shift(4),ot=R.read_shift(4)),st!=I&&Ro(Ae,"Bad compressed size: "+I+" != "+st),ot!=L&&Ro(Ae,"Bad uncompressed size: "+L+" != "+ot),ai(k,Pt,$t,{unsafe:!0,mt:dt})}function Ds(R,I){var L=I||{},k=[],F=[],U=gt(1),rt=L.compression?8:0,dt=0,Z=0,st=0,ot=0,bt=0,Dt=R.FullPaths[0],Pt=Dt,Tt=R.FileIndex[0],Ot=[],$t=0;for(Z=1;Z<R.FullPaths.length;++Z)if(Pt=R.FullPaths[Z].slice(Dt.length),Tt=R.FileIndex[Z],!(!Tt.size||!Tt.content||Pt=="Sh33tJ5")){var Ae=ot,we=gt(Pt.length);for(st=0;st<Pt.length;++st)we.write_shift(1,Pt.charCodeAt(st)&127);we=we.slice(0,we.l),Ot[bt]=rR.buf(Tt.content,0);var Oe=Tt.content;rt==8&&(Oe=z(Oe)),U=gt(30),U.write_shift(4,67324752),U.write_shift(2,20),U.write_shift(2,dt),U.write_shift(2,rt),Tt.mt?a(U,Tt.mt):U.write_shift(4,0),U.write_shift(-4,Ot[bt]),U.write_shift(4,Oe.length),U.write_shift(4,Tt.content.length),U.write_shift(2,we.length),U.write_shift(2,0),ot+=U.length,k.push(U),ot+=we.length,k.push(we),ot+=Oe.length,k.push(Oe),U=gt(46),U.write_shift(4,33639248),U.write_shift(2,0),U.write_shift(2,20),U.write_shift(2,dt),U.write_shift(2,rt),U.write_shift(4,0),U.write_shift(-4,Ot[bt]),U.write_shift(4,Oe.length),U.write_shift(4,Tt.content.length),U.write_shift(2,we.length),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(4,0),U.write_shift(4,Ae),$t+=U.l,F.push(U),$t+=we.length,F.push(we),++bt}return U=gt(22),U.write_shift(4,101010256),U.write_shift(2,0),U.write_shift(2,0),U.write_shift(2,bt),U.write_shift(2,bt),U.write_shift(4,$t),U.write_shift(4,ot),U.write_shift(2,0),bi([bi(k),bi(F),U])}var xa={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Sc(R,I){if(R.ctype)return R.ctype;var L=R.name||"",k=L.match(/\.([^\.]+)$/);return k&&xa[k[1]]||I&&(k=(L=I).match(/[\.\\]([^\.\\])+$/),k&&xa[k[1]])?xa[k[1]]:"application/octet-stream"}function Tc(R){for(var I=ec(R),L=[],k=0;k<I.length;k+=76)L.push(I.slice(k,k+76));return L.join(`\r
`)+`\r
`}function No(R){var I=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(st){var ot=st.charCodeAt(0).toString(16).toUpperCase();return"="+(ot.length==1?"0"+ot:ot)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var L=[],k=I.split(`\r
`),F=0;F<k.length;++F){var U=k[F];if(U.length==0){L.push("");continue}for(var rt=0;rt<U.length;){var dt=76,Z=U.slice(rt,rt+dt);Z.charAt(dt-1)=="="?dt--:Z.charAt(dt-2)=="="?dt-=2:Z.charAt(dt-3)=="="&&(dt-=3),Z=U.slice(rt,rt+dt),rt+=dt,rt<U.length&&(Z+="="),L.push(Z)}}return L.join(`\r
`)}function Oo(R){for(var I=[],L=0;L<R.length;++L){for(var k=R[L];L<=R.length&&k.charAt(k.length-1)=="=";)k=k.slice(0,k.length-1)+R[++L];I.push(k)}for(var F=0;F<I.length;++F)I[F]=I[F].replace(/[=][0-9A-Fa-f]{2}/g,function(U){return String.fromCharCode(parseInt(U.slice(1),16))});return Wn(I.join(`\r
`))}function Cc(R,I,L){for(var k="",F="",U="",rt,dt=0;dt<10;++dt){var Z=I[dt];if(!Z||Z.match(/^\s*$/))break;var st=Z.match(/^(.*?):\s*([^\s].*)$/);if(st)switch(st[1].toLowerCase()){case"content-location":k=st[2].trim();break;case"content-type":U=st[2].trim();break;case"content-transfer-encoding":F=st[2].trim();break}}switch(++dt,F.toLowerCase()){case"base64":rt=Wn(Ur(I.slice(dt).join("")));break;case"quoted-printable":rt=Oo(I.slice(dt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+F)}var ot=ai(R,k.slice(L.length),rt,{unsafe:!0});U&&(ot.ctype=U)}function Xh(R,I){if(kt(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var L=I&&I.root||"",k=(pe&&Buffer.isBuffer(R)?R.toString("binary"):kt(R)).split(`\r
`),F=0,U="";for(F=0;F<k.length;++F)if(U=k[F],!!/^Content-Location:/i.test(U)&&(U=U.slice(U.indexOf("file")),L||(L=U.slice(0,U.lastIndexOf("/")+1)),U.slice(0,L.length)!=L))for(;L.length>0&&(L=L.slice(0,L.length-1),L=L.slice(0,L.lastIndexOf("/")+1),U.slice(0,L.length)!=L););var rt=(k[1]||"").match(/boundary="(.*?)"/);if(!rt)throw new Error("MAD cannot find boundary");var dt="--"+(rt[1]||""),Z=[],st=[],ot={FileIndex:Z,FullPaths:st};O(ot);var bt,Dt=0;for(F=0;F<k.length;++F){var Pt=k[F];Pt!==dt&&Pt!==dt+"--"||(Dt++&&Cc(ot,k.slice(bt,F),L),bt=F)}return ot}function qn(R,I){var L=I||{},k=L.boundary||"SheetJS";k="------="+k;for(var F=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+k.slice(2)+'"',"","",""],U=R.FullPaths[0],rt=U,dt=R.FileIndex[0],Z=1;Z<R.FullPaths.length;++Z)if(rt=R.FullPaths[Z].slice(U.length),dt=R.FileIndex[Z],!(!dt.size||!dt.content||rt=="Sh33tJ5")){rt=rt.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function($t){return"_x"+$t.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function($t){return"_u"+$t.charCodeAt(0).toString(16)+"_"});for(var st=dt.content,ot=pe&&Buffer.isBuffer(st)?st.toString("binary"):kt(st),bt=0,Dt=Math.min(1024,ot.length),Pt=0,Tt=0;Tt<=Dt;++Tt)(Pt=ot.charCodeAt(Tt))>=32&&Pt<128&&++bt;var Ot=bt>=Dt*4/5;F.push(k),F.push("Content-Location: "+(L.root||"file:///C:/SheetJS/")+rt),F.push("Content-Transfer-Encoding: "+(Ot?"quoted-printable":"base64")),F.push("Content-Type: "+Sc(dt,rt)),F.push(""),F.push(Ot?No(ot):Tc(ot))}return F.push(k+`--\r
`),F.join(`\r
`)}function si(R){var I={};return O(I,R),I}function ai(R,I,L,k){var F=k&&k.unsafe;F||O(R);var U=!F&&Re.find(R,I);if(!U){var rt=R.FullPaths[0];I.slice(0,rt.length)==rt?rt=I:(rt.slice(-1)!="/"&&(rt+="/"),rt=(rt+I).replace("//","/")),U={name:r(I),type:2},R.FileIndex.push(U),R.FullPaths.push(rt),F||Re.utils.cfb_gc(R)}return U.content=L,U.size=L?L.length:0,k&&(k.CLSID&&(U.clsid=k.CLSID),k.mt&&(U.mt=k.mt),k.ct&&(U.ct=k.ct)),U}function zr(R,I){O(R);var L=Re.find(R,I);if(L){for(var k=0;k<R.FileIndex.length;++k)if(R.FileIndex[k]==L)return R.FileIndex.splice(k,1),R.FullPaths.splice(k,1),!0}return!1}function Lo(R,I,L){O(R);var k=Re.find(R,I);if(k){for(var F=0;F<R.FileIndex.length;++F)if(R.FileIndex[F]==k)return R.FileIndex[F].name=r(L),R.FullPaths[F]=L,!0}return!1}function Yh(R){M(R,!0)}return t.find=Y,t.read=B,t.parse=p,t.write=G,t.writeFile=St,t.utils={cfb_new:si,cfb_add:ai,cfb_del:zr,cfb_mov:Lo,cfb_gc:Yh,ReadShift:Gl,CheckField:Z_,prep_blob:hn,bconcat:bi,use_zlib:P,_deflateRaw:Ec,_inflateRaw:wc,consts:nt},t})();function sR(n){return typeof n=="string"?Ih(n):Array.isArray(n)?NC(n):n}function gc(n,t,e){if(typeof Deno<"u"){if(e&&typeof t=="string")switch(e){case"utf8":t=new TextEncoder(e).encode(t);break;case"binary":t=Ih(t);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(n,t)}var i=e=="utf8"?nc(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(i,n);if(typeof Blob<"u"){var r=new Blob([sR(i)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(r,n);if(typeof saveAs<"u")return saveAs(r,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(r);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:n,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=n,l.href=a,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(n);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=pc(t)),c.write(t),c.close(),t}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+n)}function Ti(n){for(var t=Object.keys(n),e=[],i=0;i<t.length;++i)Object.prototype.hasOwnProperty.call(n,t[i])&&e.push(t[i]);return e}function Wx(n,t){for(var e=[],i=Ti(n),r=0;r!==i.length;++r)e[n[i[r]][t]]==null&&(e[n[i[r]][t]]=i[r]);return e}function Sp(n){for(var t=[],e=Ti(n),i=0;i!==e.length;++i)t[n[e[i]]]=e[i];return t}function Hh(n){for(var t=[],e=Ti(n),i=0;i!==e.length;++i)t[n[e[i]]]=parseInt(e[i],10);return t}function aR(n){for(var t=[],e=Ti(n),i=0;i!==e.length;++i)t[n[e[i]]]==null&&(t[n[e[i]]]=[]),t[n[e[i]]].push(e[i]);return t}var xh=new Date(1899,11,30,0,0,0);function Qi(n,t){var e=n.getTime(),i=xh.getTime()+(n.getTimezoneOffset()-xh.getTimezoneOffset())*6e4;return(e-i)/(1440*60*1e3)}var k_=new Date,oR=xh.getTime()+(k_.getTimezoneOffset()-xh.getTimezoneOffset())*6e4,Xx=k_.getTimezoneOffset();function F_(n){var t=new Date;return t.setTime(n*24*60*60*1e3+oR),t.getTimezoneOffset()!==Xx&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Xx)*6e4),t}var Yx=new Date("2017-02-19T19:06:09.000Z"),I_=isNaN(Yx.getFullYear())?new Date("2/19/17"):Yx,lR=I_.getFullYear()==2017;function ji(n,t){var e=new Date(n);if(lR)return t>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):t<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(n instanceof Date)return n;if(I_.getFullYear()==1917&&!isNaN(e.getFullYear())){var i=e.getFullYear();return n.indexOf(""+i)>-1||e.setFullYear(e.getFullYear()+100),e}var r=n.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return n.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function jh(n,t){if(pe&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var e={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return e[a]||a})}catch{}for(var i=[],r=0;r!=n.length;++r)i.push(String.fromCharCode(n[r]));return i.join("")}function Zi(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var t={};for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=Zi(n[e]));return t}function He(n,t){for(var e="";e.length<t;)e+=n;return e}function Ir(n){var t=Number(n);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(n))return t;var e=1,i=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(t=Number(i))||(i=i.replace(/[(](.*)[)]/,function(r,a){return e=-e,a}),!isNaN(t=Number(i)))?t/e:t}var cR=["january","february","march","april","may","june","july","august","september","october","november","december"];function ic(n){var t=new Date(n),e=new Date(NaN),i=t.getYear(),r=t.getMonth(),a=t.getDate();if(isNaN(a))return e;var l=n.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&cR.indexOf(l)==-1)return e}else if(l.match(/[a-z]/))return e;return i<0||i>8099?e:(r>0||a>1)&&i!=101?t:n.match(/[^-0-9:,\/\\]/)?e:t}function Zt(n,t,e){if(n.FullPaths){if(typeof e=="string"){var i;return pe?i=jr(e):i=OC(e),Re.utils.cfb_add(n,t,i)}Re.utils.cfb_add(n,t,e)}else n.file(t,e)}function Tp(){return Re.utils.cfb_new()}var ei=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,uR={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Cp=Sp(uR),Rp=/[&<>'"]/g,hR=/[\u0000-\u0008\u000b-\u001f]/g;function Ee(n){var t=n+"";return t.replace(Rp,function(e){return Cp[e]}).replace(hR,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function $x(n){return Ee(n).replace(/ /g,"_x0020_")}var B_=/[\u0000-\u001f]/g;function fR(n){var t=n+"";return t.replace(Rp,function(e){return Cp[e]}).replace(/\n/g,"<br/>").replace(B_,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function dR(n){var t=n+"";return t.replace(Rp,function(e){return Cp[e]}).replace(B_,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function pR(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function gR(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function E0(n){for(var t="",e=0,i=0,r=0,a=0,l=0,c=0;e<n.length;){if(i=n.charCodeAt(e++),i<128){t+=String.fromCharCode(i);continue}if(r=n.charCodeAt(e++),i>191&&i<224){l=(i&31)<<6,l|=r&63,t+=String.fromCharCode(l);continue}if(a=n.charCodeAt(e++),i<240){t+=String.fromCharCode((i&15)<<12|(r&63)<<6|a&63);continue}l=n.charCodeAt(e++),c=((i&7)<<18|(r&63)<<12|(a&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function qx(n){var t=sa(2*n.length),e,i,r=1,a=0,l=0,c;for(i=0;i<n.length;i+=r)r=1,(c=n.charCodeAt(i))<128?e=c:c<224?(e=(c&31)*64+(n.charCodeAt(i+1)&63),r=2):c<240?(e=(c&15)*4096+(n.charCodeAt(i+1)&63)*64+(n.charCodeAt(i+2)&63),r=3):(r=4,e=(c&7)*262144+(n.charCodeAt(i+1)&63)*4096+(n.charCodeAt(i+2)&63)*64+(n.charCodeAt(i+3)&63),e-=65536,l=55296+(e>>>10&1023),e=56320+(e&1023)),l!==0&&(t[a++]=l&255,t[a++]=l>>>8,l=0),t[a++]=e%256,t[a++]=e>>>8;return t.slice(0,a).toString("ucs2")}function Kx(n){return jr(n,"binary").toString("utf8")}var Zu="foo bar bazâð£",Vl=pe&&(Kx(Zu)==E0(Zu)&&Kx||qx(Zu)==E0(Zu)&&qx)||E0,nc=pe?function(n){return jr(n,"utf8").toString("binary")}:function(n){for(var t=[],e=0,i=0,r=0;e<n.length;)switch(i=n.charCodeAt(e++),!0){case i<128:t.push(String.fromCharCode(i));break;case i<2048:t.push(String.fromCharCode(192+(i>>6))),t.push(String.fromCharCode(128+(i&63)));break;case(i>=55296&&i<57344):i-=55296,r=n.charCodeAt(e++)-56320+(i<<10),t.push(String.fromCharCode(240+(r>>18&7))),t.push(String.fromCharCode(144+(r>>12&63))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)));break;default:t.push(String.fromCharCode(224+(i>>12))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)))}return t.join("")},mR=(function(){var n=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(e){for(var i=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),r=0;r<n.length;++r)i=i.replace(n[r][0],n[r][1]);return i}})(),U_=/(^\s|\s$|\n)/;function Ai(n,t){return"<"+n+(t.match(U_)?' xml:space="preserve"':"")+">"+t+"</"+n+">"}function rc(n){return Ti(n).map(function(t){return" "+t+'="'+n[t]+'"'}).join("")}function Mt(n,t,e){return"<"+n+(e!=null?rc(e):"")+(t!=null?(t.match(U_)?' xml:space="preserve"':"")+">"+t+"</"+n:"/")+">"}function Z0(n,t){try{return n.toISOString().replace(/\.\d*/,"")}catch(e){if(t)throw e}return""}function vR(n,t){switch(typeof n){case"string":var e=Mt("vt:lpwstr",Ee(n));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return Mt((n|0)==n?"vt:i4":"vt:r8",Ee(String(n)));case"boolean":return Mt("vt:bool",n?"true":"false")}if(n instanceof Date)return Mt("vt:filetime",Z0(n));throw new Error("Unable to serialize "+n)}var hi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},wo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],fn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function xR(n,t){for(var e=1-2*(n[t+7]>>>7),i=((n[t+7]&127)<<4)+(n[t+6]>>>4&15),r=n[t+6]&15,a=5;a>=0;--a)r=r*256+n[t+a];return i==2047?r==0?e*(1/0):NaN:(i==0?i=-1022:(i-=1023,r+=Math.pow(2,52)),e*Math.pow(2,i-52)*r)}function yR(n,t,e){var i=(t<0||1/t==-1/0?1:0)<<7,r=0,a=0,l=i?-t:t;isFinite(l)?l==0?r=a=0:(r=Math.floor(Math.log(l)/Math.LN2),a=l*Math.pow(2,52-r),r<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?r=-1022:(a-=Math.pow(2,52),r+=1023)):(r=2047,a=isNaN(t)?26985:0);for(var c=0;c<=5;++c,a/=256)n[e+c]=a&255;n[e+6]=(r&15)<<4|a&15,n[e+7]=r>>4|i}var Qx=function(n){for(var t=[],e=10240,i=0;i<n[0].length;++i)if(n[0][i])for(var r=0,a=n[0][i].length;r<a;r+=e)t.push.apply(t,n[0][i].slice(r,r+e));return t},Zx=pe?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(t){return Buffer.isBuffer(t)?t:jr(t)})):Qx(n)}:Qx,Jx=function(n,t,e){for(var i=[],r=t;r<e;r+=2)i.push(String.fromCharCode(Il(n,r)));return i.join("").replace(zl,"")},Dp=pe?function(n,t,e){return Buffer.isBuffer(n)?n.toString("utf16le",t,e).replace(zl,""):Jx(n,t,e)}:Jx,ty=function(n,t,e){for(var i=[],r=t;r<t+e;++r)i.push(("0"+n[r].toString(16)).slice(-2));return i.join("")},H_=pe?function(n,t,e){return Buffer.isBuffer(n)?n.toString("hex",t,t+e):ty(n,t,e)}:ty,ey=function(n,t,e){for(var i=[],r=t;r<e;r++)i.push(String.fromCharCode(ao(n,r)));return i.join("")},mc=pe?function(t,e,i){return Buffer.isBuffer(t)?t.toString("utf8",e,i):ey(t,e,i)}:ey,j_=function(n,t){var e=dn(n,t);return e>0?mc(n,t+4,t+4+e-1):""},z_=j_,V_=function(n,t){var e=dn(n,t);return e>0?mc(n,t+4,t+4+e-1):""},G_=V_,W_=function(n,t){var e=2*dn(n,t);return e>0?mc(n,t+4,t+4+e-1):""},X_=W_,Y_=function(t,e){var i=dn(t,e);return i>0?Dp(t,e+4,e+4+i):""},$_=Y_,q_=function(n,t){var e=dn(n,t);return e>0?mc(n,t+4,t+4+e):""},K_=q_,Q_=function(n,t){return xR(n,t)},yh=Q_,Mp=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};pe&&(z_=function(t,e){if(!Buffer.isBuffer(t))return j_(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},G_=function(t,e){if(!Buffer.isBuffer(t))return V_(t,e);var i=t.readUInt32LE(e);return i>0?t.toString("utf8",e+4,e+4+i-1):""},X_=function(t,e){if(!Buffer.isBuffer(t))return W_(t,e);var i=2*t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i-1)},$_=function(t,e){if(!Buffer.isBuffer(t))return Y_(t,e);var i=t.readUInt32LE(e);return t.toString("utf16le",e+4,e+4+i)},K_=function(t,e){if(!Buffer.isBuffer(t))return q_(t,e);var i=t.readUInt32LE(e);return t.toString("utf8",e+4,e+4+i)},yh=function(t,e){return Buffer.isBuffer(t)?t.readDoubleLE(e):Q_(t,e)},Mp=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var ao=function(n,t){return n[t]},Il=function(n,t){return n[t+1]*256+n[t]},_R=function(n,t){var e=n[t+1]*256+n[t];return e<32768?e:(65535-e+1)*-1},dn=function(n,t){return n[t+3]*(1<<24)+(n[t+2]<<16)+(n[t+1]<<8)+n[t]},Ks=function(n,t){return n[t+3]<<24|n[t+2]<<16|n[t+1]<<8|n[t]},ER=function(n,t){return n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3]};function Gl(n,t){var e="",i,r,a=[],l,c,h,f;switch(t){case"dbcs":if(f=this.l,pe&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*n).toString("utf16le");else for(h=0;h<n;++h)e+=String.fromCharCode(Il(this,f)),f+=2;n*=2;break;case"utf8":e=mc(this,this.l,this.l+n);break;case"utf16le":n*=2,e=Dp(this,this.l,this.l+n);break;case"wstr":return Gl.call(this,n,"dbcs");case"lpstr-ansi":e=z_(this,this.l),n=4+dn(this,this.l);break;case"lpstr-cp":e=G_(this,this.l),n=4+dn(this,this.l);break;case"lpwstr":e=X_(this,this.l),n=4+2*dn(this,this.l);break;case"lpp4":n=4+dn(this,this.l),e=$_(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+dn(this,this.l),e=K_(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,e="";(l=ao(this,this.l+n++))!==0;)a.push(qu(l));e=a.join("");break;case"_wstr":for(n=0,e="";(l=Il(this,this.l+n))!==0;)a.push(qu(l)),n+=2;n+=2,e=a.join("");break;case"dbcs-cont":for(e="",f=this.l,h=0;h<n;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return l=ao(this,f),this.l=f+1,c=Gl.call(this,n-h,l?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(qu(Il(this,f))),f+=2}e=a.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(e="",f=this.l,h=0;h!=n;++h){if(this.lens&&this.lens.indexOf(f)!==-1)return l=ao(this,f),this.l=f+1,c=Gl.call(this,n-h,l?"dbcs-cont":"sbcs-cont"),a.join("")+c;a.push(qu(ao(this,f))),f+=1}e=a.join("");break;default:switch(n){case 1:return i=ao(this,this.l),this.l++,i;case 2:return i=(t==="i"?_R:Il)(this,this.l),this.l+=2,i;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(i=(n>0?Ks:ER)(this,this.l),this.l+=4,i):(r=dn(this,this.l),this.l+=4,r);case 8:case-8:if(t==="f")return n==8?r=yh(this,this.l):r=yh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,r;n=8;case 16:e=H_(this,this.l,n);break}}return this.l+=n,e}var bR=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255,n[e+2]=t>>>16&255,n[e+3]=t>>>24&255},AR=function(n,t,e){n[e]=t&255,n[e+1]=t>>8&255,n[e+2]=t>>16&255,n[e+3]=t>>24&255},wR=function(n,t,e){n[e]=t&255,n[e+1]=t>>>8&255};function SR(n,t,e){var i=0,r=0;if(e==="dbcs"){for(r=0;r!=t.length;++r)wR(this,t.charCodeAt(r),this.l+2*r);i=2*t.length}else if(e==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=t.length;++r)this[this.l+r]=t.charCodeAt(r)&255;i=t.length}else if(e==="hex"){for(;r<n;++r)this[this.l++]=parseInt(t.slice(2*r,2*r+2),16)||0;return this}else if(e==="utf16le"){var a=Math.min(this.l+n,this.length);for(r=0;r<Math.min(t.length,n);++r){var l=t.charCodeAt(r);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(n){case 1:i=1,this[this.l]=t&255;break;case 2:i=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:i=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:i=4,bR(this,t,this.l);break;case 8:if(i=8,e==="f"){yR(this,t,this.l);break}case 16:break;case-4:i=4,AR(this,t,this.l);break}return this.l+=i,this}function Z_(n,t){var e=H_(this,this.l,n.length>>1);if(e!==n)throw new Error(t+"Expected "+n+" saw "+e);this.l+=n.length>>1}function hn(n,t){n.l=t,n.read_shift=Gl,n.chk=Z_,n.write_shift=SR}function hr(n,t){n.l+=t}function gt(n){var t=sa(n);return hn(t,0),t}function Ki(){var n=[],t=pe?256:2048,e=function(f){var p=gt(f);return hn(p,0),p},i=e(t),r=function(){i&&(i.length>i.l&&(i=i.slice(0,i.l),i.l=i.length),i.length>0&&n.push(i),i=null)},a=function(f){return i&&f<i.length-i.l?i:(r(),i=e(Math.max(f+1,t)))},l=function(){return r(),bi(n)},c=function(f){r(),i=f,i.l==null&&(i.l=i.length),a(t)};return{next:a,push:c,end:l,_bufs:n}}function _t(n,t,e,i){var r=+t,a;if(!isNaN(r)){i||(i=xP[r].p||(e||[]).length||0),a=1+(r>=128?1:0)+1,i>=128&&++a,i>=16384&&++a,i>=2097152&&++a;var l=n.next(a);r<=127?l.write_shift(1,r):(l.write_shift(1,(r&127)+128),l.write_shift(1,r>>7));for(var c=0;c!=4;++c)if(i>=128)l.write_shift(1,(i&127)+128),i>>=7;else{l.write_shift(1,i);break}i>0&&Mp(e)&&n.push(e)}}function Wl(n,t,e){var i=Zi(n);if(t.s?(i.cRel&&(i.c+=t.s.c),i.rRel&&(i.r+=t.s.r)):(i.cRel&&(i.c+=t.c),i.rRel&&(i.r+=t.r)),!e||e.biff<12){for(;i.c>=256;)i.c-=256;for(;i.r>=65536;)i.r-=65536}return i}function iy(n,t,e){var i=Zi(n);return i.s=Wl(i.s,t.s,e),i.e=Wl(i.e,t.s,e),i}function Xl(n,t){if(n.cRel&&n.c<0)for(n=Zi(n);n.c<0;)n.c+=t>8?16384:256;if(n.rRel&&n.r<0)for(n=Zi(n);n.r<0;)n.r+=t>8?1048576:t>5?65536:16384;var e=be(n);return!n.cRel&&n.cRel!=null&&(e=RR(e)),!n.rRel&&n.rRel!=null&&(e=TR(e)),e}function b0(n,t){return n.s.r==0&&!n.s.rRel&&n.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Oi(n.s.c)+":"+(n.e.cRel?"":"$")+Oi(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(t.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Si(n.s.r)+":"+(n.e.rRel?"":"$")+Si(n.e.r):Xl(n.s,t.biff)+":"+Xl(n.e,t.biff)}function Np(n){return parseInt(CR(n),10)-1}function Si(n){return""+(n+1)}function TR(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function CR(n){return n.replace(/\$(\d+)$/,"$1")}function Op(n){for(var t=DR(n),e=0,i=0;i!==t.length;++i)e=26*e+t.charCodeAt(i)-64;return e-1}function Oi(n){if(n<0)throw new Error("invalid column "+n);var t="";for(++n;n;n=Math.floor((n-1)/26))t=String.fromCharCode((n-1)%26+65)+t;return t}function RR(n){return n.replace(/^([A-Z])/,"$$$1")}function DR(n){return n.replace(/^\$([A-Z])/,"$1")}function MR(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function fi(n){for(var t=0,e=0,i=0;i<n.length;++i){var r=n.charCodeAt(i);r>=48&&r<=57?t=10*t+(r-48):r>=65&&r<=90&&(e=26*e+(r-64))}return{c:e-1,r:t-1}}function be(n){for(var t=n.c+1,e="";t;t=(t-1)/26|0)e=String.fromCharCode((t-1)%26+65)+e;return e+(n.r+1)}function pn(n){var t=n.indexOf(":");return t==-1?{s:fi(n),e:fi(n)}:{s:fi(n.slice(0,t)),e:fi(n.slice(t+1))}}function ti(n,t){return typeof t>"u"||typeof t=="number"?ti(n.s,n.e):(typeof n!="string"&&(n=be(n)),typeof t!="string"&&(t=be(t)),n==t?n:n+":"+t)}function Pe(n){var t={s:{c:0,r:0},e:{c:0,r:0}},e=0,i=0,r=0,a=n.length;for(e=0;i<a&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(t.s.c=--e,e=0;i<a&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;if(t.s.r=--e,i===a||r!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++i,e=0;i!=a&&!((r=n.charCodeAt(i)-64)<1||r>26);++i)e=26*e+r;for(t.e.c=--e,e=0;i!=a&&!((r=n.charCodeAt(i)-48)<0||r>9);++i)e=10*e+r;return t.e.r=--e,t}function ny(n,t){var e=n.t=="d"&&t instanceof Date;if(n.z!=null)try{return n.w=bs(n.z,e?Qi(t):t)}catch{}try{return n.w=bs((n.XF||{}).numFmtId||(e?14:0),e?Qi(t):t)}catch{return""+t}}function Hr(n,t,e){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&e&&e.dateNF&&(n.z=e.dateNF),n.t=="e"?vc[n.v]||n.v:t==null?ny(n,n.v):ny(n,t))}function ua(n,t){var e=t&&t.sheet?t.sheet:"Sheet1",i={};return i[e]=n,{SheetNames:[e],Sheets:i}}function J_(n,t,e){var i=e||{},r=n?Array.isArray(n):i.dense,a=n||(r?[]:{}),l=0,c=0;if(a&&i.origin!=null){if(typeof i.origin=="number")l=i.origin;else{var h=typeof i.origin=="string"?fi(i.origin):i.origin;l=h.r,c=h.c}a["!ref"]||(a["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var p=Pe(a["!ref"]);f.s.c=p.s.c,f.s.r=p.s.r,f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),l==-1&&(f.e.r=l=p.e.r+1)}for(var m=0;m!=t.length;++m)if(t[m]){if(!Array.isArray(t[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[m].length;++v)if(!(typeof t[m][v]>"u")){var x={v:t[m][v]},E=l+m,_=c+v;if(f.s.r>E&&(f.s.r=E),f.s.c>_&&(f.s.c=_),f.e.r<E&&(f.e.r=E),f.e.c<_&&(f.e.c=_),t[m][v]&&typeof t[m][v]=="object"&&!Array.isArray(t[m][v])&&!(t[m][v]instanceof Date))x=t[m][v];else if(Array.isArray(x.v)&&(x.f=t[m][v][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(i.nullError)x.t="e",x.v=0;else if(i.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=i.dateNF||je[14],i.cellDates?(x.t="d",x.w=bs(x.z,Qi(x.v))):(x.t="n",x.v=Qi(x.v),x.w=bs(x.z,x.v))):x.t="s";if(r)a[E]||(a[E]=[]),a[E][_]&&a[E][_].z&&(x.z=a[E][_].z),a[E][_]=x;else{var b=be({c:_,r:E});a[b]&&a[b].z&&(x.z=a[b].z),a[b]=x}}}return f.s.c<1e7&&(a["!ref"]=ti(f)),a}function So(n,t){return J_(null,n,t)}function NR(n){return n.read_shift(4,"i")}function Yn(n,t){return t||(t=gt(4)),t.write_shift(4,n),t}function Li(n){var t=n.read_shift(4);return t===0?"":n.read_shift(t,"dbcs")}function di(n,t){var e=!1;return t==null&&(e=!0,t=gt(4+2*n.length)),t.write_shift(4,n.length),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}function OR(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function LR(n,t){return t||(t=gt(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Lp(n,t){var e=n.l,i=n.read_shift(1),r=Li(n),a=[],l={t:r,h:r};if((i&1)!==0){for(var c=n.read_shift(4),h=0;h!=c;++h)a.push(OR(n));l.r=a}else l.r=[{ich:0,ifnt:0}];return n.l=e+t,l}function PR(n,t){var e=!1;return t==null&&(e=!0,t=gt(15+4*n.t.length)),t.write_shift(1,0),di(n.t,t),e?t.slice(0,t.l):t}var kR=Lp;function FR(n,t){var e=!1;return t==null&&(e=!0,t=gt(23+4*n.t.length)),t.write_shift(1,1),di(n.t,t),t.write_shift(4,1),LR({},t),e?t.slice(0,t.l):t}function On(n){var t=n.read_shift(4),e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:t,iStyleRef:e}}function ha(n,t){return t==null&&(t=gt(8)),t.write_shift(-4,n.c),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}function fa(n){var t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:t}}function da(n,t){return t==null&&(t=gt(4)),t.write_shift(3,n.iStyleRef||n.s),t.write_shift(1,0),t}var IR=Li,tE=di;function Pp(n){var t=n.read_shift(4);return t===0||t===4294967295?"":n.read_shift(t,"dbcs")}function _h(n,t){var e=!1;return t==null&&(e=!0,t=gt(127)),t.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&t.write_shift(0,n,"dbcs"),e?t.slice(0,t.l):t}var BR=Li,J0=Pp,kp=_h;function eE(n){var t=n.slice(n.l,n.l+4),e=t[0]&1,i=t[0]&2;n.l+=4;var r=i===0?yh([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ks(t,0)>>2;return e?r/100:r}function iE(n,t){t==null&&(t=gt(4));var e=0,i=0,r=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?i=1:r==(r|0)&&r>=-536870912&&r<1<<29&&(i=1,e=1),i)t.write_shift(-4,((e?r:n)<<2)+(e+2));else throw new Error("unsupported RkNumber "+n)}function nE(n){var t={s:{},e:{}};return t.s.r=n.read_shift(4),t.e.r=n.read_shift(4),t.s.c=n.read_shift(4),t.e.c=n.read_shift(4),t}function UR(n,t){return t||(t=gt(16)),t.write_shift(4,n.s.r),t.write_shift(4,n.e.r),t.write_shift(4,n.s.c),t.write_shift(4,n.e.c),t}var pa=nE,To=UR;function Co(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function aa(n,t){return(t||gt(8)).write_shift(8,n,"f")}function HR(n){var t={},e=n.read_shift(1),i=e>>>1,r=n.read_shift(1),a=n.read_shift(2,"i"),l=n.read_shift(1),c=n.read_shift(1),h=n.read_shift(1);switch(n.l++,i){case 0:t.auto=1;break;case 1:t.index=r;var f=qR[r];f&&(t.rgb=py(f));break;case 2:t.rgb=py([l,c,h]);break;case 3:t.theme=r;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Eh(n,t){if(t||(t=gt(8)),!n||n.auto)return t.write_shift(4,0),t.write_shift(4,0),t;n.index!=null?(t.write_shift(1,2),t.write_shift(1,n.index)):n.theme!=null?(t.write_shift(1,6),t.write_shift(1,n.theme)):(t.write_shift(1,5),t.write_shift(1,0));var e=n.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),t.write_shift(2,e),!n.rgb||n.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var i=n.rgb||"FFFFFF";typeof i=="number"&&(i=("000000"+i.toString(16)).slice(-6)),t.write_shift(1,parseInt(i.slice(0,2),16)),t.write_shift(1,parseInt(i.slice(2,4),16)),t.write_shift(1,parseInt(i.slice(4,6),16)),t.write_shift(1,255)}return t}function jR(n){var t=n.read_shift(1);n.l++;var e={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return e}function zR(n,t){t||(t=gt(2));var e=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return t.write_shift(1,e),t.write_shift(1,0),t}var rE=2,cn=3,Ju=11,bh=19,th=64,VR=65,GR=71,WR=4108,XR=4126,_i=80,ry={1:{n:"CodePage",t:rE},2:{n:"Category",t:_i},3:{n:"PresentationFormat",t:_i},4:{n:"ByteCount",t:cn},5:{n:"LineCount",t:cn},6:{n:"ParagraphCount",t:cn},7:{n:"SlideCount",t:cn},8:{n:"NoteCount",t:cn},9:{n:"HiddenCount",t:cn},10:{n:"MultimediaClipCount",t:cn},11:{n:"ScaleCrop",t:Ju},12:{n:"HeadingPairs",t:WR},13:{n:"TitlesOfParts",t:XR},14:{n:"Manager",t:_i},15:{n:"Company",t:_i},16:{n:"LinksUpToDate",t:Ju},17:{n:"CharacterCount",t:cn},19:{n:"SharedDoc",t:Ju},22:{n:"HyperlinksChanged",t:Ju},23:{n:"AppVersion",t:cn,p:"version"},24:{n:"DigSig",t:VR},26:{n:"ContentType",t:_i},27:{n:"ContentStatus",t:_i},28:{n:"Language",t:_i},29:{n:"Version",t:_i},255:{},2147483648:{n:"Locale",t:bh},2147483651:{n:"Behavior",t:bh},1919054434:{}},sy={1:{n:"CodePage",t:rE},2:{n:"Title",t:_i},3:{n:"Subject",t:_i},4:{n:"Author",t:_i},5:{n:"Keywords",t:_i},6:{n:"Comments",t:_i},7:{n:"Template",t:_i},8:{n:"LastAuthor",t:_i},9:{n:"RevNumber",t:_i},10:{n:"EditTime",t:th},11:{n:"LastPrinted",t:th},12:{n:"CreatedDate",t:th},13:{n:"ModifiedDate",t:th},14:{n:"PageCount",t:cn},15:{n:"WordCount",t:cn},16:{n:"CharCount",t:cn},17:{n:"Thumbnail",t:GR},18:{n:"Application",t:_i},19:{n:"DocSecurity",t:cn},255:{},2147483648:{n:"Locale",t:bh},2147483651:{n:"Behavior",t:bh},1919054434:{}};function YR(n){return n.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var $R=YR([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),qR=Zi($R),vc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},KR={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},eh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function sE(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function aE(n,t){var e=aR(KR),i=[],r;i[i.length]=ei,i[i.length]=Mt("Types",null,{xmlns:hi.CT,"xmlns:xsd":hi.xsd,"xmlns:xsi":hi.xsi}),i=i.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Mt("Default",null,{Extension:h[0],ContentType:h[1]})}));var a=function(h){n[h]&&n[h].length>0&&(r=n[h][0],i[i.length]=Mt("Override",null,{PartName:(r[0]=="/"?"":"/")+r,ContentType:eh[h][t.bookType]||eh[h].xlsx}))},l=function(h){(n[h]||[]).forEach(function(f){i[i.length]=Mt("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:eh[h][t.bookType]||eh[h].xlsx})})},c=function(h){(n[h]||[]).forEach(function(f){i[i.length]=Mt("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:e[h][0]})})};return a("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),i.length>2&&(i[i.length]="</Types>",i[1]=i[1].replace("/>",">")),i.join("")}var he={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function oE(n){var t=n.lastIndexOf("/");return n.slice(0,t+1)+"_rels/"+n.slice(t+1)+".rels"}function vo(n){var t=[ei,Mt("Relationships",null,{xmlns:hi.RELS})];return Ti(n["!id"]).forEach(function(e){t[t.length]=Mt("Relationship",null,n["!id"][e])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function _e(n,t,e,i,r,a){if(r||(r={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),t<0)for(t=n["!idx"];n["!id"]["rId"+t];++t);if(n["!idx"]=t+1,r.Id="rId"+t,r.Type=i,r.Target=e,[he.HLINK,he.XPATH,he.XMISS].indexOf(r.Type)>-1&&(r.TargetMode="External"),n["!id"][r.Id])throw new Error("Cannot rewrite rId "+t);return n["!id"][r.Id]=r,n[("/"+r.Target).replace("//","/")]=r,t}function QR(n){var t=[ei];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<n.length;++e)t.push('  <manifest:file-entry manifest:full-path="'+n[e][0]+'" manifest:media-type="'+n[e][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function ay(n,t,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function ZR(n,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function JR(n){var t=[ei];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=n.length;++e)t.push(ay(n[e][0],n[e][1])),t.push(ZR("",n[e][0]));return t.push(ay("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function lE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+dh.version+"</meta:generator></office:meta></office:document-meta>"}var ea=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function A0(n,t,e,i,r){r[n]!=null||t==null||t===""||(r[n]=t,t=Ee(t),i[i.length]=e?Mt(n,t,e):Ai(n,t))}function cE(n,t){var e=t||{},i=[ei,Mt("cp:coreProperties",null,{"xmlns:cp":hi.CORE_PROPS,"xmlns:dc":hi.dc,"xmlns:dcterms":hi.dcterms,"xmlns:dcmitype":hi.dcmitype,"xmlns:xsi":hi.xsi})],r={};if(!n&&!e.Props)return i.join("");n&&(n.CreatedDate!=null&&A0("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:Z0(n.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r),n.ModifiedDate!=null&&A0("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:Z0(n.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},i,r));for(var a=0;a!=ea.length;++a){var l=ea[a],c=e.Props&&e.Props[l[1]]!=null?e.Props[l[1]]:n?n[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&A0(l[0],c,null,i,r)}return i.length>2&&(i[i.length]="</cp:coreProperties>",i[1]=i[1].replace("/>",">")),i.join("")}var xo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],uE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function hE(n){var t=[],e=Mt;return n||(n={}),n.Application="SheetJS",t[t.length]=ei,t[t.length]=Mt("Properties",null,{xmlns:hi.EXT_PROPS,"xmlns:vt":hi.vt}),xo.forEach(function(i){if(n[i[1]]!==void 0){var r;switch(i[2]){case"string":r=Ee(String(n[i[1]]));break;case"bool":r=n[i[1]]?"true":"false";break}r!==void 0&&(t[t.length]=e(i[0],r))}}),t[t.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=e("TitlesOfParts",e("vt:vector",n.SheetNames.map(function(i){return"<vt:lpstr>"+Ee(i)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function fE(n){var t=[ei,Mt("Properties",null,{xmlns:hi.CUST_PROPS,"xmlns:vt":hi.vt})];if(!n)return t.join("");var e=1;return Ti(n).forEach(function(r){++e,t[t.length]=Mt("property",vR(n[r]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Ee(r)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var oy={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function tD(n,t){var e=[];return Ti(oy).map(function(i){for(var r=0;r<ea.length;++r)if(ea[r][1]==i)return ea[r];for(r=0;r<xo.length;++r)if(xo[r][1]==i)return xo[r];throw i}).forEach(function(i){if(n[i[1]]!=null){var r=t&&t.Props&&t.Props[i[1]]!=null?t.Props[i[1]]:n[i[1]];switch(i[2]){case"date":r=new Date(r).toISOString().replace(/\.\d*Z/,"Z");break}typeof r=="number"?r=String(r):r===!0||r===!1?r=r?"1":"0":r instanceof Date&&(r=new Date(r).toISOString().replace(/\.\d*Z/,"")),e.push(Ai(oy[i[1]]||i[1],r))}}),Mt("DocumentProperties",e.join(""),{xmlns:fn.o})}function eD(n,t){var e=["Worksheets","SheetNames"],i="CustomDocumentProperties",r=[];return n&&Ti(n).forEach(function(a){if(Object.prototype.hasOwnProperty.call(n,a)){for(var l=0;l<ea.length;++l)if(a==ea[l][1])return;for(l=0;l<xo.length;++l)if(a==xo[l][1])return;for(l=0;l<e.length;++l)if(a==e[l])return;var c=n[a],h="string";typeof c=="number"?(h="float",c=String(c)):c===!0||c===!1?(h="boolean",c=c?"1":"0"):c=String(c),r.push(Mt($x(a),c,{"dt:dt":h}))}}),t&&Ti(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(n&&Object.prototype.hasOwnProperty.call(n,a))){var l=t[a],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),r.push(Mt($x(a),l,{"dt:dt":c}))}}),"<"+i+' xmlns="'+fn.o+'">'+r.join("")+"</"+i+">"}function iD(n){var t=typeof n=="string"?new Date(Date.parse(n)):n,e=t.getTime()/1e3+11644473600,i=e%Math.pow(2,32),r=(e-i)/Math.pow(2,32);i*=1e7,r*=1e7;var a=i/Math.pow(2,32)|0;a>0&&(i=i%Math.pow(2,32),r+=a);var l=gt(8);return l.write_shift(4,i),l.write_shift(4,r),l}function ly(n,t){var e=gt(4),i=gt(4);switch(e.write_shift(4,n==80?31:n),n){case 3:i.write_shift(-4,t);break;case 5:i=gt(8),i.write_shift(8,t,"f");break;case 11:i.write_shift(4,t?1:0);break;case 64:i=iD(t);break;case 31:case 80:for(i=gt(4+2*(t.length+1)+(t.length%2?0:2)),i.write_shift(4,t.length+1),i.write_shift(0,t,"dbcs");i.l!=i.length;)i.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+t)}return bi([e,i])}var dE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function nD(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function cy(n,t,e){var i=gt(8),r=[],a=[],l=8,c=0,h=gt(8),f=gt(8);if(h.write_shift(4,2),h.write_shift(4,1200),f.write_shift(4,1),a.push(h),r.push(f),l+=8+h.length,!t){f=gt(8),f.write_shift(4,0),r.unshift(f);var p=[gt(4)];for(p[0].write_shift(4,n.length),c=0;c<n.length;++c){var m=n[c][0];for(h=gt(8+2*(m.length+1)+(m.length%2?0:2)),h.write_shift(4,c+2),h.write_shift(4,m.length+1),h.write_shift(0,m,"dbcs");h.l!=h.length;)h.write_shift(1,0);p.push(h)}h=bi(p),a.unshift(h),l+=8+h.length}for(c=0;c<n.length;++c)if(!(t&&!t[n[c][0]])&&!(dE.indexOf(n[c][0])>-1||uE.indexOf(n[c][0])>-1)&&n[c][1]!=null){var v=n[c][1],x=0;if(t){x=+t[n[c][0]];var E=e[x];if(E.p=="version"&&typeof v=="string"){var _=v.split(".");v=(+_[0]<<16)+(+_[1]||0)}h=ly(E.t,v)}else{var b=nD(v);b==-1&&(b=31,v=String(v)),h=ly(b,v)}a.push(h),f=gt(8),f.write_shift(4,t?x:2+c),r.push(f),l+=8+h.length}var A=8*(a.length+1);for(c=0;c<a.length;++c)r[c].write_shift(4,A),A+=a[c].length;return i.write_shift(4,l),i.write_shift(4,a.length),bi([i].concat(r).concat(a))}function uy(n,t,e,i,r,a){var l=gt(r?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,Re.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,r?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,r?68:48);var h=cy(n,e,i);if(c.push(h),r){var f=cy(r,null,null);l.write_shift(16,a,"hex"),l.write_shift(4,68+h.length),c.push(f)}return bi(c)}function rD(n,t){t||(t=gt(n));for(var e=0;e<n;++e)t.write_shift(1,0);return t}function sD(n,t){return n.read_shift(t)===1}function Ui(n,t){return t||(t=gt(2)),t.write_shift(2,+!!n),t}function pE(n){return n.read_shift(2,"u")}function Mn(n,t){return t||(t=gt(2)),t.write_shift(2,n),t}function gE(n,t,e){return e||(e=gt(2)),e.write_shift(1,t=="e"?+n:+!!n),e.write_shift(1,t=="e"?1:0),e}function mE(n,t,e){var i=n.read_shift(e&&e.biff>=12?2:1),r="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var a=n.read_shift(1);a&&(r="dbcs-cont")}else e.biff==12&&(r="wstr");e.biff>=2&&e.biff<=5&&(r="cpstr");var l=i?n.read_shift(i,r):"";return l}function aD(n){var t=n.t||"",e=gt(3);e.write_shift(2,t.length),e.write_shift(1,1);var i=gt(2*t.length);i.write_shift(2*t.length,t,"utf16le");var r=[e,i];return bi(r)}function oD(n,t,e){var i;if(e){if(e.biff>=2&&e.biff<=5)return n.read_shift(t,"cpstr");if(e.biff>=12)return n.read_shift(t,"dbcs-cont")}var r=n.read_shift(1);return r===0?i=n.read_shift(t,"sbcs-cont"):i=n.read_shift(t,"dbcs-cont"),i}function lD(n,t,e){var i=n.read_shift(e&&e.biff==2?1:2);return i===0?(n.l++,""):oD(n,i,e)}function cD(n,t,e){if(e.biff>5)return lD(n,t,e);var i=n.read_shift(1);return i===0?(n.l++,""):n.read_shift(i,e.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function vE(n,t,e){return e||(e=gt(3+2*n.length)),e.write_shift(2,n.length),e.write_shift(1,1),e.write_shift(31,n,"utf16le"),e}function hy(n,t){t||(t=gt(6+n.length*2)),t.write_shift(4,1+n.length);for(var e=0;e<n.length;++e)t.write_shift(2,n.charCodeAt(e));return t.write_shift(2,0),t}function uD(n){var t=gt(512),e=0,i=n.Target;i.slice(0,7)=="file://"&&(i=i.slice(7));var r=i.indexOf("#"),a=r>-1?31:23;switch(i.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var l=[8,6815827,6619237,4849780,83];for(e=0;e<l.length;++e)t.write_shift(4,l[e]);if(a==28)i=i.slice(1),hy(i,t);else if(a&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<l.length;++e)t.write_shift(1,parseInt(l[e],16));var c=r>-1?i.slice(0,r):i;for(t.write_shift(4,2*(c.length+1)),e=0;e<c.length;++e)t.write_shift(2,c.charCodeAt(e));t.write_shift(2,0),a&8&&hy(r>-1?i.slice(r+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<l.length;++e)t.write_shift(1,parseInt(l[e],16));for(var h=0;i.slice(h*3,h*3+3)=="../"||i.slice(h*3,h*3+3)=="..\\";)++h;for(t.write_shift(2,h),t.write_shift(4,i.length-3*h+1),e=0;e<i.length-3*h;++e)t.write_shift(1,i.charCodeAt(e+3*h)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),e=0;e<6;++e)t.write_shift(4,0)}return t.slice(0,t.l)}function oa(n,t,e,i){return i||(i=gt(6)),i.write_shift(2,n),i.write_shift(2,t),i.write_shift(2,e||0),i}function hD(n,t,e){var i=e.biff>8?4:2,r=n.read_shift(i),a=n.read_shift(i,"i"),l=n.read_shift(i,"i");return[r,a,l]}function fD(n){var t=n.read_shift(2),e=n.read_shift(2),i=n.read_shift(2),r=n.read_shift(2);return{s:{c:i,r:t},e:{c:r,r:e}}}function xE(n,t){return t||(t=gt(8)),t.write_shift(2,n.s.r),t.write_shift(2,n.e.r),t.write_shift(2,n.s.c),t.write_shift(2,n.e.c),t}function Fp(n,t,e){var i=1536,r=16;switch(e.bookType){case"biff8":break;case"biff5":i=1280,r=8;break;case"biff4":i=4,r=6;break;case"biff3":i=3,r=6;break;case"biff2":i=2,r=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=gt(r);return a.write_shift(2,i),a.write_shift(2,t),r>4&&a.write_shift(2,29282),r>6&&a.write_shift(2,1997),r>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function dD(n,t){var e=!t||t.biff==8,i=gt(e?112:54);for(i.write_shift(t.biff==8?2:1,7),e&&i.write_shift(1,0),i.write_shift(4,859007059),i.write_shift(4,5458548|(e?0:536870912));i.l<i.length;)i.write_shift(1,e?0:32);return i}function pD(n,t){var e=!t||t.biff>=8?2:1,i=gt(8+e*n.name.length);i.write_shift(4,n.pos),i.write_shift(1,n.hs||0),i.write_shift(1,n.dt),i.write_shift(1,n.name.length),t.biff>=8&&i.write_shift(1,1),i.write_shift(e*n.name.length,n.name,t.biff<8?"sbcs":"utf16le");var r=i.slice(0,i.l);return r.l=i.l,r}function gD(n,t){var e=gt(8);e.write_shift(4,n.Count),e.write_shift(4,n.Unique);for(var i=[],r=0;r<n.length;++r)i[r]=aD(n[r]);var a=bi([e].concat(i));return a.parts=[e.length].concat(i.map(function(l){return l.length})),a}function mD(){var n=gt(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function vD(n){var t=gt(18),e=1718;return n&&n.RTL&&(e|=64),t.write_shift(2,e),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function xD(n,t){var e=n.name||"Arial",i=t&&t.biff==5,r=i?15+e.length:16+2*e.length,a=gt(r);return a.write_shift(2,n.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,e.length),i||a.write_shift(1,1),a.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le"),a}function yD(n,t,e,i){var r=gt(10);return oa(n,t,i,r),r.write_shift(4,e),r}function _D(n,t,e,i,r){var a=!r||r.biff==8,l=gt(8+ +a+(1+a)*e.length);return oa(n,t,i,l),l.write_shift(2,e.length),a&&l.write_shift(1,1),l.write_shift((1+a)*e.length,e,a?"utf16le":"sbcs"),l}function ED(n,t,e,i){var r=e&&e.biff==5;i||(i=gt(r?3+t.length:5+2*t.length)),i.write_shift(2,n),i.write_shift(r?1:2,t.length),r||i.write_shift(1,1),i.write_shift((r?1:2)*t.length,t,r?"sbcs":"utf16le");var a=i.length>i.l?i.slice(0,i.l):i;return a.l==null&&(a.l=a.length),a}function bD(n,t){var e=t.biff==8||!t.biff?4:2,i=gt(2*e+6);return i.write_shift(e,n.s.r),i.write_shift(e,n.e.r+1),i.write_shift(2,n.s.c),i.write_shift(2,n.e.c+1),i.write_shift(2,0),i}function fy(n,t,e,i){var r=e&&e.biff==5;i||(i=gt(r?16:20)),i.write_shift(2,0),n.style?(i.write_shift(2,n.numFmtId||0),i.write_shift(2,65524)):(i.write_shift(2,n.numFmtId||0),i.write_shift(2,t<<4));var a=0;return n.numFmtId>0&&r&&(a|=1024),i.write_shift(4,a),i.write_shift(4,0),r||i.write_shift(4,0),i.write_shift(2,0),i}function AD(n){var t=gt(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function wD(n,t,e,i,r,a){var l=gt(8);return oa(n,t,i,l),gE(e,a,l),l}function SD(n,t,e,i){var r=gt(14);return oa(n,t,i,r),aa(e,r),r}function TD(n,t,e){if(e.biff<8)return CD(n,t,e);for(var i=[],r=n.l+t,a=n.read_shift(e.biff>8?4:2);a--!==0;)i.push(hD(n,e.biff>8?12:6,e));if(n.l!=r)throw new Error("Bad ExternSheet: "+n.l+" != "+r);return i}function CD(n,t,e){n[n.l+1]==3&&n[n.l]++;var i=mE(n,t,e);return i.charCodeAt(0)==3?i.slice(1):i}function RD(n){var t=gt(2+n.length*8);t.write_shift(2,n.length);for(var e=0;e<n.length;++e)xE(n[e],t);return t}function DD(n){var t=gt(24),e=fi(n[0]);t.write_shift(2,e.r),t.write_shift(2,e.r),t.write_shift(2,e.c),t.write_shift(2,e.c);for(var i="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<16;++r)t.write_shift(1,parseInt(i[r],16));return bi([t,uD(n[1])])}function MD(n){var t=n[1].Tooltip,e=gt(10+2*(t.length+1));e.write_shift(2,2048);var i=fi(n[0]);e.write_shift(2,i.r),e.write_shift(2,i.r),e.write_shift(2,i.c),e.write_shift(2,i.c);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function ND(n){return n||(n=gt(4)),n.write_shift(2,1),n.write_shift(2,1),n}function OD(n,t,e){if(!e.cellStyles)return hr(n,t);var i=e&&e.biff>=12?4:2,r=n.read_shift(i),a=n.read_shift(i),l=n.read_shift(i),c=n.read_shift(i),h=n.read_shift(2);i==2&&(n.l+=2);var f={s:r,e:a,w:l,ixfe:c,flags:h};return(e.biff>=5||!e.biff)&&(f.level=h>>8&7),f}function LD(n,t){var e=gt(12);e.write_shift(2,t),e.write_shift(2,t),e.write_shift(2,n.width*256),e.write_shift(2,0);var i=0;return n.hidden&&(i|=1),e.write_shift(1,i),i=n.level||0,e.write_shift(1,i),e.write_shift(2,0),e}function PD(n){for(var t=gt(2*n),e=0;e<n;++e)t.write_shift(2,e+1);return t}function kD(n,t,e){var i=gt(15);return yc(i,n,t),i.write_shift(8,e,"f"),i}function FD(n,t,e){var i=gt(9);return yc(i,n,t),i.write_shift(2,e),i}var ID=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Sp({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(c,h){var f=[],p=sa(1);switch(h.type){case"base64":p=Wn(Ur(c));break;case"binary":p=Wn(c);break;case"buffer":case"array":p=c;break}hn(p,0);var m=p.read_shift(1),v=!!(m&136),x=!1,E=!1;switch(m){case 2:break;case 3:break;case 48:x=!0,v=!0;break;case 49:x=!0,v=!0;break;case 131:break;case 139:break;case 140:E=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+m.toString(16))}var _=0,b=521;m==2&&(_=p.read_shift(2)),p.l+=3,m!=2&&(_=p.read_shift(4)),_>1048576&&(_=1e6),m!=2&&(b=p.read_shift(2));var A=p.read_shift(2),T=h.codepage||1252;m!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(T=n[p[p.l]]),p.l+=1,p.l+=2),E&&(p.l+=36);for(var S=[],C={},N=Math.min(p.length,m==2?521:b-10-(x?264:0)),B=E?32:11;p.l<N&&p[p.l]!=13;)switch(C={},C.name=ph.utils.decode(T,p.slice(p.l,p.l+B)).replace(/[\u0000\r\n].*$/g,""),p.l+=B,C.type=String.fromCharCode(p.read_shift(1)),m!=2&&!E&&(C.offset=p.read_shift(4)),C.len=p.read_shift(1),m==2&&(C.offset=p.read_shift(2)),C.dec=p.read_shift(1),C.name.length&&S.push(C),m!=2&&(p.l+=E?13:14),C.type){case"B":(!x||C.len!=8)&&h.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(p[p.l]!==13&&(p.l=b-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=b;var O=0,H=0;for(f[0]=[],H=0;H!=S.length;++H)f[0][H]=S[H].name;for(;_-- >0;){if(p[p.l]===42){p.l+=A;continue}for(++p.l,f[++O]=[],H=0,H=0;H!=S.length;++H){var M=p.slice(p.l,p.l+S[H].len);p.l+=S[H].len,hn(M,0);var W=ph.utils.decode(T,M);switch(S[H].type){case"C":W.trim().length&&(f[O][H]=W.replace(/\s+$/,""));break;case"D":W.length===8?f[O][H]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):f[O][H]=W;break;case"F":f[O][H]=parseFloat(W.trim());break;case"+":case"I":f[O][H]=E?M.read_shift(-4,"i")^2147483648:M.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":f[O][H]=!0;break;case"N":case"F":f[O][H]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+m.toString(16));f[O][H]="##MEMO##"+(E?parseInt(W.trim(),10):M.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(f[O][H]=+W||0);break;case"@":f[O][H]=new Date(M.read_shift(-8,"f")-621356832e5);break;case"T":f[O][H]=new Date((M.read_shift(4)-2440588)*864e5+M.read_shift(4));break;case"Y":f[O][H]=M.read_shift(4,"i")/1e4+M.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[O][H]=-M.read_shift(-8,"f");break;case"B":if(x&&S[H].len==8){f[O][H]=M.read_shift(8,"f");break}case"G":case"P":M.l+=S[H].len;break;case"0":if(S[H].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[H].type)}}}if(m!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(f=f.slice(0,h.sheetRows)),h.DBF=S,f}function i(c,h){var f=h||{};f.dateNF||(f.dateNF="yyyymmdd");var p=So(e(c,f),f);return p["!cols"]=f.DBF.map(function(m){return{wch:m.len,DBF:m}}),delete f.DBF,p}function r(c,h){try{return ua(i(c,h),h)}catch(f){if(h&&h.WTF)throw f}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,h){var f=h||{};if(+f.codepage>=0&&tc(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var p=Ki(),m=Ch(c,{header:1,raw:!0,cellDates:!0}),v=m[0],x=m.slice(1),E=c["!cols"]||[],_=0,b=0,A=0,T=1;for(_=0;_<v.length;++_){if(((E[_]||{}).DBF||{}).name){v[_]=E[_].DBF.name,++A;continue}if(v[_]!=null){if(++A,typeof v[_]=="number"&&(v[_]=v[_].toString(10)),typeof v[_]!="string")throw new Error("DBF Invalid column name "+v[_]+" |"+typeof v[_]+"|");if(v.indexOf(v[_])!==_){for(b=0;b<1024;++b)if(v.indexOf(v[_]+"_"+b)==-1){v[_]+="_"+b;break}}}}var S=Pe(c["!ref"]),C=[],N=[],B=[];for(_=0;_<=S.e.c-S.s.c;++_){var O="",H="",M=0,W=[];for(b=0;b<x.length;++b)x[b][_]!=null&&W.push(x[b][_]);if(W.length==0||v[_]==null){C[_]="?";continue}for(b=0;b<W.length;++b){switch(typeof W[b]){case"number":H="B";break;case"string":H="C";break;case"boolean":H="L";break;case"object":H=W[b]instanceof Date?"D":"C";break;default:H="C"}M=Math.max(M,String(W[b]).length),O=O&&O!=H?"C":H}M>250&&(M=250),H=((E[_]||{}).DBF||{}).type,H=="C"&&E[_].DBF.len>M&&(M=E[_].DBF.len),O=="B"&&H=="N"&&(O="N",B[_]=E[_].DBF.dec,M=E[_].DBF.len),N[_]=O=="C"||H=="N"?M:a[O]||0,T+=N[_],C[_]=O}var Y=p.next(32);for(Y.write_shift(4,318902576),Y.write_shift(4,x.length),Y.write_shift(2,296+32*A),Y.write_shift(2,T),_=0;_<4;++_)Y.write_shift(4,0);for(Y.write_shift(4,0|(+t[__]||3)<<8),_=0,b=0;_<v.length;++_)if(v[_]!=null){var J=p.next(32),ut=(v[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);J.write_shift(1,ut,"sbcs"),J.write_shift(1,C[_]=="?"?"C":C[_],"sbcs"),J.write_shift(4,b),J.write_shift(1,N[_]||a[C[_]]||0),J.write_shift(1,B[_]||0),J.write_shift(1,2),J.write_shift(4,0),J.write_shift(1,0),J.write_shift(4,0),J.write_shift(4,0),b+=N[_]||a[C[_]]||0}var At=p.next(264);for(At.write_shift(4,13),_=0;_<65;++_)At.write_shift(4,0);for(_=0;_<x.length;++_){var Et=p.next(T);for(Et.write_shift(1,0),b=0;b<v.length;++b)if(v[b]!=null)switch(C[b]){case"L":Et.write_shift(1,x[_][b]==null?63:x[_][b]?84:70);break;case"B":Et.write_shift(8,x[_][b]||0,"f");break;case"N":var q="0";for(typeof x[_][b]=="number"&&(q=x[_][b].toFixed(B[b]||0)),A=0;A<N[b]-q.length;++A)Et.write_shift(1,32);Et.write_shift(1,q,"sbcs");break;case"D":x[_][b]?(Et.write_shift(4,("0000"+x[_][b].getFullYear()).slice(-4),"sbcs"),Et.write_shift(2,("00"+(x[_][b].getMonth()+1)).slice(-2),"sbcs"),Et.write_shift(2,("00"+x[_][b].getDate()).slice(-2),"sbcs")):Et.write_shift(8,"00000000","sbcs");break;case"C":var nt=String(x[_][b]!=null?x[_][b]:"").slice(0,N[b]);for(Et.write_shift(1,nt,"sbcs"),A=0;A<N[b]-nt.length;++A)Et.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:r,to_sheet:i,from_sheet:l}})(),BD=(function(){var n={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ti(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(v,x){var E=n[x];return typeof E=="number"?Fx(E):E},i=function(v,x,E){var _=x.charCodeAt(0)-32<<4|E.charCodeAt(0)-48;return _==59?v:Fx(_)};n["|"]=254;function r(v,x){switch(x.type){case"base64":return a(Ur(v),x);case"binary":return a(v,x);case"buffer":return a(pe&&Buffer.isBuffer(v)?v.toString("binary"):pc(v),x);case"array":return a(jh(v),x)}throw new Error("Unrecognized type "+x.type)}function a(v,x){var E=v.split(/[\n\r]+/),_=-1,b=-1,A=0,T=0,S=[],C=[],N=null,B={},O=[],H=[],M=[],W=0,Y;for(+x.codepage>=0&&tc(+x.codepage);A!==E.length;++A){W=0;var J=E[A].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,i).replace(t,e),ut=J.replace(/;;/g,"\0").split(";").map(function(X){return X.replace(/\u0000/g,";")}),At=ut[0],Et;if(J.length>0)switch(At){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ut[1].charAt(0)=="P"&&C.push(J.slice(3).replace(/;;/g,";"));break;case"C":var q=!1,nt=!1,St=!1,kt=!1,G=-1,ht=-1;for(T=1;T<ut.length;++T)switch(ut[T].charAt(0)){case"A":break;case"X":b=parseInt(ut[T].slice(1))-1,nt=!0;break;case"Y":for(_=parseInt(ut[T].slice(1))-1,nt||(b=0),Y=S.length;Y<=_;++Y)S[Y]=[];break;case"K":Et=ut[T].slice(1),Et.charAt(0)==='"'?Et=Et.slice(1,Et.length-1):Et==="TRUE"?Et=!0:Et==="FALSE"?Et=!1:isNaN(Ir(Et))?isNaN(ic(Et).getDate())||(Et=ji(Et)):(Et=Ir(Et),N!==null&&O_(N)&&(Et=F_(Et))),q=!0;break;case"E":kt=!0;var P=FM(ut[T].slice(1),{r:_,c:b});S[_][b]=[S[_][b],P];break;case"S":St=!0,S[_][b]=[S[_][b],"S5S"];break;case"G":break;case"R":G=parseInt(ut[T].slice(1))-1;break;case"C":ht=parseInt(ut[T].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+J)}if(q&&(S[_][b]&&S[_][b].length==2?S[_][b][0]=Et:S[_][b]=Et,N=null),St){if(kt)throw new Error("SYLK shared formula cannot have own formula");var j=G>-1&&S[G][ht];if(!j||!j[1])throw new Error("SYLK shared formula cannot find base");S[_][b][1]=IM(j[1],{r:_-G,c:b-ht})}break;case"F":var z=0;for(T=1;T<ut.length;++T)switch(ut[T].charAt(0)){case"X":b=parseInt(ut[T].slice(1))-1,++z;break;case"Y":for(_=parseInt(ut[T].slice(1))-1,Y=S.length;Y<=_;++Y)S[Y]=[];break;case"M":W=parseInt(ut[T].slice(1))/20;break;case"F":break;case"G":break;case"P":N=C[parseInt(ut[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(M=ut[T].slice(1).split(" "),Y=parseInt(M[0],10);Y<=parseInt(M[1],10);++Y)W=parseInt(M[2],10),H[Y-1]=W===0?{hidden:!0}:{wch:W},Ip(H[Y-1]);break;case"C":b=parseInt(ut[T].slice(1))-1,H[b]||(H[b]={});break;case"R":_=parseInt(ut[T].slice(1))-1,O[_]||(O[_]={}),W>0?(O[_].hpt=W,O[_].hpx=AE(W)):W===0&&(O[_].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+J)}z<1&&(N=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+J)}}return O.length>0&&(B["!rows"]=O),H.length>0&&(B["!cols"]=H),x&&x.sheetRows&&(S=S.slice(0,x.sheetRows)),[S,B]}function l(v,x){var E=r(v,x),_=E[0],b=E[1],A=So(_,x);return Ti(b).forEach(function(T){A[T]=b[T]}),A}function c(v,x){return ua(l(v,x),x)}function h(v,x,E,_){var b="C;Y"+(E+1)+";X"+(_+1)+";K";switch(v.t){case"n":b+=v.v||0,v.f&&!v.F&&(b+=";E"+Up(v.f,{r:E,c:_}));break;case"b":b+=v.v?"TRUE":"FALSE";break;case"e":b+=v.w||v.v;break;case"d":b+='"'+(v.w||v.v)+'"';break;case"s":b+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function f(v,x){x.forEach(function(E,_){var b="F;W"+(_+1)+" "+(_+1)+" ";E.hidden?b+="0":(typeof E.width=="number"&&!E.wpx&&(E.wpx=Ah(E.width)),typeof E.wpx=="number"&&!E.wch&&(E.wch=wh(E.wpx)),typeof E.wch=="number"&&(b+=Math.round(E.wch))),b.charAt(b.length-1)!=" "&&v.push(b)})}function p(v,x){x.forEach(function(E,_){var b="F;";E.hidden?b+="M0;":E.hpt?b+="M"+20*E.hpt+";":E.hpx&&(b+="M"+20*Sh(E.hpx)+";"),b.length>2&&v.push(b+"R"+(_+1))})}function m(v,x){var E=["ID;PWXL;N;E"],_=[],b=Pe(v["!ref"]),A,T=Array.isArray(v),S=`\r
`;E.push("P;PGeneral"),E.push("F;P0;DG0G8;M255"),v["!cols"]&&f(E,v["!cols"]),v["!rows"]&&p(E,v["!rows"]),E.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var C=b.s.r;C<=b.e.r;++C)for(var N=b.s.c;N<=b.e.c;++N){var B=be({r:C,c:N});A=T?(v[C]||[])[N]:v[B],!(!A||A.v==null&&(!A.f||A.F))&&_.push(h(A,v,C,N))}return E.join(S)+S+_.join(S)+S+"E"+S}return{to_workbook:c,to_sheet:l,from_sheet:m}})(),UD=(function(){function n(a,l){switch(l.type){case"base64":return t(Ur(a),l);case"binary":return t(a,l);case"buffer":return t(pe&&Buffer.isBuffer(a)?a.toString("binary"):pc(a),l);case"array":return t(jh(a),l)}throw new Error("Unrecognized type "+l.type)}function t(a,l){for(var c=a.split(`
`),h=-1,f=-1,p=0,m=[];p!==c.length;++p){if(c[p].trim()==="BOT"){m[++h]=[],f=0;continue}if(!(h<0)){var v=c[p].trim().split(","),x=v[0],E=v[1];++p;for(var _=c[p]||"";(_.match(/["]/g)||[]).length&1&&p<c.length-1;)_+=`
`+c[++p];switch(_=_.trim(),+x){case-1:if(_==="BOT"){m[++h]=[],f=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?m[h][f]=!0:_==="FALSE"?m[h][f]=!1:isNaN(Ir(E))?isNaN(ic(E).getDate())?m[h][f]=E:m[h][f]=ji(E):m[h][f]=Ir(E),++f;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),m[h][f++]=_!==""?_:null;break}if(_==="EOD")break}}return l&&l.sheetRows&&(m=m.slice(0,l.sheetRows)),m}function e(a,l){return So(n(a,l),l)}function i(a,l){return ua(e(a,l),l)}var r=(function(){var a=function(h,f,p,m,v){h.push(f),h.push(p+","+m),h.push('"'+v.replace(/"/g,'""')+'"')},l=function(h,f,p,m){h.push(f+","+p),h.push(f==1?'"'+m.replace(/"/g,'""')+'"':m)};return function(h){var f=[],p=Pe(h["!ref"]),m,v=Array.isArray(h);a(f,"TABLE",0,1,"sheetjs"),a(f,"VECTORS",0,p.e.r-p.s.r+1,""),a(f,"TUPLES",0,p.e.c-p.s.c+1,""),a(f,"DATA",0,0,"");for(var x=p.s.r;x<=p.e.r;++x){l(f,-1,0,"BOT");for(var E=p.s.c;E<=p.e.c;++E){var _=be({r:x,c:E});if(m=v?(h[x]||[])[E]:h[_],!m){l(f,1,0,"");continue}switch(m.t){case"n":var b=m.w;!b&&m.v!=null&&(b=m.v),b==null?m.f&&!m.F?l(f,1,0,"="+m.f):l(f,1,0,""):l(f,0,b,"V");break;case"b":l(f,0,m.v?1:0,m.v?"TRUE":"FALSE");break;case"s":l(f,1,0,isNaN(m.v)?m.v:'="'+m.v+'"');break;case"d":m.w||(m.w=bs(m.z||je[14],Qi(ji(m.v)))),l(f,0,m.w,"V");break;default:l(f,1,0,"")}}}l(f,-1,0,"EOD");var A=`\r
`,T=f.join(A);return T}})();return{to_workbook:i,to_sheet:e,from_sheet:r}})(),yE=(function(){function n(m){return m.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(m){return m.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(m,v){for(var x=m.split(`
`),E=-1,_=-1,b=0,A=[];b!==x.length;++b){var T=x[b].trim().split(":");if(T[0]==="cell"){var S=fi(T[1]);if(A.length<=S.r)for(E=A.length;E<=S.r;++E)A[E]||(A[E]=[]);switch(E=S.r,_=S.c,T[2]){case"t":A[E][_]=n(T[3]);break;case"v":A[E][_]=+T[3];break;case"vtf":var C=T[T.length-1];case"vtc":switch(T[3]){case"nl":A[E][_]=!!+T[4];break;default:A[E][_]=+T[4];break}T[2]=="vtf"&&(A[E][_]=[A[E][_],C])}}}return v&&v.sheetRows&&(A=A.slice(0,v.sheetRows)),A}function i(m,v){return So(e(m,v),v)}function r(m,v){return ua(i(m,v),v)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function f(m){if(!m||!m["!ref"])return"";for(var v=[],x=[],E,_="",b=pn(m["!ref"]),A=Array.isArray(m),T=b.s.r;T<=b.e.r;++T)for(var S=b.s.c;S<=b.e.c;++S)if(_=be({r:T,c:S}),E=A?(m[T]||[])[S]:m[_],!(!E||E.v==null||E.t==="z")){switch(x=["cell",_,"t"],E.t){case"s":case"str":x.push(t(E.v));break;case"n":E.f?(x[2]="vtf",x[3]="n",x[4]=E.v,x[5]=t(E.f)):(x[2]="v",x[3]=E.v);break;case"b":x[2]="vt"+(E.f?"f":"c"),x[3]="nl",x[4]=E.v?"1":"0",x[5]=t(E.f||(E.v?"TRUE":"FALSE"));break;case"d":var C=Qi(ji(E.v));x[2]="vtc",x[3]="nd",x[4]=""+C,x[5]=E.w||bs(E.z||je[14],C);break;case"e":continue}v.push(x.join(":"))}return v.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function p(m){return[a,l,c,l,f(m),h].join(`
`)}return{to_workbook:r,to_sheet:i,from_sheet:p}})(),HD=(function(){function n(p,m,v,x,E){E.raw?m[v][x]=p:p===""||(p==="TRUE"?m[v][x]=!0:p==="FALSE"?m[v][x]=!1:isNaN(Ir(p))?isNaN(ic(p).getDate())?m[v][x]=p:m[v][x]=ji(p):m[v][x]=Ir(p))}function t(p,m){var v=m||{},x=[];if(!p||p.length===0)return x;for(var E=p.split(/[\r\n]/),_=E.length-1;_>=0&&E[_].length===0;)--_;for(var b=10,A=0,T=0;T<=_;++T)A=E[T].indexOf(" "),A==-1?A=E[T].length:A++,b=Math.max(b,A);for(T=0;T<=_;++T){x[T]=[];var S=0;for(n(E[T].slice(0,b).trim(),x,T,S,v),S=1;S<=(E[T].length-b)/10+1;++S)n(E[T].slice(b+(S-1)*10,b+S*10).trim(),x,T,S,v)}return v.sheetRows&&(x=x.slice(0,v.sheetRows)),x}var e={44:",",9:"	",59:";",124:"|"},i={44:3,9:2,59:1,124:0};function r(p){for(var m={},v=!1,x=0,E=0;x<p.length;++x)(E=p.charCodeAt(x))==34?v=!v:!v&&E in e&&(m[E]=(m[E]||0)+1);E=[];for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&E.push([m[x],x]);if(!E.length){m=i;for(x in m)Object.prototype.hasOwnProperty.call(m,x)&&E.push([m[x],x])}return E.sort(function(_,b){return _[0]-b[0]||i[_[1]]-i[b[1]]}),e[E.pop()[1]]||44}function a(p,m){var v=m||{},x="",E=v.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(x=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(x=p.charAt(4),p=p.slice(6)):x=r(p.slice(0,1024)):v&&v.FS?x=v.FS:x=r(p.slice(0,1024));var b=0,A=0,T=0,S=0,C=0,N=x.charCodeAt(0),B=!1,O=0,H=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var M=v.dateNF!=null?iR(v.dateNF):null;function W(){var Y=p.slice(S,C),J={};if(Y.charAt(0)=='"'&&Y.charAt(Y.length-1)=='"'&&(Y=Y.slice(1,-1).replace(/""/g,'"')),Y.length===0)J.t="z";else if(v.raw)J.t="s",J.v=Y;else if(Y.trim().length===0)J.t="s",J.v=Y;else if(Y.charCodeAt(0)==61)Y.charCodeAt(1)==34&&Y.charCodeAt(Y.length-1)==34?(J.t="s",J.v=Y.slice(2,-1).replace(/""/g,'"')):BM(Y)?(J.t="n",J.f=Y.slice(1)):(J.t="s",J.v=Y);else if(Y=="TRUE")J.t="b",J.v=!0;else if(Y=="FALSE")J.t="b",J.v=!1;else if(!isNaN(T=Ir(Y)))J.t="n",v.cellText!==!1&&(J.w=Y),J.v=T;else if(!isNaN(ic(Y).getDate())||M&&Y.match(M)){J.z=v.dateNF||je[14];var ut=0;M&&Y.match(M)&&(Y=nR(Y,v.dateNF,Y.match(M)||[]),ut=1),v.cellDates?(J.t="d",J.v=ji(Y,ut)):(J.t="n",J.v=Qi(ji(Y,ut))),v.cellText!==!1&&(J.w=bs(J.z,J.v instanceof Date?Qi(J.v):J.v)),v.cellNF||delete J.z}else J.t="s",J.v=Y;if(J.t=="z"||(v.dense?(E[b]||(E[b]=[]),E[b][A]=J):E[be({c:A,r:b})]=J),S=C+1,H=p.charCodeAt(S),_.e.c<A&&(_.e.c=A),_.e.r<b&&(_.e.r=b),O==N)++A;else if(A=0,++b,v.sheetRows&&v.sheetRows<=b)return!0}t:for(;C<p.length;++C)switch(O=p.charCodeAt(C)){case 34:H===34&&(B=!B);break;case N:case 10:case 13:if(!B&&W())break t;break}return C-S>0&&W(),E["!ref"]=ti(_),E}function l(p,m){return!(m&&m.PRN)||m.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?a(p,m):So(t(p,m),m)}function c(p,m){var v="",x=m.type=="string"?[0,0,0,0]:ZP(p,m);switch(m.type){case"base64":v=Ur(p);break;case"binary":v=p;break;case"buffer":m.codepage==65001?v=p.toString("utf8"):m.codepage&&typeof ph<"u"||(v=pe&&Buffer.isBuffer(p)?p.toString("binary"):pc(p));break;case"array":v=jh(p);break;case"string":v=p;break;default:throw new Error("Unrecognized type "+m.type)}return x[0]==239&&x[1]==187&&x[2]==191?v=Vl(v.slice(3)):m.type!="string"&&m.type!="buffer"&&m.codepage==65001?v=Vl(v):m.type=="binary"&&typeof ph<"u",v.slice(0,19)=="socialcalc:version:"?yE.to_sheet(m.type=="string"?v:Vl(v),m):l(v,m)}function h(p,m){return ua(c(p,m),m)}function f(p){for(var m=[],v=Pe(p["!ref"]),x,E=Array.isArray(p),_=v.s.r;_<=v.e.r;++_){for(var b=[],A=v.s.c;A<=v.e.c;++A){var T=be({r:_,c:A});if(x=E?(p[_]||[])[A]:p[T],!x||x.v==null){b.push("          ");continue}for(var S=(x.w||(Hr(x),x.w)||"").slice(0,10);S.length<10;)S+=" ";b.push(S+(A===0?" ":""))}m.push(b.join(""))}return m.join(`
`)}return{to_workbook:h,to_sheet:c,from_sheet:f}})(),dy=(function(){function n(P,j,z){if(P){hn(P,P.l||0);for(var X=z.Enum||G;P.l<P.length;){var et=P.read_shift(2),wt=X[et]||X[65535],Ct=P.read_shift(2),pt=P.l+Ct,yt=wt.f&&wt.f(P,Ct,z);if(P.l=pt,j(yt,wt,et))return}}}function t(P,j){switch(j.type){case"base64":return e(Wn(Ur(P)),j);case"binary":return e(Wn(P),j);case"buffer":case"array":return e(P,j)}throw"Unsupported type "+j.type}function e(P,j){if(!P)return P;var z=j||{},X=z.dense?[]:{},et="Sheet1",wt="",Ct=0,pt={},yt=[],Ut=[],Lt={s:{r:0,c:0},e:{r:0,c:0}},Qt=z.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)z.Enum=G,n(P,function(Rt,ce,Ji){switch(Ji){case 0:z.vers=Rt,Rt>=4096&&(z.qpro=!0);break;case 6:Lt=Rt;break;case 204:Rt&&(wt=Rt);break;case 222:wt=Rt;break;case 15:case 51:z.qpro||(Rt[1].v=Rt[1].v.slice(1));case 13:case 14:case 16:Ji==14&&(Rt[2]&112)==112&&(Rt[2]&15)>1&&(Rt[2]&15)<15&&(Rt[1].z=z.dateNF||je[14],z.cellDates&&(Rt[1].t="d",Rt[1].v=F_(Rt[1].v))),z.qpro&&Rt[3]>Ct&&(X["!ref"]=ti(Lt),pt[et]=X,yt.push(et),X=z.dense?[]:{},Lt={s:{r:0,c:0},e:{r:0,c:0}},Ct=Rt[3],et=wt||"Sheet"+(Ct+1),wt="");var Ln=z.dense?(X[Rt[0].r]||[])[Rt[0].c]:X[be(Rt[0])];if(Ln){Ln.t=Rt[1].t,Ln.v=Rt[1].v,Rt[1].z!=null&&(Ln.z=Rt[1].z),Rt[1].f!=null&&(Ln.f=Rt[1].f);break}z.dense?(X[Rt[0].r]||(X[Rt[0].r]=[]),X[Rt[0].r][Rt[0].c]=Rt[1]):X[be(Rt[0])]=Rt[1];break}},z);else if(P[2]==26||P[2]==14)z.Enum=ht,P[2]==14&&(z.qpro=!0,P.l=0),n(P,function(Rt,ce,Ji){switch(Ji){case 204:et=Rt;break;case 22:Rt[1].v=Rt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Rt[3]>Ct&&(X["!ref"]=ti(Lt),pt[et]=X,yt.push(et),X=z.dense?[]:{},Lt={s:{r:0,c:0},e:{r:0,c:0}},Ct=Rt[3],et="Sheet"+(Ct+1)),Qt>0&&Rt[0].r>=Qt)break;z.dense?(X[Rt[0].r]||(X[Rt[0].r]=[]),X[Rt[0].r][Rt[0].c]=Rt[1]):X[be(Rt[0])]=Rt[1],Lt.e.c<Rt[0].c&&(Lt.e.c=Rt[0].c),Lt.e.r<Rt[0].r&&(Lt.e.r=Rt[0].r);break;case 27:Rt[14e3]&&(Ut[Rt[14e3][0]]=Rt[14e3][1]);break;case 1537:Ut[Rt[0]]=Rt[1],Rt[0]==Ct&&(et=Rt[1]);break}},z);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(X["!ref"]=ti(Lt),pt[wt||et]=X,yt.push(wt||et),!Ut.length)return{SheetNames:yt,Sheets:pt};for(var jt={},ge=[],ae=0;ae<Ut.length;++ae)pt[yt[ae]]?(ge.push(Ut[ae]||yt[ae]),jt[Ut[ae]]=pt[Ut[ae]]||pt[yt[ae]]):(ge.push(Ut[ae]),jt[Ut[ae]]={"!ref":"A1"});return{SheetNames:ge,Sheets:jt}}function i(P,j){var z=j||{};if(+z.codepage>=0&&tc(+z.codepage),z.type=="string")throw new Error("Cannot write WK1 to JS string");var X=Ki(),et=Pe(P["!ref"]),wt=Array.isArray(P),Ct=[];Nt(X,0,a(1030)),Nt(X,6,h(et));for(var pt=Math.min(et.e.r,8191),yt=et.s.r;yt<=pt;++yt)for(var Ut=Si(yt),Lt=et.s.c;Lt<=et.e.c;++Lt){yt===et.s.r&&(Ct[Lt]=Oi(Lt));var Qt=Ct[Lt]+Ut,jt=wt?(P[yt]||[])[Lt]:P[Qt];if(!(!jt||jt.t=="z"))if(jt.t=="n")(jt.v|0)==jt.v&&jt.v>=-32768&&jt.v<=32767?Nt(X,13,x(yt,Lt,jt.v)):Nt(X,14,_(yt,Lt,jt.v));else{var ge=Hr(jt);Nt(X,15,m(yt,Lt,ge.slice(0,239)))}}return Nt(X,1),X.end()}function r(P,j){var z=j||{};if(+z.codepage>=0&&tc(+z.codepage),z.type=="string")throw new Error("Cannot write WK3 to JS string");var X=Ki();Nt(X,0,l(P));for(var et=0,wt=0;et<P.SheetNames.length;++et)(P.Sheets[P.SheetNames[et]]||{})["!ref"]&&Nt(X,27,kt(P.SheetNames[et],wt++));var Ct=0;for(et=0;et<P.SheetNames.length;++et){var pt=P.Sheets[P.SheetNames[et]];if(!(!pt||!pt["!ref"])){for(var yt=Pe(pt["!ref"]),Ut=Array.isArray(pt),Lt=[],Qt=Math.min(yt.e.r,8191),jt=yt.s.r;jt<=Qt;++jt)for(var ge=Si(jt),ae=yt.s.c;ae<=yt.e.c;++ae){jt===yt.s.r&&(Lt[ae]=Oi(ae));var Rt=Lt[ae]+ge,ce=Ut?(pt[jt]||[])[ae]:pt[Rt];if(!(!ce||ce.t=="z"))if(ce.t=="n")Nt(X,23,W(jt,ae,Ct,ce.v));else{var Ji=Hr(ce);Nt(X,22,O(jt,ae,Ct,Ji.slice(0,239)))}}++Ct}}return Nt(X,1),X.end()}function a(P){var j=gt(2);return j.write_shift(2,P),j}function l(P){var j=gt(26);j.write_shift(2,4096),j.write_shift(2,4),j.write_shift(4,0);for(var z=0,X=0,et=0,wt=0;wt<P.SheetNames.length;++wt){var Ct=P.SheetNames[wt],pt=P.Sheets[Ct];if(!(!pt||!pt["!ref"])){++et;var yt=pn(pt["!ref"]);z<yt.e.r&&(z=yt.e.r),X<yt.e.c&&(X=yt.e.c)}}return z>8191&&(z=8191),j.write_shift(2,z),j.write_shift(1,et),j.write_shift(1,X),j.write_shift(2,0),j.write_shift(2,0),j.write_shift(1,1),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(4,0),j}function c(P,j,z){var X={s:{c:0,r:0},e:{c:0,r:0}};return j==8&&z.qpro?(X.s.c=P.read_shift(1),P.l++,X.s.r=P.read_shift(2),X.e.c=P.read_shift(1),P.l++,X.e.r=P.read_shift(2),X):(X.s.c=P.read_shift(2),X.s.r=P.read_shift(2),j==12&&z.qpro&&(P.l+=2),X.e.c=P.read_shift(2),X.e.r=P.read_shift(2),j==12&&z.qpro&&(P.l+=2),X.s.c==65535&&(X.s.c=X.e.c=X.s.r=X.e.r=0),X)}function h(P){var j=gt(8);return j.write_shift(2,P.s.c),j.write_shift(2,P.s.r),j.write_shift(2,P.e.c),j.write_shift(2,P.e.r),j}function f(P,j,z){var X=[{c:0,r:0},{t:"n",v:0},0,0];return z.qpro&&z.vers!=20768?(X[0].c=P.read_shift(1),X[3]=P.read_shift(1),X[0].r=P.read_shift(2),P.l+=2):(X[2]=P.read_shift(1),X[0].c=P.read_shift(2),X[0].r=P.read_shift(2)),X}function p(P,j,z){var X=P.l+j,et=f(P,j,z);if(et[1].t="s",z.vers==20768){P.l++;var wt=P.read_shift(1);return et[1].v=P.read_shift(wt,"utf8"),et}return z.qpro&&P.l++,et[1].v=P.read_shift(X-P.l,"cstr"),et}function m(P,j,z){var X=gt(7+z.length);X.write_shift(1,255),X.write_shift(2,j),X.write_shift(2,P),X.write_shift(1,39);for(var et=0;et<X.length;++et){var wt=z.charCodeAt(et);X.write_shift(1,wt>=128?95:wt)}return X.write_shift(1,0),X}function v(P,j,z){var X=f(P,j,z);return X[1].v=P.read_shift(2,"i"),X}function x(P,j,z){var X=gt(7);return X.write_shift(1,255),X.write_shift(2,j),X.write_shift(2,P),X.write_shift(2,z,"i"),X}function E(P,j,z){var X=f(P,j,z);return X[1].v=P.read_shift(8,"f"),X}function _(P,j,z){var X=gt(13);return X.write_shift(1,255),X.write_shift(2,j),X.write_shift(2,P),X.write_shift(8,z,"f"),X}function b(P,j,z){var X=P.l+j,et=f(P,j,z);if(et[1].v=P.read_shift(8,"f"),z.qpro)P.l=X;else{var wt=P.read_shift(2);C(P.slice(P.l,P.l+wt),et),P.l+=wt}return et}function A(P,j,z){var X=j&32768;return j&=-32769,j=(X?P:0)+(j>=8192?j-16384:j),(X?"":"$")+(z?Oi(j):Si(j))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(P,j){hn(P,0);for(var z=[],X=0,et="",wt="",Ct="",pt="";P.l<P.length;){var yt=P[P.l++];switch(yt){case 0:z.push(P.read_shift(8,"f"));break;case 1:wt=A(j[0].c,P.read_shift(2),!0),et=A(j[0].r,P.read_shift(2),!1),z.push(wt+et);break;case 2:{var Ut=A(j[0].c,P.read_shift(2),!0),Lt=A(j[0].r,P.read_shift(2),!1);wt=A(j[0].c,P.read_shift(2),!0),et=A(j[0].r,P.read_shift(2),!1),z.push(Ut+Lt+":"+wt+et)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:z.push("("+z.pop()+")");break;case 5:z.push(P.read_shift(2));break;case 6:{for(var Qt="";yt=P[P.l++];)Qt+=String.fromCharCode(yt);z.push('"'+Qt.replace(/"/g,'""')+'"')}break;case 8:z.push("-"+z.pop());break;case 23:z.push("+"+z.pop());break;case 22:z.push("NOT("+z.pop()+")");break;case 20:case 21:pt=z.pop(),Ct=z.pop(),z.push(["AND","OR"][yt-20]+"("+Ct+","+pt+")");break;default:if(yt<32&&S[yt])pt=z.pop(),Ct=z.pop(),z.push(Ct+S[yt]+pt);else if(T[yt]){if(X=T[yt][1],X==69&&(X=P[P.l++]),X>z.length){console.error("WK1 bad formula parse 0x"+yt.toString(16)+":|"+z.join("|")+"|");return}var jt=z.slice(-X);z.length-=X,z.push(T[yt][0]+"("+jt.join(",")+")")}else return yt<=7?console.error("WK1 invalid opcode "+yt.toString(16)):yt<=24?console.error("WK1 unsupported op "+yt.toString(16)):yt<=30?console.error("WK1 invalid opcode "+yt.toString(16)):yt<=115?console.error("WK1 unsupported function opcode "+yt.toString(16)):console.error("WK1 unrecognized opcode "+yt.toString(16))}}z.length==1?j[1].f=""+z[0]:console.error("WK1 bad formula parse |"+z.join("|")+"|")}function N(P){var j=[{c:0,r:0},{t:"n",v:0},0];return j[0].r=P.read_shift(2),j[3]=P[P.l++],j[0].c=P[P.l++],j}function B(P,j){var z=N(P);return z[1].t="s",z[1].v=P.read_shift(j-4,"cstr"),z}function O(P,j,z,X){var et=gt(6+X.length);et.write_shift(2,P),et.write_shift(1,z),et.write_shift(1,j),et.write_shift(1,39);for(var wt=0;wt<X.length;++wt){var Ct=X.charCodeAt(wt);et.write_shift(1,Ct>=128?95:Ct)}return et.write_shift(1,0),et}function H(P,j){var z=N(P);z[1].v=P.read_shift(2);var X=z[1].v>>1;if(z[1].v&1)switch(X&7){case 0:X=(X>>3)*5e3;break;case 1:X=(X>>3)*500;break;case 2:X=(X>>3)/20;break;case 3:X=(X>>3)/200;break;case 4:X=(X>>3)/2e3;break;case 5:X=(X>>3)/2e4;break;case 6:X=(X>>3)/16;break;case 7:X=(X>>3)/64;break}return z[1].v=X,z}function M(P,j){var z=N(P),X=P.read_shift(4),et=P.read_shift(4),wt=P.read_shift(2);if(wt==65535)return X===0&&et===3221225472?(z[1].t="e",z[1].v=15):X===0&&et===3489660928?(z[1].t="e",z[1].v=42):z[1].v=0,z;var Ct=wt&32768;return wt=(wt&32767)-16446,z[1].v=(1-Ct*2)*(et*Math.pow(2,wt+32)+X*Math.pow(2,wt)),z}function W(P,j,z,X){var et=gt(14);if(et.write_shift(2,P),et.write_shift(1,z),et.write_shift(1,j),X==0)return et.write_shift(4,0),et.write_shift(4,0),et.write_shift(2,65535),et;var wt=0,Ct=0,pt=0,yt=0;return X<0&&(wt=1,X=-X),Ct=Math.log2(X)|0,X/=Math.pow(2,Ct-31),yt=X>>>0,(yt&2147483648)==0&&(X/=2,++Ct,yt=X>>>0),X-=yt,yt|=2147483648,yt>>>=0,X*=Math.pow(2,32),pt=X>>>0,et.write_shift(4,pt),et.write_shift(4,yt),Ct+=16383+(wt?32768:0),et.write_shift(2,Ct),et}function Y(P,j){var z=M(P);return P.l+=j-14,z}function J(P,j){var z=N(P),X=P.read_shift(4);return z[1].v=X>>6,z}function ut(P,j){var z=N(P),X=P.read_shift(8,"f");return z[1].v=X,z}function At(P,j){var z=ut(P);return P.l+=j-10,z}function Et(P,j){return P[P.l+j-1]==0?P.read_shift(j,"cstr"):""}function q(P,j){var z=P[P.l++];z>j-1&&(z=j-1);for(var X="";X.length<z;)X+=String.fromCharCode(P[P.l++]);return X}function nt(P,j,z){if(!(!z.qpro||j<21)){var X=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var et=P.read_shift(j-21,"cstr");return[X,et]}}function St(P,j){for(var z={},X=P.l+j;P.l<X;){var et=P.read_shift(2);if(et==14e3){for(z[et]=[0,""],z[et][0]=P.read_shift(2);P[P.l];)z[et][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return z}function kt(P,j){var z=gt(5+P.length);z.write_shift(2,14e3),z.write_shift(2,j);for(var X=0;X<P.length;++X){var et=P.charCodeAt(X);z[z.l++]=et>127?95:et}return z[z.l++]=0,z}var G={0:{n:"BOF",f:pE},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:E},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Et},222:{n:"SHEETNAMELP",f:q},65535:{n:""}},ht={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:M},24:{n:"NUMBER18",f:H},25:{n:"FORMULA19",f:Y},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:St},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:J},38:{n:"??"},39:{n:"NUMBER27",f:ut},40:{n:"FORMULA28",f:At},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Et},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:nt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:i,book_to_wk3:r,to_workbook:t}})(),jD=/^\s|\s$|[\t\n\r]/;function _E(n,t){if(!t.bookSST)return"";var e=[ei];e[e.length]=Mt("sst",null,{xmlns:wo[0],count:n.Count,uniqueCount:n.Unique});for(var i=0;i!=n.length;++i)if(n[i]!=null){var r=n[i],a="<si>";r.r?a+=r.r:(a+="<t",r.t||(r.t=""),r.t.match(jD)&&(a+=' xml:space="preserve"'),a+=">"+Ee(r.t)+"</t>"),a+="</si>",e[e.length]=a}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function zD(n){return[n.read_shift(4),n.read_shift(4)]}function VD(n,t){return t||(t=gt(8)),t.write_shift(4,n.Count),t.write_shift(4,n.Unique),t}var GD=PR;function WD(n){var t=Ki();_t(t,159,VD(n));for(var e=0;e<n.length;++e)_t(t,19,GD(n[e]));return _t(t,160),t.end()}function XD(n){for(var t=[],e=n.split(""),i=0;i<e.length;++i)t[i]=e[i].charCodeAt(0);return t}function EE(n){var t=0,e,i=XD(n),r=i.length+1,a,l,c,h,f;for(e=sa(r),e[0]=i.length,a=1;a!=r;++a)e[a]=i[a-1];for(a=r-1;a>=0;--a)l=e[a],c=(t&16384)===0?0:1,h=t<<1&32767,f=c|h,t=f^l;return t^52811}var YD=(function(){function n(r,a){switch(a.type){case"base64":return t(Ur(r),a);case"binary":return t(r,a);case"buffer":return t(pe&&Buffer.isBuffer(r)?r.toString("binary"):pc(r),a);case"array":return t(jh(r),a)}throw new Error("Unrecognized type "+a.type)}function t(r,a){var l=a||{},c=l.dense?[]:{},h=r.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,m){Array.isArray(c)&&(c[m]=[]);for(var v=/\\\w+\b/g,x=0,E,_=-1;E=v.exec(p);){switch(E[0]){case"\\cell":var b=p.slice(x,v.lastIndex-E[0].length);if(b[0]==" "&&(b=b.slice(1)),++_,b.length){var A={v:b,t:"s"};Array.isArray(c)?c[m][_]=A:c[be({r:m,c:_})]=A}break}x=v.lastIndex}_>f.e.c&&(f.e.c=_)}),c["!ref"]=ti(f),c}function e(r,a){return ua(n(r,a),a)}function i(r){for(var a=["{\\rtf1\\ansi"],l=Pe(r["!ref"]),c,h=Array.isArray(r),f=l.s.r;f<=l.e.r;++f){a.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)a.push("\\cellx"+(p+1));for(a.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var m=be({r:f,c:p});c=h?(r[f]||[])[p]:r[m],!(!c||c.v==null&&(!c.f||c.F))&&(a.push(" "+(c.w||(Hr(c),c.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:e,to_sheet:n,from_sheet:i}})();function py(n){for(var t=0,e=1;t!=3;++t)e=e*256+(n[t]>255?255:n[t]<0?0:n[t]);return e.toString(16).toUpperCase().slice(1)}var $D=6,Br=$D;function Ah(n){return Math.floor((n+Math.round(128/Br)/256)*Br)}function wh(n){return Math.floor((n-5)/Br*100+.5)/100}function tp(n){return Math.round((n*Br+5)/Br*256)/256}function Ip(n){n.width?(n.wpx=Ah(n.width),n.wch=wh(n.wpx),n.MDW=Br):n.wpx?(n.wch=wh(n.wpx),n.width=tp(n.wch),n.MDW=Br):typeof n.wch=="number"&&(n.width=tp(n.wch),n.wpx=Ah(n.width),n.MDW=Br),n.customWidth&&delete n.customWidth}var qD=96,bE=qD;function Sh(n){return n*96/bE}function AE(n){return n*bE/96}function KD(n){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var i=e[0];i<=e[1];++i)n[i]!=null&&(t[t.length]=Mt("numFmt",null,{numFmtId:i,formatCode:Ee(n[i])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Mt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function QD(n){var t=[];return t[t.length]=Mt("cellXfs",null),n.forEach(function(e){t[t.length]=Mt("xf",null,e)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Mt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function wE(n,t){var e=[ei,Mt("styleSheet",null,{xmlns:wo[0],"xmlns:vt":hi.vt})],i;return n.SSF&&(i=KD(n.SSF))!=null&&(e[e.length]=i),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(i=QD(t.cellXfs))&&(e[e.length]=i),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function ZD(n,t){var e=n.read_shift(2),i=Li(n);return[e,i]}function JD(n,t,e){e||(e=gt(6+4*t.length)),e.write_shift(2,n),di(t,e);var i=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),i}function tM(n,t,e){var i={};i.sz=n.read_shift(2)/20;var r=jR(n);r.fItalic&&(i.italic=1),r.fCondense&&(i.condense=1),r.fExtend&&(i.extend=1),r.fShadow&&(i.shadow=1),r.fOutline&&(i.outline=1),r.fStrikeout&&(i.strike=1);var a=n.read_shift(2);switch(a===700&&(i.bold=1),n.read_shift(2)){case 1:i.vertAlign="superscript";break;case 2:i.vertAlign="subscript";break}var l=n.read_shift(1);l!=0&&(i.underline=l);var c=n.read_shift(1);c>0&&(i.family=c);var h=n.read_shift(1);switch(h>0&&(i.charset=h),n.l++,i.color=HR(n),n.read_shift(1)){case 1:i.scheme="major";break;case 2:i.scheme="minor";break}return i.name=Li(n),i}function eM(n,t){t||(t=gt(153)),t.write_shift(2,n.sz*20),zR(n,t),t.write_shift(2,n.bold?700:400);var e=0;n.vertAlign=="superscript"?e=1:n.vertAlign=="subscript"&&(e=2),t.write_shift(2,e),t.write_shift(1,n.underline||0),t.write_shift(1,n.family||0),t.write_shift(1,n.charset||0),t.write_shift(1,0),Eh(n.color,t);var i=0;return i=2,t.write_shift(1,i),di(n.name,t),t.length>t.l?t.slice(0,t.l):t}var iM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],w0,nM=hr;function gy(n,t){t||(t=gt(84)),w0||(w0=Sp(iM));var e=w0[n.patternType];e==null&&(e=40),t.write_shift(4,e);var i=0;if(e!=40)for(Eh({auto:1},t),Eh({auto:1},t);i<12;++i)t.write_shift(4,0);else{for(;i<4;++i)t.write_shift(4,0);for(;i<12;++i)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function rM(n,t){var e=n.l+t,i=n.read_shift(2),r=n.read_shift(2);return n.l=e,{ixfe:i,numFmtId:r}}function SE(n,t,e){e||(e=gt(16)),e.write_shift(2,t||0),e.write_shift(2,n.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var i=0;return e.write_shift(1,i),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function Ll(n,t){return t||(t=gt(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var sM=hr;function aM(n,t){return t||(t=gt(51)),t.write_shift(1,0),Ll(null,t),Ll(null,t),Ll(null,t),Ll(null,t),Ll(null,t),t.length>t.l?t.slice(0,t.l):t}function oM(n,t){return t||(t=gt(52)),t.write_shift(4,n.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),_h(n.name||"",t),t.length>t.l?t.slice(0,t.l):t}function lM(n,t,e){var i=gt(2052);return i.write_shift(4,n),_h(t,i),_h(e,i),i.length>i.l?i.slice(0,i.l):i}function cM(n,t){if(t){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&++e}),e!=0&&(_t(n,615,Yn(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&_t(n,44,JD(r,t[r]))}),_t(n,616))}}function uM(n){var t=1;_t(n,611,Yn(t)),_t(n,43,eM({sz:12,color:{theme:1},name:"Calibri",family:2})),_t(n,612)}function hM(n){var t=2;_t(n,603,Yn(t)),_t(n,45,gy({patternType:"none"})),_t(n,45,gy({patternType:"gray125"})),_t(n,604)}function fM(n){var t=1;_t(n,613,Yn(t)),_t(n,46,aM()),_t(n,614)}function dM(n){var t=1;_t(n,626,Yn(t)),_t(n,47,SE({numFmtId:0},65535)),_t(n,627)}function pM(n,t){_t(n,617,Yn(t.length)),t.forEach(function(e){_t(n,47,SE(e,0))}),_t(n,618)}function gM(n){var t=1;_t(n,619,Yn(t)),_t(n,48,oM({xfId:0,name:"Normal"})),_t(n,620)}function mM(n){var t=0;_t(n,505,Yn(t)),_t(n,506)}function vM(n){var t=0;_t(n,508,lM(t,"TableStyleMedium9","PivotStyleMedium4")),_t(n,509)}function xM(n,t){var e=Ki();return _t(e,278),cM(e,n.SSF),uM(e),hM(e),fM(e),dM(e),pM(e,t.cellXfs),gM(e),mM(e),vM(e),_t(e,279),e.end()}function TE(n,t){if(t&&t.themeXLSX)return t.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var e=[ei];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function yM(n,t){return{flags:n.read_shift(4),version:n.read_shift(4),name:Li(n)}}function _M(n){var t=gt(12+2*n.name.length);return t.write_shift(4,n.flags),t.write_shift(4,n.version),di(n.name,t),t.slice(0,t.l)}function EM(n){for(var t=[],e=n.read_shift(4);e-- >0;)t.push([n.read_shift(4),n.read_shift(4)]);return t}function bM(n){var t=gt(4+8*n.length);t.write_shift(4,n.length);for(var e=0;e<n.length;++e)t.write_shift(4,n[e][0]),t.write_shift(4,n[e][1]);return t}function AM(n,t){var e=gt(8+2*t.length);return e.write_shift(4,n),di(t,e),e.slice(0,e.l)}function wM(n){return n.l+=4,n.read_shift(4)!=0}function SM(n,t){var e=gt(8);return e.write_shift(4,n),e.write_shift(4,1),e}function TM(){var n=Ki();return _t(n,332),_t(n,334,Yn(1)),_t(n,335,_M({name:"XLDAPR",version:12e4,flags:3496657072})),_t(n,336),_t(n,339,AM(1,"XLDAPR")),_t(n,52),_t(n,35,Yn(514)),_t(n,4096,Yn(0)),_t(n,4097,Mn(1)),_t(n,36),_t(n,53),_t(n,340),_t(n,337,SM(1)),_t(n,51,bM([[1,0]])),_t(n,338),_t(n,333),n.end()}function CE(){var n=[ei];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function CM(n){var t={};t.i=n.read_shift(4);var e={};e.r=n.read_shift(4),e.c=n.read_shift(4),t.r=be(e);var i=n.read_shift(1);return i&2&&(t.l="1"),i&8&&(t.a="1"),t}var co=1024;function RE(n,t){for(var e=[21600,21600],i=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),r=[Mt("xml",null,{"xmlns:v":fn.v,"xmlns:o":fn.o,"xmlns:x":fn.x,"xmlns:mv":fn.mv}).replace(/\/>/,">"),Mt("o:shapelayout",Mt("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),Mt("v:shapetype",[Mt("v:stroke",null,{joinstyle:"miter"}),Mt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:i})];co<n*1e3;)co+=1e3;return t.forEach(function(a){var l=fi(a[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var h=c.type=="gradient"?Mt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=Mt("v:fill",h,c),p={on:"t",obscured:"t"};++co,r=r.concat(["<v:shape"+rc({id:"_x0000_s"+co,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,Mt("v:shadow",null,p),Mt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ai("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),Ai("x:AutoFill","False"),Ai("x:Row",String(l.r)),Ai("x:Column",String(l.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),r.push("</xml>"),r.join("")}function DE(n){var t=[ei,Mt("comments",null,{xmlns:wo[0]})],e=[];return t.push("<authors>"),n.forEach(function(i){i[1].forEach(function(r){var a=Ee(r.a);e.indexOf(a)==-1&&(e.push(a),t.push("<author>"+a+"</author>")),r.T&&r.ID&&e.indexOf("tc="+r.ID)==-1&&(e.push("tc="+r.ID),t.push("<author>tc="+r.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),n.forEach(function(i){var r=0,a=[];if(i[1][0]&&i[1][0].T&&i[1][0].ID?r=e.indexOf("tc="+i[1][0].ID):i[1].forEach(function(h){h.a&&(r=e.indexOf(Ee(h.a))),a.push(h.t||"")}),t.push('<comment ref="'+i[0]+'" authorId="'+r+'"><text>'),a.length<=1)t.push(Ai("t",Ee(a[0]||"")));else{for(var l=`Comment:
    `+a[0]+`
`,c=1;c<a.length;++c)l+=`Reply:
    `+a[c]+`
`;t.push(Ai("t",Ee(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function RM(n,t,e){var i=[ei,Mt("ThreadedComments",null,{xmlns:hi.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(r){var a="";(r[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var h={ref:r[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};c==0?a=h.id:h.parentId=a,l.ID=h.id,l.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),i.push(Mt("threadedComment",Ai("text",l.t||""),h))})}),i.push("</ThreadedComments>"),i.join("")}function DM(n){var t=[ei,Mt("personList",null,{xmlns:hi.TCMNT,"xmlns:x":wo[0]}).replace(/[\/]>/,">")];return n.forEach(function(e,i){t.push(Mt("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+i).slice(-12)+"}",userId:e,providerId:"None"}))}),t.push("</personList>"),t.join("")}function MM(n){var t={};t.iauthor=n.read_shift(4);var e=pa(n);return t.rfx=e.s,t.ref=be(e.s),n.l+=16,t}function NM(n,t){return t==null&&(t=gt(36)),t.write_shift(4,n[1].iauthor),To(n[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var OM=Li;function LM(n){return di(n.slice(0,54))}function PM(n){var t=Ki(),e=[];return _t(t,628),_t(t,630),n.forEach(function(i){i[1].forEach(function(r){e.indexOf(r.a)>-1||(e.push(r.a.slice(0,54)),_t(t,632,LM(r.a)))})}),_t(t,631),_t(t,633),n.forEach(function(i){i[1].forEach(function(r){r.iauthor=e.indexOf(r.a);var a={s:fi(i[0]),e:fi(i[0])};_t(t,635,NM([a,r])),r.t&&r.t.length>0&&_t(t,637,FR(r)),_t(t,636),delete r.iauthor})}),_t(t,634),_t(t,629),t.end()}function kM(n,t){t.FullPaths.forEach(function(e,i){if(i!=0){var r=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");r.slice(-1)!=="/"&&Re.utils.cfb_add(n,r,t.FileIndex[i].content)}})}var ME=["xlsb","xlsm","xlam","biff8","xla"],FM=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function e(i,r,a,l){var c=!1,h=!1;a.length==0?h=!0:a.charAt(0)=="["&&(h=!0,a=a.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var f=a.length>0?parseInt(a,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return c?p+=t.c:--p,h?f+=t.r:--f,r+(c?"":"$")+Oi(p)+(h?"":"$")+Si(f)}return function(r,a){return t=a,r.replace(n,e)}})(),Bp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Up=(function(){return function(t,e){return t.replace(Bp,function(i,r,a,l,c,h){var f=Op(l)-(a?0:e.c),p=Np(h)-(c?0:e.r),m=p==0?"":c?p+1:"["+p+"]",v=f==0?"":a?f+1:"["+f+"]";return r+"R"+m+"C"+v})}})();function IM(n,t){return n.replace(Bp,function(e,i,r,a,l,c){return i+(r=="$"?r+a:Oi(Op(a)+t.c))+(l=="$"?l+c:Si(Np(c)+t.r))})}function BM(n){return n.length!=1}function qe(n){n.l+=1}function As(n,t){var e=n.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function NE(n,t,e){var i=2;if(e){if(e.biff>=2&&e.biff<=5)return OE(n);e.biff==12&&(i=4)}var r=n.read_shift(i),a=n.read_shift(i),l=As(n),c=As(n);return{s:{r,c:l[0],cRel:l[1],rRel:l[2]},e:{r:a,c:c[0],cRel:c[1],rRel:c[2]}}}function OE(n){var t=As(n),e=As(n),i=n.read_shift(1),r=n.read_shift(1);return{s:{r:t[0],c:i,cRel:t[1],rRel:t[2]},e:{r:e[0],c:r,cRel:e[1],rRel:e[2]}}}function UM(n,t,e){if(e.biff<8)return OE(n);var i=n.read_shift(e.biff==12?4:2),r=n.read_shift(e.biff==12?4:2),a=As(n),l=As(n);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r,c:l[0],cRel:l[1],rRel:l[2]}}}function LE(n,t,e){if(e&&e.biff>=2&&e.biff<=5)return HM(n);var i=n.read_shift(e&&e.biff==12?4:2),r=As(n);return{r:i,c:r[0],cRel:r[1],rRel:r[2]}}function HM(n){var t=As(n),e=n.read_shift(1);return{r:t[0],c:e,cRel:t[1],rRel:t[2]}}function jM(n){var t=n.read_shift(2),e=n.read_shift(2);return{r:t,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function zM(n,t,e){var i=e&&e.biff?e.biff:8;if(i>=2&&i<=5)return VM(n);var r=n.read_shift(i>=12?4:2),a=n.read_shift(2),l=(a&16384)>>14,c=(a&32768)>>15;if(a&=16383,c==1)for(;r>524287;)r-=1048576;if(l==1)for(;a>8191;)a=a-16384;return{r,c:a,cRel:l,rRel:c}}function VM(n){var t=n.read_shift(2),e=n.read_shift(1),i=(t&32768)>>15,r=(t&16384)>>14;return t&=16383,i==1&&t>=8192&&(t=t-16384),r==1&&e>=128&&(e=e-256),{r:t,c:e,cRel:r,rRel:i}}function GM(n,t,e){var i=(n[n.l++]&96)>>5,r=NE(n,e.biff>=2&&e.biff<=5?6:8,e);return[i,r]}function WM(n,t,e){var i=(n[n.l++]&96)>>5,r=n.read_shift(2,"i"),a=8;if(e)switch(e.biff){case 5:n.l+=12,a=6;break;case 12:a=12;break}var l=NE(n,a,e);return[i,r,l]}function XM(n,t,e){var i=(n[n.l++]&96)>>5;return n.l+=e&&e.biff>8?12:e.biff<8?6:8,[i]}function YM(n,t,e){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),a=8;if(e)switch(e.biff){case 5:n.l+=12,a=6;break;case 12:a=12;break}return n.l+=a,[i,r]}function $M(n,t,e){var i=(n[n.l++]&96)>>5,r=UM(n,t-1,e);return[i,r]}function qM(n,t,e){var i=(n[n.l++]&96)>>5;return n.l+=e.biff==2?6:e.biff==12?14:7,[i]}function my(n){var t=n[n.l+1]&1,e=1;return n.l+=4,[t,e]}function KM(n,t,e){n.l+=2;for(var i=n.read_shift(e&&e.biff==2?1:2),r=[],a=0;a<=i;++a)r.push(n.read_shift(e&&e.biff==2?1:2));return r}function QM(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(e&&e.biff==2?1:2)]}function ZM(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=2,[i,n.read_shift(e&&e.biff==2?1:2)]}function JM(n){var t=n[n.l+1]&255?1:0;return n.l+=2,[t,n.read_shift(2)]}function tN(n,t,e){var i=n[n.l+1]&255?1:0;return n.l+=e&&e.biff==2?3:4,[i]}function PE(n){var t=n.read_shift(1),e=n.read_shift(1);return[t,e]}function eN(n){return n.read_shift(2),PE(n)}function iN(n){return n.read_shift(2),PE(n)}function nN(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=LE(n,0,e);return[i,r]}function rN(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=zM(n,0,e);return[i,r]}function sN(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(2);e&&e.biff==5&&(n.l+=12);var a=LE(n,0,e);return[i,r,a]}function aN(n,t,e){var i=(n[n.l]&96)>>5;n.l+=1;var r=n.read_shift(e&&e.biff<=3?1:2);return[aO[r],IE[r],i]}function oN(n,t,e){var i=n[n.l++],r=n.read_shift(1),a=e&&e.biff<=3?[i==88?-1:0,n.read_shift(1)]:lN(n);return[r,(a[0]===0?IE:sO)[a[1]]]}function lN(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function cN(n,t,e){n.l+=e&&e.biff==2?3:4}function uN(n,t,e){if(n.l++,e&&e.biff==12)return[n.read_shift(4,"i"),0];var i=n.read_shift(2),r=n.read_shift(e&&e.biff==2?1:2);return[i,r]}function hN(n){return n.l++,vc[n.read_shift(1)]}function fN(n){return n.l++,n.read_shift(2)}function dN(n){return n.l++,n.read_shift(1)!==0}function pN(n){return n.l++,Co(n)}function gN(n,t,e){return n.l++,mE(n,t-1,e)}function mN(n,t){var e=[n.read_shift(1)];if(t==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=sD(n,1)?"TRUE":"FALSE",t!=12&&(n.l+=7);break;case 37:case 16:e[1]=vc[n[n.l]],n.l+=t==12?4:8;break;case 0:n.l+=8;break;case 1:e[1]=Co(n);break;case 2:e[1]=cD(n,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function vN(n,t,e){for(var i=n.read_shift(e.biff==12?4:2),r=[],a=0;a!=i;++a)r.push((e.biff==12?pa:fD)(n));return r}function xN(n,t,e){var i=0,r=0;e.biff==12?(i=n.read_shift(4),r=n.read_shift(4)):(r=1+n.read_shift(1),i=1+n.read_shift(2)),e.biff>=2&&e.biff<8&&(--i,--r==0&&(r=256));for(var a=0,l=[];a!=i&&(l[a]=[]);++a)for(var c=0;c!=r;++c)l[a][c]=mN(n,e.biff);return l}function yN(n,t,e){var i=n.read_shift(1)>>>5&3,r=!e||e.biff>=8?4:2,a=n.read_shift(r);switch(e.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[i,0,a]}function _N(n,t,e){if(e.biff==5)return EN(n);var i=n.read_shift(1)>>>5&3,r=n.read_shift(2),a=n.read_shift(4);return[i,r,a]}function EN(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2,"i");n.l+=8;var i=n.read_shift(2);return n.l+=12,[t,e,i]}function bN(n,t,e){var i=n.read_shift(1)>>>5&3;n.l+=e&&e.biff==2?3:4;var r=n.read_shift(e&&e.biff==2?1:2);return[i,r]}function AN(n,t,e){var i=n.read_shift(1)>>>5&3,r=n.read_shift(e&&e.biff==2?1:2);return[i,r]}function wN(n,t,e){var i=n.read_shift(1)>>>5&3;return n.l+=4,e.biff<8&&n.l--,e.biff==12&&(n.l+=2),[i]}function SN(n,t,e){var i=(n[n.l++]&96)>>5,r=n.read_shift(2),a=4;if(e)switch(e.biff){case 5:a=15;break;case 12:a=6;break}return n.l+=a,[i,r]}var TN=hr,CN=hr,RN=hr;function xc(n,t,e){return n.l+=2,[jM(n)]}function Hp(n){return n.l+=6,[]}var DN=xc,MN=Hp,NN=Hp,ON=xc;function kE(n){return n.l+=2,[pE(n),n.read_shift(2)&1]}var LN=xc,PN=kE,kN=Hp,FN=xc,IN=xc,BN=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function UN(n){n.l+=2;var t=n.read_shift(2),e=n.read_shift(2),i=n.read_shift(4),r=n.read_shift(2),a=n.read_shift(2),l=BN[e>>2&31];return{ixti:t,coltype:e&3,rt:l,idx:i,c:r,C:a}}function HN(n){return n.l+=2,[n.read_shift(4)]}function jN(n,t,e){return n.l+=5,n.l+=2,n.l+=e.biff==2?1:4,["PTGSHEET"]}function zN(n,t,e){return n.l+=e.biff==2?4:5,["PTGENDSHEET"]}function VN(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function GN(n){var t=n.read_shift(1)>>>5&3,e=n.read_shift(2);return[t,e]}function WN(n){return n.l+=4,[0,0]}var vy={1:{n:"PtgExp",f:uN},2:{n:"PtgTbl",f:RN},3:{n:"PtgAdd",f:qe},4:{n:"PtgSub",f:qe},5:{n:"PtgMul",f:qe},6:{n:"PtgDiv",f:qe},7:{n:"PtgPower",f:qe},8:{n:"PtgConcat",f:qe},9:{n:"PtgLt",f:qe},10:{n:"PtgLe",f:qe},11:{n:"PtgEq",f:qe},12:{n:"PtgGe",f:qe},13:{n:"PtgGt",f:qe},14:{n:"PtgNe",f:qe},15:{n:"PtgIsect",f:qe},16:{n:"PtgUnion",f:qe},17:{n:"PtgRange",f:qe},18:{n:"PtgUplus",f:qe},19:{n:"PtgUminus",f:qe},20:{n:"PtgPercent",f:qe},21:{n:"PtgParen",f:qe},22:{n:"PtgMissArg",f:qe},23:{n:"PtgStr",f:gN},26:{n:"PtgSheet",f:jN},27:{n:"PtgEndSheet",f:zN},28:{n:"PtgErr",f:hN},29:{n:"PtgBool",f:dN},30:{n:"PtgInt",f:fN},31:{n:"PtgNum",f:pN},32:{n:"PtgArray",f:qM},33:{n:"PtgFunc",f:aN},34:{n:"PtgFuncVar",f:oN},35:{n:"PtgName",f:yN},36:{n:"PtgRef",f:nN},37:{n:"PtgArea",f:GM},38:{n:"PtgMemArea",f:bN},39:{n:"PtgMemErr",f:TN},40:{n:"PtgMemNoMem",f:CN},41:{n:"PtgMemFunc",f:AN},42:{n:"PtgRefErr",f:wN},43:{n:"PtgAreaErr",f:XM},44:{n:"PtgRefN",f:rN},45:{n:"PtgAreaN",f:$M},46:{n:"PtgMemAreaN",f:VN},47:{n:"PtgMemNoMemN",f:GN},57:{n:"PtgNameX",f:_N},58:{n:"PtgRef3d",f:sN},59:{n:"PtgArea3d",f:WM},60:{n:"PtgRefErr3d",f:SN},61:{n:"PtgAreaErr3d",f:YM},255:{}},XN={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},YN={1:{n:"PtgElfLel",f:kE},2:{n:"PtgElfRw",f:FN},3:{n:"PtgElfCol",f:DN},6:{n:"PtgElfRwV",f:IN},7:{n:"PtgElfColV",f:ON},10:{n:"PtgElfRadical",f:LN},11:{n:"PtgElfRadicalS",f:kN},13:{n:"PtgElfColS",f:MN},15:{n:"PtgElfColSV",f:NN},16:{n:"PtgElfRadicalLel",f:PN},25:{n:"PtgList",f:UN},29:{n:"PtgSxName",f:HN},255:{}},$N={0:{n:"PtgAttrNoop",f:WN},1:{n:"PtgAttrSemi",f:tN},2:{n:"PtgAttrIf",f:ZM},4:{n:"PtgAttrChoose",f:KM},8:{n:"PtgAttrGoto",f:QM},16:{n:"PtgAttrSum",f:cN},32:{n:"PtgAttrBaxcel",f:my},33:{n:"PtgAttrBaxcel",f:my},64:{n:"PtgAttrSpace",f:eN},65:{n:"PtgAttrSpaceSemi",f:iN},128:{n:"PtgAttrIfError",f:JM},255:{}};function qN(n,t,e,i){if(i.biff<8)return hr(n,t);for(var r=n.l+t,a=[],l=0;l!==e.length;++l)switch(e[l][0]){case"PtgArray":e[l][1]=xN(n,0,i),a.push(e[l][1]);break;case"PtgMemArea":e[l][2]=vN(n,e[l][1],i),a.push(e[l][2]);break;case"PtgExp":i&&i.biff==12&&(e[l][1][1]=n.read_shift(4),a.push(e[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[l][0]}return t=r-n.l,t!==0&&a.push(hr(n,t)),a}function KN(n,t,e){for(var i=n.l+t,r,a,l=[];i!=n.l;)t=i-n.l,a=n[n.l],r=vy[a]||vy[XN[a]],(a===24||a===25)&&(r=(a===24?YN:$N)[n[n.l+1]]),!r||!r.f?hr(n,t):l.push([r.n,r.f(n,t,e)]);return l}function QN(n){for(var t=[],e=0;e<n.length;++e){for(var i=n[e],r=[],a=0;a<i.length;++a){var l=i[a];if(l)switch(l[0]){case 2:r.push('"'+l[1].replace(/"/g,'""')+'"');break;default:r.push(l[1])}else r.push("")}t.push(r.join(","))}return t.join(";")}var ZN={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function JN(n,t){if(!n&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function FE(n,t,e){if(!n)return"SH33TJSERR0";if(e.biff>8&&(!n.XTI||!n.XTI[t]))return n.SheetNames[t];if(!n.XTI)return"SH33TJSERR6";var i=n.XTI[t];if(e.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":n.XTI[t-1];if(!i)return"SH33TJSERR1";var r="";if(e.biff>8)switch(n[i[0]][0]){case 357:return r=i[1]==-1?"#REF":n.SheetNames[i[1]],i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 358:return e.SID!=null?n.SheetNames[e.SID]:"SH33TJSSAME"+n[i[0]][0];case 355:default:return"SH33TJSSRC"+n[i[0]][0]}switch(n[i[0]][0][0]){case 1025:return r=i[1]==-1?"#REF":n.SheetNames[i[1]]||"SH33TJSERR3",i[1]==i[2]?r:r+":"+n.SheetNames[i[2]];case 14849:return n[i[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return n[i[0]][0][3]?(r=i[1]==-1?"#REF":n[i[0]][0][3][i[1]]||"SH33TJSERR4",i[1]==i[2]?r:r+":"+n[i[0]][0][3][i[2]]):"SH33TJSERR2"}}function xy(n,t,e){var i=FE(n,t,e);return i=="#REF"?i:JN(i,e)}function Ao(n,t,e,i,r){var a=r&&r.biff||8,l={s:{c:0,r:0}},c=[],h,f,p,m=0,v=0,x,E="";if(!n[0]||!n[0][0])return"";for(var _=-1,b="",A=0,T=n[0].length;A<T;++A){var S=n[0][A];switch(S[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=c.pop(),f=c.pop(),_>=0){switch(n[0][_][1][0]){case 0:b=He(" ",n[0][_][1][1]);break;case 1:b=He("\r",n[0][_][1][1]);break;default:if(b="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}f=f+b,_=-1}c.push(f+ZN[S[0]]+h);break;case"PtgIsect":h=c.pop(),f=c.pop(),c.push(f+" "+h);break;case"PtgUnion":h=c.pop(),f=c.pop(),c.push(f+","+h);break;case"PtgRange":h=c.pop(),f=c.pop(),c.push(f+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Wl(S[1][1],l,r),c.push(Xl(p,a));break;case"PtgRefN":p=e?Wl(S[1][1],e,r):S[1][1],c.push(Xl(p,a));break;case"PtgRef3d":m=S[1][1],p=Wl(S[1][2],l,r),E=xy(i,m,r),c.push(E+"!"+Xl(p,a));break;case"PtgFunc":case"PtgFuncVar":var C=S[1][0],N=S[1][1];C||(C=0),C&=127;var B=C==0?[]:c.slice(-C);c.length-=C,N==="User"&&(N=B.shift()),c.push(N+"("+B.join(",")+")");break;case"PtgBool":c.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(S[1]);break;case"PtgNum":c.push(String(S[1]));break;case"PtgStr":c.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(S[1]);break;case"PtgAreaN":x=iy(S[1][1],e?{s:e}:l,r),c.push(b0(x,r));break;case"PtgArea":x=iy(S[1][1],l,r),c.push(b0(x,r));break;case"PtgArea3d":m=S[1][1],x=S[1][2],E=xy(i,m,r),c.push(E+"!"+b0(x,r));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=S[1][2];var O=(i.names||[])[v-1]||(i[0]||[])[v],H=O?O.Name:"SH33TJSNAME"+String(v);H&&H.slice(0,6)=="_xlfn."&&!r.xlfn&&(H=H.slice(6)),c.push(H);break;case"PtgNameX":var M=S[1][1];v=S[1][2];var W;if(r.biff<=5)M<0&&(M=-M),i[M]&&(W=i[M][v]);else{var Y="";if(((i[M]||[])[0]||[])[0]==14849||(((i[M]||[])[0]||[])[0]==1025?i[M][v]&&i[M][v].itab>0&&(Y=i.SheetNames[i[M][v].itab-1]+"!"):Y=i.SheetNames[v-1]+"!"),i[M]&&i[M][v])Y+=i[M][v].Name;else if(i[0]&&i[0][v])Y+=i[0][v].Name;else{var J=(FE(i,M,r)||"").split(";;");J[v-1]?Y=J[v-1]:Y+="SH33TJSERRX"}c.push(Y);break}W||(W={Name:"SH33TJSERRY"}),c.push(W.Name);break;case"PtgParen":var ut="(",At=")";if(_>=0){switch(b="",n[0][_][1][0]){case 2:ut=He(" ",n[0][_][1][1])+ut;break;case 3:ut=He("\r",n[0][_][1][1])+ut;break;case 4:At=He(" ",n[0][_][1][1])+At;break;case 5:At=He("\r",n[0][_][1][1])+At;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}_=-1}c.push(ut+c.pop()+At);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":p={c:S[1][1],r:S[1][0]};var Et={c:e.c,r:e.r};if(i.sharedf[be(p)]){var q=i.sharedf[be(p)];c.push(Ao(q,l,Et,i,r))}else{var nt=!1;for(h=0;h!=i.arrayf.length;++h)if(f=i.arrayf[h],!(p.c<f[0].s.c||p.c>f[0].e.c)&&!(p.r<f[0].s.r||p.r>f[0].e.r)){c.push(Ao(f[1],l,Et,i,r)),nt=!0;break}nt||c.push(S[1])}break;case"PtgArray":c.push("{"+QN(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=A;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var St=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(r.biff!=3&&_>=0&&St.indexOf(n[0][A][0])==-1){S=n[0][_];var kt=!0;switch(S[1][0]){case 4:kt=!1;case 0:b=He(" ",S[1][1]);break;case 5:kt=!1;case 1:b=He("\r",S[1][1]);break;default:if(b="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}c.push((kt?b:"")+c.pop()+(kt?"":b)),_=-1}}if(c.length>1&&r.WTF)throw new Error("bad formula stack");return c[0]}function tO(n){if(n==null){var t=gt(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof n=="number")return aa(n);return aa(0)}function eO(n,t,e,i,r){var a=oa(t,e,r),l=tO(n.v),c=gt(6),h=33;c.write_shift(2,h),c.write_shift(4,0);for(var f=gt(n.bf.length),p=0;p<n.bf.length;++p)f[p]=n.bf[p];var m=bi([a,l,c,f]);return m}function zh(n,t,e){var i=n.read_shift(4),r=KN(n,i,e),a=n.read_shift(4),l=a>0?qN(n,a,r,e):null;return[r,l]}var iO=zh,Vh=zh,nO=zh,rO=zh,sO={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},IE={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},aO={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function oO(n){var t="of:="+n.replace(Bp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function lO(n){return n.replace(/\./,"!")}var Yl=typeof Map<"u";function jp(n,t,e){var i=0,r=n.length;if(e){if(Yl?e.has(t):Object.prototype.hasOwnProperty.call(e,t)){for(var a=Yl?e.get(t):e[t];i<a.length;++i)if(n[a[i]].t===t)return n.Count++,a[i]}}else for(;i<r;++i)if(n[i].t===t)return n.Count++,i;return n[r]={t},n.Count++,n.Unique++,e&&(Yl?(e.has(t)||e.set(t,[]),e.get(t).push(r)):(Object.prototype.hasOwnProperty.call(e,t)||(e[t]=[]),e[t].push(r))),r}function Gh(n,t){var e={min:n+1,max:n+1},i=-1;return t.MDW&&(Br=t.MDW),t.width!=null?e.customWidth=1:t.wpx!=null?i=wh(t.wpx):t.wch!=null&&(i=t.wch),i>-1?(e.width=tp(i),e.customWidth=1):t.width!=null&&(e.width=t.width),t.hidden&&(e.hidden=!0),t.level!=null&&(e.outlineLevel=e.level=t.level),e}function BE(n,t){if(n){var e=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=e[0]),n.right==null&&(n.right=e[1]),n.top==null&&(n.top=e[2]),n.bottom==null&&(n.bottom=e[3]),n.header==null&&(n.header=e[4]),n.footer==null&&(n.footer=e[5])}}function Ss(n,t,e){var i=e.revssf[t.z!=null?t.z:"General"],r=60,a=n.length;if(i==null&&e.ssf){for(;r<392;++r)if(e.ssf[r]==null){L_(t.z,r),e.ssf[r]=t.z,e.revssf[t.z]=i=r;break}}for(r=0;r!=a;++r)if(n[r].numFmtId===i)return r;return n[a]={numFmtId:i,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function cO(n,t,e){if(n&&n["!ref"]){var i=Pe(n["!ref"]);if(i.e.c<i.s.c||i.e.r<i.s.r)throw new Error("Bad range ("+e+"): "+n["!ref"])}}function uO(n){if(n.length===0)return"";for(var t='<mergeCells count="'+n.length+'">',e=0;e!=n.length;++e)t+='<mergeCell ref="'+ti(n[e])+'"/>';return t+"</mergeCells>"}function hO(n,t,e,i,r){var a=!1,l={},c=null;if(i.bookType!=="xlsx"&&t.vbaraw){var h=t.SheetNames[e];try{t.Workbook&&(h=t.Workbook.Sheets[e].CodeName||h)}catch{}a=!0,l.codeName=nc(Ee(h))}if(n&&n["!outline"]){var f={summaryBelow:1,summaryRight:1};n["!outline"].above&&(f.summaryBelow=0),n["!outline"].left&&(f.summaryRight=0),c=(c||"")+Mt("outlinePr",null,f)}!a&&!c||(r[r.length]=Mt("sheetPr",c,l))}var fO=["objects","scenarios","selectLockedCells","selectUnlockedCells"],dO=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function pO(n){var t={sheet:1};return fO.forEach(function(e){n[e]!=null&&n[e]&&(t[e]="1")}),dO.forEach(function(e){n[e]!=null&&!n[e]&&(t[e]="0")}),n.password&&(t.password=EE(n.password).toString(16).toUpperCase()),Mt("sheetProtection",null,t)}function gO(n){return BE(n),Mt("pageMargins",null,n)}function mO(n,t){for(var e=["<cols>"],i,r=0;r!=t.length;++r)(i=t[r])&&(e[e.length]=Mt("col",null,Gh(r,i)));return e[e.length]="</cols>",e.join("")}function vO(n,t,e,i){var r=typeof n.ref=="string"?n.ref:ti(n.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var a=e.Workbook.Names,l=pn(r);l.s.r==l.e.r&&(l.e.r=pn(t["!ref"]).e.r,r=ti(l));for(var c=0;c<a.length;++c){var h=a[c];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==i){h.Ref="'"+e.SheetNames[i]+"'!"+r;break}}return c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+r}),Mt("autoFilter",null,{ref:r})}function xO(n,t,e,i){var r={workbookViewId:"0"};return(((i||{}).Workbook||{}).Views||[])[0]&&(r.rightToLeft=i.Workbook.Views[0].RTL?"1":"0"),Mt("sheetViews",Mt("sheetView",null,r),{})}function yO(n,t,e,i){if(n.c&&e["!comments"].push([t,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var r="",a=n.t,l=n.v;if(n.t!=="z")switch(n.t){case"b":r=n.v?"1":"0";break;case"n":r=""+n.v;break;case"e":r=vc[n.v];break;case"d":i&&i.cellDates?r=ji(n.v,-1).toISOString():(n=Zi(n),n.t="n",r=""+(n.v=Qi(ji(n.v)))),typeof n.z>"u"&&(n.z=je[14]);break;default:r=n.v;break}var c=Ai("v",Ee(r)),h={r:t},f=Ss(i.cellXfs,n,i);switch(f!==0&&(h.s=f),n.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(i&&i.bookSST){c=Ai("v",""+jp(i.Strings,n.v,i.revStrings)),h.t="s";break}h.t="str";break}if(n.t!=a&&(n.t=a,n.v=l),typeof n.f=="string"&&n.f){var p=n.F&&n.F.slice(0,t.length)==t?{t:"array",ref:n.F}:null;c=Mt("f",Ee(n.f),p)+(n.v!=null?c:"")}return n.l&&e["!links"].push([t,n.l]),n.D&&(h.cm=1),Mt("c",c,h)}function _O(n,t,e,i){var r=[],a=[],l=Pe(n["!ref"]),c="",h,f="",p=[],m=0,v=0,x=n["!rows"],E=Array.isArray(n),_={r:f},b,A=-1;for(v=l.s.c;v<=l.e.c;++v)p[v]=Oi(v);for(m=l.s.r;m<=l.e.r;++m){for(a=[],f=Si(m),v=l.s.c;v<=l.e.c;++v){h=p[v]+f;var T=E?(n[m]||[])[v]:n[h];T!==void 0&&(c=yO(T,h,n,t))!=null&&a.push(c)}(a.length>0||x&&x[m])&&(_={r:f},x&&x[m]&&(b=x[m],b.hidden&&(_.hidden=1),A=-1,b.hpx?A=Sh(b.hpx):b.hpt&&(A=b.hpt),A>-1&&(_.ht=A,_.customHeight=1),b.level&&(_.outlineLevel=b.level)),r[r.length]=Mt("row",a.join(""),_))}if(x)for(;m<x.length;++m)x&&x[m]&&(_={r:m+1},b=x[m],b.hidden&&(_.hidden=1),A=-1,b.hpx?A=Sh(b.hpx):b.hpt&&(A=b.hpt),A>-1&&(_.ht=A,_.customHeight=1),b.level&&(_.outlineLevel=b.level),r[r.length]=Mt("row","",_));return r.join("")}function UE(n,t,e,i){var r=[ei,Mt("worksheet",null,{xmlns:wo[0],"xmlns:r":hi.r})],a=e.SheetNames[n],l=0,c="",h=e.Sheets[a];h==null&&(h={});var f=h["!ref"]||"A1",p=Pe(f);if(p.e.c>16383||p.e.r>1048575){if(t.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),f=ti(p)}i||(i={}),h["!comments"]=[];var m=[];hO(h,e,n,t,r),r[r.length]=Mt("dimension",null,{ref:f}),r[r.length]=xO(h,t,n,e),t.sheetFormat&&(r[r.length]=Mt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(r[r.length]=mO(h,h["!cols"])),r[l=r.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(c=_O(h,t),c.length>0&&(r[r.length]=c)),r.length>l+1&&(r[r.length]="</sheetData>",r[l]=r[l].replace("/>",">")),h["!protect"]&&(r[r.length]=pO(h["!protect"])),h["!autofilter"]!=null&&(r[r.length]=vO(h["!autofilter"],h,e,n)),h["!merges"]!=null&&h["!merges"].length>0&&(r[r.length]=uO(h["!merges"]));var v=-1,x,E=-1;return h["!links"].length>0&&(r[r.length]="<hyperlinks>",h["!links"].forEach(function(_){_[1].Target&&(x={ref:_[0]},_[1].Target.charAt(0)!="#"&&(E=_e(i,-1,Ee(_[1].Target).replace(/#.*$/,""),he.HLINK),x["r:id"]="rId"+E),(v=_[1].Target.indexOf("#"))>-1&&(x.location=Ee(_[1].Target.slice(v+1))),_[1].Tooltip&&(x.tooltip=Ee(_[1].Tooltip)),r[r.length]=Mt("hyperlink",null,x))}),r[r.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(r[r.length]=gO(h["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(r[r.length]=Ai("ignoredErrors",Mt("ignoredError",null,{numberStoredAsText:1,sqref:f}))),m.length>0&&(E=_e(i,-1,"../drawings/drawing"+(n+1)+".xml",he.DRAW),r[r.length]=Mt("drawing",null,{"r:id":"rId"+E}),h["!drawing"]=m),h["!comments"].length>0&&(E=_e(i,-1,"../drawings/vmlDrawing"+(n+1)+".vml",he.VML),r[r.length]=Mt("legacyDrawing",null,{"r:id":"rId"+E}),h["!legacy"]=E),r.length>1&&(r[r.length]="</worksheet>",r[1]=r[1].replace("/>",">")),r.join("")}function EO(n,t){var e={},i=n.l+t;e.r=n.read_shift(4),n.l+=4;var r=n.read_shift(2);n.l+=1;var a=n.read_shift(1);return n.l=i,a&7&&(e.level=a&7),a&16&&(e.hidden=!0),a&32&&(e.hpt=r/20),e}function bO(n,t,e){var i=gt(145),r=(e["!rows"]||[])[n]||{};i.write_shift(4,n),i.write_shift(4,0);var a=320;r.hpx?a=Sh(r.hpx)*20:r.hpt&&(a=r.hpt*20),i.write_shift(2,a),i.write_shift(1,0);var l=0;r.level&&(l|=r.level),r.hidden&&(l|=16),(r.hpx||r.hpt)&&(l|=32),i.write_shift(1,l),i.write_shift(1,0);var c=0,h=i.l;i.l+=4;for(var f={r:n,c:0},p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var m=-1,v=-1,x=p<<10;x<p+1<<10;++x){f.c=x;var E=Array.isArray(e)?(e[f.r]||[])[f.c]:e[be(f)];E&&(m<0&&(m=x),v=x)}m<0||(++c,i.write_shift(4,m),i.write_shift(4,v))}var _=i.l;return i.l=h,i.write_shift(4,c),i.l=_,i.length>i.l?i.slice(0,i.l):i}function AO(n,t,e,i){var r=bO(i,e,t);(r.length>17||(t["!rows"]||[])[i])&&_t(n,0,r)}var wO=pa,SO=To;function TO(){}function CO(n,t){var e={},i=n[n.l];return++n.l,e.above=!(i&64),e.left=!(i&128),n.l+=18,e.name=IR(n),e}function RO(n,t,e){e==null&&(e=gt(84+4*n.length));var i=192;t&&(t.above&&(i&=-65),t.left&&(i&=-129)),e.write_shift(1,i);for(var r=1;r<3;++r)e.write_shift(1,0);return Eh({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),tE(n,e),e.slice(0,e.l)}function DO(n){var t=On(n);return[t]}function MO(n,t,e){return e==null&&(e=gt(8)),ha(t,e)}function NO(n){var t=fa(n);return[t]}function OO(n,t,e){return e==null&&(e=gt(4)),da(t,e)}function LO(n){var t=On(n),e=n.read_shift(1);return[t,e,"b"]}function PO(n,t,e){return e==null&&(e=gt(9)),ha(t,e),e.write_shift(1,n.v?1:0),e}function kO(n){var t=fa(n),e=n.read_shift(1);return[t,e,"b"]}function FO(n,t,e){return e==null&&(e=gt(5)),da(t,e),e.write_shift(1,n.v?1:0),e}function IO(n){var t=On(n),e=n.read_shift(1);return[t,e,"e"]}function BO(n,t,e){return e==null&&(e=gt(9)),ha(t,e),e.write_shift(1,n.v),e}function UO(n){var t=fa(n),e=n.read_shift(1);return[t,e,"e"]}function HO(n,t,e){return e==null&&(e=gt(8)),da(t,e),e.write_shift(1,n.v),e.write_shift(2,0),e.write_shift(1,0),e}function jO(n){var t=On(n),e=n.read_shift(4);return[t,e,"s"]}function zO(n,t,e){return e==null&&(e=gt(12)),ha(t,e),e.write_shift(4,t.v),e}function VO(n){var t=fa(n),e=n.read_shift(4);return[t,e,"s"]}function GO(n,t,e){return e==null&&(e=gt(8)),da(t,e),e.write_shift(4,t.v),e}function WO(n){var t=On(n),e=Co(n);return[t,e,"n"]}function XO(n,t,e){return e==null&&(e=gt(16)),ha(t,e),aa(n.v,e),e}function YO(n){var t=fa(n),e=Co(n);return[t,e,"n"]}function $O(n,t,e){return e==null&&(e=gt(12)),da(t,e),aa(n.v,e),e}function qO(n){var t=On(n),e=eE(n);return[t,e,"n"]}function KO(n,t,e){return e==null&&(e=gt(12)),ha(t,e),iE(n.v,e),e}function QO(n){var t=fa(n),e=eE(n);return[t,e,"n"]}function ZO(n,t,e){return e==null&&(e=gt(8)),da(t,e),iE(n.v,e),e}function JO(n){var t=On(n),e=Lp(n);return[t,e,"is"]}function tL(n){var t=On(n),e=Li(n);return[t,e,"str"]}function eL(n,t,e){return e==null&&(e=gt(12+4*n.v.length)),ha(t,e),di(n.v,e),e.length>e.l?e.slice(0,e.l):e}function iL(n){var t=fa(n),e=Li(n);return[t,e,"str"]}function nL(n,t,e){return e==null&&(e=gt(8+4*n.v.length)),da(t,e),di(n.v,e),e.length>e.l?e.slice(0,e.l):e}function rL(n,t,e){var i=n.l+t,r=On(n);r.r=e["!row"];var a=n.read_shift(1),l=[r,a,"b"];if(e.cellFormula){n.l+=2;var c=Vh(n,i-n.l,e);l[3]=Ao(c,null,r,e.supbooks,e)}else n.l=i;return l}function sL(n,t,e){var i=n.l+t,r=On(n);r.r=e["!row"];var a=n.read_shift(1),l=[r,a,"e"];if(e.cellFormula){n.l+=2;var c=Vh(n,i-n.l,e);l[3]=Ao(c,null,r,e.supbooks,e)}else n.l=i;return l}function aL(n,t,e){var i=n.l+t,r=On(n);r.r=e["!row"];var a=Co(n),l=[r,a,"n"];if(e.cellFormula){n.l+=2;var c=Vh(n,i-n.l,e);l[3]=Ao(c,null,r,e.supbooks,e)}else n.l=i;return l}function oL(n,t,e){var i=n.l+t,r=On(n);r.r=e["!row"];var a=Li(n),l=[r,a,"str"];if(e.cellFormula){n.l+=2;var c=Vh(n,i-n.l,e);l[3]=Ao(c,null,r,e.supbooks,e)}else n.l=i;return l}var lL=pa,cL=To;function uL(n,t){return t==null&&(t=gt(4)),t.write_shift(4,n),t}function hL(n,t){var e=n.l+t,i=pa(n),r=Pp(n),a=Li(n),l=Li(n),c=Li(n);n.l=e;var h={rfx:i,relId:r,loc:a,display:c};return l&&(h.Tooltip=l),h}function fL(n,t){var e=gt(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));To({s:fi(n[0]),e:fi(n[0])},e),kp("rId"+t,e);var i=n[1].Target.indexOf("#"),r=i==-1?"":n[1].Target.slice(i+1);return di(r||"",e),di(n[1].Tooltip||"",e),di("",e),e.slice(0,e.l)}function dL(){}function pL(n,t,e){var i=n.l+t,r=nE(n),a=n.read_shift(1),l=[r];if(l[2]=a,e.cellFormula){var c=iO(n,i-n.l,e);l[1]=c}else n.l=i;return l}function gL(n,t,e){var i=n.l+t,r=pa(n),a=[r];if(e.cellFormula){var l=rO(n,i-n.l,e);a[1]=l,n.l=i}else n.l=i;return a}function mL(n,t,e){e==null&&(e=gt(18));var i=Gh(n,t);e.write_shift(-4,n),e.write_shift(-4,n),e.write_shift(4,(i.width||10)*256),e.write_shift(4,0);var r=0;return t.hidden&&(r|=1),typeof i.width=="number"&&(r|=2),t.level&&(r|=t.level<<8),e.write_shift(2,r),e}var HE=["left","right","top","bottom","header","footer"];function vL(n){var t={};return HE.forEach(function(e){t[e]=Co(n)}),t}function xL(n,t){return t==null&&(t=gt(48)),BE(n),HE.forEach(function(e){aa(n[e],t)}),t}function yL(n){var t=n.read_shift(2);return n.l+=28,{RTL:t&32}}function _L(n,t,e){e==null&&(e=gt(30));var i=924;return(((t||{}).Views||[])[0]||{}).RTL&&(i|=32),e.write_shift(2,i),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function EL(n){var t=gt(24);return t.write_shift(4,4),t.write_shift(4,1),To(n,t),t}function bL(n,t){return t==null&&(t=gt(66)),t.write_shift(2,n.password?EE(n.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?t.write_shift(4,n[e[0]]!=null&&!n[e[0]]?1:0):t.write_shift(4,n[e[0]]!=null&&n[e[0]]?0:1)}),t}function AL(){}function wL(){}function SL(n,t,e,i,r,a,l){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=Zi(t),t.z=t.z||je[14],t.v=Qi(ji(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var h={r:e,c:i};switch(h.s=Ss(r.cellXfs,t,r),t.l&&a["!links"].push([be(h),t.l]),t.c&&a["!comments"].push([be(h),t.c]),t.t){case"s":case"str":return r.bookSST?(c=jp(r.Strings,t.v,r.revStrings),h.t="s",h.v=c,l?_t(n,18,GO(t,h)):_t(n,7,zO(t,h))):(h.t="str",l?_t(n,17,nL(t,h)):_t(n,6,eL(t,h))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?_t(n,13,ZO(t,h)):_t(n,2,KO(t,h)):l?_t(n,16,$O(t,h)):_t(n,5,XO(t,h)),!0;case"b":return h.t="b",l?_t(n,15,FO(t,h)):_t(n,4,PO(t,h)),!0;case"e":return h.t="e",l?_t(n,14,HO(t,h)):_t(n,3,BO(t,h)),!0}return l?_t(n,12,OO(t,h)):_t(n,1,MO(t,h)),!0}function TL(n,t,e,i){var r=Pe(t["!ref"]||"A1"),a,l="",c=[];_t(n,145);var h=Array.isArray(t),f=r.e.r;t["!rows"]&&(f=Math.max(r.e.r,t["!rows"].length-1));for(var p=r.s.r;p<=f;++p){l=Si(p),AO(n,t,r,p);var m=!1;if(p<=r.e.r)for(var v=r.s.c;v<=r.e.c;++v){p===r.s.r&&(c[v]=Oi(v)),a=c[v]+l;var x=h?(t[p]||[])[v]:t[a];if(!x){m=!1;continue}m=SL(n,x,p,v,i,t,m)}}_t(n,146)}function CL(n,t){!t||!t["!merges"]||(_t(n,177,uL(t["!merges"].length)),t["!merges"].forEach(function(e){_t(n,176,cL(e))}),_t(n,178))}function RL(n,t){!t||!t["!cols"]||(_t(n,390),t["!cols"].forEach(function(e,i){e&&_t(n,60,mL(i,e))}),_t(n,391))}function DL(n,t){!t||!t["!ref"]||(_t(n,648),_t(n,649,EL(Pe(t["!ref"]))),_t(n,650))}function ML(n,t,e){t["!links"].forEach(function(i){if(i[1].Target){var r=_e(e,-1,i[1].Target.replace(/#.*$/,""),he.HLINK);_t(n,494,fL(i,r))}}),delete t["!links"]}function NL(n,t,e,i){if(t["!comments"].length>0){var r=_e(i,-1,"../drawings/vmlDrawing"+(e+1)+".vml",he.VML);_t(n,551,kp("rId"+r)),t["!legacy"]=r}}function OL(n,t,e,i){if(t["!autofilter"]){var r=t["!autofilter"],a=typeof r.ref=="string"?r.ref:ti(r.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var l=e.Workbook.Names,c=pn(a);c.s.r==c.e.r&&(c.e.r=pn(t["!ref"]).e.r,a=ti(c));for(var h=0;h<l.length;++h){var f=l[h];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==i){f.Ref="'"+e.SheetNames[i]+"'!"+a;break}}h==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:i,Ref:"'"+e.SheetNames[i]+"'!"+a}),_t(n,161,To(Pe(a))),_t(n,162)}}function LL(n,t,e){_t(n,133),_t(n,137,_L(t,e)),_t(n,138),_t(n,134)}function PL(n,t){t["!protect"]&&_t(n,535,bL(t["!protect"]))}function kL(n,t,e,i){var r=Ki(),a=e.SheetNames[n],l=e.Sheets[a]||{},c=a;try{e&&e.Workbook&&(c=e.Workbook.Sheets[n].CodeName||c)}catch{}var h=Pe(l["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],_t(r,129),(e.vbaraw||l["!outline"])&&_t(r,147,RO(c,l["!outline"])),_t(r,148,SO(h)),LL(r,l,e.Workbook),RL(r,l),TL(r,l,n,t),PL(r,l),OL(r,l,e,n),CL(r,l),ML(r,l,i),l["!margins"]&&_t(r,476,xL(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&DL(r,l),NL(r,l,n,i),_t(r,130),r.end()}function FL(n,t){n.l+=10;var e=Li(n);return{name:e}}var IL=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function BL(n){return!n.Workbook||!n.Workbook.WBProps?"false":gR(n.Workbook.WBProps.date1904)?"true":"false"}var UL="][*?/\\".split("");function jE(n,t){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return UL.forEach(function(i){if(n.indexOf(i)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}function HL(n,t,e){n.forEach(function(i,r){jE(i);for(var a=0;a<r;++a)if(i==n[a])throw new Error("Duplicate Sheet Name: "+i);if(e){var l=t&&t[r]&&t[r].CodeName||i;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function jL(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var t=n.Workbook&&n.Workbook.Sheets||[];HL(n.SheetNames,t,!!n.vbaraw);for(var e=0;e<n.SheetNames.length;++e)cO(n.Sheets[n.SheetNames[e]],n.SheetNames[e],e)}function zE(n){var t=[ei];t[t.length]=Mt("workbook",null,{xmlns:wo[0],"xmlns:r":hi.r});var e=n.Workbook&&(n.Workbook.Names||[]).length>0,i={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(IL.forEach(function(c){n.Workbook.WBProps[c[0]]!=null&&n.Workbook.WBProps[c[0]]!=c[1]&&(i[c[0]]=n.Workbook.WBProps[c[0]])}),n.Workbook.WBProps.CodeName&&(i.codeName=n.Workbook.WBProps.CodeName,delete i.CodeName)),t[t.length]=Mt("workbookPr",null,i);var r=n.Workbook&&n.Workbook.Sheets||[],a=0;if(r&&r[0]&&r[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=n.SheetNames.length&&!(!r[a]||!r[a].Hidden);++a);a==n.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=n.SheetNames.length;++a){var l={name:Ee(n.SheetNames[a].slice(0,31))};if(l.sheetId=""+(a+1),l["r:id"]="rId"+(a+1),r[a])switch(r[a].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Mt("sheet",null,l)}return t[t.length]="</sheets>",e&&(t[t.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(c){var h={name:c.Name};c.Comment&&(h.comment=c.Comment),c.Sheet!=null&&(h.localSheetId=""+c.Sheet),c.Hidden&&(h.hidden="1"),c.Ref&&(t[t.length]=Mt("definedName",Ee(c.Ref),h))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function zL(n,t){var e={};return e.Hidden=n.read_shift(4),e.iTabID=n.read_shift(4),e.strRelID=J0(n),e.name=Li(n),e}function VL(n,t){return t||(t=gt(127)),t.write_shift(4,n.Hidden),t.write_shift(4,n.iTabID),kp(n.strRelID,t),di(n.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function GL(n,t){var e={},i=n.read_shift(4);e.defaultThemeVersion=n.read_shift(4);var r=t>8?Li(n):"";return r.length>0&&(e.CodeName=r),e.autoCompressPictures=!!(i&65536),e.backupFile=!!(i&64),e.checkCompatibility=!!(i&4096),e.date1904=!!(i&1),e.filterPrivacy=!!(i&8),e.hidePivotFieldList=!!(i&1024),e.promptedSolutions=!!(i&16),e.publishItems=!!(i&2048),e.refreshAllConnections=!!(i&262144),e.saveExternalLinkValues=!!(i&128),e.showBorderUnselectedTables=!!(i&4),e.showInkAnnotation=!!(i&32),e.showObjects=["all","placeholders","none"][i>>13&3],e.showPivotChartFilter=!!(i&32768),e.updateLinks=["userSet","never","always"][i>>8&3],e}function WL(n,t){t||(t=gt(72));var e=0;return n&&n.filterPrivacy&&(e|=8),t.write_shift(4,e),t.write_shift(4,0),tE(n&&n.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function XL(n,t,e){var i=n.l+t;n.l+=4,n.l+=1;var r=n.read_shift(4),a=BR(n),l=nO(n,0,e),c=Pp(n);n.l=i;var h={Name:a,Ptg:l};return r<268435455&&(h.Sheet=r),c&&(h.Comment=c),h}function YL(n,t){_t(n,143);for(var e=0;e!=t.SheetNames.length;++e){var i=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[e]&&t.Workbook.Sheets[e].Hidden||0,r={Hidden:i,iTabID:e+1,strRelID:"rId"+(e+1),name:t.SheetNames[e]};_t(n,156,VL(r))}_t(n,144)}function $L(n,t){t||(t=gt(127));for(var e=0;e!=4;++e)t.write_shift(4,0);return di("SheetJS",t),di(dh.version,t),di(dh.version,t),di("7262",t),t.length>t.l?t.slice(0,t.l):t}function qL(n,t){t||(t=gt(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,n),t.write_shift(4,n);var e=120;return t.write_shift(1,e),t.length>t.l?t.slice(0,t.l):t}function KL(n,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var e=t.Workbook.Sheets,i=0,r=-1,a=-1;i<e.length;++i)!e[i]||!e[i].Hidden&&r==-1?r=i:e[i].Hidden==1&&a==-1&&(a=i);a>r||(_t(n,135),_t(n,158,qL(r)),_t(n,136))}}function QL(n,t){var e=Ki();return _t(e,131),_t(e,128,$L()),_t(e,153,WL(n.Workbook&&n.Workbook.WBProps||null)),KL(e,n),YL(e,n),_t(e,132),e.end()}function ZL(n,t,e){return(t.slice(-4)===".bin"?QL:zE)(n)}function JL(n,t,e,i,r){return(t.slice(-4)===".bin"?kL:UE)(n,e,i,r)}function tP(n,t,e){return(t.slice(-4)===".bin"?xM:wE)(n,e)}function eP(n,t,e){return(t.slice(-4)===".bin"?WD:_E)(n,e)}function iP(n,t,e){return(t.slice(-4)===".bin"?PM:DE)(n)}function nP(n){return(n.slice(-4)===".bin"?TM:CE)()}function rP(n,t){var e=[];return n.Props&&e.push(tD(n.Props,t)),n.Custprops&&e.push(eD(n.Props,n.Custprops)),e.join("")}function sP(){return""}function aP(n,t){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(i,r){var a=[];a.push(Mt("NumberFormat",null,{"ss:Format":Ee(je[i.numFmtId])}));var l={"ss:ID":"s"+(21+r)};e.push(Mt("Style",a.join(""),l))}),Mt("Styles",e.join(""))}function VE(n){return Mt("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+Up(n.Ref,{r:0,c:0})})}function oP(n){if(!((n||{}).Workbook||{}).Names)return"";for(var t=n.Workbook.Names,e=[],i=0;i<t.length;++i){var r=t[i];r.Sheet==null&&(r.Name.match(/^_xlfn\./)||e.push(VE(r)))}return Mt("Names",e.join(""))}function lP(n,t,e,i){if(!n||!((i||{}).Workbook||{}).Names)return"";for(var r=i.Workbook.Names,a=[],l=0;l<r.length;++l){var c=r[l];c.Sheet==e&&(c.Name.match(/^_xlfn\./)||a.push(VE(c)))}return a.join("")}function cP(n,t,e,i){if(!n)return"";var r=[];if(n["!margins"]&&(r.push("<PageSetup>"),n["!margins"].header&&r.push(Mt("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&r.push(Mt("Footer",null,{"x:Margin":n["!margins"].footer})),r.push(Mt("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),r.push("</PageSetup>")),i&&i.Workbook&&i.Workbook.Sheets&&i.Workbook.Sheets[e])if(i.Workbook.Sheets[e].Hidden)r.push(Mt("Visible",i.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<e&&!(i.Workbook.Sheets[a]&&!i.Workbook.Sheets[a].Hidden);++a);a==e&&r.push("<Selected/>")}return((((i||{}).Workbook||{}).Views||[])[0]||{}).RTL&&r.push("<DisplayRightToLeft/>"),n["!protect"]&&(r.push(Ai("ProtectContents","True")),n["!protect"].objects&&r.push(Ai("ProtectObjects","True")),n["!protect"].scenarios&&r.push(Ai("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?r.push(Ai("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&r.push(Ai("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){n["!protect"][l[0]]&&r.push("<"+l[1]+"/>")})),r.length==0?"":Mt("WorksheetOptions",r.join(""),{xmlns:fn.x})}function uP(n){return n.map(function(t){var e=pR(t.t||""),i=Mt("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return Mt("Comment",i,{"ss:Author":t.a})}).join("")}function hP(n,t,e,i,r,a,l){if(!n||n.v==null&&n.f==null)return"";var c={};if(n.f&&(c["ss:Formula"]="="+Ee(Up(n.f,l))),n.F&&n.F.slice(0,t.length)==t){var h=fi(n.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(h.r==l.r?"":"["+(h.r-l.r)+"]")+"C"+(h.c==l.c?"":"["+(h.c-l.c)+"]")}if(n.l&&n.l.Target&&(c["ss:HRef"]=Ee(n.l.Target),n.l.Tooltip&&(c["x:HRefScreenTip"]=Ee(n.l.Tooltip))),e["!merges"])for(var f=e["!merges"],p=0;p!=f.length;++p)f[p].s.c!=l.c||f[p].s.r!=l.r||(f[p].e.c>f[p].s.c&&(c["ss:MergeAcross"]=f[p].e.c-f[p].s.c),f[p].e.r>f[p].s.r&&(c["ss:MergeDown"]=f[p].e.r-f[p].s.r));var m="",v="";switch(n.t){case"z":if(!i.sheetStubs)return"";break;case"n":m="Number",v=String(n.v);break;case"b":m="Boolean",v=n.v?"1":"0";break;case"e":m="Error",v=vc[n.v];break;case"d":m="DateTime",v=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||je[14]);break;case"s":m="String",v=dR(n.v||"");break}var x=Ss(i.cellXfs,n,i);c["ss:StyleID"]="s"+(21+x),c["ss:Index"]=l.c+1;var E=n.v!=null?v:"",_=n.t=="z"?"":'<Data ss:Type="'+m+'">'+E+"</Data>";return(n.c||[]).length>0&&(_+=uP(n.c)),Mt("Cell",_,c)}function fP(n,t){var e='<Row ss:Index="'+(n+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=AE(t.hpt)),t.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(e+=' ss:Hidden="1"')),e+">"}function dP(n,t,e,i){if(!n["!ref"])return"";var r=Pe(n["!ref"]),a=n["!merges"]||[],l=0,c=[];n["!cols"]&&n["!cols"].forEach(function(b,A){Ip(b);var T=!!b.width,S=Gh(A,b),C={"ss:Index":A+1};T&&(C["ss:Width"]=Ah(S.width)),b.hidden&&(C["ss:Hidden"]="1"),c.push(Mt("Column",null,C))});for(var h=Array.isArray(n),f=r.s.r;f<=r.e.r;++f){for(var p=[fP(f,(n["!rows"]||[])[f])],m=r.s.c;m<=r.e.c;++m){var v=!1;for(l=0;l!=a.length;++l)if(!(a[l].s.c>m)&&!(a[l].s.r>f)&&!(a[l].e.c<m)&&!(a[l].e.r<f)){(a[l].s.c!=m||a[l].s.r!=f)&&(v=!0);break}if(!v){var x={r:f,c:m},E=be(x),_=h?(n[f]||[])[m]:n[E];p.push(hP(_,E,n,t,e,i,x))}}p.push("</Row>"),p.length>2&&c.push(p.join(""))}return c.join("")}function pP(n,t,e){var i=[],r=e.SheetNames[n],a=e.Sheets[r],l=a?lP(a,t,n,e):"";return l.length>0&&i.push("<Names>"+l+"</Names>"),l=a?dP(a,t,n,e):"",l.length>0&&i.push("<Table>"+l+"</Table>"),i.push(cP(a,t,n,e)),i.join("")}function gP(n,t){t||(t={}),n.SSF||(n.SSF=Zi(je)),n.SSF&&(Uh(),Bh(n.SSF),t.revssf=Hh(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF,t.cellXfs=[],Ss(t.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(rP(n,t)),e.push(sP()),e.push(""),e.push("");for(var i=0;i<n.SheetNames.length;++i)e.push(Mt("Worksheet",pP(i,t,n),{"ss:Name":Ee(n.SheetNames[i])}));return e[2]=aP(n,t),e[3]=oP(n),ei+Mt("Workbook",e.join(""),{xmlns:fn.ss,"xmlns:o":fn.o,"xmlns:x":fn.x,"xmlns:ss":fn.ss,"xmlns:dt":fn.dt,"xmlns:html":fn.html})}var S0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function mP(n,t){var e=[],i=[],r=[],a=0,l,c=Wx(ry,"n"),h=Wx(sy,"n");if(n.Props)for(l=Ti(n.Props),a=0;a<l.length;++a)(Object.prototype.hasOwnProperty.call(c,l[a])?e:Object.prototype.hasOwnProperty.call(h,l[a])?i:r).push([l[a],n.Props[l[a]]]);if(n.Custprops)for(l=Ti(n.Custprops),a=0;a<l.length;++a)Object.prototype.hasOwnProperty.call(n.Props||{},l[a])||(Object.prototype.hasOwnProperty.call(c,l[a])?e:Object.prototype.hasOwnProperty.call(h,l[a])?i:r).push([l[a],n.Custprops[l[a]]]);var f=[];for(a=0;a<r.length;++a)dE.indexOf(r[a][0])>-1||uE.indexOf(r[a][0])>-1||r[a][1]!=null&&f.push(r[a]);i.length&&Re.utils.cfb_add(t,"/SummaryInformation",uy(i,S0.SI,h,sy)),(e.length||f.length)&&Re.utils.cfb_add(t,"/DocumentSummaryInformation",uy(e,S0.DSI,c,ry,f.length?f:null,S0.UDI))}function vP(n,t){var e=t||{},i=Re.utils.cfb_new({root:"R"}),r="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":r="/Workbook",e.biff=8;break;case"biff5":r="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Re.utils.cfb_add(i,r,GE(n,e)),e.biff==8&&(n.Props||n.Custprops)&&mP(n,i),e.biff==8&&n.vbaraw&&kM(i,Re.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),i}var xP={0:{f:EO},1:{f:DO},2:{f:qO},3:{f:IO},4:{f:LO},5:{f:WO},6:{f:tL},7:{f:jO},8:{f:oL},9:{f:aL},10:{f:rL},11:{f:sL},12:{f:NO},13:{f:QO},14:{f:UO},15:{f:kO},16:{f:YO},17:{f:iL},18:{f:VO},19:{f:Lp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:XL},40:{},42:{},43:{f:tM},44:{f:ZD},45:{f:nM},46:{f:sM},47:{f:rM},48:{},49:{f:NR},50:{},51:{f:EM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:OD},62:{f:JO},63:{f:CM},64:{f:AL},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:yL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:CO},148:{f:wO,p:16},151:{f:dL},152:{},153:{f:GL},154:{},155:{},156:{f:zL},157:{},158:{},159:{T:1,f:zD},160:{T:-1},161:{T:1,f:pa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:lL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:yM},336:{T:-1},337:{f:wM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:J0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:TD},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:pL},427:{f:gL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:vL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:TO},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:hL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:J0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:OM},633:{T:1},634:{T:-1},635:{T:1,f:MM},636:{T:-1},637:{f:kR},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:FL},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:wL},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Nt(n,t,e,i){var r=t;if(!isNaN(r)){var a=i||(e||[]).length||0,l=n.next(4);l.write_shift(2,r),l.write_shift(2,a),a>0&&Mp(e)&&n.push(e)}}function yP(n,t,e,i){var r=(e||[]).length||0;if(r<=8224)return Nt(n,t,e,r);var a=t;if(!isNaN(a)){for(var l=e.parts||[],c=0,h=0,f=0;f+(l[c]||8224)<=8224;)f+=l[c]||8224,c++;var p=n.next(4);for(p.write_shift(2,a),p.write_shift(2,f),n.push(e.slice(h,h+f)),h+=f;h<r;){for(p=n.next(4),p.write_shift(2,60),f=0;f+(l[c]||8224)<=8224;)f+=l[c]||8224,c++;p.write_shift(2,f),n.push(e.slice(h,h+f)),h+=f}}}function yc(n,t,e){return n||(n=gt(7)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,0),n.write_shift(1,0),n}function _P(n,t,e,i){var r=gt(9);return yc(r,n,t),gE(e,i||"b",r),r}function EP(n,t,e){var i=gt(8+2*e.length);return yc(i,n,t),i.write_shift(1,e.length),i.write_shift(e.length,e,"sbcs"),i.l<i.length?i.slice(0,i.l):i}function bP(n,t,e,i){if(t.v!=null)switch(t.t){case"d":case"n":var r=t.t=="d"?Qi(ji(t.v)):t.v;r==(r|0)&&r>=0&&r<65536?Nt(n,2,FD(e,i,r)):Nt(n,3,kD(e,i,r));return;case"b":case"e":Nt(n,5,_P(e,i,t.v,t.t));return;case"s":case"str":Nt(n,4,EP(e,i,(t.v||"").slice(0,255)));return}Nt(n,1,yc(null,e,i))}function AP(n,t,e,i){var r=Array.isArray(t),a=Pe(t["!ref"]||"A1"),l,c="",h=[];if(a.e.c>255||a.e.r>16383){if(i.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),l=ti(a)}for(var f=a.s.r;f<=a.e.r;++f){c=Si(f);for(var p=a.s.c;p<=a.e.c;++p){f===a.s.r&&(h[p]=Oi(p)),l=h[p]+c;var m=r?(t[f]||[])[p]:t[l];m&&bP(n,m,f,p)}}}function wP(n,t){for(var e=t||{},i=Ki(),r=0,a=0;a<n.SheetNames.length;++a)n.SheetNames[a]==e.sheet&&(r=a);if(r==0&&e.sheet&&n.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return Nt(i,e.biff==4?1033:e.biff==3?521:9,Fp(n,16,e)),AP(i,n.Sheets[n.SheetNames[r]],r,e),Nt(i,10),i.end()}function SP(n,t,e){Nt(n,49,xD({sz:12,name:"Arial"},e))}function TP(n,t,e){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(i){for(var r=i[0];r<=i[1];++r)t[r]!=null&&Nt(n,1054,ED(r,t[r],e))})}function CP(n,t){var e=gt(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),Nt(n,2151,e),e=gt(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),xE(Pe(t["!ref"]||"A1"),e),e.write_shift(4,4),Nt(n,2152,e)}function RP(n,t){for(var e=0;e<16;++e)Nt(n,224,fy({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(i){Nt(n,224,fy(i,0,t))})}function DP(n,t){for(var e=0;e<t["!links"].length;++e){var i=t["!links"][e];Nt(n,440,DD(i)),i[1].Tooltip&&Nt(n,2048,MD(i))}delete t["!links"]}function MP(n,t){if(t){var e=0;t.forEach(function(i,r){++e<=256&&i&&Nt(n,125,LD(Gh(r,i),r))})}}function NP(n,t,e,i,r){var a=16+Ss(r.cellXfs,t,r);if(t.v==null&&!t.bf){Nt(n,513,oa(e,i,a));return}if(t.bf)Nt(n,6,eO(t,e,i,r,a));else switch(t.t){case"d":case"n":var l=t.t=="d"?Qi(ji(t.v)):t.v;Nt(n,515,SD(e,i,l,a));break;case"b":case"e":Nt(n,517,wD(e,i,t.v,a,r,t.t));break;case"s":case"str":if(r.bookSST){var c=jp(r.Strings,t.v,r.revStrings);Nt(n,253,yD(e,i,c,a))}else Nt(n,516,_D(e,i,(t.v||"").slice(0,255),a,r));break;default:Nt(n,513,oa(e,i,a))}}function OP(n,t,e){var i=Ki(),r=e.SheetNames[n],a=e.Sheets[r]||{},l=(e||{}).Workbook||{},c=(l.Sheets||[])[n]||{},h=Array.isArray(a),f=t.biff==8,p,m="",v=[],x=Pe(a["!ref"]||"A1"),E=f?65536:16384;if(x.e.c>255||x.e.r>=E){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,E-1)}Nt(i,2057,Fp(e,16,t)),Nt(i,13,Mn(1)),Nt(i,12,Mn(100)),Nt(i,15,Ui(!0)),Nt(i,17,Ui(!1)),Nt(i,16,aa(.001)),Nt(i,95,Ui(!0)),Nt(i,42,Ui(!1)),Nt(i,43,Ui(!1)),Nt(i,130,Mn(1)),Nt(i,128,AD()),Nt(i,131,Ui(!1)),Nt(i,132,Ui(!1)),f&&MP(i,a["!cols"]),Nt(i,512,bD(x,t)),f&&(a["!links"]=[]);for(var _=x.s.r;_<=x.e.r;++_){m=Si(_);for(var b=x.s.c;b<=x.e.c;++b){_===x.s.r&&(v[b]=Oi(b)),p=v[b]+m;var A=h?(a[_]||[])[b]:a[p];A&&(NP(i,A,_,b,t),f&&A.l&&a["!links"].push([p,A.l]))}}var T=c.CodeName||c.name||r;return f&&Nt(i,574,vD((l.Views||[])[0])),f&&(a["!merges"]||[]).length&&Nt(i,229,RD(a["!merges"])),f&&DP(i,a),Nt(i,442,vE(T)),f&&CP(i,a),Nt(i,10),i.end()}function LP(n,t,e){var i=Ki(),r=(n||{}).Workbook||{},a=r.Sheets||[],l=r.WBProps||{},c=e.biff==8,h=e.biff==5;if(Nt(i,2057,Fp(n,5,e)),e.bookType=="xla"&&Nt(i,135),Nt(i,225,c?Mn(1200):null),Nt(i,193,rD(2)),h&&Nt(i,191),h&&Nt(i,192),Nt(i,226),Nt(i,92,dD("SheetJS",e)),Nt(i,66,Mn(c?1200:1252)),c&&Nt(i,353,Mn(0)),c&&Nt(i,448),Nt(i,317,PD(n.SheetNames.length)),c&&n.vbaraw&&Nt(i,211),c&&n.vbaraw){var f=l.CodeName||"ThisWorkbook";Nt(i,442,vE(f))}Nt(i,156,Mn(17)),Nt(i,25,Ui(!1)),Nt(i,18,Ui(!1)),Nt(i,19,Mn(0)),c&&Nt(i,431,Ui(!1)),c&&Nt(i,444,Mn(0)),Nt(i,61,mD()),Nt(i,64,Ui(!1)),Nt(i,141,Mn(0)),Nt(i,34,Ui(BL(n)=="true")),Nt(i,14,Ui(!0)),c&&Nt(i,439,Ui(!1)),Nt(i,218,Mn(0)),SP(i,n,e),TP(i,n.SSF,e),RP(i,e),c&&Nt(i,352,Ui(!1));var p=i.end(),m=Ki();c&&Nt(m,140,ND()),c&&e.Strings&&yP(m,252,gD(e.Strings)),Nt(m,10);var v=m.end(),x=Ki(),E=0,_=0;for(_=0;_<n.SheetNames.length;++_)E+=(c?12:11)+(c?2:1)*n.SheetNames[_].length;var b=p.length+E+v.length;for(_=0;_<n.SheetNames.length;++_){var A=a[_]||{};Nt(x,133,pD({pos:b,hs:A.Hidden||0,dt:0,name:n.SheetNames[_]},e)),b+=t[_].length}var T=x.end();if(E!=T.length)throw new Error("BS8 "+E+" != "+T.length);var S=[];return p.length&&S.push(p),T.length&&S.push(T),v.length&&S.push(v),bi(S)}function PP(n,t){var e=t||{},i=[];n&&!n.SSF&&(n.SSF=Zi(je)),n&&n.SSF&&(Uh(),Bh(n.SSF),e.revssf=Hh(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,zp(e),e.cellXfs=[],Ss(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var r=0;r<n.SheetNames.length;++r)i[i.length]=OP(r,e,n);return i.unshift(LP(n,i,e)),bi(i)}function GE(n,t){for(var e=0;e<=n.SheetNames.length;++e){var i=n.Sheets[n.SheetNames[e]];if(!(!i||!i["!ref"])){var r=pn(i["!ref"]);r.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return PP(n,t);case 4:case 3:case 2:return wP(n,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function kP(n,t,e,i){for(var r=n["!merges"]||[],a=[],l=t.s.c;l<=t.e.c;++l){for(var c=0,h=0,f=0;f<r.length;++f)if(!(r[f].s.r>e||r[f].s.c>l)&&!(r[f].e.r<e||r[f].e.c<l)){if(r[f].s.r<e||r[f].s.c<l){c=-1;break}c=r[f].e.r-r[f].s.r+1,h=r[f].e.c-r[f].s.c+1;break}if(!(c<0)){var p=be({r:e,c:l}),m=i.dense?(n[e]||[])[l]:n[p],v=m&&m.v!=null&&(m.h||fR(m.w||(Hr(m),m.w)||""))||"",x={};c>1&&(x.rowspan=c),h>1&&(x.colspan=h),i.editable?v='<span contenteditable="true">'+v+"</span>":m&&(x["data-t"]=m&&m.t||"z",m.v!=null&&(x["data-v"]=m.v),m.z!=null&&(x["data-z"]=m.z),m.l&&(m.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+m.l.Target+'">'+v+"</a>")),x.id=(i.id||"sjs")+"-"+p,a.push(Mt("td",v,x))}}var E="<tr>";return E+a.join("")+"</tr>"}var FP='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',IP="</body></html>";function BP(n,t,e){var i=[];return i.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function WE(n,t){var e=t||{},i=e.header!=null?e.header:FP,r=e.footer!=null?e.footer:IP,a=[i],l=pn(n["!ref"]);e.dense=Array.isArray(n),a.push(BP(n,l,e));for(var c=l.s.r;c<=l.e.r;++c)a.push(kP(n,l,c,e));return a.push("</table>"+r),a.join("")}function XE(n,t,e){var i=e||{},r=0,a=0;if(i.origin!=null)if(typeof i.origin=="number")r=i.origin;else{var l=typeof i.origin=="string"?fi(i.origin):i.origin;r=l.r,a=l.c}var c=t.getElementsByTagName("tr"),h=Math.min(i.sheetRows||1e7,c.length),f={s:{r:0,c:0},e:{r,c:a}};if(n["!ref"]){var p=pn(n["!ref"]);f.s.r=Math.min(f.s.r,p.s.r),f.s.c=Math.min(f.s.c,p.s.c),f.e.r=Math.max(f.e.r,p.e.r),f.e.c=Math.max(f.e.c,p.e.c),r==-1&&(f.e.r=r=p.e.r+1)}var m=[],v=0,x=n["!rows"]||(n["!rows"]=[]),E=0,_=0,b=0,A=0,T=0,S=0;for(n["!cols"]||(n["!cols"]=[]);E<c.length&&_<h;++E){var C=c[E];if(yy(C)){if(i.display)continue;x[_]={hidden:!0}}var N=C.children;for(b=A=0;b<N.length;++b){var B=N[b];if(!(i.display&&yy(B))){var O=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):mR(B.innerHTML),H=B.getAttribute("data-z")||B.getAttribute("z");for(v=0;v<m.length;++v){var M=m[v];M.s.c==A+a&&M.s.r<_+r&&_+r<=M.e.r&&(A=M.e.c+1-a,v=-1)}S=+B.getAttribute("colspan")||1,((T=+B.getAttribute("rowspan")||1)>1||S>1)&&m.push({s:{r:_+r,c:A+a},e:{r:_+r+(T||1)-1,c:A+a+(S||1)-1}});var W={t:"s",v:O},Y=B.getAttribute("data-t")||B.getAttribute("t")||"";O!=null&&(O.length==0?W.t=Y||"z":i.raw||O.trim().length==0||Y=="s"||(O==="TRUE"?W={t:"b",v:!0}:O==="FALSE"?W={t:"b",v:!1}:isNaN(Ir(O))?isNaN(ic(O).getDate())||(W={t:"d",v:ji(O)},i.cellDates||(W={t:"n",v:Qi(W.v)}),W.z=i.dateNF||je[14]):W={t:"n",v:Ir(O)})),W.z===void 0&&H!=null&&(W.z=H);var J="",ut=B.getElementsByTagName("A");if(ut&&ut.length)for(var At=0;At<ut.length&&!(ut[At].hasAttribute("href")&&(J=ut[At].getAttribute("href"),J.charAt(0)!="#"));++At);J&&J.charAt(0)!="#"&&(W.l={Target:J}),i.dense?(n[_+r]||(n[_+r]=[]),n[_+r][A+a]=W):n[be({c:A+a,r:_+r})]=W,f.e.c<A+a&&(f.e.c=A+a),A+=S}}++_}return m.length&&(n["!merges"]=(n["!merges"]||[]).concat(m)),f.e.r=Math.max(f.e.r,_-1+r),n["!ref"]=ti(f),_>=h&&(n["!fullref"]=ti((f.e.r=c.length-E+_-1+r,f))),n}function YE(n,t){var e=t||{},i=e.dense?[]:{};return XE(i,n,t)}function UP(n,t){return ua(YE(n,t),t)}function yy(n){var t="",e=HP(n);return e&&(t=e(n).getPropertyValue("display")),t||(t=n.style&&n.style.display),t==="none"}function HP(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var jP=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return ei+t}})(),_y=(function(){var n=function(a){return Ee(a).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,i=function(a,l,c){var h=[];h.push('      <table:table table:name="'+Ee(l.SheetNames[c])+`" table:style-name="ta1">
`);var f=0,p=0,m=pn(a["!ref"]||"A1"),v=a["!merges"]||[],x=0,E=Array.isArray(a);if(a["!cols"])for(p=0;p<=m.e.c;++p)h.push("        <table:table-column"+(a["!cols"][p]?' table:style-name="co'+a["!cols"][p].ods+'"':"")+`></table:table-column>
`);var _="",b=a["!rows"]||[];for(f=0;f<m.s.r;++f)_=b[f]?' table:style-name="ro'+b[f].ods+'"':"",h.push("        <table:table-row"+_+`></table:table-row>
`);for(;f<=m.e.r;++f){for(_=b[f]?' table:style-name="ro'+b[f].ods+'"':"",h.push("        <table:table-row"+_+`>
`),p=0;p<m.s.c;++p)h.push(t);for(;p<=m.e.c;++p){var A=!1,T={},S="";for(x=0;x!=v.length;++x)if(!(v[x].s.c>p)&&!(v[x].s.r>f)&&!(v[x].e.c<p)&&!(v[x].e.r<f)){(v[x].s.c!=p||v[x].s.r!=f)&&(A=!0),T["table:number-columns-spanned"]=v[x].e.c-v[x].s.c+1,T["table:number-rows-spanned"]=v[x].e.r-v[x].s.r+1;break}if(A){h.push(e);continue}var C=be({r:f,c:p}),N=E?(a[f]||[])[p]:a[C];if(N&&N.f&&(T["table:formula"]=Ee(oO(N.f)),N.F&&N.F.slice(0,C.length)==C)){var B=pn(N.F);T["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,T["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!N){h.push(t);continue}switch(N.t){case"b":S=N.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=N.v?"true":"false";break;case"n":S=N.w||String(N.v||0),T["office:value-type"]="float",T["office:value"]=N.v||0;break;case"s":case"str":S=N.v==null?"":N.v,T["office:value-type"]="string";break;case"d":S=N.w||ji(N.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=ji(N.v).toISOString(),T["table:style-name"]="ce1";break;default:h.push(t);continue}var O=n(S);if(N.l&&N.l.Target){var H=N.l.Target;H=H.charAt(0)=="#"?"#"+lO(H.slice(1)):H,H.charAt(0)!="#"&&!H.match(/^\w+:/)&&(H="../"+H),O=Mt("text:a",O,{"xlink:href":H.replace(/&/g,"&amp;")})}h.push("          "+Mt("table:table-cell",Mt("text:p",O,{}),T)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},r=function(a,l){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var p=0;p<f["!cols"].length;++p)if(f["!cols"][p]){var m=f["!cols"][p];if(m.width==null&&m.wpx==null&&m.wch==null)continue;Ip(m),m.ods=c;var v=f["!cols"][p].wpx+"px";a.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),a.push(`  </style:style>
`),++c}}});var h=0;l.SheetNames.map(function(f){return l.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var p=0;p<f["!rows"].length;++p)if(f["!rows"][p]){f["!rows"][p].ods=h;var m=f["!rows"][p].hpx+"px";a.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+m+`"/>
`),a.push(`  </style:style>
`),++h}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(l,c){var h=[ei],f=rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=rc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(h.push("<office:document"+f+p+`>
`),h.push(lE().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+f+`>
`),r(h,l),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var m=0;m!=l.SheetNames.length;++m)h.push(i(l.Sheets[l.SheetNames[m]],l,m));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),c.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function $E(n,t){if(t.bookType=="fods")return _y(n,t);var e=Tp(),i="",r=[],a=[];return i="mimetype",Zt(e,i,"application/vnd.oasis.opendocument.spreadsheet"),i="content.xml",Zt(e,i,_y(n,t)),r.push([i,"text/xml"]),a.push([i,"ContentFile"]),i="styles.xml",Zt(e,i,jP(n,t)),r.push([i,"text/xml"]),a.push([i,"StylesFile"]),i="meta.xml",Zt(e,i,ei+lE()),r.push([i,"text/xml"]),a.push([i,"MetadataFile"]),i="manifest.rdf",Zt(e,i,JR(a)),r.push([i,"application/rdf+xml"]),i="META-INF/manifest.xml",Zt(e,i,QR(r)),e}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Th(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function zP(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):Wn(nc(n))}function VP(n,t){t:for(var e=0;e<=n.length-t.length;++e){for(var i=0;i<t.length;++i)if(n[e+i]!=t[i])continue t;return!0}return!1}function ws(n){var t=n.reduce(function(r,a){return r+a.length},0),e=new Uint8Array(t),i=0;return n.forEach(function(r){e.set(r,i),i+=r.length}),e}function GP(n,t,e){var i=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,r=e/Math.pow(10,i-6176);n[t+15]|=i>>7,n[t+14]|=(i&127)<<1;for(var a=0;r>=1;++a,r/=256)n[t+a]=r&255;n[t+15]|=e>=0?0:128}function sc(n,t){var e=t?t[0]:0,i=n[e]&127;t:if(n[e++]>=128&&(i|=(n[e]&127)<<7,n[e++]<128||(i|=(n[e]&127)<<14,n[e++]<128)||(i|=(n[e]&127)<<21,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,28),++e,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,35),++e,n[e++]<128)||(i+=(n[e]&127)*Math.pow(2,42),++e,n[e++]<128)))break t;return t&&(t[0]=e),i}function ye(n){var t=new Uint8Array(7);t[0]=n&127;var e=1;t:if(n>127){if(t[e-1]|=128,t[e]=n>>7&127,++e,n<=16383||(t[e-1]|=128,t[e]=n>>14&127,++e,n<=2097151)||(t[e-1]|=128,t[e]=n>>21&127,++e,n<=268435455)||(t[e-1]|=128,t[e]=n/256>>>21&127,++e,n<=34359738367)||(t[e-1]|=128,t[e]=n/65536>>>21&127,++e,n<=4398046511103))break t;t[e-1]|=128,t[e]=n/16777216>>>21&127,++e}return t.slice(0,e)}function yo(n){var t=0,e=n[t]&127;t:if(n[t++]>=128){if(e|=(n[t]&127)<<7,n[t++]<128||(e|=(n[t]&127)<<14,n[t++]<128)||(e|=(n[t]&127)<<21,n[t++]<128))break t;e|=(n[t]&127)<<28}return e}function ri(n){for(var t=[],e=[0];e[0]<n.length;){var i=e[0],r=sc(n,e),a=r&7;r=Math.floor(r/8);var l=0,c;if(r==0)break;switch(a){case 0:{for(var h=e[0];n[e[0]++]>=128;);c=n.slice(h,e[0])}break;case 5:l=4,c=n.slice(e[0],e[0]+l),e[0]+=l;break;case 1:l=8,c=n.slice(e[0],e[0]+l),e[0]+=l;break;case 2:l=sc(n,e),c=n.slice(e[0],e[0]+l),e[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(r," at offset ").concat(i))}var f={data:c,type:a};t[r]==null?t[r]=[f]:t[r].push(f)}return t}function yi(n){var t=[];return n.forEach(function(e,i){e.forEach(function(r){r.data&&(t.push(ye(i*8+r.type)),r.type==2&&t.push(ye(r.data.length)),t.push(r.data))})}),ws(t)}function zn(n){for(var t,e=[],i=[0];i[0]<n.length;){var r=sc(n,i),a=ri(n.slice(i[0],i[0]+r));i[0]+=r;var l={id:yo(a[1][0].data),messages:[]};a[2].forEach(function(c){var h=ri(c.data),f=yo(h[3][0].data);l.messages.push({meta:h,data:n.slice(i[0],i[0]+f)}),i[0]+=f}),(t=a[3])!=null&&t[0]&&(l.merge=yo(a[3][0].data)>>>0>0),e.push(l)}return e}function eo(n){var t=[];return n.forEach(function(e){var i=[];i[1]=[{data:ye(e.id),type:0}],i[2]=[],e.merge!=null&&(i[3]=[{data:ye(+!!e.merge),type:0}]);var r=[];e.messages.forEach(function(l){r.push(l.data),l.meta[3]=[{type:0,data:ye(l.data.length)}],i[2].push({data:yi(l.meta),type:2})});var a=yi(i);t.push(ye(a.length)),t.push(a),r.forEach(function(l){return t.push(l)})}),ws(t)}function WP(n,t){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var e=[0],i=sc(t,e),r=[];e[0]<t.length;){var a=t[e[0]]&3;if(a==0){var l=t[e[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[e[0]],c>1&&(l|=t[e[0]+1]<<8),c>2&&(l|=t[e[0]+2]<<16),c>3&&(l|=t[e[0]+3]<<24),l>>>=0,l++,e[0]+=c}r.push(t.slice(e[0],e[0]+l)),e[0]+=l;continue}else{var h=0,f=0;if(a==1?(f=(t[e[0]]>>2&7)+4,h=(t[e[0]++]&224)<<3,h|=t[e[0]++]):(f=(t[e[0]++]>>2)+1,a==2?(h=t[e[0]]|t[e[0]+1]<<8,e[0]+=2):(h=(t[e[0]]|t[e[0]+1]<<8|t[e[0]+2]<<16|t[e[0]+3]<<24)>>>0,e[0]+=4)),r=[ws(r)],h==0)throw new Error("Invalid offset 0");if(h>r[0].length)throw new Error("Invalid offset beyond length");if(f>=h)for(r.push(r[0].slice(-h)),f-=h;f>=r[r.length-1].length;)r.push(r[r.length-1]),f-=r[r.length-1].length;r.push(r[0].slice(-h,-h+f))}}var p=ws(r);if(p.length!=i)throw new Error("Unexpected length: ".concat(p.length," != ").concat(i));return p}function Vn(n){for(var t=[],e=0;e<n.length;){var i=n[e++],r=n[e]|n[e+1]<<8|n[e+2]<<16;e+=3,t.push(WP(i,n.slice(e,e+r))),e+=r}if(e!==n.length)throw new Error("data is not a valid framed stream!");return ws(t)}function io(n){for(var t=[],e=0;e<n.length;){var i=Math.min(n.length-e,268435455),r=new Uint8Array(4);t.push(r);var a=ye(i),l=a.length;t.push(a),i<=60?(l++,t.push(new Uint8Array([i-1<<2]))):i<=256?(l+=2,t.push(new Uint8Array([240,i-1&255]))):i<=65536?(l+=3,t.push(new Uint8Array([244,i-1&255,i-1>>8&255]))):i<=16777216?(l+=4,t.push(new Uint8Array([248,i-1&255,i-1>>8&255,i-1>>16&255]))):i<=4294967296&&(l+=5,t.push(new Uint8Array([252,i-1&255,i-1>>8&255,i-1>>16&255,i-1>>>24&255]))),t.push(n.slice(e,e+i)),l+=i,r[0]=0,r[1]=l&255,r[2]=l>>8&255,r[3]=l>>16&255,e+=i}return ws(t)}function T0(n,t){var e=new Uint8Array(32),i=Th(e),r=12,a=0;switch(e[0]=5,n.t){case"n":e[1]=2,GP(e,r,n.v),a|=1,r+=16;break;case"b":e[1]=6,i.setFloat64(r,n.v?1:0,!0),a|=2,r+=8;break;case"s":if(t.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));e[1]=3,i.setUint32(r,t.indexOf(n.v),!0),a|=8,r+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(8,a,!0),e.slice(0,r)}function C0(n,t){var e=new Uint8Array(32),i=Th(e),r=12,a=0;switch(e[0]=3,n.t){case"n":e[2]=2,i.setFloat64(r,n.v,!0),a|=32,r+=8;break;case"b":e[2]=6,i.setFloat64(r,n.v?1:0,!0),a|=32,r+=8;break;case"s":if(t.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));e[2]=3,i.setUint32(r,t.indexOf(n.v),!0),a|=16,r+=4;break;default:throw"unsupported cell type "+n.t}return i.setUint32(4,a,!0),e.slice(0,r)}function fs(n){var t=ri(n);return sc(t[1][0].data)}function XP(n,t,e){var i,r,a,l;if(!((i=n[6])!=null&&i[0])||!((r=n[7])!=null&&r[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(a=n[8])==null?void 0:a[0])==null?void 0:l.data)&&yo(n[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var h=0,f=Th(n[7][0].data),p=0,m=[],v=Th(n[4][0].data),x=0,E=[],_=0;_<t.length;++_){if(t[_]==null){f.setUint16(_*2,65535,!0),v.setUint16(_*2,65535);continue}f.setUint16(_*2,p,!0),v.setUint16(_*2,x,!0);var b,A;switch(typeof t[_]){case"string":b=T0({t:"s",v:t[_]},e),A=C0({t:"s",v:t[_]},e);break;case"number":b=T0({t:"n",v:t[_]},e),A=C0({t:"n",v:t[_]},e);break;case"boolean":b=T0({t:"b",v:t[_]},e),A=C0({t:"b",v:t[_]},e);break;default:throw new Error("Unsupported value "+t[_])}m.push(b),p+=b.length,E.push(A),x+=A.length,++h}for(n[2][0].data=ye(h);_<n[7][0].data.length/2;++_)f.setUint16(_*2,65535,!0),v.setUint16(_*2,65535,!0);return n[6][0].data=ws(m),n[3][0].data=ws(E),h}function YP(n,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var i=pn(e["!ref"]);i.s.r=i.s.c=0;var r=!1;i.e.c>9&&(r=!0,i.e.c=9),i.e.r>49&&(r=!0,i.e.r=49),r&&console.error("The Numbers writer is currently limited to ".concat(ti(i)));var a=Ch(e,{range:i,header:1}),l=["~Sh33tJ5~"];a.forEach(function(j){return j.forEach(function(z){typeof z=="string"&&l.push(z)})});var c={},h=[],f=Re.read(t.numbers,{type:"base64"});f.FileIndex.map(function(j,z){return[j,f.FullPaths[z]]}).forEach(function(j){var z=j[0],X=j[1];if(z.type==2&&z.name.match(/\.iwa/)){var et=z.content,wt=Vn(et),Ct=zn(wt);Ct.forEach(function(pt){h.push(pt.id),c[pt.id]={deps:[],location:X,type:yo(pt.messages[0].meta[1][0].data)}})}}),h.sort(function(j,z){return j-z});var p=h.filter(function(j){return j>1}).map(function(j){return[j,ye(j)]});f.FileIndex.map(function(j,z){return[j,f.FullPaths[z]]}).forEach(function(j){var z=j[0];if(j[1],!!z.name.match(/\.iwa/)){var X=zn(Vn(z.content));X.forEach(function(et){et.messages.forEach(function(wt){p.forEach(function(Ct){et.messages.some(function(pt){return yo(pt.meta[1][0].data)!=11006&&VP(pt.data,Ct[1])})&&c[Ct[0]].deps.push(et.id)})})})}});for(var m=Re.find(f,c[1].location),v=zn(Vn(m.content)),x,E=0;E<v.length;++E){var _=v[E];_.id==1&&(x=_)}var b=fs(ri(x.messages[0].data)[1][0].data);for(m=Re.find(f,c[b].location),v=zn(Vn(m.content)),E=0;E<v.length;++E)_=v[E],_.id==b&&(x=_);for(b=fs(ri(x.messages[0].data)[2][0].data),m=Re.find(f,c[b].location),v=zn(Vn(m.content)),E=0;E<v.length;++E)_=v[E],_.id==b&&(x=_);for(b=fs(ri(x.messages[0].data)[2][0].data),m=Re.find(f,c[b].location),v=zn(Vn(m.content)),E=0;E<v.length;++E)_=v[E],_.id==b&&(x=_);var A=ri(x.messages[0].data);{A[6][0].data=ye(i.e.r+1),A[7][0].data=ye(i.e.c+1);var T=fs(A[46][0].data),S=Re.find(f,c[T].location),C=zn(Vn(S.content));{for(var N=0;N<C.length&&C[N].id!=T;++N);if(C[N].id!=T)throw"Bad ColumnRowUIDMapArchive";var B=ri(C[N].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var O=0;O<=i.e.c;++O){var H=[];H[1]=H[2]=[{type:0,data:ye(O+420690)}],B[1].push({type:2,data:yi(H)}),B[2].push({type:0,data:ye(O)}),B[3].push({type:0,data:ye(O)})}B[4]=[],B[5]=[],B[6]=[];for(var M=0;M<=i.e.r;++M)H=[],H[1]=H[2]=[{type:0,data:ye(M+726270)}],B[4].push({type:2,data:yi(H)}),B[5].push({type:0,data:ye(M)}),B[6].push({type:0,data:ye(M)});C[N].messages[0].data=yi(B)}S.content=io(eo(C)),S.size=S.content.length,delete A[46];var W=ri(A[4][0].data);{W[7][0].data=ye(i.e.r+1);var Y=ri(W[1][0].data),J=fs(Y[2][0].data);S=Re.find(f,c[J].location),C=zn(Vn(S.content));{if(C[0].id!=J)throw"Bad HeaderStorageBucket";var ut=ri(C[0].messages[0].data);for(M=0;M<a.length;++M){var At=ri(ut[2][0].data);At[1][0].data=ye(M),At[4][0].data=ye(a[M].length),ut[2][M]={type:ut[2][0].type,data:yi(At)}}C[0].messages[0].data=yi(ut)}S.content=io(eo(C)),S.size=S.content.length;var Et=fs(W[2][0].data);S=Re.find(f,c[Et].location),C=zn(Vn(S.content));{if(C[0].id!=Et)throw"Bad HeaderStorageBucket";for(ut=ri(C[0].messages[0].data),O=0;O<=i.e.c;++O)At=ri(ut[2][0].data),At[1][0].data=ye(O),At[4][0].data=ye(i.e.r+1),ut[2][O]={type:ut[2][0].type,data:yi(At)};C[0].messages[0].data=yi(ut)}S.content=io(eo(C)),S.size=S.content.length;var q=fs(W[4][0].data);(function(){for(var j=Re.find(f,c[q].location),z=zn(Vn(j.content)),X,et=0;et<z.length;++et){var wt=z[et];wt.id==q&&(X=wt)}var Ct=ri(X.messages[0].data);{Ct[3]=[];var pt=[];l.forEach(function(Lt,Qt){pt[1]=[{type:0,data:ye(Qt)}],pt[2]=[{type:0,data:ye(1)}],pt[3]=[{type:2,data:zP(Lt)}],Ct[3].push({type:2,data:yi(pt)})})}X.messages[0].data=yi(Ct);var yt=eo(z),Ut=io(yt);j.content=Ut,j.size=j.content.length})();var nt=ri(W[3][0].data);{var St=nt[1][0];delete nt[2];var kt=ri(St.data);{var G=fs(kt[2][0].data);(function(){for(var j=Re.find(f,c[G].location),z=zn(Vn(j.content)),X,et=0;et<z.length;++et){var wt=z[et];wt.id==G&&(X=wt)}var Ct=ri(X.messages[0].data);{delete Ct[6],delete nt[7];var pt=new Uint8Array(Ct[5][0].data);Ct[5]=[];for(var yt=0,Ut=0;Ut<=i.e.r;++Ut){var Lt=ri(pt);yt+=XP(Lt,a[Ut],l),Lt[1][0].data=ye(Ut),Ct[5].push({data:yi(Lt),type:2})}Ct[1]=[{type:0,data:ye(i.e.c+1)}],Ct[2]=[{type:0,data:ye(i.e.r+1)}],Ct[3]=[{type:0,data:ye(yt)}],Ct[4]=[{type:0,data:ye(i.e.r+1)}]}X.messages[0].data=yi(Ct);var Qt=eo(z),jt=io(Qt);j.content=jt,j.size=j.content.length})()}St.data=yi(kt)}W[3][0].data=yi(nt)}A[4][0].data=yi(W)}x.messages[0].data=yi(A);var ht=eo(v),P=io(ht);return m.content=P,m.size=m.content.length,f}function $P(n){return function(e){for(var i=0;i!=n.length;++i){var r=n[i];e[r[0]]===void 0&&(e[r[0]]=r[1]),r[2]==="n"&&(e[r[0]]=Number(e[r[0]]))}}}function zp(n){$P([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function qP(n,t){return t.bookType=="ods"?$E(n,t):t.bookType=="numbers"?YP(n,t):t.bookType=="xlsb"?KP(n,t):QP(n,t)}function KP(n,t){co=1024,n&&!n.SSF&&(n.SSF=Zi(je)),n&&n.SSF&&(Uh(),Bh(n.SSF),t.revssf=Hh(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Yl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e=t.bookType=="xlsb"?"bin":"xml",i=ME.indexOf(t.bookType)>-1,r=sE();zp(t=t||{});var a=Tp(),l="",c=0;if(t.cellXfs=[],Ss(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),l="docProps/core.xml",Zt(a,l,cE(n.Props,t)),r.coreprops.push(l),_e(t.rels,2,l,he.CORE_PROPS),l="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var h=[],f=0;f<n.SheetNames.length;++f)(n.Workbook.Sheets[f]||{}).Hidden!=2&&h.push(n.SheetNames[f]);n.Props.SheetNames=h}for(n.Props.Worksheets=n.Props.SheetNames.length,Zt(a,l,hE(n.Props)),r.extprops.push(l),_e(t.rels,3,l,he.EXT_PROPS),n.Custprops!==n.Props&&Ti(n.Custprops||{}).length>0&&(l="docProps/custom.xml",Zt(a,l,fE(n.Custprops)),r.custprops.push(l),_e(t.rels,4,l,he.CUST_PROPS)),c=1;c<=n.SheetNames.length;++c){var p={"!id":{}},m=n.Sheets[n.SheetNames[c-1]],v=(m||{})["!type"]||"sheet";switch(v){case"chart":default:l="xl/worksheets/sheet"+c+"."+e,Zt(a,l,JL(c-1,l,t,n,p)),r.sheets.push(l),_e(t.wbrels,-1,"worksheets/sheet"+c+"."+e,he.WS[0])}if(m){var x=m["!comments"],E=!1,_="";x&&x.length>0&&(_="xl/comments"+c+"."+e,Zt(a,_,iP(x,_)),r.comments.push(_),_e(p,-1,"../comments"+c+"."+e,he.CMNT),E=!0),m["!legacy"]&&E&&Zt(a,"xl/drawings/vmlDrawing"+c+".vml",RE(c,m["!comments"])),delete m["!comments"],delete m["!legacy"]}p["!id"].rId1&&Zt(a,oE(l),vo(p))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+e,Zt(a,l,eP(t.Strings,l,t)),r.strs.push(l),_e(t.wbrels,-1,"sharedStrings."+e,he.SST)),l="xl/workbook."+e,Zt(a,l,ZL(n,l)),r.workbooks.push(l),_e(t.rels,1,l,he.WB),l="xl/theme/theme1.xml",Zt(a,l,TE(n.Themes,t)),r.themes.push(l),_e(t.wbrels,-1,"theme/theme1.xml",he.THEME),l="xl/styles."+e,Zt(a,l,tP(n,l,t)),r.styles.push(l),_e(t.wbrels,-1,"styles."+e,he.STY),n.vbaraw&&i&&(l="xl/vbaProject.bin",Zt(a,l,n.vbaraw),r.vba.push(l),_e(t.wbrels,-1,"vbaProject.bin",he.VBA)),l="xl/metadata."+e,Zt(a,l,nP(l)),r.metadata.push(l),_e(t.wbrels,-1,"metadata."+e,he.XLMETA),Zt(a,"[Content_Types].xml",aE(r,t)),Zt(a,"_rels/.rels",vo(t.rels)),Zt(a,"xl/_rels/workbook."+e+".rels",vo(t.wbrels)),delete t.revssf,delete t.ssf,a}function QP(n,t){co=1024,n&&!n.SSF&&(n.SSF=Zi(je)),n&&n.SSF&&(Uh(),Bh(n.SSF),t.revssf=Hh(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Yl?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var e="xml",i=ME.indexOf(t.bookType)>-1,r=sE();zp(t=t||{});var a=Tp(),l="",c=0;if(t.cellXfs=[],Ss(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),l="docProps/core.xml",Zt(a,l,cE(n.Props,t)),r.coreprops.push(l),_e(t.rels,2,l,he.CORE_PROPS),l="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var h=[],f=0;f<n.SheetNames.length;++f)(n.Workbook.Sheets[f]||{}).Hidden!=2&&h.push(n.SheetNames[f]);n.Props.SheetNames=h}n.Props.Worksheets=n.Props.SheetNames.length,Zt(a,l,hE(n.Props)),r.extprops.push(l),_e(t.rels,3,l,he.EXT_PROPS),n.Custprops!==n.Props&&Ti(n.Custprops||{}).length>0&&(l="docProps/custom.xml",Zt(a,l,fE(n.Custprops)),r.custprops.push(l),_e(t.rels,4,l,he.CUST_PROPS));var p=["SheetJ5"];for(t.tcid=0,c=1;c<=n.SheetNames.length;++c){var m={"!id":{}},v=n.Sheets[n.SheetNames[c-1]],x=(v||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+c+"."+e,Zt(a,l,UE(c-1,t,n,m)),r.sheets.push(l),_e(t.wbrels,-1,"worksheets/sheet"+c+"."+e,he.WS[0])}if(v){var E=v["!comments"],_=!1,b="";if(E&&E.length>0){var A=!1;E.forEach(function(T){T[1].forEach(function(S){S.T==!0&&(A=!0)})}),A&&(b="xl/threadedComments/threadedComment"+c+"."+e,Zt(a,b,RM(E,p,t)),r.threadedcomments.push(b),_e(m,-1,"../threadedComments/threadedComment"+c+"."+e,he.TCMNT)),b="xl/comments"+c+"."+e,Zt(a,b,DE(E)),r.comments.push(b),_e(m,-1,"../comments"+c+"."+e,he.CMNT),_=!0}v["!legacy"]&&_&&Zt(a,"xl/drawings/vmlDrawing"+c+".vml",RE(c,v["!comments"])),delete v["!comments"],delete v["!legacy"]}m["!id"].rId1&&Zt(a,oE(l),vo(m))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+e,Zt(a,l,_E(t.Strings,t)),r.strs.push(l),_e(t.wbrels,-1,"sharedStrings."+e,he.SST)),l="xl/workbook."+e,Zt(a,l,zE(n)),r.workbooks.push(l),_e(t.rels,1,l,he.WB),l="xl/theme/theme1.xml",Zt(a,l,TE(n.Themes,t)),r.themes.push(l),_e(t.wbrels,-1,"theme/theme1.xml",he.THEME),l="xl/styles."+e,Zt(a,l,wE(n,t)),r.styles.push(l),_e(t.wbrels,-1,"styles."+e,he.STY),n.vbaraw&&i&&(l="xl/vbaProject.bin",Zt(a,l,n.vbaraw),r.vba.push(l),_e(t.wbrels,-1,"vbaProject.bin",he.VBA)),l="xl/metadata."+e,Zt(a,l,CE()),r.metadata.push(l),_e(t.wbrels,-1,"metadata."+e,he.XLMETA),p.length>1&&(l="xl/persons/person.xml",Zt(a,l,DM(p)),r.people.push(l),_e(t.wbrels,-1,"persons/person.xml",he.PEOPLE)),Zt(a,"[Content_Types].xml",aE(r,t)),Zt(a,"_rels/.rels",vo(t.rels)),Zt(a,"xl/_rels/workbook."+e+".rels",vo(t.wbrels)),delete t.revssf,delete t.ssf,a}function ZP(n,t){var e="";switch((t||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":e=Ur(n.slice(0,12));break;case"binary":e=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function qE(n,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return gc(t.file,Re.write(n,{type:pe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Re.write(n,t)}function JP(n,t){var e=Zi(t||{}),i=qP(n,e);return t4(i,e)}function t4(n,t){var e={},i=pe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(e.compression="DEFLATE"),t.password)e.type=i;else switch(t.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":e.type=i;break;default:throw new Error("Unrecognized type "+t.type)}var r=n.FullPaths?Re.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!t.compression}):n.generate(e);if(typeof Deno<"u"&&typeof r=="string"){if(t.type=="binary"||t.type=="base64")return r;r=new Uint8Array(Ih(r))}return t.password&&typeof encrypt_agile<"u"?qE(encrypt_agile(r,t.password),t):t.type==="file"?gc(t.file,r):t.type=="string"?Vl(r):r}function e4(n,t){var e=t||{},i=vP(n,e);return qE(i,e)}function ar(n,t,e){e||(e="");var i=e+n;switch(t.type){case"base64":return ec(nc(i));case"binary":return nc(i);case"string":return n;case"file":return gc(t.file,i,"utf8");case"buffer":return pe?jr(i,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(i):ar(i,{type:"binary"}).split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function i4(n,t){switch(t.type){case"base64":return ec(n);case"binary":return n;case"string":return n;case"file":return gc(t.file,n,"binary");case"buffer":return pe?jr(n,"binary"):n.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ih(n,t){switch(t.type){case"string":case"base64":case"binary":for(var e="",i=0;i<n.length;++i)e+=String.fromCharCode(n[i]);return t.type=="base64"?ec(e):t.type=="string"?Vl(e):e;case"file":return gc(t.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+t.type)}}function KE(n,t){MC(),jL(n);var e=Zi(t||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var i=KE(n,e);return e.type="array",Ih(i)}var r=0;if(e.sheet&&(typeof e.sheet=="number"?r=e.sheet:r=n.SheetNames.indexOf(e.sheet),!n.SheetNames[r]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return ar(gP(n,e),e);case"slk":case"sylk":return ar(BD.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"htm":case"html":return ar(WE(n.Sheets[n.SheetNames[r]],e),e);case"txt":return i4(QE(n.Sheets[n.SheetNames[r]],e),e);case"csv":return ar(Vp(n.Sheets[n.SheetNames[r]],e),e,"\uFEFF");case"dif":return ar(UD.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"dbf":return ih(ID.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"prn":return ar(HD.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"rtf":return ar(YD.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"eth":return ar(yE.from_sheet(n.Sheets[n.SheetNames[r]],e),e);case"fods":return ar($E(n,e),e);case"wk1":return ih(dy.sheet_to_wk1(n.Sheets[n.SheetNames[r]],e),e);case"wk3":return ih(dy.book_to_wk3(n,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),ih(GE(n,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),e4(n,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return JP(n,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function n4(n){if(!n.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(n.bookType=e.slice(1)),n.bookType=t[n.bookType]||n.bookType}}function r4(n,t,e){var i={};return i.type="file",i.file=t,n4(i),KE(n,i)}function s4(n,t,e,i,r,a,l,c){var h=Si(e),f=c.defval,p=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),m=!0,v=r===1?[]:{};if(r!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:e,enumerable:!1})}catch{v.__rowNum__=e}else v.__rowNum__=e;if(!l||n[e])for(var x=t.s.c;x<=t.e.c;++x){var E=l?n[e][x]:n[i[x]+h];if(E===void 0||E.t===void 0){if(f===void 0)continue;a[x]!=null&&(v[a[x]]=f);continue}var _=E.v;switch(E.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+E.t)}if(a[x]!=null){if(_==null)if(E.t=="e"&&_===null)v[a[x]]=null;else if(f!==void 0)v[a[x]]=f;else if(p&&_===null)v[a[x]]=null;else continue;else v[a[x]]=p&&(E.t!=="n"||E.t==="n"&&c.rawNumbers!==!1)?_:Hr(E,_,c);_!=null&&(m=!1)}}return{row:v,isempty:m}}function Ch(n,t){if(n==null||n["!ref"]==null)return[];var e={t:"n",v:0},i=0,r=1,a=[],l=0,c="",h={s:{r:0,c:0},e:{r:0,c:0}},f=t||{},p=f.range!=null?f.range:n["!ref"];switch(f.header===1?i=1:f.header==="A"?i=2:Array.isArray(f.header)?i=3:f.header==null&&(i=0),typeof p){case"string":h=Pe(p);break;case"number":h=Pe(n["!ref"]),h.s.r=p;break;default:h=p}i>0&&(r=0);var m=Si(h.s.r),v=[],x=[],E=0,_=0,b=Array.isArray(n),A=h.s.r,T=0,S={};b&&!n[A]&&(n[A]=[]);var C=f.skipHidden&&n["!cols"]||[],N=f.skipHidden&&n["!rows"]||[];for(T=h.s.c;T<=h.e.c;++T)if(!(C[T]||{}).hidden)switch(v[T]=Oi(T),e=b?n[A][T]:n[v[T]+m],i){case 1:a[T]=T-h.s.c;break;case 2:a[T]=v[T];break;case 3:a[T]=f.header[T-h.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),c=l=Hr(e,null,f),_=S[l]||0,!_)S[l]=1;else{do c=l+"_"+_++;while(S[c]);S[l]=_,S[c]=1}a[T]=c}for(A=h.s.r+r;A<=h.e.r;++A)if(!(N[A]||{}).hidden){var B=s4(n,h,A,v,i,a,b,f);(B.isempty===!1||(i===1?f.blankrows!==!1:f.blankrows))&&(x[E++]=B.row)}return x.length=E,x}var Ey=/"/g;function a4(n,t,e,i,r,a,l,c){for(var h=!0,f=[],p="",m=Si(e),v=t.s.c;v<=t.e.c;++v)if(i[v]){var x=c.dense?(n[e]||[])[v]:n[i[v]+m];if(x==null)p="";else if(x.v!=null){h=!1,p=""+(c.rawNumbers&&x.t=="n"?x.v:Hr(x,null,c));for(var E=0,_=0;E!==p.length;++E)if((_=p.charCodeAt(E))===r||_===a||_===34||c.forceQuotes){p='"'+p.replace(Ey,'""')+'"';break}p=="ID"&&(p='"ID"')}else x.f!=null&&!x.F?(h=!1,p="="+x.f,p.indexOf(",")>=0&&(p='"'+p.replace(Ey,'""')+'"')):p="";f.push(p)}return c.blankrows===!1&&h?null:f.join(l)}function Vp(n,t){var e=[],i=t??{};if(n==null||n["!ref"]==null)return"";var r=Pe(n["!ref"]),a=i.FS!==void 0?i.FS:",",l=a.charCodeAt(0),c=i.RS!==void 0?i.RS:`
`,h=c.charCodeAt(0),f=new RegExp((a=="|"?"\\|":a)+"+$"),p="",m=[];i.dense=Array.isArray(n);for(var v=i.skipHidden&&n["!cols"]||[],x=i.skipHidden&&n["!rows"]||[],E=r.s.c;E<=r.e.c;++E)(v[E]||{}).hidden||(m[E]=Oi(E));for(var _=0,b=r.s.r;b<=r.e.r;++b)(x[b]||{}).hidden||(p=a4(n,r,b,m,l,h,a,i),p!=null&&(i.strip&&(p=p.replace(f,"")),(p||i.blankrows!==!1)&&e.push((_++?c:"")+p)));return delete i.dense,e.join("")}function QE(n,t){t||(t={}),t.FS="	",t.RS=`
`;var e=Vp(n,t);return e}function o4(n){var t="",e,i="";if(n==null||n["!ref"]==null)return[];var r=Pe(n["!ref"]),a="",l=[],c,h=[],f=Array.isArray(n);for(c=r.s.c;c<=r.e.c;++c)l[c]=Oi(c);for(var p=r.s.r;p<=r.e.r;++p)for(a=Si(p),c=r.s.c;c<=r.e.c;++c)if(t=l[c]+a,e=f?(n[p]||[])[c]:n[t],i="",e!==void 0){if(e.F!=null){if(t=e.F,!e.f)continue;i=e.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(e.f!=null)i=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)i=""+e.v;else if(e.t=="b")i=e.v?"TRUE":"FALSE";else if(e.w!==void 0)i="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?i="'"+e.v:i=""+e.v}}h[h.length]=t+"="+i}return h}function ZE(n,t,e){var i=e||{},r=+!i.skipHeader,a=n||{},l=0,c=0;if(a&&i.origin!=null)if(typeof i.origin=="number")l=i.origin;else{var h=typeof i.origin=="string"?fi(i.origin):i.origin;l=h.r,c=h.c}var f,p={s:{c:0,r:0},e:{c,r:l+t.length-1+r}};if(a["!ref"]){var m=Pe(a["!ref"]);p.e.c=Math.max(p.e.c,m.e.c),p.e.r=Math.max(p.e.r,m.e.r),l==-1&&(l=m.e.r+1,p.e.r=l+t.length-1+r)}else l==-1&&(l=0,p.e.r=t.length-1+r);var v=i.header||[],x=0;t.forEach(function(_,b){Ti(_).forEach(function(A){(x=v.indexOf(A))==-1&&(v[x=v.length]=A);var T=_[A],S="z",C="",N=be({c:c+x,r:l+b+r});f=ac(a,N),T&&typeof T=="object"&&!(T instanceof Date)?a[N]=T:(typeof T=="number"?S="n":typeof T=="boolean"?S="b":typeof T=="string"?S="s":T instanceof Date?(S="d",i.cellDates||(S="n",T=Qi(T)),C=i.dateNF||je[14]):T===null&&i.nullError&&(S="e",T=0),f?(f.t=S,f.v=T,delete f.w,delete f.R,C&&(f.z=C)):a[N]=f={t:S,v:T},C&&(f.z=C))})}),p.e.c=Math.max(p.e.c,c+v.length-1);var E=Si(l);if(r)for(x=0;x<v.length;++x)a[Oi(x+c)+E]={t:"s",v:v[x]};return a["!ref"]=ti(p),a}function l4(n,t){return ZE(null,n,t)}function ac(n,t,e){if(typeof t=="string"){if(Array.isArray(n)){var i=fi(t);return n[i.r]||(n[i.r]=[]),n[i.r][i.c]||(n[i.r][i.c]={t:"z"})}return n[t]||(n[t]={t:"z"})}return typeof t!="number"?ac(n,be(t)):ac(n,be({r:t,c:e||0}))}function c4(n,t){if(typeof t=="number"){if(t>=0&&n.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var e=n.SheetNames.indexOf(t);if(e>-1)return e;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function u4(){return{SheetNames:[],Sheets:{}}}function h4(n,t,e,i){var r=1;if(!e)for(;r<=65535&&n.SheetNames.indexOf(e="Sheet"+r)!=-1;++r,e=void 0);if(!e||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(i&&n.SheetNames.indexOf(e)>=0){var a=e.match(/(^.*?)(\d+)$/);r=a&&+a[2]||0;var l=a&&a[1]||e;for(++r;r<=65535&&n.SheetNames.indexOf(e=l+r)!=-1;++r);}if(jE(e),n.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return n.SheetNames.push(e),n.Sheets[e]=t,e}function f4(n,t,e){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var i=c4(n,t);switch(n.Workbook.Sheets[i]||(n.Workbook.Sheets[i]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}n.Workbook.Sheets[i].Hidden=e}function d4(n,t){return n.z=t,n}function JE(n,t,e){return t?(n.l={Target:t},e&&(n.l.Tooltip=e)):delete n.l,n}function p4(n,t,e){return JE(n,"#"+t,e)}function g4(n,t,e){n.c||(n.c=[]),n.c.push({t,a:e||"SheetJS"})}function m4(n,t,e,i){for(var r=typeof t!="string"?t:Pe(t),a=typeof t=="string"?t:ti(t),l=r.s.r;l<=r.e.r;++l)for(var c=r.s.c;c<=r.e.c;++c){var h=ac(n,l,c);h.t="n",h.F=a,delete h.v,l==r.s.r&&c==r.s.c&&(h.f=e,i&&(h.D=!0))}return n}var R0={encode_col:Oi,encode_row:Si,encode_cell:be,encode_range:ti,decode_col:Op,decode_row:Np,split_cell:MR,decode_cell:fi,decode_range:pn,format_cell:Hr,sheet_add_aoa:J_,sheet_add_json:ZE,sheet_add_dom:XE,aoa_to_sheet:So,json_to_sheet:l4,table_to_sheet:YE,table_to_book:UP,sheet_to_csv:Vp,sheet_to_txt:QE,sheet_to_json:Ch,sheet_to_html:WE,sheet_to_formulae:o4,sheet_to_row_object_array:Ch,sheet_get_cell:ac,book_new:u4,book_append_sheet:h4,book_set_sheet_visibility:f4,cell_set_number_format:d4,cell_set_hyperlink:JE,cell_set_internal_link:p4,cell_add_comment:g4,sheet_set_array_formula:m4,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};ho.workerSrc=mT;const tb="docreview_state_v1";function Pr(){try{return JSON.parse(localStorage.getItem(tb)||"{}")}catch{return{}}}function oc(n){localStorage.setItem(tb,JSON.stringify(n))}function Wh(n="id"){return`${n}_${Math.random().toString(36).slice(2,9)}`}function eb(){return new Date().toISOString()}function v4(){const[n,t]=re.useState(()=>Pr().user||null);return{user:n,login:r=>{const a={id:Wh("u"),name:r.split("@")[0],email:r},l=Pr();l.user=a,oc(l),t(a)},logout:()=>{const r=Pr();delete r.user,oc(r),t(null)}}}function x4(){const[n,t]=re.useState(()=>Pr().files||[]);return re.useEffect(()=>{const r=Pr();t(r.files||[])},[]),{files:n,addFile:r=>{const a=Pr();a.files=a.files||[],a.files.push(r),oc(a),t(a.files)},removeFile:r=>{const a=Pr();a.files=(a.files||[]).filter(l=>l.id!==r),oc(a),t(a.files)}}}function y4({onLogin:n}){const[t,e]=re.useState("");return ct.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:ct.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow p-6 space-y-4",children:[ct.jsx("h1",{className:"text-2xl font-bold",children:"DocReview Login"}),ct.jsx("input",{className:"w-full border rounded-lg p-2",placeholder:"email",value:t,onChange:i=>e(i.target.value)}),ct.jsx("button",{className:"w-full py-2 rounded-xl bg-black text-white",onClick:()=>t&&n(t),children:"Login"})]})})}function _4({user:n,files:t,onOpen:e,onDelete:i}){return ct.jsx("div",{className:"min-h-screen bg-gray-50",children:ct.jsxs("div",{className:"max-w-5xl mx-auto py-6",children:[ct.jsx("div",{className:"flex items-center justify-between mb-4",children:ct.jsx("h2",{className:"text-xl font-semibold",children:"Library"})}),ct.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.map(r=>ct.jsxs("div",{className:"bg-white rounded-xl p-4 shadow flex items-center justify-between",children:[ct.jsxs("div",{children:[ct.jsx("div",{className:"font-medium",children:r.name}),ct.jsx("div",{className:"text-xs text-gray-500",children:new Date(r.created_at).toLocaleString()})]}),ct.jsxs("div",{className:"flex gap-2",children:[ct.jsx("button",{className:"px-3 py-1 rounded-lg border",onClick:()=>e(r),children:"Open"}),ct.jsx("button",{className:"px-3 py-1 rounded-lg border text-red-600",onClick:()=>i(r.id),children:"Delete"})]})]},r.id)),t.length===0&&ct.jsx("div",{className:"text-gray-500",children:"Belum ada file. Gunakan tombol “Upload PDF” di kanan atas."})]})]})})}function E4({sections:n,onJump:t,activeId:e,getDisplayLabel:i}){return ct.jsxs("div",{className:"w-56 border-r overflow-auto p-2",style:{height:"calc(100vh - 64px)"},children:[ct.jsx("div",{className:"font-semibold mb-2",children:"Sections"}),n.map(r=>ct.jsxs("button",{className:`block w-full text-left px-2 py-1 rounded-lg hover:bg-gray-50 ${e===r.id?"bg-gray-100":""}`,onClick:()=>t(r),title:r.title,children:[" ".repeat(2*Math.max(0,(r.level||1)-1)),r.title,ct.jsxs("span",{className:"text-[11px] text-gray-500 ml-1",children:["[",i(r.page),"]"]})]},r.id)),n.length===0&&ct.jsx("div",{className:"text-gray-500 text-sm",children:"(Tidak ada outline; menggunakan deteksi heading fallback)"})]})}function b4({user:n,file:t,sections:e,page:i,onAdd:r,comments:a,onExport:l,pickMode:c,setPickMode:h,activeSectionId:f,onRequestJumpSection:p,getDisplayLabel:m}){const[v,x]=re.useState(""),[E,_]=re.useState(""),[b,A]=re.useState("");re.useEffect(()=>{x(f??"")},[f]),re.useEffect(()=>{_("")},[i]);const T=()=>{b.trim()&&(r({section_id:v||null,page:i,line_no:null,body:b,comment_type:"region",region_bbox:null}),A(""))},S=C=>{const N=C.target.value;if(x(N),!N)return;const B=e.find(O=>O.id===N);B&&p&&p(B)};return ct.jsx("div",{className:"w-70 border-l gap-2",style:{height:"calc(100vh - 64px)"},children:ct.jsxs("div",{className:"h-full flex flex-col",children:[ct.jsxs("div",{className:"p-3 border-b",children:[ct.jsx("div",{className:"font-semibold mb-2",children:"Komentar"}),ct.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-2 text-sm",children:[ct.jsxs("div",{children:[ct.jsx("label",{className:"block text-xs text-gray-500",children:"Section"}),ct.jsxs("select",{className:"w-full border rounded p-1",value:v,onChange:S,children:[ct.jsx("option",{value:"",children:"(none)"}),e.map(C=>ct.jsx("option",{value:C.id,children:C.title},C.id))]})]}),ct.jsxs("div",{children:[ct.jsx("label",{className:"block text-xs text-gray-500",children:"Page"}),ct.jsx("input",{className:"w-full border rounded p-1",value:m(i)||"",readOnly:!0})]})]}),ct.jsx("textarea",{className:"w-full border rounded p-2 text-sm",rows:3,placeholder:"Tulis komentar...",value:b,onChange:C=>A(C.target.value)}),ct.jsxs("div",{className:"flex justify-between items-center mt-2",children:[ct.jsx("button",{className:"px-3 py-1 bg-black text-white rounded-lg",onClick:T,children:"Tambah"}),ct.jsx("button",{className:"px-3 py-1 border rounded-lg",onClick:l,children:"Export Excel"})]})]}),ct.jsxs("div",{className:"flex-1 overflow-auto p-3",children:[ct.jsx("div",{className:"font-medium mb-2",children:"Riwayat"}),ct.jsxs("div",{className:"space-y-2",children:[a.slice().reverse().map(C=>ct.jsxs("div",{className:"border rounded-lg p-2 text-sm",children:[ct.jsxs("div",{className:"text-[10px] text-gray-500 flex gap-2",children:[ct.jsx("span",{children:new Date(C.created_at).toLocaleString()}),ct.jsxs("span",{children:["• ",C.user_name]}),ct.jsxs("span",{children:["• Pg ",C.page,C.line_no!=null?`, Ln ${C.line_no}`:""]})]}),C.section_title&&ct.jsxs("div",{className:"text-[10px] text-gray-600",children:["Section: ",C.section_title]}),ct.jsx("div",{className:"mt-1",children:C.body})]},C.id)),a.length===0&&ct.jsx("div",{className:"text-gray-500 text-sm",children:"Belum ada komentar."})]})]})]})})}async function A4(n,t){const e=Array.isArray(t)?t:await n.getDestination(t);if(!e)return null;const[i,r,a,l,c]=e;return{pageNum:await n.getPageIndex(i)+1,pdfX:typeof a=="number"?a:0,pdfY:typeof l=="number"?l:0,zoom:typeof c=="number"?c:null,explicitDest:e}}async function ib(n,t,e=1){const i=[];if(!t)return i;for(const r of t){let a=null;try{r.dest&&(a=await A4(n,r.dest))}catch{a=null}if(i.push({id:Wh("sec"),title:r.title||"Untitled",level:e,loc:a?{pageNum:a.pageNum,pdfX:a.pdfX,pdfY:a.pdfY,zoom:a.zoom}:null,explicitDest:a?a.explicitDest:null}),r.items&&r.items.length){const l=await ib(n,r.items,e+1);i.push(...l)}}return i}function w4({onOpen:n}){return ct.jsx("button",{className:"pdf-floating fixed z-40 top-20 left-4 px-2.5 py-1.5 text-xs rounded-lg border bg-white/90 backdrop-blur shadow hover:bg-white pointer-events-auto",onClick:n,title:"Buka Sections","aria-label":"Buka Sections",children:"☰"})}function S4({open:n,onClose:t,children:e}){return ct.jsx("div",{className:"fixed z-50 top-16 left-0 bottom-0 transition-transform pointer-events-none",children:ct.jsxs("div",{className:`h-full w-[15rem] max-w-[90vw] bg-white/90 backdrop-blur border-r shadow-2xl rounded-r-xl
        ${n?"translate-x-0":"-translate-x-full"} pointer-events-auto transition-transform duration-300`,role:"dialog","aria-modal":"false",children:[ct.jsxs("div",{className:"h-9 flex items-center justify-between px-3 border-b",children:[ct.jsx("div",{className:"font-medium text-sm",children:"Sections"}),ct.jsx("button",{className:"text-xs px-2 py-1 rounded border",onClick:t,children:"Tutup"})]}),ct.jsx("div",{className:"h-[calc(100%-2.25rem)] overflow-auto",children:e})]})})}function T4({sections:n,activeId:t,onJump:e,getDisplayLabel:i,onClose:r}){const a=Array.isArray(n)?n:[];return ct.jsx("div",{className:"p-2",children:ct.jsx("div",{className:"space-y-1",children:a.length?a.map(l=>ct.jsxs("button",{className:`w-full text-left px-2 py-1 rounded hover:bg-gray-50 text-sm
              ${t===l.id?"bg-gray-100 font-medium":""}`,title:l.title,onClick:()=>{e?.(l)},children:[l.title,ct.jsxs("span",{className:"text-[11px] text-gray-500 ml-1",children:["[",i(l.page),"]"]})]},l.id)):ct.jsx("div",{className:"text-xs text-gray-500 px-2",children:"Tidak ada outline."})})})}function C4({open:n,onClose:t,children:e}){return n?ct.jsx("div",{className:`fixed z-50 bottom-4 right-4
                 w-60 max-w-[90vw] max-h-[75vh]
                 bg-white/80 backdrop-blur-md border shadow-2xl rounded-xl
                 flex flex-col overflow-hidden
                 transition-all duration-200`,role:"dialog","aria-modal":"false",children:ct.jsx("div",{className:"flex-1 overflow-auto",children:e})}):null}function R4({onExpand:n,comments:t,pageLabel:e}){const r=(Array.isArray(t)?t:[]).slice(-1);return ct.jsx("div",{className:"pdf-floating absolute bottom-4 right-4 z-40",children:ct.jsxs("div",{className:"bg-white/70 backdrop-blur-md border shadow-xl rounded-xl w-40 max-w-[80vw]",children:[ct.jsxs("div",{className:"px-3 py-2 border-b flex items-center justify-between",children:[ct.jsx("div",{className:"text-sm font-medium",children:"Komentar"}),ct.jsx("button",{className:"text-xs px-2 py-1 border rounded",onClick:n,children:"Buka"})]}),ct.jsx("div",{className:"p-3 text-xs text-gray-600",children:r.length?ct.jsxs(ct.Fragment,{children:[ct.jsx("div",{className:"font-medium mb-1",children:"Terbaru"}),ct.jsx("div",{className:"line-clamp-2",children:r[0].body})]}):ct.jsx("div",{children:"Belum ada komentar."})})]})})}function D4({sections:n,page:t,onAdd:e,pickMode:i,setPickMode:r,getDisplayLabel:a,onClose:l,activeSectionId:c,onRequestJumpSection:h}){const[f,p]=qs.useState(""),[m,v]=qs.useState(""),[x,E]=qs.useState("");qs.useEffect(()=>{v("")},[t]),qs.useEffect(()=>{c&&p(c)},[c]);const _=()=>{x.trim()&&(e({section_id:f||null,page:t,line_no:null,body:x,comment_type:"region",region_bbox:null}),E(""),v(""))};return ct.jsxs("div",{className:"h-full flex flex-col",children:[ct.jsxs("div",{className:"h-10 flex items-center justify-between px-3 border-b sticky top-0 bg-white/80 backdrop-blur-md",children:[ct.jsx("div",{className:"font-medium text-sm",children:"Tambah Komentar"}),ct.jsx("button",{className:"text-sm px-2 py-1 rounded border",onClick:l,children:"Tutup"})]}),ct.jsxs("div",{className:"p-3 space-y-2 text-sm overflow-auto",children:[ct.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[ct.jsxs("div",{children:[ct.jsx("label",{className:"block text-xs text-gray-500",children:"Section"}),ct.jsxs("select",{className:"w-full border rounded p-1",value:f,onChange:b=>{const A=b.target.value;if(p(A),!A)return;const T=(n||[]).find(S=>S.id===A);T&&h&&h(T)},children:[ct.jsx("option",{value:"",children:"(none)"}),(Array.isArray(n)?n:[]).map(b=>ct.jsx("option",{value:b.id,children:b.title},b.id))]})]}),ct.jsxs("div",{children:[ct.jsx("label",{className:"block text-xs text-gray-500",children:"Page"}),ct.jsx("input",{className:"w-full border rounded p-1",value:a(t)||"",readOnly:!0})]})]}),ct.jsxs("div",{children:[ct.jsx("label",{className:"block text-xs text-gray-500",children:"Komentar"}),ct.jsx("textarea",{className:"w-full border rounded p-2 text-sm",rows:4,placeholder:"Tulis komentar…",value:x,onChange:b=>E(b.target.value)})]}),ct.jsx("div",{className:"flex justify-end",children:ct.jsx("button",{className:"px-3 py-1 bg-black text-white rounded-lg",onClick:_,children:"Tambah"})})]})]})}function M4({pageNumber:n,pageLabel:t}){return ct.jsx("div",{className:"fixed z-40 top-20 right-8 px-2.5 py-1.5 text-xs rounded-lg border bg-white/90 backdrop-blur shadow pointer-events-none",children:ct.jsxs("div",{className:"flex items-center gap-1",children:[ct.jsx("span",{className:"font-medium",children:"Page"}),ct.jsxs("span",{children:[": ",ct.jsx("b",{children:n})]})]})})}function N4({user:n,file:t,onBack:e}){const i=re.useRef(null),r=re.useRef(null),a=re.useRef(null),l=re.useRef(null),[c,h]=re.useState(null),[f,p]=re.useState([]),[m,v]=re.useState(null),[x,E]=re.useState(1),[_,b]=re.useState(()=>(Pr().comments||[]).filter(pt=>pt.file_id===t.id)),[A,T]=re.useState(null),S=re.useRef(!1),C=re.useRef(null),[N,B]=re.useState(!0),O=re.useRef([]),[H,M]=re.useState("text"),W=re.useRef(null),[Y,J]=re.useState(!1),[ut,At]=re.useState(!1),[Et,q]=re.useState(!1),nt=pt=>A&&A[pt-1]?A[pt-1]:String(pt);re.useEffect(()=>{let pt=!1;return(async()=>{B(!0);try{const Ut=await Wy({url:t.url,useSystemFonts:!0}).promise;if(W.current=Ut,pt)return;const Lt=new Ep;a.current=Lt;const Qt=new yp({eventBus:Lt}),jt=new bp({container:i.current,eventBus:Lt,linkService:Qt,textLayerMode:2});Qt.setViewer(jt),r.current=jt,l.current=Qt,jt.setDocument(Ut),Qt.setDocument(Ut),Lt.on("pagesinit",()=>{S.current=!0,r.current.currentScaleValue="page-width",St(),C.current&&(ht(C.current),C.current=null)}),Lt.on("pagechanging",Rt=>{Rt?.pageNumber&&E(Rt.pageNumber)}),Lt.on("updateviewarea",Rt=>{const ce=Rt?.location?.pageNumber??r.current?.currentPageNumber;ce&&E(ce)}),Lt.on("pagerendered",async Rt=>{const ce=Rt.pageNumber;r.current?._pages?.[ce-1]});try{const Rt=await Ut.getPageLabels();pt||T(Rt||null)}catch{pt||T(null)}let ge=[];const ae=await Ut.getOutline();ae&&ae.length&&(ge=(await ib(Ut,ae,1)).map(ce=>({id:ce.id,title:ce.title,level:ce.level,page:ce.loc?.pageNum||1,pdfX:ce.loc?.pdfX??null,pdfY:ce.loc?.pdfY??null,dest:ce.explicitDest||null}))),pt||p(ge)}catch(yt){console.error("Gagal memuat PDF:",yt)}finally{pt||B(!1)}})(),()=>{pt=!0;try{r.current?.setDocument(null),l.current?.setDocument(null)}catch{}}},[t.url]),re.useEffect(()=>{const pt=i.current;if(!pt)return;let yt=null;const Ut=()=>{cancelAnimationFrame(yt),yt=requestAnimationFrame(()=>{const Lt=pt.scrollTop+pt.clientHeight/2,Qt=O.current;if(!Qt.length)return;let jt=Qt[0];for(const ge of Qt)if(ge.absY<=Lt)jt=ge;else break;jt&&jt.id!==m&&v(jt.id)})};return pt.addEventListener("scroll",Ut,{passive:!0}),()=>{pt.removeEventListener("scroll",Ut),yt&&cancelAnimationFrame(yt)}},[m]);const St=qs.useCallback(()=>{const pt=r.current,yt=i.current;if(!pt||!yt||!f.length)return;const Ut=[];for(const Lt of f){const Qt=pt._pages?.[Lt.page-1];if(!Qt)continue;const jt=Qt.div.offsetTop;let ge=0;if(typeof Lt.pdfY=="number"){const[Rt,ce]=Qt.viewport.convertToViewportPoint(Lt.pdfX||0,Lt.pdfY);ge=ce}const ae=jt+ge;Ut.push({id:Lt.id,page:Lt.page,absY:ae})}Ut.sort((Lt,Qt)=>Lt.absY-Qt.absY),O.current=Ut},[f]),kt=({section_id:pt,page:yt,line_no:Ut,body:Lt,comment_type:Qt,region_bbox:jt})=>{const ge=Pr();ge.comments=ge.comments||[];const ae=pt&&f.find(ce=>ce.id===pt)?.title||null,Rt={id:Wh("c"),file_id:t.id,section_id:pt||null,section_title:ae,page:yt,line_no:Ut||null,body:Lt,user_id:n.id,user_name:n.name,created_at:eb(),comment_type:Qt||null,region_bbox:jt||null};ge.comments.push(Rt),oc(ge),b(ge.comments.filter(ce=>ce.file_id===t.id))},G=()=>{const pt=_.map(Lt=>({Section:Lt.section_title||"","Hal (PDF)":Lt.page,"Hal (Label)":nt(Lt.page),Line:Lt.line_no||"-",Komentar:Lt.body,User:Lt.user_name,Waktu:new Date(Lt.created_at).toLocaleString()})),yt=R0.json_to_sheet(pt),Ut=R0.book_new();R0.book_append_sheet(Ut,yt,"Comments"),r4(Ut,`${t.name.replace(/\.pdf$/i,"")}_comments.xlsx`)},ht=pt=>{if(!S.current){C.current=pt;return}const yt=r.current,Ut=i.current;if(!yt||!Ut)return;if(!yt._pages?.[pt.page-1]){l.current?.goToPage(pt.page);return}St();const jt=O.current.find(ge=>ge.id===pt.id);if(jt){const ae=Math.max(0,jt.absY-Ut.clientHeight*.35);Ut.scrollTo({top:ae,behavior:"smooth"})}else pt.dest&&yt.scrollPageIntoView?yt.scrollPageIntoView({pageNumber:pt.page,destArray:pt.dest}):l.current?.goToPage(pt.page);v(pt.id),E(pt.page)},P=re.useRef(null),j=qs.useCallback(()=>{P.current&&cancelAnimationFrame(P.current),P.current=requestAnimationFrame(()=>{St(),setTimeout(()=>St(),120)})},[St]);re.useEffect(()=>{const pt=a.current;if(!pt)return;const yt=()=>j(),Ut=()=>j();return pt.on("scalechanging",yt),pt.on("scalechange",yt),pt.on("pagerendered",Ut),()=>{pt.off?.("scalechanging",yt),pt.off?.("scalechange",yt),pt.off?.("pagerendered",Ut)}},[j]),re.useEffect(()=>{r.current&&requestAnimationFrame(()=>{try{a.current?.dispatch?.("resize",{source:window})}catch{}try{window.dispatchEvent(new Event("resize"))}catch{}const pt=r.current,yt=pt.currentScaleValue;yt?pt.currentScaleValue=yt:pt.currentScale=pt.currentScale,pageLineIndexRef.current.clear(),j()})},[Y,j]);const z=()=>{pageLineIndexRef.current?.clear?.(),j()},X=()=>{r.current&&(r.current.currentScale*=1.1,z())},et=()=>{r.current&&(r.current.currentScale/=1.1,z())},wt=()=>{r.current&&(r.current.currentScaleValue="page-width",z())},Ct=()=>{r.current&&(r.current.currentScaleValue="page-fit",z())};return ct.jsxs("div",{className:"min-h-screen flex flex-col",children:[ct.jsxs("div",{className:"h-16 border-b flex items-center justify-between px-4",children:[ct.jsxs("div",{className:"flex items-center gap-3",children:[ct.jsx("button",{className:"px-3 py-1 border rounded-lg",onClick:e,children:"← Library"}),ct.jsx("div",{className:"font-semibold",children:t.name})]}),ct.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[ct.jsx("button",{className:"px-2 border rounded",onClick:et,children:"-"}),ct.jsx("button",{className:"px-2 border rounded",onClick:X,children:"+"}),ct.jsx("button",{className:"px-2 border rounded",onClick:wt,children:"Fit W"}),ct.jsx("button",{className:"px-2 border rounded",onClick:Ct,children:"Fit P"}),ct.jsx("button",{className:"px-2 border rounded",onClick:()=>J(pt=>{const yt=!pt;return yt||(q(!1),At(!1)),yt}),title:"Toggle Fullscreen PDF",children:Y?"Exit Full":"Full PDF"})]})]}),ct.jsx("div",{className:"flex-1 overflow-hidden",children:ct.jsxs("div",{className:"flex h-[calc(100vh-64px)]",children:[ct.jsx("div",{className:Y?"hidden":"",children:ct.jsx(E4,{sections:f,onJump:ht,activeId:m,getDisplayLabel:nt})}),ct.jsxs("div",{className:"relative flex-1",children:[ct.jsxs("div",{ref:i,className:"absolute inset-0 overflow-auto bg-neutral-500",children:[ct.jsx("div",{className:"pdfViewer"}),N&&ct.jsx("div",{className:"pdf-floating absolute inset-0 flex items-center justify-center bg-black/30 text-white text-lg font-semibold",children:"Loading PDF..."})]}),!Y&&ct.jsx("div",{className:"pdf-floating pointer-events-none absolute top-2 left-1/2 -translate-x-1/2 z-30",children:ct.jsxs("div",{className:"rounded-full border bg-white/90 backdrop-blur px-3 py-1 text-xs shadow",children:[ct.jsx("b",{children:"Page"}),":",ct.jsx("b",{children:x})]})}),Y&&ct.jsx(M4,{pageNumber:x}),Y&&ct.jsx(w4,{onOpen:()=>At(!0)}),Y&&ct.jsx(R4,{onExpand:()=>q(!0),comments:_,pageLabel:nt(x)})]}),!Y&&ct.jsx(b4,{user:n,file:t,sections:f,page:x,onAdd:kt,comments:_,onExport:G,activeSectionId:m,onRequestJumpSection:ht,getDisplayLabel:nt})]})}),Y&&ct.jsx(S4,{open:ut,onClose:()=>At(!1),children:ct.jsx(T4,{sections:f,activeId:m,onJump:pt=>{At(!1),ht(pt)},getDisplayLabel:nt,onClose:()=>At(!1)})}),Y&&ct.jsx(C4,{open:Et,onClose:()=>q(!1),children:ct.jsx(D4,{sections:Array.isArray(f)?f:[],page:x,onAdd:kt,getDisplayLabel:nt,onClose:()=>q(!1),activeSectionId:m,onRequestJumpSection:ht})})]})}function O4(){const{user:n,login:t,logout:e}=v4(),{files:i,addFile:r,removeFile:a}=x4(),[l,c]=re.useState(null),h=re.useRef(null),f=()=>h.current?.click(),p=async m=>{const v=m.target.files?.[0];if(!v||!n)return;const x=URL.createObjectURL(v),E={id:Wh("f"),owner_id:n.id,name:v.name,mime:v.type,url:x,created_at:eb()};r(E),m.target.value=""};return n?l?ct.jsx(N4,{user:n,file:l,onBack:()=>c(null)}):ct.jsxs("div",{className:"min-h-screen",children:[ct.jsxs("div",{className:"h-16 border-b flex items-center justify-between px-4",children:[ct.jsxs("div",{className:"flex items-center gap-2",children:[ct.jsx("img",{src:"GHI.png",alt:"DocReview",className:"h-6 w-auto",loading:"eager",onError:m=>{m.currentTarget.style.display="none"}}),ct.jsx("span",{className:"sr-only",children:"DocReview"})]}),ct.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[ct.jsx("input",{type:"file",accept:"application/pdf",ref:h,className:"hidden",onChange:p}),ct.jsx("span",{children:n.email}),ct.jsx("button",{className:"px-3 py-1 border rounded-lg",onClick:e,children:"Logout"}),ct.jsx("button",{className:"px-3 py-1 border rounded-lg",onClick:f,children:"Upload PDF"})]})]}),ct.jsx(_4,{user:n,files:i,onOpen:c,onDelete:a})]}):ct.jsx(y4,{onLogin:t})}_w.createRoot(document.getElementById("root")).render(ct.jsx(re.StrictMode,{children:ct.jsx(O4,{})}));
